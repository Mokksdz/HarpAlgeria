From fa2516b171558c7f91fa357e33025f55736a9c8c Mon Sep 17 00:00:00 2001
From: Aura Academy <beta@aura-academy.com>
Date: Sat, 6 Dec 2025 12:29:44 +0100
Subject: [PATCH 1/7] style: apply Prettier formatting to all source files

---
 prisma/dev.db                                 |  Bin 622592 -> 622592 bytes
 src/app/about/page.tsx                        |  488 +++--
 src/app/account/page.tsx                      |   87 +-
 src/app/admin/clients/page.tsx                |  224 +-
 src/app/admin/collections/[id]/edit/page.tsx  |  474 +++--
 src/app/admin/collections/new/page.tsx        |  457 +++--
 src/app/admin/collections/page.tsx            |  329 +--
 .../admin/compta/advances/[id]/apply/page.tsx |   88 +-
 src/app/admin/compta/advances/new/page.tsx    |   66 +-
 src/app/admin/compta/advances/page.tsx        |   55 +-
 src/app/admin/compta/charges/new/page.tsx     |   66 +-
 src/app/admin/compta/charges/page.tsx         |   94 +-
 src/app/admin/compta/layout.tsx               |   15 +-
 src/app/admin/compta/models/[id]/bom/page.tsx |  113 +-
 .../admin/compta/models/[id]/costs/page.tsx   |   92 +-
 src/app/admin/compta/models/new/page.tsx      |   88 +-
 src/app/admin/compta/models/page.tsx          |   36 +-
 src/app/admin/compta/page.tsx                 |  100 +-
 .../compta/production/[id]/consume/page.tsx   |   88 +-
 src/app/admin/compta/production/[id]/page.tsx |  122 +-
 src/app/admin/compta/production/new/page.tsx  |   78 +-
 src/app/admin/compta/production/page.tsx      |   71 +-
 src/app/admin/compta/purchases/[id]/page.tsx  |  138 +-
 .../compta/purchases/[id]/receive/page.tsx    |  120 +-
 src/app/admin/compta/purchases/new/page.tsx   |  113 +-
 src/app/admin/compta/purchases/page.tsx       |   83 +-
 src/app/admin/compta/reports/page.tsx         |   89 +-
 src/app/admin/compta/stock/[id]/page.tsx      |  101 +-
 src/app/admin/compta/stock/new/page.tsx       |   92 +-
 src/app/admin/compta/stock/page.tsx           |  100 +-
 src/app/admin/docs/page.tsx                   |   60 +-
 src/app/admin/layout.tsx                      |  336 +--
 src/app/admin/login/page.tsx                  |  263 +--
 src/app/admin/orders/page.tsx                 | 1365 +++++++------
 src/app/admin/page.tsx                        |  936 +++++----
 src/app/admin/products/[id]/edit/page.tsx     | 1056 +++++-----
 src/app/admin/products/new/page.tsx           | 1172 ++++++-----
 src/app/admin/products/page.tsx               |  370 ++--
 src/app/admin/settings/customization/page.tsx |    4 +-
 src/app/admin/settings/page.tsx               |   77 +-
 src/app/admin/shipping/page.tsx               | 1186 ++++++-----
 .../accounting/advances/[id]/apply/route.ts   |    8 +-
 src/app/api/accounting/advances/[id]/route.ts |   35 +-
 src/app/api/accounting/advances/route.ts      |   15 +-
 src/app/api/accounting/charges/[id]/route.ts  |   22 +-
 src/app/api/accounting/charges/route.ts       |   20 +-
 .../api/accounting/inventory/[id]/route.ts    |   35 +-
 .../accounting/inventory/adjustment/route.ts  |   13 +-
 .../accounting/inventory/reconcile/route.ts   |   20 +-
 src/app/api/accounting/inventory/route.ts     |   48 +-
 .../inventory/transactions/route.ts           |    4 +-
 src/app/api/accounting/marketing/route.ts     |   12 +-
 .../api/accounting/models/[id]/bom/route.ts   |   43 +-
 .../api/accounting/models/[id]/costs/route.ts |   16 +-
 .../models/[id]/costs/snapshot/route.ts       |    8 +-
 src/app/api/accounting/models/[id]/route.ts   |  160 +-
 src/app/api/accounting/models/route.ts        |  106 +-
 .../purchases/[id]/preview/route.ts           |    4 +-
 .../purchases/[id]/receive/route.ts           |   20 +-
 .../api/accounting/purchases/[id]/route.ts    |   51 +-
 src/app/api/accounting/purchases/route.ts     |   77 +-
 src/app/api/accounting/reports/route.ts       |  167 +-
 .../api/accounting/suppliers/[id]/route.ts    |   14 +-
 src/app/api/accounting/suppliers/route.ts     |   15 +-
 src/app/api/collections/[id]/route.ts         |  127 +-
 src/app/api/collections/route.ts              |  133 +-
 src/app/api/docs/route.ts                     |    8 +-
 src/app/api/orders/[id]/reserve/route.ts      |   58 +-
 src/app/api/orders/[id]/route.ts              |  337 +--
 src/app/api/orders/[id]/ship/route.ts         |   34 +-
 src/app/api/orders/route.ts                   |  311 +--
 src/app/api/production/[id]/consume/route.ts  |   29 +-
 src/app/api/production/[id]/route.ts          |   50 +-
 src/app/api/production/route.ts               |   60 +-
 src/app/api/products/[id]/route.ts            |  146 +-
 src/app/api/products/route.ts                 |  210 +-
 src/app/api/seed/route.ts                     |  305 +--
 src/app/api/shipping/route.ts                 |  154 +-
 src/app/api/shipping/track/route.ts           |   44 +-
 src/app/api/shipping/yalidine/route.ts        |  210 +-
 src/app/api/shipping/yalidine/track/route.ts  |   99 +-
 src/app/api/tracking/route.ts                 |  464 +++--
 src/app/api/upload/route.ts                   |  101 +-
 src/app/api/v3/account/profile/route.ts       |   32 +-
 src/app/api/v3/admin/birthday/route.ts        |   18 +-
 src/app/api/v3/auth/auto-create/route.ts      |   39 +-
 .../api/v3/auth/magic-link/verify/route.ts    |   27 +-
 .../v3/compta/advances/[id]/apply/route.ts    |   24 +-
 src/app/api/v3/compta/advances/[id]/route.ts  |   29 +-
 src/app/api/v3/compta/advances/route.ts       |    5 +-
 src/app/api/v3/compta/charges/[id]/route.ts   |   25 +-
 src/app/api/v3/compta/charges/route.ts        |    6 +-
 src/app/api/v3/compta/clients/export/route.ts |   37 +-
 src/app/api/v3/compta/clients/route.ts        |   54 +-
 src/app/api/v3/compta/inventory/[id]/route.ts |   49 +-
 .../v3/compta/inventory/adjustment/route.ts   |   29 +-
 .../v3/compta/inventory/reconcile/route.ts    |   23 +-
 src/app/api/v3/compta/inventory/route.ts      |   49 +-
 .../api/v3/compta/models/[id]/bom/route.ts    |   36 +-
 .../api/v3/compta/models/[id]/costs/route.ts  |   42 +-
 src/app/api/v3/compta/models/[id]/route.ts    |   35 +-
 src/app/api/v3/compta/models/route.ts         |    4 +-
 .../compta/production/[id]/complete/route.ts  |   28 +-
 .../compta/production/[id]/consume/route.ts   |   17 +-
 .../compta/production/[id]/preview/route.ts   |   16 +-
 .../api/v3/compta/production/[id]/route.ts    |   54 +-
 src/app/api/v3/compta/production/route.ts     |    8 +-
 .../v3/compta/purchases/[id]/preview/route.ts |   20 +-
 .../v3/compta/purchases/[id]/receive/route.ts |   61 +-
 src/app/api/v3/compta/purchases/[id]/route.ts |   42 +-
 src/app/api/v3/compta/purchases/route.ts      |   41 +-
 src/app/api/v3/compta/reports/route.ts        |    2 +-
 src/app/api/v3/compta/route.ts                |   48 +-
 src/app/api/v3/compta/suppliers/[id]/route.ts |   40 +-
 src/app/api/v3/compta/suppliers/route.ts      |   12 +-
 src/app/api/v3/loyalty/balance/route.ts       |   36 +-
 src/app/api/v3/loyalty/earn/route.ts          |   35 +-
 src/app/api/v3/loyalty/redeem/route.ts        |    4 +-
 src/app/api/v3/loyalty/rewards/route.ts       |    6 +-
 src/app/api/v3/site/hero/history/route.ts     |    8 +-
 src/app/api/v3/site/hero/rollback/route.ts    |    4 +-
 src/app/api/v3/site/settings/hero/route.ts    |   16 +-
 src/app/api/v3/site/settings/route.ts         |    8 +-
 src/app/api/v3/wishlist/route.ts              |    4 +-
 src/app/api/v3/wishlist/sync/route.ts         |   32 +-
 src/app/api/v3/wishlist/toggle/route.ts       |   10 +-
 src/app/auth/magic-link-request/page.tsx      |   72 +-
 src/app/auth/magic-link-verify/page.tsx       |  102 +-
 src/app/checkout/page.tsx                     | 1188 ++++++-----
 src/app/contact/page.tsx                      |  556 ++---
 src/app/error.tsx                             |   78 +-
 src/app/globals.css                           |   38 +-
 src/app/layout.tsx                            |  123 +-
 src/app/loading.tsx                           |   10 +-
 src/app/lookbook/page.tsx                     |  389 ++--
 src/app/loyalty/page.tsx                      |    9 +-
 src/app/not-found.tsx                         |   51 +-
 src/app/order-confirmation/page.tsx           |  188 +-
 src/app/page.tsx                              |  617 +++---
 src/app/privacy/page.tsx                      |  287 +--
 src/app/product/[id]/layout.tsx               |   94 +-
 src/app/product/[id]/page.tsx                 | 1816 ++++++++++-------
 src/app/robots.ts                             |   16 +-
 src/app/shop/page.tsx                         |  507 ++---
 src/app/sitemap.ts                            |  152 +-
 src/app/suivi/page.tsx                        |  516 ++---
 src/app/terms/page.tsx                        |  334 +--
 src/app/wishlist/page.tsx                     |  131 +-
 src/components/Analytics.tsx                  |  245 +--
 src/components/BackInStockAlert.tsx           |  342 ++--
 src/components/CartDrawer.tsx                 |  506 +++--
 src/components/CartProvider.tsx               |  190 +-
 src/components/ErrorBoundary.tsx              |  218 +-
 src/components/Footer.tsx                     |  410 ++--
 src/components/Header.tsx                     |  463 +++--
 src/components/JsonLd.tsx                     |  446 ++--
 src/components/LanguageProvider.tsx           |   82 +-
 src/components/LoyaltyWidget.tsx              |  509 ++---
 src/components/MainLayout.tsx                 |   68 +-
 src/components/ProductCard.tsx                |  205 +-
 src/components/SessionProvider.tsx            |    2 +-
 src/components/Skeleton.tsx                   |   72 +-
 src/components/admin/AdminHeroEditor.tsx      |  279 ++-
 .../loyalty/AccountBirthdayBanner.tsx         |   63 +-
 src/components/loyalty/LoyaltyDashboard.tsx   |  134 +-
 .../loyalty/ProfileCompletionBanner.tsx       |   92 +-
 src/components/loyalty/RewardCard.tsx         |   20 +-
 src/components/wishlist/WishlistButton.tsx    |   22 +-
 src/lib/accounting/constants.ts               |   54 +-
 .../services/__tests__/cost.service.test.ts   |   16 +-
 .../__tests__/inventory.service.test.ts       |   24 +-
 .../accounting/services/advance.service.ts    |   24 +-
 src/lib/accounting/services/cost.service.ts   |  198 +-
 src/lib/accounting/services/index.ts          |    2 +-
 .../accounting/services/inventory.service.ts  |  147 +-
 .../accounting/services/production.service.ts |   55 +-
 .../accounting/services/purchase.service.ts   |   50 +-
 src/lib/accounting/types.ts                   |  146 +-
 src/lib/auth-helpers.ts                       |   58 +-
 src/lib/auth.ts                               |  173 +-
 src/lib/auth/auto-email.service.ts            |  120 +-
 src/lib/compta/accounting.ts                  |   83 +-
 src/lib/compta/schemas/production.schemas.ts  |   30 +-
 src/lib/compta/schemas/purchase.schemas.ts    |   61 +-
 src/lib/compta/services/index.ts              |    4 +-
 src/lib/compta/services/inventory-service.ts  |   93 +-
 src/lib/compta/services/models-service.ts     |   14 +-
 src/lib/compta/services/production-service.ts |  161 +-
 src/lib/compta/services/purchases-service.ts  |  102 +-
 src/lib/config.ts                             |   62 +-
 src/lib/delivery-data.ts                      |  446 +++-
 src/lib/email/magic-link.ts                   |   49 +-
 src/lib/inventory-service.ts                  |   32 +-
 src/lib/logger.ts                             |    6 +-
 src/lib/loyalty/services/loyalty.service.ts   |  151 +-
 src/lib/loyalty/services/wishlist.service.ts  |   41 +-
 src/lib/pagination.ts                         |   14 +-
 src/lib/prisma.ts                             |   12 +-
 src/lib/rate-limit.ts                         |   48 +-
 src/lib/schemas/admin.schemas.ts              |   15 +-
 src/lib/site/settings.service.ts              |   46 +-
 src/lib/translations.ts                       |  783 +++----
 src/lib/utils.ts                              |   31 +-
 src/lib/utils/csv.ts                          |    2 +-
 src/lib/validations.ts                        |  337 +--
 src/lib/validations/profile.ts                |   14 +-
 src/lib/yalidine-stopdesks.ts                 |  116 +-
 src/lib/yalidine.ts                           |  919 +++++----
 src/lib/zrexpress-stopdesks.ts                |  762 +++++--
 src/lib/zrexpress.ts                          |  543 ++---
 src/middleware.ts                             |    8 +-
 src/types/api.ts                              |  390 ++--
 src/types/index.ts                            |  229 ++-
 213 files changed, 19764 insertions(+), 14349 deletions(-)

diff --git a/prisma/dev.db b/prisma/dev.db
index 89af096003394b66147367ee1a7e79e59d8089de..34780f5789f78c9d4c4ade5cbc6d8fb0a0547af2 100644
GIT binary patch
delta 1290
zcmbu8&uiLX7{_@vveZjFZHx+$!FscOjmB3`v(vzO7)U3h?68@i(`u|vQ+1bm>uo42
z$VR)#2BW8y*^wOe4;a|nuEX2BY_PGDqf27_MJfy$!h6X3yr1v)dEReowUt_JrM?W<
zhC2$_PsxqWbp`D_P18_+b~C7)&!=R$SU@j39pwC#J$?aR8*95eAQn`%&kjk!goJg5
z-+*w1G)+|%I>9_hc-N!%yb$_$Ieod3DbO(2Hwsi>>`_dCn@p71c*w+NHs4M?ScE=<
zV{&Wafi^s3E4$lOSX9QkmNVlGq`USRCnQl!l|?E;-DeWarfo}sBlUURIe0scdER4j
zkA~&Jhl>GOc+Kt}2pY4jo4opzXDL<dpiZutjbwCN$ZUjyeqT<e7W!>=PQY#Vr2DxW
zFcpuciWcg)gHtU2m(+mA_VtI8h7_a`9SnrDK4Jeu%zW7IlXk67Vt8vo8q_W}Br(0&
zhT6gg<fzIrd&AHT)3Id)&QlOSC)-Kj(m=%V{bWS2l&L=*gS7>8^$Z&l4&B4i2=*@N
z`p?&p-3O6tx-{M)*Mnh1BT3@J0)-?hObL(|#1JP)bO=Hoau7*e2!?|J$scBUf#+C1
zhj<CHKFD)YK%B_8lbB1xTKHpP&+Iy-UoKTGu;uMsMpDul|5cSrVzK1)q2ToDB4UM=
z^I36~-;u}B;UFX-G<2z~zf_^+YF7XEb9zXg3n4QquclG4cvQRiU1HVruY=|}30+@&
zW_8ib_wZXr_76<_fp*x#p=<eah|O)kv()_9!*8nJ@Buj!JMH&5{)LEKbxLXk828{=
H8b0|4X+gwV

delta 1290
zcmbu7PiWIn9LITEidiqI7e!V~5!|iYdrgz3Cp))*I|!wgF$A^Ezjj;y%_g+#WxWlA
zv5JR+>@XC>lfzDuV+*?~-Oa1)W)J=W@#4mONp07X7KDZHAbIb7zTe;P_pMfEs@0j=
zG>AR-E`Zqk#8UHGaf5>u9pYz0D<&0%TU#%u_!rG)$o=hV@ELe%t&LWP8gsI7yhqD6
zq=FfY1qq9#l7w_ME<A|)=NInzAw*Jkb+nQ#uxqcMbg09{hl@Il2@Ar~vamR?*}m}L
z5c&Y#(kp!rtmR=-%4>2)s`PXncX}Ho>>61&3i)6v&GOm6eIYKyCRTLVRUg(Jf;Xas
z?==zinM47+`PU!^uin}MoYl)6o40epa~w5lphnN(LJ(50t&nAlO~Zgz&Pika)|&_5
zwzpsX&;)G7qn_djYOjJrB6>!fz&G*vyE_<WAQ$FBLDoE>CVx`{KekWkN%Mpz$o(;C
zFj~YZP2gg8jeVj+cTYKbZyCC7J9f0deF&oGbRz*gCWyGc9&`zgW5y3xXKoDLI3`Xh
z7xr+}g}q96{`0kDw?X6zmL{9@e3FGw7FCfCiAhnFL>Lq~C^AUo6~rWE5#diH$w*|v
zDw9-^#0J8u$S?{ERR*zqU%rtbJSMSEKBl&;;Yvk3+(1#2nYDCQR@e3XWtB9gsQFQd
zyBJ+WDJQdqj4~_bv)$+*DFY!5p`}~q3zf=duAIrIR&zKcH-G-IqQX7uN5$#UXpwiR
zS=&Db4RhjHUwP_uQ7^Q~TR8jNvW;Ih_u3@%Opk_4cqi{n)!((r8^#y1Ll4Bx{B=%#
Sq#~E?k`V#c9DGx!PyPZ9#JbP`

diff --git a/src/app/about/page.tsx b/src/app/about/page.tsx
index a88eb54..3e12c81 100644
--- a/src/app/about/page.tsx
+++ b/src/app/about/page.tsx
@@ -3,219 +3,291 @@
 import { useLanguage } from "@/components/LanguageProvider";
 import Image from "next/image";
 import Link from "next/link";
-import { Award, Heart, Sparkles, ArrowRight, Quote, Truck, MapPin, Shield, CheckCircle, Star, Package } from "lucide-react";
+import {
+  Award,
+  Heart,
+  Sparkles,
+  ArrowRight,
+  Quote,
+  Truck,
+  MapPin,
+  Shield,
+  CheckCircle,
+  Star,
+  Package,
+} from "lucide-react";
 
 export default function AboutPage() {
-    useLanguage(); // Keep for potential future i18n
-
-    return (
-        <div className="min-h-screen bg-gradient-to-b from-harp-cream/30 to-white">
-            {/* Hero Section - Minimalist */}
-            <section className="relative pt-32 pb-20 md:pt-40 md:pb-24 overflow-hidden bg-harp-sand/30">
-                <div className="container mx-auto px-4">
-                    <div className="max-w-3xl mx-auto text-center relative z-10">
-                        <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
-                            Notre Histoire
-                        </span>
-                        <h1 className="text-4xl md:text-6xl font-serif font-medium text-gray-900 mb-6 leading-tight">
-                            L'Élégance Intemporelle,<br/>Redéfinie.
-                        </h1>
-                        <p className="text-lg md:text-xl text-gray-500 leading-relaxed font-light max-w-2xl mx-auto">
-                            Une ode à la femme moderne qui ne choisit jamais entre pudeur et style.
-                            Harp incarne une vision nouvelle de la mode algérienne.
-                        </p>
-                    </div>
-                </div>
-                
-                {/* Abstract Background Elements */}
-                <div className="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none">
-                    <div className="absolute -top-[20%] -left-[10%] w-[50%] h-[50%] bg-harp-beige/20 rounded-full blur-3xl" />
-                    <div className="absolute top-[20%] -right-[10%] w-[40%] h-[60%] bg-harp-gold/5 rounded-full blur-3xl" />
-                </div>
-            </section>
-
-            {/* Section 1: Origine de la marque - Asymmetrical Layout */}
-            <section className="py-24 bg-white">
-                <div className="container mx-auto px-4">
-                    <div className="grid grid-cols-1 lg:grid-cols-12 gap-12 items-center">
-                        {/* Text Content */}
-                        <div className="lg:col-span-5 order-2 lg:order-1">
-                            <h2 className="text-3xl md:text-4xl font-serif font-medium text-gray-900 mb-8">
-                                Une histoire de passion <br/> et d'exigence.
-                            </h2>
-                            
-                            <div className="space-y-6 text-gray-600 font-light leading-relaxed">
-                                <p>
-                                    <strong className="text-gray-900 font-medium">Harp</strong> est née d'une volonté simple mais ambitieuse : 
-                                    offrir aux femmes algériennes une mode qui célèbre leur identité avec raffinement.
-                                </p>
-                                <p>
-                                    Loin de la fast-fashion, nous prenons le temps. Le temps de dessiner, de choisir, 
-                                    d'ajuster. Fondée en Algérie, notre maison s'inspire de l'héritage local tout en 
-                                    regardant vers l'avenir.
-                                </p>
-                                <p>
-                                    Nos collections sont le fruit d'un savoir-faire artisanal, où chaque couture raconte 
-                                    une histoire de dévouement et de précision.
-                                </p>
-                            </div>
-
-                            <div className="flex gap-12 mt-12 pt-8 border-t border-gray-100">
-                                <div>
-                                    <p className="text-3xl font-serif font-medium text-gray-900">2024</p>
-                                    <p className="text-xs uppercase tracking-widest text-gray-400 mt-1">Fondation</p>
-                                </div>
-                                <div>
-                                    <p className="text-3xl font-serif font-medium text-gray-900">100%</p>
-                                    <p className="text-xs uppercase tracking-widest text-gray-400 mt-1">Algérien</p>
-                                </div>
-                            </div>
-                        </div>
-
-                        {/* Visual Composition */}
-                        <div className="lg:col-span-6 lg:col-start-7 order-1 lg:order-2 relative">
-                            <div className="grid grid-cols-2 gap-4">
-                                <div className="space-y-4 mt-12">
-                                    <div className="relative aspect-[3/4] overflow-hidden rounded-sm">
-                                        <Image
-                                            src="https://images.unsplash.com/photo-1594938298603-c8148c4dae35?w=600&q=80"
-                                            alt="Création Harp"
-                                            fill
-                                            className="object-cover hover:scale-105 transition-transform duration-700"
-                                        />
-                                    </div>
-                                </div>
-                                <div className="space-y-4">
-                                    <div className="relative aspect-[3/4] overflow-hidden rounded-sm">
-                                        <Image
-                                            src="https://images.unsplash.com/photo-1585487000160-6ebcfceb0d03?w=600&q=80"
-                                            alt="Style Harp"
-                                            fill
-                                            className="object-cover hover:scale-105 transition-transform duration-700"
-                                        />
-                                    </div>
-                                </div>
-                            </div>
-                        </div>
-                    </div>
-                </div>
-            </section>
-
-            {/* Section 2: Vision - Clean Grid */}
-            <section className="py-24 bg-[#F9F9F9]">
-                <div className="container mx-auto px-4">
-                    <div className="max-w-4xl mx-auto text-center mb-16">
-                        <h2 className="text-3xl md:text-4xl font-serif font-medium text-gray-900 mb-6">
-                            Notre Philosophie
-                        </h2>
-                        <p className="text-lg text-gray-500 font-light">
-                            L'équilibre parfait entre esthétique contemporaine et valeurs traditionnelles.
-                        </p>
-                    </div>
-
-                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
-                        {[
-                            { icon: Heart, title: "Respectueuse", desc: "Des coupes fluides et couvrantes qui subliment sans dévoiler." },
-                            { icon: Sparkles, title: "Moderne", desc: "Une esthétique épurée, ancrée dans son époque." },
-                            { icon: Star, title: "Exclusive", desc: "Des petites séries pour garantir l'unicité de chaque pièce." }
-                        ].map((item, i) => (
-                            <div key={i} className="bg-white p-10 shadow-[0_2px_20px_-4px_rgba(0,0,0,0.05)] transition-transform hover:-translate-y-1 duration-300">
-                                <item.icon size={24} className="text-gray-900 mb-6" />
-                                <h3 className="font-serif font-medium text-xl text-gray-900 mb-3">{item.title}</h3>
-                                <p className="text-gray-500 text-sm leading-relaxed font-light">
-                                    {item.desc}
-                                </p>
-                            </div>
-                        ))}
-                    </div>
+  useLanguage(); // Keep for potential future i18n
+
+  return (
+    <div className="min-h-screen bg-gradient-to-b from-harp-cream/30 to-white">
+      {/* Hero Section - Minimalist */}
+      <section className="relative pt-32 pb-20 md:pt-40 md:pb-24 overflow-hidden bg-harp-sand/30">
+        <div className="container mx-auto px-4">
+          <div className="max-w-3xl mx-auto text-center relative z-10">
+            <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
+              Notre Histoire
+            </span>
+            <h1 className="text-4xl md:text-6xl font-serif font-medium text-gray-900 mb-6 leading-tight">
+              L'Élégance Intemporelle,
+              <br />
+              Redéfinie.
+            </h1>
+            <p className="text-lg md:text-xl text-gray-500 leading-relaxed font-light max-w-2xl mx-auto">
+              Une ode à la femme moderne qui ne choisit jamais entre pudeur et
+              style. Harp incarne une vision nouvelle de la mode algérienne.
+            </p>
+          </div>
+        </div>
+
+        {/* Abstract Background Elements */}
+        <div className="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none">
+          <div className="absolute -top-[20%] -left-[10%] w-[50%] h-[50%] bg-harp-beige/20 rounded-full blur-3xl" />
+          <div className="absolute top-[20%] -right-[10%] w-[40%] h-[60%] bg-harp-gold/5 rounded-full blur-3xl" />
+        </div>
+      </section>
+
+      {/* Section 1: Origine de la marque - Asymmetrical Layout */}
+      <section className="py-24 bg-white">
+        <div className="container mx-auto px-4">
+          <div className="grid grid-cols-1 lg:grid-cols-12 gap-12 items-center">
+            {/* Text Content */}
+            <div className="lg:col-span-5 order-2 lg:order-1">
+              <h2 className="text-3xl md:text-4xl font-serif font-medium text-gray-900 mb-8">
+                Une histoire de passion <br /> et d'exigence.
+              </h2>
+
+              <div className="space-y-6 text-gray-600 font-light leading-relaxed">
+                <p>
+                  <strong className="text-gray-900 font-medium">Harp</strong>{" "}
+                  est née d'une volonté simple mais ambitieuse : offrir aux
+                  femmes algériennes une mode qui célèbre leur identité avec
+                  raffinement.
+                </p>
+                <p>
+                  Loin de la fast-fashion, nous prenons le temps. Le temps de
+                  dessiner, de choisir, d'ajuster. Fondée en Algérie, notre
+                  maison s'inspire de l'héritage local tout en regardant vers
+                  l'avenir.
+                </p>
+                <p>
+                  Nos collections sont le fruit d'un savoir-faire artisanal, où
+                  chaque couture raconte une histoire de dévouement et de
+                  précision.
+                </p>
+              </div>
+
+              <div className="flex gap-12 mt-12 pt-8 border-t border-gray-100">
+                <div>
+                  <p className="text-3xl font-serif font-medium text-gray-900">
+                    2024
+                  </p>
+                  <p className="text-xs uppercase tracking-widest text-gray-400 mt-1">
+                    Fondation
+                  </p>
                 </div>
-            </section>
-
-            {/* Quote Section - Minimal */}
-            <section className="py-32 bg-white">
-                <div className="container mx-auto px-4">
-                    <div className="max-w-3xl mx-auto text-center">
-                        <Quote size={32} className="text-gray-300 mx-auto mb-8" />
-                        <blockquote className="text-2xl md:text-4xl font-serif text-gray-900 leading-relaxed mb-8">
-                            "L'élégance n'est pas une question de vêtements, c'est une attitude. 
-                            Harp vous donne simplement l'assurance de l'exprimer."
-                        </blockquote>
-                        <cite className="text-sm uppercase tracking-widest text-gray-400 not-italic">
-                            — L'Équipe Harp
-                        </cite>
-                    </div>
+                <div>
+                  <p className="text-3xl font-serif font-medium text-gray-900">
+                    100%
+                  </p>
+                  <p className="text-xs uppercase tracking-widest text-gray-400 mt-1">
+                    Algérien
+                  </p>
                 </div>
-            </section>
-
-            {/* Section 3: Engagement Qualité - Split */}
-            <section className="py-0 bg-white">
-                <div className="grid grid-cols-1 lg:grid-cols-2">
-                    <div className="relative aspect-square lg:aspect-auto lg:h-full min-h-[500px]">
-                         <Image
-                            src="https://images.unsplash.com/photo-1551232864-3f0890e580d9?w=1200&q=80"
-                            alt="Qualité Harp"
-                            fill
-                            className="object-cover"
-                        />
-                    </div>
-                    <div className="flex items-center justify-center p-12 lg:p-24 bg-gray-50">
-                        <div className="max-w-md">
-                            <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
-                                Notre Promesse
-                            </span>
-                            <h2 className="text-3xl md:text-4xl font-serif font-medium text-gray-900 mb-8">
-                                L'Excellence sans compromis.
-                            </h2>
-                            
-                            <div className="space-y-8">
-                                {[
-                                    { title: "Matières Nobles", desc: "Sélection rigoureuse de tissus pour leur tombé et leur confort." },
-                                    { title: "Finitions Artisanales", desc: "Une attention obsessionnelle portée à chaque détail." },
-                                    { title: "Contrôle Qualité", desc: "Chaque pièce est minutieusement inspectée avant de vous rejoindre." }
-                                ].map((item, i) => (
-                                    <div key={i}>
-                                        <h4 className="text-lg font-serif font-medium text-gray-900 mb-2">{item.title}</h4>
-                                        <p className="text-gray-500 font-light text-sm">{item.desc}</p>
-                                    </div>
-                                ))}
-                            </div>
-                        </div>
-                    </div>
+              </div>
+            </div>
+
+            {/* Visual Composition */}
+            <div className="lg:col-span-6 lg:col-start-7 order-1 lg:order-2 relative">
+              <div className="grid grid-cols-2 gap-4">
+                <div className="space-y-4 mt-12">
+                  <div className="relative aspect-[3/4] overflow-hidden rounded-sm">
+                    <Image
+                      src="https://images.unsplash.com/photo-1594938298603-c8148c4dae35?w=600&q=80"
+                      alt="Création Harp"
+                      fill
+                      className="object-cover hover:scale-105 transition-transform duration-700"
+                    />
+                  </div>
                 </div>
-            </section>
-
-            {/* Section 4: Livraison - Minimal Data */}
-            <section className="py-24 bg-white border-t border-gray-100">
-                <div className="container mx-auto px-4 text-center">
-                     <h2 className="text-3xl md:text-4xl font-serif font-medium text-gray-900 mb-16">
-                        Service Premium
-                    </h2>
-
-                    <div className="grid grid-cols-1 md:grid-cols-4 gap-8 max-w-5xl mx-auto">
-                        {[
-                            { icon: MapPin, label: "58 Wilayas", sub: "Couverture nationale" },
-                            { icon: Truck, label: "24h - 72h", sub: "Livraison express" },
-                            { icon: Package, label: "Suivi Live", sub: "Via nos partenaires" },
-                            { icon: CheckCircle, label: "Satisfait", sub: "Ou remboursé" }
-                        ].map((item, i) => (
-                            <div key={i} className="group p-6">
-                                <item.icon size={28} className="text-gray-900 mx-auto mb-4 group-hover:scale-110 transition-transform" />
-                                <p className="text-lg font-medium text-gray-900 mb-1">{item.label}</p>
-                                <p className="text-xs text-gray-500 uppercase tracking-wider">{item.sub}</p>
-                            </div>
-                        ))}
-                    </div>
-                    
-                    <div className="mt-16">
-                        <Link
-                            href="/shop"
-                            className="inline-block border-b border-gray-900 pb-1 text-sm uppercase tracking-widest hover:text-gray-600 hover:border-gray-600 transition-all"
-                        >
-                            Découvrir nos collections
-                        </Link>
-                    </div>
+                <div className="space-y-4">
+                  <div className="relative aspect-[3/4] overflow-hidden rounded-sm">
+                    <Image
+                      src="https://images.unsplash.com/photo-1585487000160-6ebcfceb0d03?w=600&q=80"
+                      alt="Style Harp"
+                      fill
+                      className="object-cover hover:scale-105 transition-transform duration-700"
+                    />
+                  </div>
                 </div>
-            </section>
+              </div>
+            </div>
+          </div>
+        </div>
+      </section>
+
+      {/* Section 2: Vision - Clean Grid */}
+      <section className="py-24 bg-[#F9F9F9]">
+        <div className="container mx-auto px-4">
+          <div className="max-w-4xl mx-auto text-center mb-16">
+            <h2 className="text-3xl md:text-4xl font-serif font-medium text-gray-900 mb-6">
+              Notre Philosophie
+            </h2>
+            <p className="text-lg text-gray-500 font-light">
+              L'équilibre parfait entre esthétique contemporaine et valeurs
+              traditionnelles.
+            </p>
+          </div>
+
+          <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
+            {[
+              {
+                icon: Heart,
+                title: "Respectueuse",
+                desc: "Des coupes fluides et couvrantes qui subliment sans dévoiler.",
+              },
+              {
+                icon: Sparkles,
+                title: "Moderne",
+                desc: "Une esthétique épurée, ancrée dans son époque.",
+              },
+              {
+                icon: Star,
+                title: "Exclusive",
+                desc: "Des petites séries pour garantir l'unicité de chaque pièce.",
+              },
+            ].map((item, i) => (
+              <div
+                key={i}
+                className="bg-white p-10 shadow-[0_2px_20px_-4px_rgba(0,0,0,0.05)] transition-transform hover:-translate-y-1 duration-300"
+              >
+                <item.icon size={24} className="text-gray-900 mb-6" />
+                <h3 className="font-serif font-medium text-xl text-gray-900 mb-3">
+                  {item.title}
+                </h3>
+                <p className="text-gray-500 text-sm leading-relaxed font-light">
+                  {item.desc}
+                </p>
+              </div>
+            ))}
+          </div>
+        </div>
+      </section>
+
+      {/* Quote Section - Minimal */}
+      <section className="py-32 bg-white">
+        <div className="container mx-auto px-4">
+          <div className="max-w-3xl mx-auto text-center">
+            <Quote size={32} className="text-gray-300 mx-auto mb-8" />
+            <blockquote className="text-2xl md:text-4xl font-serif text-gray-900 leading-relaxed mb-8">
+              "L'élégance n'est pas une question de vêtements, c'est une
+              attitude. Harp vous donne simplement l'assurance de l'exprimer."
+            </blockquote>
+            <cite className="text-sm uppercase tracking-widest text-gray-400 not-italic">
+              — L'Équipe Harp
+            </cite>
+          </div>
+        </div>
+      </section>
+
+      {/* Section 3: Engagement Qualité - Split */}
+      <section className="py-0 bg-white">
+        <div className="grid grid-cols-1 lg:grid-cols-2">
+          <div className="relative aspect-square lg:aspect-auto lg:h-full min-h-[500px]">
+            <Image
+              src="https://images.unsplash.com/photo-1551232864-3f0890e580d9?w=1200&q=80"
+              alt="Qualité Harp"
+              fill
+              className="object-cover"
+            />
+          </div>
+          <div className="flex items-center justify-center p-12 lg:p-24 bg-gray-50">
+            <div className="max-w-md">
+              <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
+                Notre Promesse
+              </span>
+              <h2 className="text-3xl md:text-4xl font-serif font-medium text-gray-900 mb-8">
+                L'Excellence sans compromis.
+              </h2>
+
+              <div className="space-y-8">
+                {[
+                  {
+                    title: "Matières Nobles",
+                    desc: "Sélection rigoureuse de tissus pour leur tombé et leur confort.",
+                  },
+                  {
+                    title: "Finitions Artisanales",
+                    desc: "Une attention obsessionnelle portée à chaque détail.",
+                  },
+                  {
+                    title: "Contrôle Qualité",
+                    desc: "Chaque pièce est minutieusement inspectée avant de vous rejoindre.",
+                  },
+                ].map((item, i) => (
+                  <div key={i}>
+                    <h4 className="text-lg font-serif font-medium text-gray-900 mb-2">
+                      {item.title}
+                    </h4>
+                    <p className="text-gray-500 font-light text-sm">
+                      {item.desc}
+                    </p>
+                  </div>
+                ))}
+              </div>
+            </div>
+          </div>
+        </div>
+      </section>
+
+      {/* Section 4: Livraison - Minimal Data */}
+      <section className="py-24 bg-white border-t border-gray-100">
+        <div className="container mx-auto px-4 text-center">
+          <h2 className="text-3xl md:text-4xl font-serif font-medium text-gray-900 mb-16">
+            Service Premium
+          </h2>
+
+          <div className="grid grid-cols-1 md:grid-cols-4 gap-8 max-w-5xl mx-auto">
+            {[
+              {
+                icon: MapPin,
+                label: "58 Wilayas",
+                sub: "Couverture nationale",
+              },
+              { icon: Truck, label: "24h - 72h", sub: "Livraison express" },
+              {
+                icon: Package,
+                label: "Suivi Live",
+                sub: "Via nos partenaires",
+              },
+              { icon: CheckCircle, label: "Satisfait", sub: "Ou remboursé" },
+            ].map((item, i) => (
+              <div key={i} className="group p-6">
+                <item.icon
+                  size={28}
+                  className="text-gray-900 mx-auto mb-4 group-hover:scale-110 transition-transform"
+                />
+                <p className="text-lg font-medium text-gray-900 mb-1">
+                  {item.label}
+                </p>
+                <p className="text-xs text-gray-500 uppercase tracking-wider">
+                  {item.sub}
+                </p>
+              </div>
+            ))}
+          </div>
+
+          <div className="mt-16">
+            <Link
+              href="/shop"
+              className="inline-block border-b border-gray-900 pb-1 text-sm uppercase tracking-widest hover:text-gray-600 hover:border-gray-600 transition-all"
+            >
+              Découvrir nos collections
+            </Link>
+          </div>
         </div>
-    );
+      </section>
+    </div>
+  );
 }
diff --git a/src/app/account/page.tsx b/src/app/account/page.tsx
index 376e13f..aee464f 100644
--- a/src/app/account/page.tsx
+++ b/src/app/account/page.tsx
@@ -20,54 +20,65 @@ export default function AccountPage() {
 
   if (loading) {
     return (
-        <div className="min-h-[60vh] flex items-center justify-center">
-            <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#5C4033]"></div>
-        </div>
+      <div className="min-h-[60vh] flex items-center justify-center">
+        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#5C4033]"></div>
+      </div>
     );
   }
 
   return (
     <div className="container mx-auto px-4 py-12">
-        <div className="max-w-4xl mx-auto">
-            <div className="flex justify-between items-center mb-8">
-                <h1 className="text-3xl font-serif text-[#5C4033]">Mon Compte</h1>
-                <button 
-                    onClick={() => signOut({ callbackUrl: "/" })}
-                    className="text-sm text-gray-500 hover:text-red-600 transition-colors"
-                >
-                    Se déconnecter
-                </button>
+      <div className="max-w-4xl mx-auto">
+        <div className="flex justify-between items-center mb-8">
+          <h1 className="text-3xl font-serif text-[#5C4033]">Mon Compte</h1>
+          <button
+            onClick={() => signOut({ callbackUrl: "/" })}
+            className="text-sm text-gray-500 hover:text-red-600 transition-colors"
+          >
+            Se déconnecter
+          </button>
+        </div>
+
+        <div className="bg-white shadow-sm border border-gray-100 rounded-lg p-8">
+          <div className="grid md:grid-cols-2 gap-8">
+            <div>
+              <h2 className="text-lg font-medium mb-4">
+                Informations personnelles
+              </h2>
+              <div className="space-y-2 text-gray-600">
+                <p>
+                  <span className="font-medium text-gray-900">Email:</span>{" "}
+                  {session?.user?.email}
+                </p>
+                <p>
+                  <span className="font-medium text-gray-900">Statut:</span>{" "}
+                  {session?.user?.image === "black" ? "Membre Black" : "Membre"}
+                </p>
+              </div>
             </div>
 
-            <div className="bg-white shadow-sm border border-gray-100 rounded-lg p-8">
-                <div className="grid md:grid-cols-2 gap-8">
-                    <div>
-                        <h2 className="text-lg font-medium mb-4">Informations personnelles</h2>
-                        <div className="space-y-2 text-gray-600">
-                            <p><span className="font-medium text-gray-900">Email:</span> {session?.user?.email}</p>
-                            <p><span className="font-medium text-gray-900">Statut:</span> {session?.user?.image === "black" ? "Membre Black" : "Membre"}</p>
-                        </div>
-                    </div>
-                    
-                    <div>
-                        <h2 className="text-lg font-medium mb-4">Mes avantages</h2>
-                        <div className="bg-[#F9F7F2] p-6 rounded-lg">
-                            <p className="text-gray-600 mb-2">Programme de fidélité</p>
-                            <Link href="/loyalty" className="text-[#5C4033] underline text-sm">
-                                Voir mes points et récompenses
-                            </Link>
-                        </div>
-                    </div>
-                </div>
+            <div>
+              <h2 className="text-lg font-medium mb-4">Mes avantages</h2>
+              <div className="bg-[#F9F7F2] p-6 rounded-lg">
+                <p className="text-gray-600 mb-2">Programme de fidélité</p>
+                <Link
+                  href="/loyalty"
+                  className="text-[#5C4033] underline text-sm"
+                >
+                  Voir mes points et récompenses
+                </Link>
+              </div>
+            </div>
+          </div>
 
-                <div className="mt-12 border-t border-gray-100 pt-8">
-                    <h2 className="text-lg font-medium mb-6">Mes commandes récentes</h2>
-                    <div className="text-center py-8 text-gray-500 bg-gray-50 rounded-lg">
-                        Aucune commande récente.
-                    </div>
-                </div>
+          <div className="mt-12 border-t border-gray-100 pt-8">
+            <h2 className="text-lg font-medium mb-6">Mes commandes récentes</h2>
+            <div className="text-center py-8 text-gray-500 bg-gray-50 rounded-lg">
+              Aucune commande récente.
             </div>
+          </div>
         </div>
+      </div>
     </div>
   );
 }
diff --git a/src/app/admin/clients/page.tsx b/src/app/admin/clients/page.tsx
index f7bbe2d..34e1e71 100644
--- a/src/app/admin/clients/page.tsx
+++ b/src/app/admin/clients/page.tsx
@@ -2,11 +2,11 @@
 
 import { useEffect, useState, Fragment } from "react";
 import Link from "next/link";
-import { 
-  Users, 
-  Search, 
-  Download, 
-  ChevronLeft, 
+import {
+  Users,
+  Search,
+  Download,
+  ChevronLeft,
   ChevronRight,
   ChevronDown,
   ChevronUp,
@@ -26,7 +26,7 @@ import {
   Eye,
   DollarSign,
   Package,
-  Clock
+  Clock,
 } from "lucide-react";
 import { cn } from "@/lib/utils";
 
@@ -71,7 +71,7 @@ type VipLevel = "ALL" | "SILVER" | "GOLD" | "BLACK";
 const vipColors: Record<string, string> = {
   SILVER: "bg-gray-100 text-gray-700",
   GOLD: "bg-amber-100 text-amber-700",
-  BLACK: "bg-gray-900 text-white"
+  BLACK: "bg-gray-900 text-white",
 };
 
 const statusColors: Record<string, string> = {
@@ -79,7 +79,7 @@ const statusColors: Record<string, string> = {
   CONFIRMED: "bg-blue-100 text-blue-700",
   SHIPPED: "bg-purple-100 text-purple-700",
   DELIVERED: "bg-green-100 text-green-700",
-  CANCELLED: "bg-red-100 text-red-700"
+  CANCELLED: "bg-red-100 text-red-700",
 };
 
 export default function AdminClientsPage() {
@@ -101,12 +101,12 @@ export default function AdminClientsPage() {
       const params = new URLSearchParams({
         page: String(p),
         pageSize: String(pageSize),
-        vipLevel: vipFilter
+        vipLevel: vipFilter,
       });
       if (search) params.set("search", search);
 
       const res = await fetch(`/api/v3/compta/clients?${params.toString()}`, {
-        credentials: "include"
+        credentials: "include",
       });
       const json = await res.json();
 
@@ -136,13 +136,13 @@ export default function AdminClientsPage() {
   async function onExport(format: "csv" | "json") {
     setExporting(true);
     setShowExportMenu(false);
-    
+
     const params = new URLSearchParams({ format, vipLevel: vipFilter });
     if (search) params.set("search", search);
-    
+
     // Open download in new tab
     window.open(`/api/v3/compta/clients/export?${params.toString()}`, "_blank");
-    
+
     setTimeout(() => setExporting(false), 2000);
   }
 
@@ -156,7 +156,8 @@ export default function AdminClientsPage() {
             Clients
           </h1>
           <p className="text-sm text-gray-500 mt-1">
-            {total} client{total > 1 ? "s" : ""} enregistré{total > 1 ? "s" : ""}
+            {total} client{total > 1 ? "s" : ""} enregistré
+            {total > 1 ? "s" : ""}
           </p>
         </div>
 
@@ -183,7 +184,7 @@ export default function AdminClientsPage() {
               )}
               Exporter
             </button>
-            
+
             {showExportMenu && (
               <div className="absolute right-0 mt-2 w-40 bg-white rounded-lg shadow-xl border border-gray-100 py-1 z-10">
                 <button
@@ -212,7 +213,10 @@ export default function AdminClientsPage() {
           {/* Search */}
           <form onSubmit={handleSearch} className="flex-1 flex gap-2">
             <div className="relative flex-1">
-              <Search size={18} className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" />
+              <Search
+                size={18}
+                className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
+              />
               <input
                 type="text"
                 value={search}
@@ -253,20 +257,37 @@ export default function AdminClientsPage() {
             <thead>
               <tr className="bg-gray-50 border-b border-gray-100">
                 <th className="w-8 p-4"></th>
-                <th className="text-left p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">Client</th>
-                <th className="text-left p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">Contact</th>
-                <th className="text-left p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">Localisation</th>
-                <th className="text-center p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">Commandes</th>
-                <th className="text-center p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">Total dépensé</th>
-                <th className="text-center p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">Points</th>
-                <th className="text-center p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">VIP</th>
+                <th className="text-left p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">
+                  Client
+                </th>
+                <th className="text-left p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">
+                  Contact
+                </th>
+                <th className="text-left p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">
+                  Localisation
+                </th>
+                <th className="text-center p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">
+                  Commandes
+                </th>
+                <th className="text-center p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">
+                  Total dépensé
+                </th>
+                <th className="text-center p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">
+                  Points
+                </th>
+                <th className="text-center p-4 text-xs font-semibold text-gray-500 uppercase tracking-wider">
+                  VIP
+                </th>
               </tr>
             </thead>
             <tbody>
               {loading ? (
                 <tr>
                   <td colSpan={8} className="p-8 text-center">
-                    <Loader2 size={24} className="animate-spin mx-auto text-gray-400" />
+                    <Loader2
+                      size={24}
+                      className="animate-spin mx-auto text-gray-400"
+                    />
                     <p className="text-sm text-gray-500 mt-2">Chargement...</p>
                   </td>
                 </tr>
@@ -280,12 +301,16 @@ export default function AdminClientsPage() {
               ) : (
                 items.map((client) => (
                   <Fragment key={client.id}>
-                    <tr 
+                    <tr
                       className={cn(
                         "border-b border-gray-50 hover:bg-gray-50/50 transition-colors cursor-pointer",
-                        expandedClient === client.id && "bg-harp-cream/30"
+                        expandedClient === client.id && "bg-harp-cream/30",
                       )}
-                      onClick={() => setExpandedClient(expandedClient === client.id ? null : client.id)}
+                      onClick={() =>
+                        setExpandedClient(
+                          expandedClient === client.id ? null : client.id,
+                        )
+                      }
                     >
                       <td className="p-4">
                         <button className="p-1 hover:bg-gray-100 rounded">
@@ -305,11 +330,16 @@ export default function AdminClientsPage() {
                             <Mail size={12} />
                             {client.email}
                             {client.isEmailVerified && (
-                              <span className="text-green-500 text-[10px]">✓</span>
+                              <span className="text-green-500 text-[10px]">
+                                ✓
+                              </span>
                             )}
                           </p>
                           <p className="text-[10px] text-gray-400 mt-1">
-                            Inscrit le {new Date(client.createdAt).toLocaleDateString("fr-FR")}
+                            Inscrit le{" "}
+                            {new Date(client.createdAt).toLocaleDateString(
+                              "fr-FR",
+                            )}
                           </p>
                         </div>
                       </td>
@@ -326,7 +356,9 @@ export default function AdminClientsPage() {
                           {client.birthDate && (
                             <span className="text-xs text-gray-400 flex items-center gap-1">
                               <Calendar size={10} />
-                              {new Date(client.birthDate).toLocaleDateString("fr-FR")}
+                              {new Date(client.birthDate).toLocaleDateString(
+                                "fr-FR",
+                              )}
                             </span>
                           )}
                         </div>
@@ -354,7 +386,10 @@ export default function AdminClientsPage() {
                           </span>
                           {client.lastOrderDate && (
                             <p className="text-[10px] text-gray-400 mt-1">
-                              Dernière: {new Date(client.lastOrderDate).toLocaleDateString("fr-FR")}
+                              Dernière:{" "}
+                              {new Date(
+                                client.lastOrderDate,
+                              ).toLocaleDateString("fr-FR")}
                             </p>
                           )}
                         </div>
@@ -378,16 +413,19 @@ export default function AdminClientsPage() {
                         )}
                       </td>
                       <td className="p-4 text-center">
-                        <span className={cn(
-                          "inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium",
-                          vipColors[client.vipLevel] || "bg-gray-100 text-gray-600"
-                        )}>
+                        <span
+                          className={cn(
+                            "inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium",
+                            vipColors[client.vipLevel] ||
+                              "bg-gray-100 text-gray-600",
+                          )}
+                        >
                           {client.vipLevel === "BLACK" && <Crown size={12} />}
                           {client.vipLevel}
                         </span>
                       </td>
                     </tr>
-                    
+
                     {/* Expanded Row */}
                     {expandedClient === client.id && (
                       <tr className="bg-harp-cream/20">
@@ -402,32 +440,57 @@ export default function AdminClientsPage() {
                               <div className="space-y-2 text-sm">
                                 <div className="flex justify-between">
                                   <span className="text-gray-500">ID</span>
-                                  <span className="font-mono text-xs text-gray-600">{client.id.slice(0, 12)}...</span>
+                                  <span className="font-mono text-xs text-gray-600">
+                                    {client.id.slice(0, 12)}...
+                                  </span>
                                 </div>
                                 <div className="flex justify-between">
                                   <span className="text-gray-500">Rôle</span>
-                                  <span className={cn(
-                                    "px-2 py-0.5 rounded text-xs",
-                                    client.role === "admin" ? "bg-red-100 text-red-700" : "bg-gray-100 text-gray-600"
-                                  )}>
+                                  <span
+                                    className={cn(
+                                      "px-2 py-0.5 rounded text-xs",
+                                      client.role === "admin"
+                                        ? "bg-red-100 text-red-700"
+                                        : "bg-gray-100 text-gray-600",
+                                    )}
+                                  >
                                     {client.role}
                                   </span>
                                 </div>
                                 <div className="flex justify-between">
-                                  <span className="text-gray-500">Inscription via</span>
-                                  <span className="text-gray-600">{client.createdVia}</span>
+                                  <span className="text-gray-500">
+                                    Inscription via
+                                  </span>
+                                  <span className="text-gray-600">
+                                    {client.createdVia}
+                                  </span>
                                 </div>
                                 <div className="flex justify-between">
-                                  <span className="text-gray-500">Email vérifié</span>
-                                  <span className={client.isEmailVerified ? "text-green-600" : "text-red-500"}>
+                                  <span className="text-gray-500">
+                                    Email vérifié
+                                  </span>
+                                  <span
+                                    className={
+                                      client.isEmailVerified
+                                        ? "text-green-600"
+                                        : "text-red-500"
+                                    }
+                                  >
                                     {client.isEmailVerified ? "Oui ✓" : "Non"}
                                   </span>
                                 </div>
                                 {client.lastAddress && (
                                   <div className="pt-2 border-t">
-                                    <span className="text-gray-500 block mb-1">Adresse</span>
-                                    <p className="text-gray-700 text-xs">{client.lastAddress.address}</p>
-                                    <p className="text-gray-500 text-xs">{client.lastAddress.city}, Wilaya {client.lastAddress.wilaya}</p>
+                                    <span className="text-gray-500 block mb-1">
+                                      Adresse
+                                    </span>
+                                    <p className="text-gray-700 text-xs">
+                                      {client.lastAddress.address}
+                                    </p>
+                                    <p className="text-gray-500 text-xs">
+                                      {client.lastAddress.city}, Wilaya{" "}
+                                      {client.lastAddress.wilaya}
+                                    </p>
                                   </div>
                                 )}
                               </div>
@@ -441,33 +504,46 @@ export default function AdminClientsPage() {
                               </h4>
                               {client.recentOrders.length > 0 ? (
                                 <div className="space-y-2">
-                                  {client.recentOrders.slice(0, 5).map((order) => (
-                                    <div key={order.id} className="flex items-center justify-between p-2 bg-gray-50 rounded-lg text-sm">
-                                      <div className="flex items-center gap-3">
-                                        <Link 
-                                          href={`/admin/orders?search=${order.orderNumber}`}
-                                          className="font-mono text-xs text-harp-brown hover:underline"
-                                          onClick={(e) => e.stopPropagation()}
-                                        >
-                                          #{order.orderNumber.slice(-8)}
-                                        </Link>
-                                        <span className={cn(
-                                          "px-2 py-0.5 rounded-full text-[10px] font-medium",
-                                          statusColors[order.status] || "bg-gray-100 text-gray-600"
-                                        )}>
-                                          {order.status}
-                                        </span>
-                                      </div>
-                                      <div className="text-right">
-                                        <span className="font-medium text-gray-900">
-                                          {Number(order.total).toLocaleString()} DZD
-                                        </span>
-                                        <p className="text-[10px] text-gray-400">
-                                          {new Date(order.createdAt).toLocaleDateString("fr-FR")}
-                                        </p>
+                                  {client.recentOrders
+                                    .slice(0, 5)
+                                    .map((order) => (
+                                      <div
+                                        key={order.id}
+                                        className="flex items-center justify-between p-2 bg-gray-50 rounded-lg text-sm"
+                                      >
+                                        <div className="flex items-center gap-3">
+                                          <Link
+                                            href={`/admin/orders?search=${order.orderNumber}`}
+                                            className="font-mono text-xs text-harp-brown hover:underline"
+                                            onClick={(e) => e.stopPropagation()}
+                                          >
+                                            #{order.orderNumber.slice(-8)}
+                                          </Link>
+                                          <span
+                                            className={cn(
+                                              "px-2 py-0.5 rounded-full text-[10px] font-medium",
+                                              statusColors[order.status] ||
+                                                "bg-gray-100 text-gray-600",
+                                            )}
+                                          >
+                                            {order.status}
+                                          </span>
+                                        </div>
+                                        <div className="text-right">
+                                          <span className="font-medium text-gray-900">
+                                            {Number(
+                                              order.total,
+                                            ).toLocaleString()}{" "}
+                                            DZD
+                                          </span>
+                                          <p className="text-[10px] text-gray-400">
+                                            {new Date(
+                                              order.createdAt,
+                                            ).toLocaleDateString("fr-FR")}
+                                          </p>
+                                        </div>
                                       </div>
-                                    </div>
-                                  ))}
+                                    ))}
                                 </div>
                               ) : (
                                 <p className="text-sm text-gray-400 text-center py-4">
diff --git a/src/app/admin/collections/[id]/edit/page.tsx b/src/app/admin/collections/[id]/edit/page.tsx
index a628930..647207b 100644
--- a/src/app/admin/collections/[id]/edit/page.tsx
+++ b/src/app/admin/collections/[id]/edit/page.tsx
@@ -2,233 +2,279 @@
 
 import { useState, useEffect, use, useRef } from "react";
 import { useRouter } from "next/navigation";
-import { ArrowLeft, Upload, Loader2, X, Image as ImageIcon, Save } from "lucide-react";
+import {
+  ArrowLeft,
+  Upload,
+  Loader2,
+  X,
+  Image as ImageIcon,
+  Save,
+} from "lucide-react";
 import Link from "next/link";
 import { cn } from "@/lib/utils";
 
-export default function EditCollectionPage({ params }: { params: Promise<{ id: string }> }) {
-    const { id } = use(params);
-    const router = useRouter();
-    const fileInputRef = useRef<HTMLInputElement>(null);
-    const [loading, setLoading] = useState(true);
-    const [saving, setSaving] = useState(false);
-    const [uploading, setUploading] = useState(false);
-    const [formData, setFormData] = useState({
-        nameFr: "",
-        nameAr: "",
-        image: "",
-    });
-
-    useEffect(() => {
-        const fetchCollection = async () => {
-            try {
-                const res = await fetch(`/api/collections/${id}`);
-                if (!res.ok) throw new Error("Collection not found");
-                const data = await res.json();
-
-                setFormData({
-                    nameFr: data.nameFr,
-                    nameAr: data.nameAr,
-                    image: data.image || "",
-                });
-            } catch (error) {
-                console.error("Error fetching collection:", error);
-                alert("Erreur lors du chargement de la collection");
-                router.push("/admin/collections");
-            } finally {
-                setLoading(false);
-            }
-        };
-
-        fetchCollection();
-    }, [id, router]);
-
-    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
-        setFormData({ ...formData, [e.target.name]: e.target.value });
-    };
+export default function EditCollectionPage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
+  const { id } = use(params);
+  const router = useRouter();
+  const fileInputRef = useRef<HTMLInputElement>(null);
+  const [loading, setLoading] = useState(true);
+  const [saving, setSaving] = useState(false);
+  const [uploading, setUploading] = useState(false);
+  const [formData, setFormData] = useState({
+    nameFr: "",
+    nameAr: "",
+    image: "",
+  });
 
-    const handleFileUpload = async (file: File) => {
-        setUploading(true);
-        try {
-            const uploadData = new FormData();
-            uploadData.append('file', file);
-            const response = await fetch('/api/upload', { method: 'POST', body: uploadData });
-            if (response.ok) {
-                const data = await response.json();
-                setFormData(prev => ({ ...prev, image: data.url }));
-            }
-        } catch (error) {
-            console.error('Upload error:', error);
-        } finally {
-            setUploading(false);
-        }
-    };
+  useEffect(() => {
+    const fetchCollection = async () => {
+      try {
+        const res = await fetch(`/api/collections/${id}`);
+        if (!res.ok) throw new Error("Collection not found");
+        const data = await res.json();
 
-    const handleSubmit = async (e: React.FormEvent) => {
-        e.preventDefault();
-        setSaving(true);
-
-        try {
-            const response = await fetch(`/api/collections/${id}`, {
-                method: "PUT",
-                headers: { "Content-Type": "application/json" },
-                body: JSON.stringify(formData),
-            });
-
-            if (response.ok) {
-                router.push("/admin/collections");
-            } else {
-                alert("Erreur lors de la modification de la collection");
-            }
-        } catch (error) {
-            console.error("Error updating collection:", error);
-            alert("Erreur lors de la modification de la collection");
-        } finally {
-            setSaving(false);
-        }
+        setFormData({
+          nameFr: data.nameFr,
+          nameAr: data.nameAr,
+          image: data.image || "",
+        });
+      } catch (error) {
+        console.error("Error fetching collection:", error);
+        alert("Erreur lors du chargement de la collection");
+        router.push("/admin/collections");
+      } finally {
+        setLoading(false);
+      }
     };
 
-    if (loading) {
-        return (
-            <div className="min-h-[400px] flex flex-col items-center justify-center">
-                <Loader2 size={32} className="animate-spin text-gray-300 mb-4" />
-                <p className="text-sm text-gray-500 uppercase tracking-widest">Chargement...</p>
-            </div>
-        );
+    fetchCollection();
+  }, [id, router]);
+
+  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
+    setFormData({ ...formData, [e.target.name]: e.target.value });
+  };
+
+  const handleFileUpload = async (file: File) => {
+    setUploading(true);
+    try {
+      const uploadData = new FormData();
+      uploadData.append("file", file);
+      const response = await fetch("/api/upload", {
+        method: "POST",
+        body: uploadData,
+      });
+      if (response.ok) {
+        const data = await response.json();
+        setFormData((prev) => ({ ...prev, image: data.url }));
+      }
+    } catch (error) {
+      console.error("Upload error:", error);
+    } finally {
+      setUploading(false);
+    }
+  };
+
+  const handleSubmit = async (e: React.FormEvent) => {
+    e.preventDefault();
+    setSaving(true);
+
+    try {
+      const response = await fetch(`/api/collections/${id}`, {
+        method: "PUT",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify(formData),
+      });
+
+      if (response.ok) {
+        router.push("/admin/collections");
+      } else {
+        alert("Erreur lors de la modification de la collection");
+      }
+    } catch (error) {
+      console.error("Error updating collection:", error);
+      alert("Erreur lors de la modification de la collection");
+    } finally {
+      setSaving(false);
     }
+  };
 
+  if (loading) {
     return (
-        <div className="max-w-2xl mx-auto space-y-8">
-            <div>
-                <Link href="/admin/collections" className="inline-flex items-center gap-2 text-gray-400 hover:text-gray-900 transition-colors mb-6">
-                    <ArrowLeft size={16} />
-                    <span className="text-sm font-medium">Retour aux collections</span>
-                </Link>
-
-                <h1 className="text-3xl font-serif font-medium text-gray-900">Modifier la Collection</h1>
-                <p className="text-gray-500 text-sm mt-2">Mettez à jour les informations de la collection</p>
+      <div className="min-h-[400px] flex flex-col items-center justify-center">
+        <Loader2 size={32} className="animate-spin text-gray-300 mb-4" />
+        <p className="text-sm text-gray-500 uppercase tracking-widest">
+          Chargement...
+        </p>
+      </div>
+    );
+  }
+
+  return (
+    <div className="max-w-2xl mx-auto space-y-8">
+      <div>
+        <Link
+          href="/admin/collections"
+          className="inline-flex items-center gap-2 text-gray-400 hover:text-gray-900 transition-colors mb-6"
+        >
+          <ArrowLeft size={16} />
+          <span className="text-sm font-medium">Retour aux collections</span>
+        </Link>
+
+        <h1 className="text-3xl font-serif font-medium text-gray-900">
+          Modifier la Collection
+        </h1>
+        <p className="text-gray-500 text-sm mt-2">
+          Mettez à jour les informations de la collection
+        </p>
+      </div>
+
+      <form
+        onSubmit={handleSubmit}
+        className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-8"
+      >
+        <div className="space-y-6">
+          <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">
+            Informations générales
+          </h2>
+
+          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Nom (Français)
+              </label>
+              <input
+                required
+                name="nameFr"
+                value={formData.nameFr}
+                onChange={handleChange}
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+            </div>
+            <div className="space-y-2" dir="rtl">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                الاسم (بالعربية)
+              </label>
+              <input
+                required
+                name="nameAr"
+                value={formData.nameAr}
+                onChange={handleChange}
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
             </div>
+          </div>
 
-            <form onSubmit={handleSubmit} className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-8">
-                <div className="space-y-6">
-                    <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">Informations générales</h2>
-                    
-                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Nom (Français)</label>
-                            <input
-                                required
-                                name="nameFr"
-                                value={formData.nameFr}
-                                onChange={handleChange}
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                        <div className="space-y-2" dir="rtl">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">الاسم (بالعربية)</label>
-                            <input
-                                required
-                                name="nameAr"
-                                value={formData.nameAr}
-                                onChange={handleChange}
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                    </div>
-
-                    <div className="space-y-4">
-                        <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Image de couverture</label>
-                        
-                        {/* Image Preview */}
-                        {formData.image ? (
-                            <div className="relative w-full max-w-md aspect-video bg-gray-50 rounded-xl overflow-hidden group">
-                                {/* eslint-disable-next-line @next/next/no-img-element */}
-                                <img 
-                                    src={formData.image} 
-                                    alt="Preview" 
-                                    className="w-full h-full object-cover" 
-                                />
-                                <div className="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors" />
-                                <button
-                                    type="button"
-                                    onClick={() => setFormData(prev => ({ ...prev, image: "" }))}
-                                    className="absolute top-3 right-3 p-2 bg-white text-red-500 rounded-lg hover:bg-red-50 shadow-sm opacity-0 group-hover:opacity-100 transition-all transform translate-y-2 group-hover:translate-y-0"
-                                >
-                                    <X size={16} />
-                                </button>
-                            </div>
-                        ) : (
-                            <div 
-                                onClick={() => fileInputRef.current?.click()}
-                                className="w-full max-w-md aspect-video border-2 border-dashed border-gray-200 rounded-xl flex flex-col items-center justify-center text-gray-400 hover:border-gray-300 hover:bg-gray-50 transition-all cursor-pointer gap-3"
-                            >
-                                <div className="p-3 bg-gray-100 rounded-full">
-                                    <ImageIcon size={24} className="text-gray-400" />
-                                </div>
-                                <div className="text-center">
-                                    <p className="text-sm font-medium text-gray-900">Cliquez pour uploader</p>
-                                    <p className="text-xs text-gray-400 mt-1">PNG, JPG jusqu'à 5MB</p>
-                                </div>
-                            </div>
-                        )}
-                        
-                        {/* Upload controls */}
-                        <input
-                            ref={fileInputRef}
-                            type="file"
-                            accept="image/*"
-                            onChange={(e) => e.target.files?.[0] && handleFileUpload(e.target.files[0])}
-                            className="hidden"
-                        />
-                        
-                        <div className="flex gap-3 max-w-md">
-                            <div className="relative flex-1">
-                                <input
-                                    name="image"
-                                    value={formData.image}
-                                    onChange={handleChange}
-                                    placeholder="Ou coller une URL..."
-                                    className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none text-sm text-gray-600"
-                                />
-                            </div>
-                            <button
-                                type="button"
-                                onClick={() => fileInputRef.current?.click()}
-                                disabled={uploading}
-                                className="px-4 py-3 bg-gray-900 text-white rounded-xl hover:bg-gray-800 disabled:opacity-50 transition-colors"
-                            >
-                                {uploading ? <Loader2 size={18} className="animate-spin" /> : <Upload size={18} />}
-                            </button>
-                        </div>
-                    </div>
-                </div>
+          <div className="space-y-4">
+            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+              Image de couverture
+            </label>
 
-                <div className="pt-6 border-t border-gray-50 flex items-center justify-end gap-4">
-                    <Link
-                        href="/admin/collections"
-                        className="px-6 py-2.5 text-gray-500 hover:text-gray-900 font-medium transition-colors text-sm"
-                    >
-                        Annuler
-                    </Link>
-                    <button
-                        type="submit"
-                        disabled={saving}
-                        className="bg-gray-900 text-white px-6 py-2.5 rounded-xl hover:bg-gray-800 transition-all disabled:opacity-50 flex items-center gap-2 text-sm font-medium shadow-sm"
-                    >
-                        {saving ? (
-                            <>
-                                <Loader2 size={16} className="animate-spin" />
-                                Enregistrement...
-                            </>
-                        ) : (
-                            <>
-                                <Save size={16} />
-                                Enregistrer
-                            </>
-                        )}
-                    </button>
+            {/* Image Preview */}
+            {formData.image ? (
+              <div className="relative w-full max-w-md aspect-video bg-gray-50 rounded-xl overflow-hidden group">
+                {/* eslint-disable-next-line @next/next/no-img-element */}
+                <img
+                  src={formData.image}
+                  alt="Preview"
+                  className="w-full h-full object-cover"
+                />
+                <div className="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors" />
+                <button
+                  type="button"
+                  onClick={() =>
+                    setFormData((prev) => ({ ...prev, image: "" }))
+                  }
+                  className="absolute top-3 right-3 p-2 bg-white text-red-500 rounded-lg hover:bg-red-50 shadow-sm opacity-0 group-hover:opacity-100 transition-all transform translate-y-2 group-hover:translate-y-0"
+                >
+                  <X size={16} />
+                </button>
+              </div>
+            ) : (
+              <div
+                onClick={() => fileInputRef.current?.click()}
+                className="w-full max-w-md aspect-video border-2 border-dashed border-gray-200 rounded-xl flex flex-col items-center justify-center text-gray-400 hover:border-gray-300 hover:bg-gray-50 transition-all cursor-pointer gap-3"
+              >
+                <div className="p-3 bg-gray-100 rounded-full">
+                  <ImageIcon size={24} className="text-gray-400" />
+                </div>
+                <div className="text-center">
+                  <p className="text-sm font-medium text-gray-900">
+                    Cliquez pour uploader
+                  </p>
+                  <p className="text-xs text-gray-400 mt-1">
+                    PNG, JPG jusqu'à 5MB
+                  </p>
                 </div>
-            </form>
+              </div>
+            )}
+
+            {/* Upload controls */}
+            <input
+              ref={fileInputRef}
+              type="file"
+              accept="image/*"
+              onChange={(e) =>
+                e.target.files?.[0] && handleFileUpload(e.target.files[0])
+              }
+              className="hidden"
+            />
+
+            <div className="flex gap-3 max-w-md">
+              <div className="relative flex-1">
+                <input
+                  name="image"
+                  value={formData.image}
+                  onChange={handleChange}
+                  placeholder="Ou coller une URL..."
+                  className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none text-sm text-gray-600"
+                />
+              </div>
+              <button
+                type="button"
+                onClick={() => fileInputRef.current?.click()}
+                disabled={uploading}
+                className="px-4 py-3 bg-gray-900 text-white rounded-xl hover:bg-gray-800 disabled:opacity-50 transition-colors"
+              >
+                {uploading ? (
+                  <Loader2 size={18} className="animate-spin" />
+                ) : (
+                  <Upload size={18} />
+                )}
+              </button>
+            </div>
+          </div>
         </div>
-    );
+
+        <div className="pt-6 border-t border-gray-50 flex items-center justify-end gap-4">
+          <Link
+            href="/admin/collections"
+            className="px-6 py-2.5 text-gray-500 hover:text-gray-900 font-medium transition-colors text-sm"
+          >
+            Annuler
+          </Link>
+          <button
+            type="submit"
+            disabled={saving}
+            className="bg-gray-900 text-white px-6 py-2.5 rounded-xl hover:bg-gray-800 transition-all disabled:opacity-50 flex items-center gap-2 text-sm font-medium shadow-sm"
+          >
+            {saving ? (
+              <>
+                <Loader2 size={16} className="animate-spin" />
+                Enregistrement...
+              </>
+            ) : (
+              <>
+                <Save size={16} />
+                Enregistrer
+              </>
+            )}
+          </button>
+        </div>
+      </form>
+    </div>
+  );
 }
diff --git a/src/app/admin/collections/new/page.tsx b/src/app/admin/collections/new/page.tsx
index 4945e01..2d642ee 100644
--- a/src/app/admin/collections/new/page.tsx
+++ b/src/app/admin/collections/new/page.tsx
@@ -2,221 +2,262 @@
 
 import { useState, useRef } from "react";
 import { useRouter } from "next/navigation";
-import { ArrowLeft, Plus, Image as ImageIcon, Upload, Loader2, X } from "lucide-react";
+import {
+  ArrowLeft,
+  Plus,
+  Image as ImageIcon,
+  Upload,
+  Loader2,
+  X,
+} from "lucide-react";
 import Link from "next/link";
 import { cn } from "@/lib/utils";
 
 export default function NewCollectionPage() {
-    const router = useRouter();
-    const fileInputRef = useRef<HTMLInputElement>(null);
-    const [loading, setLoading] = useState(false);
-    const [uploading, setUploading] = useState(false);
-    const [error, setError] = useState<string | null>(null);
-    const [formData, setFormData] = useState({
-        nameFr: "",
-        nameAr: "",
-        image: "",
-    });
-
-    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
-        setFormData({ ...formData, [e.target.name]: e.target.value });
-        setError(null);
-    };
-
-    const handleFileUpload = async (file: File) => {
-        if (!file.type.startsWith('image/')) {
-            setError('Veuillez sélectionner une image');
-            return;
-        }
-        setUploading(true);
-        setError(null);
-        try {
-            const uploadData = new FormData();
-            uploadData.append('file', file);
-            const response = await fetch('/api/upload', { method: 'POST', body: uploadData });
-            if (response.ok) {
-                const data = await response.json();
-                setFormData(prev => ({ ...prev, image: data.url }));
-            } else {
-                setError('Erreur lors de l\'upload');
-            }
-        } catch {
-            setError('Erreur lors de l\'upload');
-        } finally {
-            setUploading(false);
-        }
-    };
-
-    const handleSubmit = async (e: React.FormEvent) => {
-        e.preventDefault();
-        setLoading(true);
-
-        try {
-            const response = await fetch("/api/collections", {
-                method: "POST",
-                headers: { "Content-Type": "application/json" },
-                body: JSON.stringify(formData),
-            });
-
-            if (response.ok) {
-                router.push("/admin/collections");
-            } else {
-                const data = await response.json();
-                setError(data.details?.join(', ') || 'Erreur lors de la création');
-            }
-        } catch (err) {
-            console.error("Error creating collection:", err);
-            setError('Erreur de connexion');
-        } finally {
-            setLoading(false);
-        }
-    };
-
-    return (
-        <div className="max-w-2xl mx-auto space-y-8">
-            <div>
-                <Link href="/admin/collections" className="inline-flex items-center gap-2 text-gray-400 hover:text-gray-900 transition-colors mb-6">
-                    <ArrowLeft size={16} />
-                    <span className="text-sm font-medium">Retour aux collections</span>
-                </Link>
-                
-                <h1 className="text-3xl font-serif font-medium text-gray-900">Nouvelle Collection</h1>
-                <p className="text-gray-500 text-sm mt-2">Créez une nouvelle collection de produits</p>
+  const router = useRouter();
+  const fileInputRef = useRef<HTMLInputElement>(null);
+  const [loading, setLoading] = useState(false);
+  const [uploading, setUploading] = useState(false);
+  const [error, setError] = useState<string | null>(null);
+  const [formData, setFormData] = useState({
+    nameFr: "",
+    nameAr: "",
+    image: "",
+  });
+
+  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
+    setFormData({ ...formData, [e.target.name]: e.target.value });
+    setError(null);
+  };
+
+  const handleFileUpload = async (file: File) => {
+    if (!file.type.startsWith("image/")) {
+      setError("Veuillez sélectionner une image");
+      return;
+    }
+    setUploading(true);
+    setError(null);
+    try {
+      const uploadData = new FormData();
+      uploadData.append("file", file);
+      const response = await fetch("/api/upload", {
+        method: "POST",
+        body: uploadData,
+      });
+      if (response.ok) {
+        const data = await response.json();
+        setFormData((prev) => ({ ...prev, image: data.url }));
+      } else {
+        setError("Erreur lors de l'upload");
+      }
+    } catch {
+      setError("Erreur lors de l'upload");
+    } finally {
+      setUploading(false);
+    }
+  };
+
+  const handleSubmit = async (e: React.FormEvent) => {
+    e.preventDefault();
+    setLoading(true);
+
+    try {
+      const response = await fetch("/api/collections", {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify(formData),
+      });
+
+      if (response.ok) {
+        router.push("/admin/collections");
+      } else {
+        const data = await response.json();
+        setError(data.details?.join(", ") || "Erreur lors de la création");
+      }
+    } catch (err) {
+      console.error("Error creating collection:", err);
+      setError("Erreur de connexion");
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  return (
+    <div className="max-w-2xl mx-auto space-y-8">
+      <div>
+        <Link
+          href="/admin/collections"
+          className="inline-flex items-center gap-2 text-gray-400 hover:text-gray-900 transition-colors mb-6"
+        >
+          <ArrowLeft size={16} />
+          <span className="text-sm font-medium">Retour aux collections</span>
+        </Link>
+
+        <h1 className="text-3xl font-serif font-medium text-gray-900">
+          Nouvelle Collection
+        </h1>
+        <p className="text-gray-500 text-sm mt-2">
+          Créez une nouvelle collection de produits
+        </p>
+      </div>
+
+      <form
+        onSubmit={handleSubmit}
+        className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-8"
+      >
+        <div className="space-y-6">
+          <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">
+            Informations générales
+          </h2>
+
+          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Nom (Français) *
+              </label>
+              <input
+                required
+                name="nameFr"
+                value={formData.nameFr}
+                onChange={handleChange}
+                placeholder="Ex: Collection Hiver 2025"
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+            </div>
+            <div className="space-y-2" dir="rtl">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                الاسم (بالعربية) *
+              </label>
+              <input
+                required
+                name="nameAr"
+                value={formData.nameAr}
+                onChange={handleChange}
+                placeholder="مثال: مجموعة شتاء 2025"
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
             </div>
+          </div>
 
-            <form onSubmit={handleSubmit} className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-8">
-                <div className="space-y-6">
-                    <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">Informations générales</h2>
-                    
-                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Nom (Français) *</label>
-                            <input
-                                required
-                                name="nameFr"
-                                value={formData.nameFr}
-                                onChange={handleChange}
-                                placeholder="Ex: Collection Hiver 2025"
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                        <div className="space-y-2" dir="rtl">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">الاسم (بالعربية) *</label>
-                            <input
-                                required
-                                name="nameAr"
-                                value={formData.nameAr}
-                                onChange={handleChange}
-                                placeholder="مثال: مجموعة شتاء 2025"
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                    </div>
-
-                    {/* Error display */}
-                    {error && (
-                        <div className="bg-red-50 text-red-600 px-4 py-3 rounded-xl text-sm flex items-center gap-2">
-                            <div className="w-1.5 h-1.5 rounded-full bg-red-600" />
-                            {error}
-                        </div>
-                    )}
-
-                    <div className="space-y-4">
-                        <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Image de couverture</label>
-                        
-                        {/* Image Preview */}
-                        {formData.image ? (
-                            <div className="relative w-full max-w-md aspect-video bg-gray-50 rounded-xl overflow-hidden group">
-                                {/* eslint-disable-next-line @next/next/no-img-element */}
-                                <img
-                                    src={formData.image}
-                                    alt="Aperçu"
-                                    className="w-full h-full object-cover"
-                                    onError={(e) => {
-                                        (e.target as HTMLImageElement).src = `https://placehold.co/300x300/F5F1EC/4A3A2A?text=Error`;
-                                    }}
-                                />
-                                <div className="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors" />
-                                <button
-                                    type="button"
-                                    onClick={() => setFormData(prev => ({ ...prev, image: '' }))}
-                                    className="absolute top-3 right-3 p-2 bg-white text-red-500 rounded-lg hover:bg-red-50 shadow-sm opacity-0 group-hover:opacity-100 transition-all transform translate-y-2 group-hover:translate-y-0"
-                                >
-                                    <X size={16} />
-                                </button>
-                            </div>
-                        ) : (
-                            <div 
-                                onClick={() => fileInputRef.current?.click()}
-                                className="w-full max-w-md aspect-video border-2 border-dashed border-gray-200 rounded-xl flex flex-col items-center justify-center text-gray-400 hover:border-gray-300 hover:bg-gray-50 transition-all cursor-pointer gap-3"
-                            >
-                                <div className="p-3 bg-gray-100 rounded-full">
-                                    <ImageIcon size={24} className="text-gray-400" />
-                                </div>
-                                <div className="text-center">
-                                    <p className="text-sm font-medium text-gray-900">Cliquez pour uploader</p>
-                                    <p className="text-xs text-gray-400 mt-1">PNG, JPG jusqu'à 5MB</p>
-                                </div>
-                            </div>
-                        )}
-                        
-                        {/* Upload controls */}
-                        <input
-                            ref={fileInputRef}
-                            type="file"
-                            accept="image/*"
-                            onChange={(e) => e.target.files?.[0] && handleFileUpload(e.target.files[0])}
-                            className="hidden"
-                        />
-                        
-                        <div className="flex gap-3 max-w-md">
-                            <div className="relative flex-1">
-                                <input
-                                    name="image"
-                                    value={formData.image}
-                                    onChange={handleChange}
-                                    placeholder="Ou coller une URL..."
-                                    className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none text-sm text-gray-600"
-                                />
-                            </div>
-                            <button
-                                type="button"
-                                onClick={() => fileInputRef.current?.click()}
-                                disabled={uploading}
-                                className="px-4 py-3 bg-gray-900 text-white rounded-xl hover:bg-gray-800 disabled:opacity-50 transition-colors"
-                            >
-                                {uploading ? <Loader2 size={18} className="animate-spin" /> : <Upload size={18} />}
-                            </button>
-                        </div>
-                    </div>
-                </div>
+          {/* Error display */}
+          {error && (
+            <div className="bg-red-50 text-red-600 px-4 py-3 rounded-xl text-sm flex items-center gap-2">
+              <div className="w-1.5 h-1.5 rounded-full bg-red-600" />
+              {error}
+            </div>
+          )}
+
+          <div className="space-y-4">
+            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+              Image de couverture
+            </label>
 
-                <div className="pt-6 border-t border-gray-50 flex items-center justify-end gap-4">
-                    <Link
-                        href="/admin/collections"
-                        className="px-6 py-2.5 text-gray-500 hover:text-gray-900 font-medium transition-colors text-sm"
-                    >
-                        Annuler
-                    </Link>
-                    <button
-                        type="submit"
-                        disabled={loading}
-                        className="bg-gray-900 text-white px-6 py-2.5 rounded-xl hover:bg-gray-800 transition-all disabled:opacity-50 flex items-center gap-2 text-sm font-medium shadow-sm"
-                    >
-                        {loading ? (
-                            <>
-                                <Loader2 size={16} className="animate-spin" />
-                                Création...
-                            </>
-                        ) : (
-                            <>
-                                <Plus size={16} />
-                                Créer la collection
-                            </>
-                        )}
-                    </button>
+            {/* Image Preview */}
+            {formData.image ? (
+              <div className="relative w-full max-w-md aspect-video bg-gray-50 rounded-xl overflow-hidden group">
+                {/* eslint-disable-next-line @next/next/no-img-element */}
+                <img
+                  src={formData.image}
+                  alt="Aperçu"
+                  className="w-full h-full object-cover"
+                  onError={(e) => {
+                    (e.target as HTMLImageElement).src =
+                      `https://placehold.co/300x300/F5F1EC/4A3A2A?text=Error`;
+                  }}
+                />
+                <div className="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors" />
+                <button
+                  type="button"
+                  onClick={() =>
+                    setFormData((prev) => ({ ...prev, image: "" }))
+                  }
+                  className="absolute top-3 right-3 p-2 bg-white text-red-500 rounded-lg hover:bg-red-50 shadow-sm opacity-0 group-hover:opacity-100 transition-all transform translate-y-2 group-hover:translate-y-0"
+                >
+                  <X size={16} />
+                </button>
+              </div>
+            ) : (
+              <div
+                onClick={() => fileInputRef.current?.click()}
+                className="w-full max-w-md aspect-video border-2 border-dashed border-gray-200 rounded-xl flex flex-col items-center justify-center text-gray-400 hover:border-gray-300 hover:bg-gray-50 transition-all cursor-pointer gap-3"
+              >
+                <div className="p-3 bg-gray-100 rounded-full">
+                  <ImageIcon size={24} className="text-gray-400" />
                 </div>
-            </form>
+                <div className="text-center">
+                  <p className="text-sm font-medium text-gray-900">
+                    Cliquez pour uploader
+                  </p>
+                  <p className="text-xs text-gray-400 mt-1">
+                    PNG, JPG jusqu'à 5MB
+                  </p>
+                </div>
+              </div>
+            )}
+
+            {/* Upload controls */}
+            <input
+              ref={fileInputRef}
+              type="file"
+              accept="image/*"
+              onChange={(e) =>
+                e.target.files?.[0] && handleFileUpload(e.target.files[0])
+              }
+              className="hidden"
+            />
+
+            <div className="flex gap-3 max-w-md">
+              <div className="relative flex-1">
+                <input
+                  name="image"
+                  value={formData.image}
+                  onChange={handleChange}
+                  placeholder="Ou coller une URL..."
+                  className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none text-sm text-gray-600"
+                />
+              </div>
+              <button
+                type="button"
+                onClick={() => fileInputRef.current?.click()}
+                disabled={uploading}
+                className="px-4 py-3 bg-gray-900 text-white rounded-xl hover:bg-gray-800 disabled:opacity-50 transition-colors"
+              >
+                {uploading ? (
+                  <Loader2 size={18} className="animate-spin" />
+                ) : (
+                  <Upload size={18} />
+                )}
+              </button>
+            </div>
+          </div>
+        </div>
+
+        <div className="pt-6 border-t border-gray-50 flex items-center justify-end gap-4">
+          <Link
+            href="/admin/collections"
+            className="px-6 py-2.5 text-gray-500 hover:text-gray-900 font-medium transition-colors text-sm"
+          >
+            Annuler
+          </Link>
+          <button
+            type="submit"
+            disabled={loading}
+            className="bg-gray-900 text-white px-6 py-2.5 rounded-xl hover:bg-gray-800 transition-all disabled:opacity-50 flex items-center gap-2 text-sm font-medium shadow-sm"
+          >
+            {loading ? (
+              <>
+                <Loader2 size={16} className="animate-spin" />
+                Création...
+              </>
+            ) : (
+              <>
+                <Plus size={16} />
+                Créer la collection
+              </>
+            )}
+          </button>
         </div>
-    );
+      </form>
+    </div>
+  );
 }
diff --git a/src/app/admin/collections/page.tsx b/src/app/admin/collections/page.tsx
index 121de3a..456e3c3 100644
--- a/src/app/admin/collections/page.tsx
+++ b/src/app/admin/collections/page.tsx
@@ -1,164 +1,199 @@
 "use client";
 
 import Link from "next/link";
-import { Plus, Edit, Trash2, Search, Filter, FolderOpen, Layers } from "lucide-react";
+import {
+  Plus,
+  Edit,
+  Trash2,
+  Search,
+  Filter,
+  FolderOpen,
+  Layers,
+} from "lucide-react";
 import { useState, useEffect } from "react";
 
 export default function AdminCollectionsPage() {
-    const [collections, setCollections] = useState<any[]>([]);
-    const [loading, setLoading] = useState(true);
-    const [searchQuery, setSearchQuery] = useState("");
+  const [collections, setCollections] = useState<any[]>([]);
+  const [loading, setLoading] = useState(true);
+  const [searchQuery, setSearchQuery] = useState("");
 
-    useEffect(() => {
-        fetch("/api/collections")
-            .then((res) => res.json())
-            .then((data) => {
-                setCollections(data);
-                setLoading(false);
-            })
-            .catch((err) => {
-                console.error("Failed to fetch collections", err);
-                setLoading(false);
-            });
-    }, []);
+  useEffect(() => {
+    fetch("/api/collections")
+      .then((res) => res.json())
+      .then((data) => {
+        setCollections(data);
+        setLoading(false);
+      })
+      .catch((err) => {
+        console.error("Failed to fetch collections", err);
+        setLoading(false);
+      });
+  }, []);
 
-    const handleDelete = async (id: string) => {
-        if (!confirm("Êtes-vous sûr de vouloir supprimer cette collection ?")) return;
+  const handleDelete = async (id: string) => {
+    if (!confirm("Êtes-vous sûr de vouloir supprimer cette collection ?"))
+      return;
 
-        try {
-            const res = await fetch(`/api/collections/${id}`, {
-                method: "DELETE",
-            });
+    try {
+      const res = await fetch(`/api/collections/${id}`, {
+        method: "DELETE",
+      });
 
-            if (res.ok) {
-                setCollections(collections.filter((c) => c.id !== id));
-            } else {
-                alert("Erreur lors de la suppression");
-            }
-        } catch (error) {
-            console.error("Error deleting collection:", error);
-            alert("Erreur lors de la suppression");
-        }
-    };
+      if (res.ok) {
+        setCollections(collections.filter((c) => c.id !== id));
+      } else {
+        alert("Erreur lors de la suppression");
+      }
+    } catch (error) {
+      console.error("Error deleting collection:", error);
+      alert("Erreur lors de la suppression");
+    }
+  };
 
-    const filteredCollections = collections.filter(c => 
-        c.nameFr.toLowerCase().includes(searchQuery.toLowerCase()) ||
-        c.nameAr.toLowerCase().includes(searchQuery.toLowerCase())
-    );
+  const filteredCollections = collections.filter(
+    (c) =>
+      c.nameFr.toLowerCase().includes(searchQuery.toLowerCase()) ||
+      c.nameAr.toLowerCase().includes(searchQuery.toLowerCase()),
+  );
 
-    return (
-        <div className="space-y-8">
-            {/* Header */}
-            <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
-                <div>
-                    <h1 className="text-3xl font-serif font-medium text-gray-900">Collections</h1>
-                    <p className="text-gray-500 text-sm mt-1">Organisez vos produits par collection</p>
-                </div>
-                <Link
-                    href="/admin/collections/new"
-                    className="inline-flex items-center gap-2 bg-gray-900 text-white px-5 py-2.5 rounded-lg hover:bg-gray-800 transition-all text-sm font-medium shadow-sm"
-                >
-                    <Plus size={18} />
-                    Nouvelle collection
-                </Link>
-            </div>
+  return (
+    <div className="space-y-8">
+      {/* Header */}
+      <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
+        <div>
+          <h1 className="text-3xl font-serif font-medium text-gray-900">
+            Collections
+          </h1>
+          <p className="text-gray-500 text-sm mt-1">
+            Organisez vos produits par collection
+          </p>
+        </div>
+        <Link
+          href="/admin/collections/new"
+          className="inline-flex items-center gap-2 bg-gray-900 text-white px-5 py-2.5 rounded-lg hover:bg-gray-800 transition-all text-sm font-medium shadow-sm"
+        >
+          <Plus size={18} />
+          Nouvelle collection
+        </Link>
+      </div>
 
-            {/* Stats & Filters */}
-            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
-                <div className="bg-white p-5 rounded-xl border border-gray-100 flex items-center gap-4 shadow-sm">
-                    <div className="p-3 bg-blue-50 text-blue-600 rounded-xl">
-                        <Layers size={24} />
-                    </div>
-                    <div>
-                        <p className="text-sm text-gray-500 font-medium">Total Collections</p>
-                        <p className="text-2xl font-serif font-medium text-gray-900">{collections.length}</p>
-                    </div>
-                </div>
-                
-                <div className="md:col-span-2 bg-white p-1 rounded-xl border border-gray-100 shadow-sm flex items-center">
-                    <div className="relative flex-1">
-                        <Search size={18} className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" />
-                        <input 
-                            type="text" 
-                            placeholder="Rechercher une collection..." 
-                            className="w-full pl-10 pr-4 py-3 bg-transparent border-none text-sm focus:ring-0 outline-none placeholder:text-gray-400"
-                            value={searchQuery}
-                            onChange={(e) => setSearchQuery(e.target.value)}
-                        />
-                    </div>
-                </div>
-            </div>
+      {/* Stats & Filters */}
+      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
+        <div className="bg-white p-5 rounded-xl border border-gray-100 flex items-center gap-4 shadow-sm">
+          <div className="p-3 bg-blue-50 text-blue-600 rounded-xl">
+            <Layers size={24} />
+          </div>
+          <div>
+            <p className="text-sm text-gray-500 font-medium">
+              Total Collections
+            </p>
+            <p className="text-2xl font-serif font-medium text-gray-900">
+              {collections.length}
+            </p>
+          </div>
+        </div>
 
-            {/* Table */}
-            <div className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
-                <table className="w-full text-left">
-                    <thead>
-                        <tr className="border-b border-gray-100 bg-gray-50/50 text-xs uppercase tracking-widest text-gray-500">
-                            <th className="py-4 px-6 font-medium">Collection</th>
-                            <th className="py-4 px-6 font-medium text-right">Nom Arabe</th>
-                            <th className="py-4 px-6 font-medium">Produits</th>
-                            <th className="py-4 px-6 font-medium text-right">Actions</th>
-                        </tr>
-                    </thead>
-                    <tbody className="divide-y divide-gray-50 text-sm">
-                        {loading ? (
-                            <tr>
-                                <td colSpan={4} className="py-16 text-center text-gray-400">Chargement...</td>
-                            </tr>
-                        ) : filteredCollections.length === 0 ? (
-                            <tr>
-                                <td colSpan={4} className="py-16 text-center text-gray-400">Aucune collection trouvée.</td>
-                            </tr>
+        <div className="md:col-span-2 bg-white p-1 rounded-xl border border-gray-100 shadow-sm flex items-center">
+          <div className="relative flex-1">
+            <Search
+              size={18}
+              className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
+            />
+            <input
+              type="text"
+              placeholder="Rechercher une collection..."
+              className="w-full pl-10 pr-4 py-3 bg-transparent border-none text-sm focus:ring-0 outline-none placeholder:text-gray-400"
+              value={searchQuery}
+              onChange={(e) => setSearchQuery(e.target.value)}
+            />
+          </div>
+        </div>
+      </div>
+
+      {/* Table */}
+      <div className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
+        <table className="w-full text-left">
+          <thead>
+            <tr className="border-b border-gray-100 bg-gray-50/50 text-xs uppercase tracking-widest text-gray-500">
+              <th className="py-4 px-6 font-medium">Collection</th>
+              <th className="py-4 px-6 font-medium text-right">Nom Arabe</th>
+              <th className="py-4 px-6 font-medium">Produits</th>
+              <th className="py-4 px-6 font-medium text-right">Actions</th>
+            </tr>
+          </thead>
+          <tbody className="divide-y divide-gray-50 text-sm">
+            {loading ? (
+              <tr>
+                <td colSpan={4} className="py-16 text-center text-gray-400">
+                  Chargement...
+                </td>
+              </tr>
+            ) : filteredCollections.length === 0 ? (
+              <tr>
+                <td colSpan={4} className="py-16 text-center text-gray-400">
+                  Aucune collection trouvée.
+                </td>
+              </tr>
+            ) : (
+              filteredCollections.map((collection) => (
+                <tr
+                  key={collection.id}
+                  className="hover:bg-gray-50/50 transition-colors group"
+                >
+                  <td className="py-4 px-6">
+                    <div className="flex items-center gap-4">
+                      <div className="w-12 h-12 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 border border-gray-100">
+                        {collection.image ? (
+                          // eslint-disable-next-line @next/next/no-img-element
+                          <img
+                            src={collection.image}
+                            alt={collection.nameFr}
+                            className="w-full h-full object-cover"
+                          />
                         ) : (
-                            filteredCollections.map((collection) => (
-                                <tr key={collection.id} className="hover:bg-gray-50/50 transition-colors group">
-                                    <td className="py-4 px-6">
-                                        <div className="flex items-center gap-4">
-                                            <div className="w-12 h-12 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 border border-gray-100">
-                                                {collection.image ? (
-                                                    // eslint-disable-next-line @next/next/no-img-element
-                                                    <img
-                                                        src={collection.image}
-                                                        alt={collection.nameFr}
-                                                        className="w-full h-full object-cover"
-                                                    />
-                                                ) : (
-                                                    <div className="w-full h-full flex items-center justify-center text-gray-400">
-                                                        <FolderOpen size={20} />
-                                                    </div>
-                                                )}
-                                            </div>
-                                            <span className="font-medium text-gray-900">{collection.nameFr}</span>
-                                        </div>
-                                    </td>
-                                    <td className="py-4 px-6 font-medium text-right text-gray-600" dir="rtl">{collection.nameAr}</td>
-                                    <td className="py-4 px-6">
-                                        <span className="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-gray-50 text-gray-600 border border-gray-100">
-                                            {collection.products?.length || 0} produits
-                                        </span>
-                                    </td>
-                                    <td className="py-4 px-6 text-right">
-                                        <div className="flex justify-end items-center gap-2 opacity-0 group-hover:opacity-100 transition-all translate-x-2 group-hover:translate-x-0">
-                                            <Link
-                                                href={`/admin/collections/${collection.id}/edit`}
-                                                className="p-2 text-gray-400 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"
-                                            >
-                                                <Edit size={16} />
-                                            </Link>
-                                            <button
-                                                onClick={() => handleDelete(collection.id)}
-                                                className="p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors"
-                                            >
-                                                <Trash2 size={16} />
-                                            </button>
-                                        </div>
-                                    </td>
-                                </tr>
-                            ))
+                          <div className="w-full h-full flex items-center justify-center text-gray-400">
+                            <FolderOpen size={20} />
+                          </div>
                         )}
-                    </tbody>
-                </table>
-            </div>
-        </div>
-    );
+                      </div>
+                      <span className="font-medium text-gray-900">
+                        {collection.nameFr}
+                      </span>
+                    </div>
+                  </td>
+                  <td
+                    className="py-4 px-6 font-medium text-right text-gray-600"
+                    dir="rtl"
+                  >
+                    {collection.nameAr}
+                  </td>
+                  <td className="py-4 px-6">
+                    <span className="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-gray-50 text-gray-600 border border-gray-100">
+                      {collection.products?.length || 0} produits
+                    </span>
+                  </td>
+                  <td className="py-4 px-6 text-right">
+                    <div className="flex justify-end items-center gap-2 opacity-0 group-hover:opacity-100 transition-all translate-x-2 group-hover:translate-x-0">
+                      <Link
+                        href={`/admin/collections/${collection.id}/edit`}
+                        className="p-2 text-gray-400 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"
+                      >
+                        <Edit size={16} />
+                      </Link>
+                      <button
+                        onClick={() => handleDelete(collection.id)}
+                        className="p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors"
+                      >
+                        <Trash2 size={16} />
+                      </button>
+                    </div>
+                  </td>
+                </tr>
+              ))
+            )}
+          </tbody>
+        </table>
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/admin/compta/advances/[id]/apply/page.tsx b/src/app/admin/compta/advances/[id]/apply/page.tsx
index 9db2802..ba88d01 100644
--- a/src/app/admin/compta/advances/[id]/apply/page.tsx
+++ b/src/app/admin/compta/advances/[id]/apply/page.tsx
@@ -22,7 +22,11 @@ interface Purchase {
   status: string;
 }
 
-export default function ApplyAdvancePage({ params }: { params: Promise<{ id: string }> }) {
+export default function ApplyAdvancePage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
   const { id } = use(params);
   const router = useRouter();
   const [advance, setAdvance] = useState<Advance | null>(null);
@@ -34,8 +38,12 @@ export default function ApplyAdvancePage({ params }: { params: Promise<{ id: str
 
   useEffect(() => {
     Promise.all([
-      fetch(`/api/v3/compta/advances/${id}`, { credentials: "include" }).then((r) => r.json()),
-      fetch("/api/v3/compta/purchases?status=ORDERED&limit=50", { credentials: "include" }).then((r) => r.json()),
+      fetch(`/api/v3/compta/advances/${id}`, { credentials: "include" }).then(
+        (r) => r.json(),
+      ),
+      fetch("/api/v3/compta/purchases?status=ORDERED&limit=50", {
+        credentials: "include",
+      }).then((r) => r.json()),
     ]).then(([advData, purchData]) => {
       if (advData.success) {
         setAdvance(advData.advance);
@@ -44,7 +52,7 @@ export default function ApplyAdvancePage({ params }: { params: Promise<{ id: str
       if (purchData.success) {
         // Filter purchases from same supplier with amount due
         const filtered = purchData.items.filter(
-          (p: Purchase) => p.amountDue > 0
+          (p: Purchase) => p.amountDue > 0,
         );
         setPurchases(filtered);
       }
@@ -59,7 +67,8 @@ export default function ApplyAdvancePage({ params }: { params: Promise<{ id: str
     setSubmitting(true);
     try {
       const res = await fetch(`/api/v3/compta/advances/${id}/apply`, {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify({
           purchaseId: selectedPurchase,
@@ -78,18 +87,31 @@ export default function ApplyAdvancePage({ params }: { params: Promise<{ id: str
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
 
-  if (loading) return <div className="text-center py-12 text-slate-500">Chargement...</div>;
-  if (!advance) return <div className="text-center py-12 text-red-500">Avance non trouvée</div>;
+  if (loading)
+    return (
+      <div className="text-center py-12 text-slate-500">Chargement...</div>
+    );
+  if (!advance)
+    return (
+      <div className="text-center py-12 text-red-500">Avance non trouvée</div>
+    );
 
   const selectedPurchaseData = purchases.find((p) => p.id === selectedPurchase);
-  const maxAmount = Math.min(advance.amountRemaining, selectedPurchaseData?.amountDue || 0);
+  const maxAmount = Math.min(
+    advance.amountRemaining,
+    selectedPurchaseData?.amountDue || 0,
+  );
 
   return (
     <div className="max-w-2xl mx-auto space-y-6">
       <header className="flex items-center gap-4">
-        <Link href="/admin/compta/advances" className="p-2 hover:bg-slate-100 rounded-lg">
+        <Link
+          href="/admin/compta/advances"
+          className="p-2 hover:bg-slate-100 rounded-lg"
+        >
           <ArrowLeft size={20} />
         </Link>
         <div>
@@ -106,14 +128,22 @@ export default function ApplyAdvancePage({ params }: { params: Promise<{ id: str
         <div className="flex-1">
           <p className="font-medium">{advance.supplier.name}</p>
           <p className="text-sm text-green-700">
-            Disponible: <span className="font-bold">{formatCurrency(advance.amountRemaining)}</span>
+            Disponible:{" "}
+            <span className="font-bold">
+              {formatCurrency(advance.amountRemaining)}
+            </span>
           </p>
         </div>
       </div>
 
-      <form onSubmit={handleSubmit} className="bg-white p-6 rounded-2xl shadow space-y-6">
+      <form
+        onSubmit={handleSubmit}
+        className="bg-white p-6 rounded-2xl shadow space-y-6"
+      >
         <div>
-          <label className="block text-sm font-medium text-slate-700 mb-1">Achat à régler</label>
+          <label className="block text-sm font-medium text-slate-700 mb-1">
+            Achat à régler
+          </label>
           <select
             value={selectedPurchase}
             onChange={(e) => {
@@ -141,13 +171,17 @@ export default function ApplyAdvancePage({ params }: { params: Promise<{ id: str
             </div>
             <div className="flex justify-between text-sm">
               <span className="text-slate-600">Reste dû</span>
-              <span className="text-orange-600 font-medium">{formatCurrency(selectedPurchaseData.amountDue)}</span>
+              <span className="text-orange-600 font-medium">
+                {formatCurrency(selectedPurchaseData.amountDue)}
+              </span>
             </div>
           </div>
         )}
 
         <div>
-          <label className="block text-sm font-medium text-slate-700 mb-1">Montant à appliquer</label>
+          <label className="block text-sm font-medium text-slate-700 mb-1">
+            Montant à appliquer
+          </label>
           <input
             type="number"
             min="1"
@@ -167,28 +201,42 @@ export default function ApplyAdvancePage({ params }: { params: Promise<{ id: str
         {/* Preview */}
         {selectedPurchaseData && amount > 0 && (
           <div className="bg-blue-50 p-4 rounded-lg">
-            <p className="text-sm font-medium text-blue-800 mb-2">Après application:</p>
+            <p className="text-sm font-medium text-blue-800 mb-2">
+              Après application:
+            </p>
             <div className="flex items-center gap-4 text-sm">
               <div className="flex-1">
                 <p className="text-slate-600">Avance restante</p>
-                <p className="font-bold text-blue-600">{formatCurrency(advance.amountRemaining - amount)}</p>
+                <p className="font-bold text-blue-600">
+                  {formatCurrency(advance.amountRemaining - amount)}
+                </p>
               </div>
               <ArrowRight className="text-slate-400" size={20} />
               <div className="flex-1">
                 <p className="text-slate-600">Achat restant dû</p>
-                <p className="font-bold text-green-600">{formatCurrency(selectedPurchaseData.amountDue - amount)}</p>
+                <p className="font-bold text-green-600">
+                  {formatCurrency(selectedPurchaseData.amountDue - amount)}
+                </p>
               </div>
             </div>
           </div>
         )}
 
         <div className="flex justify-end gap-4 pt-4 border-t">
-          <Link href="/admin/compta/advances" className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/advances"
+            className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg"
+          >
             Annuler
           </Link>
           <button
             type="submit"
-            disabled={submitting || !selectedPurchase || amount <= 0 || amount > maxAmount}
+            disabled={
+              submitting ||
+              !selectedPurchase ||
+              amount <= 0 ||
+              amount > maxAmount
+            }
             className="flex items-center gap-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50"
           >
             <CheckCircle size={18} />
diff --git a/src/app/admin/compta/advances/new/page.tsx b/src/app/admin/compta/advances/new/page.tsx
index b9c97e9..c379ae6 100644
--- a/src/app/admin/compta/advances/new/page.tsx
+++ b/src/app/admin/compta/advances/new/page.tsx
@@ -46,7 +46,8 @@ export default function NewAdvancePage() {
 
     try {
       const res = await fetch("/api/v3/compta/advances", {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify({
           ...form,
@@ -70,33 +71,47 @@ export default function NewAdvancePage() {
   return (
     <div className="max-w-2xl mx-auto space-y-6">
       <header className="flex items-center gap-4">
-        <Link href="/admin/compta/advances" className="p-2 hover:bg-slate-100 rounded-lg">
+        <Link
+          href="/admin/compta/advances"
+          className="p-2 hover:bg-slate-100 rounded-lg"
+        >
           <ArrowLeft size={20} />
         </Link>
         <div>
           <h1 className="text-2xl font-serif">Nouvelle Avance</h1>
-          <p className="text-sm text-slate-600">Enregistrer une avance fournisseur</p>
+          <p className="text-sm text-slate-600">
+            Enregistrer une avance fournisseur
+          </p>
         </div>
       </header>
 
       {error && (
-        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">{error}</div>
+        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">
+          {error}
+        </div>
       )}
 
-      <form onSubmit={handleSubmit} className="bg-white p-6 rounded-2xl shadow space-y-6">
+      <form
+        onSubmit={handleSubmit}
+        className="bg-white p-6 rounded-2xl shadow space-y-6"
+      >
         <div className="flex items-center gap-3 pb-4 border-b">
           <div className="p-3 bg-green-100 rounded-xl">
             <Wallet className="text-green-600" size={24} />
           </div>
           <div>
             <p className="font-medium">Avance Fournisseur</p>
-            <p className="text-sm text-slate-500">Cette avance pourra être appliquée sur de futurs achats</p>
+            <p className="text-sm text-slate-500">
+              Cette avance pourra être appliquée sur de futurs achats
+            </p>
           </div>
         </div>
 
         <div className="grid grid-cols-2 gap-4">
           <div className="col-span-2">
-            <label className="block text-sm font-medium text-slate-700 mb-1">Fournisseur *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Fournisseur *
+            </label>
             <select
               value={form.supplierId}
               onChange={(e) => setForm({ ...form, supplierId: e.target.value })}
@@ -113,12 +128,16 @@ export default function NewAdvancePage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Montant (DZD) *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Montant (DZD) *
+            </label>
             <input
               type="number"
               min="1"
               value={form.amount}
-              onChange={(e) => setForm({ ...form, amount: parseFloat(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({ ...form, amount: parseFloat(e.target.value) || 0 })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
               placeholder="50000"
               required
@@ -126,10 +145,14 @@ export default function NewAdvancePage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Mode de paiement</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Mode de paiement
+            </label>
             <select
               value={form.paymentMethod}
-              onChange={(e) => setForm({ ...form, paymentMethod: e.target.value })}
+              onChange={(e) =>
+                setForm({ ...form, paymentMethod: e.target.value })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
             >
               <option value="CASH">Espèces</option>
@@ -141,17 +164,23 @@ export default function NewAdvancePage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Date paiement</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Date paiement
+            </label>
             <input
               type="date"
               value={form.paymentDate}
-              onChange={(e) => setForm({ ...form, paymentDate: e.target.value })}
+              onChange={(e) =>
+                setForm({ ...form, paymentDate: e.target.value })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
             />
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Référence</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Référence
+            </label>
             <input
               type="text"
               value={form.reference}
@@ -162,7 +191,9 @@ export default function NewAdvancePage() {
           </div>
 
           <div className="col-span-2">
-            <label className="block text-sm font-medium text-slate-700 mb-1">Notes</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Notes
+            </label>
             <textarea
               value={form.notes}
               onChange={(e) => setForm({ ...form, notes: e.target.value })}
@@ -174,7 +205,10 @@ export default function NewAdvancePage() {
         </div>
 
         <div className="flex justify-end gap-4 pt-4 border-t">
-          <Link href="/admin/compta/advances" className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/advances"
+            className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg"
+          >
             Annuler
           </Link>
           <button
diff --git a/src/app/admin/compta/advances/page.tsx b/src/app/admin/compta/advances/page.tsx
index 810c1c4..919e8b7 100644
--- a/src/app/admin/compta/advances/page.tsx
+++ b/src/app/admin/compta/advances/page.tsx
@@ -51,7 +51,9 @@ export default function AdvancesPage() {
     try {
       const params = new URLSearchParams({ limit: "20" });
       if (filter) params.set("status", filter);
-      const res = await fetch(`/api/v3/compta/advances?${params}`, { credentials: "include" });
+      const res = await fetch(`/api/v3/compta/advances?${params}`, {
+        credentials: "include",
+      });
       const data = await res.json();
       if (data.success) {
         setAdvances(data.items);
@@ -64,7 +66,8 @@ export default function AdvancesPage() {
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
   const formatDate = (d: string) => new Date(d).toLocaleDateString("fr-FR");
 
   return (
@@ -72,7 +75,9 @@ export default function AdvancesPage() {
       <header className="flex justify-between items-center">
         <div>
           <h1 className="text-2xl font-serif">Avances Fournisseurs</h1>
-          <p className="text-sm text-slate-600">Gestion des avances et applications</p>
+          <p className="text-sm text-slate-600">
+            Gestion des avances et applications
+          </p>
         </div>
         <Link
           href="/admin/compta/advances/new"
@@ -89,19 +94,25 @@ export default function AdvancesPage() {
             <div className="flex items-center gap-2 text-slate-500 text-sm mb-1">
               <Wallet size={16} /> Total Avances
             </div>
-            <p className="text-xl font-bold">{formatCurrency(stats.totalAdvances)}</p>
+            <p className="text-xl font-bold">
+              {formatCurrency(stats.totalAdvances)}
+            </p>
           </div>
           <div className="bg-white p-4 rounded-xl shadow">
             <div className="flex items-center gap-2 text-slate-500 text-sm mb-1">
               <CheckCircle size={16} /> Utilisé
             </div>
-            <p className="text-xl font-bold text-orange-600">{formatCurrency(stats.totalUsed)}</p>
+            <p className="text-xl font-bold text-orange-600">
+              {formatCurrency(stats.totalUsed)}
+            </p>
           </div>
           <div className="bg-white p-4 rounded-xl shadow">
             <div className="flex items-center gap-2 text-slate-500 text-sm mb-1">
               <Clock size={16} /> Disponible
             </div>
-            <p className="text-xl font-bold text-green-600">{formatCurrency(stats.totalRemaining)}</p>
+            <p className="text-xl font-bold text-green-600">
+              {formatCurrency(stats.totalRemaining)}
+            </p>
           </div>
         </div>
       )}
@@ -113,7 +124,9 @@ export default function AdvancesPage() {
             key={s}
             onClick={() => setFilter(s)}
             className={`px-3 py-1.5 rounded-lg text-sm ${
-              filter === s ? "bg-harp-brown text-white" : "bg-white text-slate-700 hover:bg-slate-100"
+              filter === s
+                ? "bg-harp-brown text-white"
+                : "bg-white text-slate-700 hover:bg-slate-100"
             }`}
           >
             {s === "" ? "Toutes" : statusConfig[s]?.label || s}
@@ -126,7 +139,9 @@ export default function AdvancesPage() {
         {loading ? (
           <div className="p-8 text-center text-slate-500">Chargement...</div>
         ) : advances.length === 0 ? (
-          <div className="p-8 text-center text-slate-500">Aucune avance trouvée</div>
+          <div className="p-8 text-center text-slate-500">
+            Aucune avance trouvée
+          </div>
         ) : (
           <table className="w-full">
             <thead className="bg-slate-50 text-left text-sm text-slate-600">
@@ -149,21 +164,33 @@ export default function AdvancesPage() {
                     <td className="px-4 py-3 font-medium">{a.advanceNumber}</td>
                     <td className="px-4 py-3">
                       <div>{a.supplier.name}</div>
-                      <div className="text-xs text-slate-500">{a.supplier.code}</div>
+                      <div className="text-xs text-slate-500">
+                        {a.supplier.code}
+                      </div>
+                    </td>
+                    <td className="px-4 py-3 text-right font-medium">
+                      {formatCurrency(a.amount)}
+                    </td>
+                    <td className="px-4 py-3 text-right text-orange-600">
+                      {formatCurrency(a.amountUsed)}
                     </td>
-                    <td className="px-4 py-3 text-right font-medium">{formatCurrency(a.amount)}</td>
-                    <td className="px-4 py-3 text-right text-orange-600">{formatCurrency(a.amountUsed)}</td>
                     <td className="px-4 py-3 text-right text-green-600 font-medium">
                       {formatCurrency(a.amountRemaining)}
                     </td>
                     <td className="px-4 py-3">
-                      <span className={`px-2 py-1 rounded-full text-xs ${status.color}`}>
+                      <span
+                        className={`px-2 py-1 rounded-full text-xs ${status.color}`}
+                      >
                         {status.label}
                       </span>
                     </td>
                     <td className="px-4 py-3 text-sm">
-                      <div>{paymentLabels[a.paymentMethod] || a.paymentMethod}</div>
-                      <div className="text-xs text-slate-500">{formatDate(a.paymentDate)}</div>
+                      <div>
+                        {paymentLabels[a.paymentMethod] || a.paymentMethod}
+                      </div>
+                      <div className="text-xs text-slate-500">
+                        {formatDate(a.paymentDate)}
+                      </div>
                     </td>
                     <td className="px-4 py-3">
                       {a.amountRemaining > 0 && (
diff --git a/src/app/admin/compta/charges/new/page.tsx b/src/app/admin/compta/charges/new/page.tsx
index 0a16ac6..95f7823 100644
--- a/src/app/admin/compta/charges/new/page.tsx
+++ b/src/app/admin/compta/charges/new/page.tsx
@@ -66,7 +66,8 @@ export default function NewChargePage() {
 
     try {
       const res = await fetch("/api/v3/compta/charges", {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify({
           ...form,
@@ -91,7 +92,10 @@ export default function NewChargePage() {
   return (
     <div className="max-w-2xl mx-auto space-y-6">
       <header className="flex items-center gap-4">
-        <Link href="/admin/compta/charges" className="p-2 hover:bg-slate-100 rounded-lg">
+        <Link
+          href="/admin/compta/charges"
+          className="p-2 hover:bg-slate-100 rounded-lg"
+        >
           <ArrowLeft size={20} />
         </Link>
         <div>
@@ -101,23 +105,32 @@ export default function NewChargePage() {
       </header>
 
       {error && (
-        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">{error}</div>
+        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">
+          {error}
+        </div>
       )}
 
-      <form onSubmit={handleSubmit} className="bg-white p-6 rounded-2xl shadow space-y-6">
+      <form
+        onSubmit={handleSubmit}
+        className="bg-white p-6 rounded-2xl shadow space-y-6"
+      >
         <div className="flex items-center gap-3 pb-4 border-b">
           <div className="p-3 bg-blue-100 rounded-xl">
             <Receipt className="text-blue-600" size={24} />
           </div>
           <div>
             <p className="font-medium">Charge / Dépense</p>
-            <p className="text-sm text-slate-500">Sera comptabilisée dans les coûts de revient</p>
+            <p className="text-sm text-slate-500">
+              Sera comptabilisée dans les coûts de revient
+            </p>
           </div>
         </div>
 
         <div className="grid grid-cols-2 gap-4">
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Catégorie *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Catégorie *
+            </label>
             <select
               value={form.category}
               onChange={(e) => setForm({ ...form, category: e.target.value })}
@@ -133,7 +146,9 @@ export default function NewChargePage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Scope *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Scope *
+            </label>
             <select
               value={form.scope}
               onChange={(e) => setForm({ ...form, scope: e.target.value })}
@@ -147,7 +162,9 @@ export default function NewChargePage() {
 
           {form.scope === "MODEL" && (
             <div className="col-span-2">
-              <label className="block text-sm font-medium text-slate-700 mb-1">Modèle *</label>
+              <label className="block text-sm font-medium text-slate-700 mb-1">
+                Modèle *
+              </label>
               <select
                 value={form.modelId}
                 onChange={(e) => setForm({ ...form, modelId: e.target.value })}
@@ -165,12 +182,16 @@ export default function NewChargePage() {
           )}
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Montant (DZD) *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Montant (DZD) *
+            </label>
             <input
               type="number"
               min="1"
               value={form.amount}
-              onChange={(e) => setForm({ ...form, amount: parseFloat(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({ ...form, amount: parseFloat(e.target.value) || 0 })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
               placeholder="10000"
               required
@@ -178,7 +199,9 @@ export default function NewChargePage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Date</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Date
+            </label>
             <input
               type="date"
               value={form.date}
@@ -188,11 +211,15 @@ export default function NewChargePage() {
           </div>
 
           <div className="col-span-2">
-            <label className="block text-sm font-medium text-slate-700 mb-1">Description *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Description *
+            </label>
             <input
               type="text"
               value={form.description}
-              onChange={(e) => setForm({ ...form, description: e.target.value })}
+              onChange={(e) =>
+                setForm({ ...form, description: e.target.value })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
               placeholder="Campagne Facebook Décembre, Shooting nouvelle collection..."
               required
@@ -201,7 +228,9 @@ export default function NewChargePage() {
 
           {(form.category === "ADS" || form.category === "INFLUENCER") && (
             <div className="col-span-2">
-              <label className="block text-sm font-medium text-slate-700 mb-1">Plateforme</label>
+              <label className="block text-sm font-medium text-slate-700 mb-1">
+                Plateforme
+              </label>
               <select
                 value={form.platform}
                 onChange={(e) => setForm({ ...form, platform: e.target.value })}
@@ -218,7 +247,9 @@ export default function NewChargePage() {
           )}
 
           <div className="col-span-2">
-            <label className="block text-sm font-medium text-slate-700 mb-1">Notes</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Notes
+            </label>
             <textarea
               value={form.notes}
               onChange={(e) => setForm({ ...form, notes: e.target.value })}
@@ -230,7 +261,10 @@ export default function NewChargePage() {
         </div>
 
         <div className="flex justify-end gap-4 pt-4 border-t">
-          <Link href="/admin/compta/charges" className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/charges"
+            className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg"
+          >
             Annuler
           </Link>
           <button
diff --git a/src/app/admin/compta/charges/page.tsx b/src/app/admin/compta/charges/page.tsx
index a78f791..712e7fb 100644
--- a/src/app/admin/compta/charges/page.tsx
+++ b/src/app/admin/compta/charges/page.tsx
@@ -2,7 +2,15 @@
 
 import { useState, useEffect } from "react";
 import Link from "next/link";
-import { Plus, TrendingUp, Camera, Megaphone, Truck, Users, MoreHorizontal } from "lucide-react";
+import {
+  Plus,
+  TrendingUp,
+  Camera,
+  Megaphone,
+  Truck,
+  Users,
+  MoreHorizontal,
+} from "lucide-react";
 
 interface Charge {
   id: string;
@@ -22,13 +30,40 @@ interface CategoryStat {
   _count: number;
 }
 
-const categoryConfig: Record<string, { label: string; color: string; icon: React.ElementType }> = {
-  ATELIER: { label: "Atelier", color: "bg-purple-100 text-purple-700", icon: Users },
-  SHOOTING: { label: "Shooting", color: "bg-pink-100 text-pink-700", icon: Camera },
-  ADS: { label: "Publicité", color: "bg-blue-100 text-blue-700", icon: Megaphone },
-  INFLUENCER: { label: "Influenceur", color: "bg-orange-100 text-orange-700", icon: TrendingUp },
-  TRANSPORT: { label: "Transport", color: "bg-green-100 text-green-700", icon: Truck },
-  OTHER: { label: "Autre", color: "bg-gray-100 text-gray-700", icon: MoreHorizontal },
+const categoryConfig: Record<
+  string,
+  { label: string; color: string; icon: React.ElementType }
+> = {
+  ATELIER: {
+    label: "Atelier",
+    color: "bg-purple-100 text-purple-700",
+    icon: Users,
+  },
+  SHOOTING: {
+    label: "Shooting",
+    color: "bg-pink-100 text-pink-700",
+    icon: Camera,
+  },
+  ADS: {
+    label: "Publicité",
+    color: "bg-blue-100 text-blue-700",
+    icon: Megaphone,
+  },
+  INFLUENCER: {
+    label: "Influenceur",
+    color: "bg-orange-100 text-orange-700",
+    icon: TrendingUp,
+  },
+  TRANSPORT: {
+    label: "Transport",
+    color: "bg-green-100 text-green-700",
+    icon: Truck,
+  },
+  OTHER: {
+    label: "Autre",
+    color: "bg-gray-100 text-gray-700",
+    icon: MoreHorizontal,
+  },
 };
 
 const scopeLabels: Record<string, string> = {
@@ -51,7 +86,9 @@ export default function ChargesPage() {
     try {
       const params = new URLSearchParams({ limit: "30" });
       if (categoryFilter) params.set("category", categoryFilter);
-      const res = await fetch(`/api/v3/compta/charges?${params}`, { credentials: "include" });
+      const res = await fetch(`/api/v3/compta/charges?${params}`, {
+        credentials: "include",
+      });
       const data = await res.json();
       if (data.success) {
         setCharges(data.items);
@@ -64,7 +101,8 @@ export default function ChargesPage() {
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
   const formatDate = (d: string) => new Date(d).toLocaleDateString("fr-FR");
 
   const totalCharges = stats.reduce((sum, s) => sum + (s._sum.amount || 0), 0);
@@ -74,7 +112,9 @@ export default function ChargesPage() {
       <header className="flex justify-between items-center">
         <div>
           <h1 className="text-2xl font-serif">Charges</h1>
-          <p className="text-sm text-slate-600">Gestion des charges et allocations</p>
+          <p className="text-sm text-slate-600">
+            Gestion des charges et allocations
+          </p>
         </div>
         <Link
           href="/admin/compta/charges/new"
@@ -92,14 +132,18 @@ export default function ChargesPage() {
           return (
             <button
               key={key}
-              onClick={() => setCategoryFilter(categoryFilter === key ? "" : key)}
+              onClick={() =>
+                setCategoryFilter(categoryFilter === key ? "" : key)
+              }
               className={`p-3 rounded-xl text-left transition-all ${
                 categoryFilter === key ? "ring-2 ring-harp-brown" : ""
               } ${cfg.color}`}
             >
               <Icon size={18} className="mb-1" />
               <p className="text-xs font-medium">{cfg.label}</p>
-              <p className="text-sm font-bold">{formatCurrency(stat?._sum.amount || 0)}</p>
+              <p className="text-sm font-bold">
+                {formatCurrency(stat?._sum.amount || 0)}
+              </p>
             </button>
           );
         })}
@@ -108,7 +152,9 @@ export default function ChargesPage() {
       {/* Total */}
       <div className="bg-white p-4 rounded-xl shadow flex justify-between items-center">
         <span className="text-slate-600">Total des charges</span>
-        <span className="text-2xl font-bold">{formatCurrency(totalCharges)}</span>
+        <span className="text-2xl font-bold">
+          {formatCurrency(totalCharges)}
+        </span>
       </div>
 
       {/* Table */}
@@ -116,7 +162,9 @@ export default function ChargesPage() {
         {loading ? (
           <div className="p-8 text-center text-slate-500">Chargement...</div>
         ) : charges.length === 0 ? (
-          <div className="p-8 text-center text-slate-500">Aucune charge trouvée</div>
+          <div className="p-8 text-center text-slate-500">
+            Aucune charge trouvée
+          </div>
         ) : (
           <table className="w-full">
             <thead className="bg-slate-50 text-left text-sm text-slate-600">
@@ -137,21 +185,29 @@ export default function ChargesPage() {
                   <tr key={c.id} className="hover:bg-slate-50">
                     <td className="px-4 py-3 font-medium">{c.chargeNumber}</td>
                     <td className="px-4 py-3">
-                      <span className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs ${cat.color}`}>
+                      <span
+                        className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs ${cat.color}`}
+                      >
                         <CatIcon size={12} /> {cat.label}
                       </span>
                     </td>
                     <td className="px-4 py-3">
                       <div className="max-w-xs truncate">{c.description}</div>
                       {c.model && (
-                        <div className="text-xs text-slate-500">{c.model.name}</div>
+                        <div className="text-xs text-slate-500">
+                          {c.model.name}
+                        </div>
                       )}
                     </td>
                     <td className="px-4 py-3 text-sm text-slate-600">
                       {scopeLabels[c.scope] || c.scope}
                     </td>
-                    <td className="px-4 py-3 text-right font-medium">{formatCurrency(c.amount)}</td>
-                    <td className="px-4 py-3 text-sm text-slate-600">{formatDate(c.date)}</td>
+                    <td className="px-4 py-3 text-right font-medium">
+                      {formatCurrency(c.amount)}
+                    </td>
+                    <td className="px-4 py-3 text-sm text-slate-600">
+                      {formatDate(c.date)}
+                    </td>
                   </tr>
                 );
               })}
diff --git a/src/app/admin/compta/layout.tsx b/src/app/admin/compta/layout.tsx
index 463c661..d740479 100644
--- a/src/app/admin/compta/layout.tsx
+++ b/src/app/admin/compta/layout.tsx
@@ -24,7 +24,11 @@ const modules = [
   { href: "/admin/compta/reports", label: "Rapports", icon: BarChart3 },
 ];
 
-export default function AdminComptaLayout({ children }: { children: React.ReactNode }) {
+export default function AdminComptaLayout({
+  children,
+}: {
+  children: React.ReactNode;
+}) {
   const pathname = usePathname();
 
   return (
@@ -43,10 +47,13 @@ export default function AdminComptaLayout({ children }: { children: React.ReactN
                     "relative flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap",
                     isActive
                       ? "bg-gray-900 text-white shadow-sm"
-                      : "text-gray-500 hover:text-gray-900 hover:bg-gray-50"
+                      : "text-gray-500 hover:text-gray-900 hover:bg-gray-50",
                   )}
                 >
-                  <m.icon size={16} className={isActive ? "text-white" : "text-gray-400"} />
+                  <m.icon
+                    size={16}
+                    className={isActive ? "text-white" : "text-gray-400"}
+                  />
                   <span>{m.label}</span>
                 </Link>
               );
@@ -56,7 +63,7 @@ export default function AdminComptaLayout({ children }: { children: React.ReactN
         {/* Fade indicators for scroll */}
         <div className="absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-white to-transparent pointer-events-none md:hidden" />
       </div>
-      
+
       {children}
     </div>
   );
diff --git a/src/app/admin/compta/models/[id]/bom/page.tsx b/src/app/admin/compta/models/[id]/bom/page.tsx
index 1e2c9a8..e89995b 100644
--- a/src/app/admin/compta/models/[id]/bom/page.tsx
+++ b/src/app/admin/compta/models/[id]/bom/page.tsx
@@ -29,7 +29,11 @@ interface BomData {
   totalCost: number;
 }
 
-export default function ModelBomPage({ params }: { params: Promise<{ id: string }> }) {
+export default function ModelBomPage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
   const { id } = use(params);
   const [data, setData] = useState<BomData | null>(null);
   const [inventoryItems, setInventoryItems] = useState<InventoryItem[]>([]);
@@ -44,8 +48,12 @@ export default function ModelBomPage({ params }: { params: Promise<{ id: string
 
   useEffect(() => {
     Promise.all([
-      fetch(`/api/v3/compta/models/${id}/bom`, { credentials: "include" }).then((r) => r.json()),
-      fetch("/api/v3/compta/inventory?limit=200", { credentials: "include" }).then((r) => r.json()),
+      fetch(`/api/v3/compta/models/${id}/bom`, { credentials: "include" }).then(
+        (r) => r.json(),
+      ),
+      fetch("/api/v3/compta/inventory?limit=200", {
+        credentials: "include",
+      }).then((r) => r.json()),
     ]).then(([bomData, invData]) => {
       if (bomData.success) setData(bomData);
       if (invData.success) setInventoryItems(invData.items);
@@ -60,7 +68,8 @@ export default function ModelBomPage({ params }: { params: Promise<{ id: string
     setAdding(true);
     try {
       const res = await fetch(`/api/v3/compta/models/${id}/bom`, {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify(newItem),
       });
@@ -68,7 +77,9 @@ export default function ModelBomPage({ params }: { params: Promise<{ id: string
       const result = await res.json();
       if (result.success) {
         // Refresh data
-        const bomRes = await fetch(`/api/v3/compta/models/${id}/bom`, { credentials: "include" });
+        const bomRes = await fetch(`/api/v3/compta/models/${id}/bom`, {
+          credentials: "include",
+        });
         const bomData = await bomRes.json();
         if (bomData.success) setData(bomData);
         setNewItem({ inventoryItemId: "", quantity: 1, wasteFactor: 1.05 });
@@ -83,14 +94,20 @@ export default function ModelBomPage({ params }: { params: Promise<{ id: string
   async function handleRemoveItem(bomItemId: string) {
     if (!confirm("Supprimer cet élément ?")) return;
 
-    const res = await fetch(`/api/v3/compta/models/${id}/bom?bomItemId=${bomItemId}`, {
-      method: "DELETE", credentials: "include",
-    });
+    const res = await fetch(
+      `/api/v3/compta/models/${id}/bom?bomItemId=${bomItemId}`,
+      {
+        method: "DELETE",
+        credentials: "include",
+      },
+    );
 
     const result = await res.json();
     if (result.success) {
       // Refresh
-      const bomRes = await fetch(`/api/v3/compta/models/${id}/bom`, { credentials: "include" });
+      const bomRes = await fetch(`/api/v3/compta/models/${id}/bom`, {
+        credentials: "include",
+      });
       const bomData = await bomRes.json();
       if (bomData.success) setData(bomData);
     } else {
@@ -98,21 +115,31 @@ export default function ModelBomPage({ params }: { params: Promise<{ id: string
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
 
-  if (loading) return <div className="text-center py-12 text-slate-500">Chargement...</div>;
-  if (!data) return <div className="text-center py-12 text-red-500">Modèle non trouvé</div>;
+  if (loading)
+    return (
+      <div className="text-center py-12 text-slate-500">Chargement...</div>
+    );
+  if (!data)
+    return (
+      <div className="text-center py-12 text-red-500">Modèle non trouvé</div>
+    );
 
   // Filter out items already in BOM
   const availableItems = inventoryItems.filter(
-    (item) => !data.bom.some((b) => b.inventoryItem.id === item.id)
+    (item) => !data.bom.some((b) => b.inventoryItem.id === item.id),
   );
 
   return (
     <div className="space-y-6">
       <header className="flex items-center justify-between">
         <div className="flex items-center gap-4">
-          <Link href="/admin/compta/models" className="p-2 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/models"
+            className="p-2 hover:bg-slate-100 rounded-lg"
+          >
             <ArrowLeft size={20} />
           </Link>
           <div>
@@ -129,44 +156,66 @@ export default function ModelBomPage({ params }: { params: Promise<{ id: string
       </header>
 
       {/* Add Item Form */}
-      <form onSubmit={handleAddItem} className="bg-white p-4 rounded-xl shadow flex gap-4 items-end">
+      <form
+        onSubmit={handleAddItem}
+        className="bg-white p-4 rounded-xl shadow flex gap-4 items-end"
+      >
         <div className="flex-1">
-          <label className="block text-sm font-medium text-slate-700 mb-1">Article</label>
+          <label className="block text-sm font-medium text-slate-700 mb-1">
+            Article
+          </label>
           <select
             value={newItem.inventoryItemId}
-            onChange={(e) => setNewItem({ ...newItem, inventoryItemId: e.target.value })}
+            onChange={(e) =>
+              setNewItem({ ...newItem, inventoryItemId: e.target.value })
+            }
             className="w-full px-3 py-2 border rounded-lg"
             required
           >
             <option value="">Sélectionner un article...</option>
             {availableItems.map((item) => (
               <option key={item.id} value={item.id}>
-                {item.sku} - {item.name} ({formatCurrency(item.averageCost)}/{item.unit.toLowerCase()})
+                {item.sku} - {item.name} ({formatCurrency(item.averageCost)}/
+                {item.unit.toLowerCase()})
               </option>
             ))}
           </select>
         </div>
         <div className="w-32">
-          <label className="block text-sm font-medium text-slate-700 mb-1">Quantité</label>
+          <label className="block text-sm font-medium text-slate-700 mb-1">
+            Quantité
+          </label>
           <input
             type="number"
             min="0.01"
             step="0.01"
             value={newItem.quantity}
-            onChange={(e) => setNewItem({ ...newItem, quantity: parseFloat(e.target.value) || 0 })}
+            onChange={(e) =>
+              setNewItem({
+                ...newItem,
+                quantity: parseFloat(e.target.value) || 0,
+              })
+            }
             className="w-full px-3 py-2 border rounded-lg"
             required
           />
         </div>
         <div className="w-28">
-          <label className="block text-sm font-medium text-slate-700 mb-1">Perte %</label>
+          <label className="block text-sm font-medium text-slate-700 mb-1">
+            Perte %
+          </label>
           <input
             type="number"
             min="1"
             max="2"
             step="0.01"
             value={newItem.wasteFactor}
-            onChange={(e) => setNewItem({ ...newItem, wasteFactor: parseFloat(e.target.value) || 1 })}
+            onChange={(e) =>
+              setNewItem({
+                ...newItem,
+                wasteFactor: parseFloat(e.target.value) || 1,
+              })
+            }
             className="w-full px-3 py-2 border rounded-lg"
           />
         </div>
@@ -205,20 +254,30 @@ export default function ModelBomPage({ params }: { params: Promise<{ id: string
                     <div className="flex items-center gap-2">
                       <Package size={16} className="text-slate-400" />
                       <div>
-                        <div className="font-medium">{item.inventoryItem.name}</div>
-                        <div className="text-xs text-slate-500">{item.inventoryItem.sku}</div>
+                        <div className="font-medium">
+                          {item.inventoryItem.name}
+                        </div>
+                        <div className="text-xs text-slate-500">
+                          {item.inventoryItem.sku}
+                        </div>
                       </div>
                     </div>
                   </td>
-                  <td className="px-4 py-3 text-sm text-slate-600">{item.inventoryItem.type}</td>
+                  <td className="px-4 py-3 text-sm text-slate-600">
+                    {item.inventoryItem.type}
+                  </td>
                   <td className="px-4 py-3 text-right">
                     {item.quantity} {item.inventoryItem.unit.toLowerCase()}
                   </td>
                   <td className="px-4 py-3 text-right text-sm">
                     {Math.round((item.wasteFactor - 1) * 100)}%
                   </td>
-                  <td className="px-4 py-3 text-right text-sm">{formatCurrency(item.unitCost)}</td>
-                  <td className="px-4 py-3 text-right font-medium">{formatCurrency(item.lineCost)}</td>
+                  <td className="px-4 py-3 text-right text-sm">
+                    {formatCurrency(item.unitCost)}
+                  </td>
+                  <td className="px-4 py-3 text-right font-medium">
+                    {formatCurrency(item.lineCost)}
+                  </td>
                   <td className="px-4 py-3">
                     <button
                       onClick={() => handleRemoveItem(item.id)}
diff --git a/src/app/admin/compta/models/[id]/costs/page.tsx b/src/app/admin/compta/models/[id]/costs/page.tsx
index 64935d4..6ce6712 100644
--- a/src/app/admin/compta/models/[id]/costs/page.tsx
+++ b/src/app/admin/compta/models/[id]/costs/page.tsx
@@ -2,7 +2,16 @@
 
 import { useState, useEffect, use } from "react";
 import Link from "next/link";
-import { ArrowLeft, Camera, Save, TrendingUp, Layers, Truck, Users, Megaphone } from "lucide-react";
+import {
+  ArrowLeft,
+  Camera,
+  Save,
+  TrendingUp,
+  Layers,
+  Truck,
+  Users,
+  Megaphone,
+} from "lucide-react";
 
 interface CostData {
   model: { id: string; sku: string; name: string };
@@ -33,7 +42,11 @@ interface CostData {
   currentMarginPercent: number | null;
 }
 
-export default function ModelCostsPage({ params }: { params: Promise<{ id: string }> }) {
+export default function ModelCostsPage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
   const { id } = use(params);
   const [data, setData] = useState<CostData | null>(null);
   const [loading, setLoading] = useState(true);
@@ -51,7 +64,10 @@ export default function ModelCostsPage({ params }: { params: Promise<{ id: strin
   async function handleSnapshot() {
     setSaving(true);
     try {
-      const res = await fetch(`/api/v3/compta/models/${id}/costs`, { method: "POST", credentials: "include" });
+      const res = await fetch(`/api/v3/compta/models/${id}/costs`, {
+        method: "POST",
+        credentials: "include",
+      });
       const result = await res.json();
       if (result.success) {
         alert("Snapshot créé avec succès !");
@@ -63,10 +79,17 @@ export default function ModelCostsPage({ params }: { params: Promise<{ id: strin
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
 
-  if (loading) return <div className="text-center py-12 text-slate-500">Chargement...</div>;
-  if (!data) return <div className="text-center py-12 text-red-500">Modèle non trouvé</div>;
+  if (loading)
+    return (
+      <div className="text-center py-12 text-slate-500">Chargement...</div>
+    );
+  if (!data)
+    return (
+      <div className="text-center py-12 text-red-500">Modèle non trouvé</div>
+    );
 
   const { breakdown } = data;
 
@@ -74,12 +97,17 @@ export default function ModelCostsPage({ params }: { params: Promise<{ id: strin
     <div className="space-y-6">
       <header className="flex items-center justify-between">
         <div className="flex items-center gap-4">
-          <Link href="/admin/compta/models" className="p-2 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/models"
+            className="p-2 hover:bg-slate-100 rounded-lg"
+          >
             <ArrowLeft size={20} />
           </Link>
           <div>
             <h1 className="text-2xl font-serif">Analyse des Coûts</h1>
-            <p className="text-sm text-slate-600">{data.model.name} ({data.model.sku})</p>
+            <p className="text-sm text-slate-600">
+              {data.model.name} ({data.model.sku})
+            </p>
           </div>
         </div>
         <button
@@ -107,7 +135,9 @@ export default function ModelCostsPage({ params }: { params: Promise<{ id: strin
             </div>
             <div className="mt-4 pt-4 border-t flex justify-between font-medium">
               <span>Total matières</span>
-              <span className="text-blue-600">{formatCurrency(breakdown.materialsCost)}</span>
+              <span className="text-blue-600">
+                {formatCurrency(breakdown.materialsCost)}
+              </span>
             </div>
           </div>
 
@@ -123,7 +153,9 @@ export default function ModelCostsPage({ params }: { params: Promise<{ id: strin
             </div>
             <div className="mt-4 pt-4 border-t flex justify-between font-medium">
               <span>Total production</span>
-              <span className="text-purple-600">{formatCurrency(breakdown.productionCost)}</span>
+              <span className="text-purple-600">
+                {formatCurrency(breakdown.productionCost)}
+              </span>
             </div>
           </div>
 
@@ -140,7 +172,9 @@ export default function ModelCostsPage({ params }: { params: Promise<{ id: strin
             </div>
             <div className="mt-4 pt-4 border-t flex justify-between font-medium">
               <span>Total marketing</span>
-              <span className="text-orange-600">{formatCurrency(breakdown.marketingCost)}</span>
+              <span className="text-orange-600">
+                {formatCurrency(breakdown.marketingCost)}
+              </span>
             </div>
           </div>
 
@@ -163,7 +197,9 @@ export default function ModelCostsPage({ params }: { params: Promise<{ id: strin
           {/* Total */}
           <div className="bg-gradient-to-br from-slate-800 to-slate-900 p-6 rounded-2xl text-white">
             <p className="text-slate-400 text-sm mb-1">Coût de revient total</p>
-            <p className="text-3xl font-bold">{formatCurrency(breakdown.totalCost)}</p>
+            <p className="text-3xl font-bold">
+              {formatCurrency(breakdown.totalCost)}
+            </p>
           </div>
 
           {/* Suggested Prices */}
@@ -172,15 +208,21 @@ export default function ModelCostsPage({ params }: { params: Promise<{ id: strin
             <div className="space-y-3">
               <div className="flex justify-between items-center p-3 bg-red-50 rounded-lg">
                 <span className="text-sm">Marge 30%</span>
-                <span className="font-bold">{formatCurrency(data.suggestedPrices.margin30)}</span>
+                <span className="font-bold">
+                  {formatCurrency(data.suggestedPrices.margin30)}
+                </span>
               </div>
               <div className="flex justify-between items-center p-3 bg-yellow-50 rounded-lg">
                 <span className="text-sm">Marge 40%</span>
-                <span className="font-bold">{formatCurrency(data.suggestedPrices.margin40)}</span>
+                <span className="font-bold">
+                  {formatCurrency(data.suggestedPrices.margin40)}
+                </span>
               </div>
               <div className="flex justify-between items-center p-3 bg-green-50 rounded-lg">
                 <span className="text-sm">Marge 50%</span>
-                <span className="font-bold">{formatCurrency(data.suggestedPrices.margin50)}</span>
+                <span className="font-bold">
+                  {formatCurrency(data.suggestedPrices.margin50)}
+                </span>
               </div>
             </div>
           </div>
@@ -192,16 +234,25 @@ export default function ModelCostsPage({ params }: { params: Promise<{ id: strin
               <div className="space-y-3 text-sm">
                 <div className="flex justify-between">
                   <span className="text-slate-600">Prix de vente</span>
-                  <span className="font-medium">{formatCurrency(data.currentPrice)}</span>
+                  <span className="font-medium">
+                    {formatCurrency(data.currentPrice)}
+                  </span>
                 </div>
                 <div className="flex justify-between">
                   <span className="text-slate-600">Coût de revient</span>
-                  <span className="font-medium">{formatCurrency(breakdown.totalCost)}</span>
+                  <span className="font-medium">
+                    {formatCurrency(breakdown.totalCost)}
+                  </span>
                 </div>
                 <div className="border-t pt-3 flex justify-between">
                   <span className="text-slate-600">Marge</span>
-                  <span className={`font-bold ${data.currentMarginPercent && data.currentMarginPercent >= 30 ? "text-green-600" : "text-red-600"}`}>
-                    {data.currentMargin ? formatCurrency(data.currentMargin) : "-"} ({data.currentMarginPercent}%)
+                  <span
+                    className={`font-bold ${data.currentMarginPercent && data.currentMarginPercent >= 30 ? "text-green-600" : "text-red-600"}`}
+                  >
+                    {data.currentMargin
+                      ? formatCurrency(data.currentMargin)
+                      : "-"}{" "}
+                    ({data.currentMarginPercent}%)
                   </span>
                 </div>
               </div>
@@ -224,7 +275,8 @@ export default function ModelCostsPage({ params }: { params: Promise<{ id: strin
 }
 
 function CostItem({ label, value }: { label: string; value: number }) {
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
   return (
     <div className="bg-slate-50 p-3 rounded-lg">
       <p className="text-xs text-slate-500 mb-1">{label}</p>
diff --git a/src/app/admin/compta/models/new/page.tsx b/src/app/admin/compta/models/new/page.tsx
index 8ca0e4c..b89f16f 100644
--- a/src/app/admin/compta/models/new/page.tsx
+++ b/src/app/admin/compta/models/new/page.tsx
@@ -32,7 +32,8 @@ export default function NewModelPage() {
 
     try {
       const res = await fetch("/api/v3/compta/models", {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify(form),
       });
@@ -53,37 +54,53 @@ export default function NewModelPage() {
   return (
     <div className="max-w-2xl mx-auto space-y-6">
       <header className="flex items-center gap-4">
-        <Link href="/admin/compta/models" className="p-2 hover:bg-slate-100 rounded-lg">
+        <Link
+          href="/admin/compta/models"
+          className="p-2 hover:bg-slate-100 rounded-lg"
+        >
           <ArrowLeft size={20} />
         </Link>
         <div>
           <h1 className="text-2xl font-serif">Nouveau Modèle</h1>
-          <p className="text-sm text-slate-600">Créer un modèle pour calcul de coûts</p>
+          <p className="text-sm text-slate-600">
+            Créer un modèle pour calcul de coûts
+          </p>
         </div>
       </header>
 
       {error && (
-        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">{error}</div>
+        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">
+          {error}
+        </div>
       )}
 
-      <form onSubmit={handleSubmit} className="bg-white p-6 rounded-2xl shadow space-y-6">
+      <form
+        onSubmit={handleSubmit}
+        className="bg-white p-6 rounded-2xl shadow space-y-6"
+      >
         <div className="flex items-center gap-3 pb-4 border-b">
           <div className="p-3 bg-amber-100 rounded-xl">
             <Layers className="text-amber-600" size={24} />
           </div>
           <div>
             <p className="font-medium">Modèle Produit</p>
-            <p className="text-sm text-slate-500">Après création, ajoutez la nomenclature (BOM)</p>
+            <p className="text-sm text-slate-500">
+              Après création, ajoutez la nomenclature (BOM)
+            </p>
           </div>
         </div>
 
         <div className="grid grid-cols-2 gap-4">
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">SKU *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              SKU *
+            </label>
             <input
               type="text"
               value={form.sku}
-              onChange={(e) => setForm({ ...form, sku: e.target.value.toUpperCase() })}
+              onChange={(e) =>
+                setForm({ ...form, sku: e.target.value.toUpperCase() })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20 font-mono"
               placeholder="JEBBA-001"
               required
@@ -91,7 +108,9 @@ export default function NewModelPage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Nom *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Nom *
+            </label>
             <input
               type="text"
               value={form.name}
@@ -103,55 +122,81 @@ export default function NewModelPage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Coût main d&apos;œuvre/unité</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Coût main d&apos;œuvre/unité
+            </label>
             <input
               type="number"
               min="0"
               value={form.laborCost}
-              onChange={(e) => setForm({ ...form, laborCost: parseFloat(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({ ...form, laborCost: parseFloat(e.target.value) || 0 })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
               placeholder="500"
             />
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Autres coûts/unité</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Autres coûts/unité
+            </label>
             <input
               type="number"
               min="0"
               value={form.otherCost}
-              onChange={(e) => setForm({ ...form, otherCost: parseFloat(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({ ...form, otherCost: parseFloat(e.target.value) || 0 })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
               placeholder="100"
             />
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Prix de vente</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Prix de vente
+            </label>
             <input
               type="number"
               min="0"
               value={form.sellingPrice}
-              onChange={(e) => setForm({ ...form, sellingPrice: parseFloat(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({
+                  ...form,
+                  sellingPrice: parseFloat(e.target.value) || 0,
+                })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
               placeholder="4500"
             />
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Unités estimées</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Unités estimées
+            </label>
             <input
               type="number"
               min="1"
               value={form.estimatedUnits}
-              onChange={(e) => setForm({ ...form, estimatedUnits: parseInt(e.target.value) || 100 })}
+              onChange={(e) =>
+                setForm({
+                  ...form,
+                  estimatedUnits: parseInt(e.target.value) || 100,
+                })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
             />
-            <p className="text-xs text-slate-500 mt-1">Pour répartir les charges fixes</p>
+            <p className="text-xs text-slate-500 mt-1">
+              Pour répartir les charges fixes
+            </p>
           </div>
 
           <div className="col-span-2">
-            <label className="block text-sm font-medium text-slate-700 mb-1">Description</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Description
+            </label>
             <textarea
               value={form.notes}
               onChange={(e) => setForm({ ...form, notes: e.target.value })}
@@ -163,7 +208,10 @@ export default function NewModelPage() {
         </div>
 
         <div className="flex justify-end gap-4 pt-4 border-t">
-          <Link href="/admin/compta/models" className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/models"
+            className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg"
+          >
             Annuler
           </Link>
           <button
diff --git a/src/app/admin/compta/models/page.tsx b/src/app/admin/compta/models/page.tsx
index eff9789..e734cdf 100644
--- a/src/app/admin/compta/models/page.tsx
+++ b/src/app/admin/compta/models/page.tsx
@@ -28,7 +28,9 @@ export default function ModelsPage() {
     try {
       const params = new URLSearchParams({ limit: "50" });
       if (search) params.set("search", search);
-      const res = await fetch(`/api/v3/compta/models?${params}`, { credentials: "include" });
+      const res = await fetch(`/api/v3/compta/models?${params}`, {
+        credentials: "include",
+      });
       const data = await res.json();
       if (data.success) setModels(data.items);
     } catch (err) {
@@ -38,14 +40,17 @@ export default function ModelsPage() {
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
 
   return (
     <div className="space-y-6">
       <header className="flex justify-between items-center">
         <div>
           <h1 className="text-2xl font-serif">Modèles & Nomenclature</h1>
-          <p className="text-sm text-slate-600">Gestion des modèles, BOM et coûts</p>
+          <p className="text-sm text-slate-600">
+            Gestion des modèles, BOM et coûts
+          </p>
         </div>
         <Link
           href="/admin/compta/models/new"
@@ -71,18 +76,27 @@ export default function ModelsPage() {
       {loading ? (
         <div className="text-center text-slate-500 py-8">Chargement...</div>
       ) : models.length === 0 ? (
-        <div className="text-center text-slate-500 py-8">Aucun modèle trouvé</div>
+        <div className="text-center text-slate-500 py-8">
+          Aucun modèle trouvé
+        </div>
       ) : (
         <div className="grid grid-cols-2 gap-4">
           {models.map((model) => (
-            <div key={model.id} className="bg-white rounded-xl shadow p-4 hover:shadow-md transition-shadow">
+            <div
+              key={model.id}
+              className="bg-white rounded-xl shadow p-4 hover:shadow-md transition-shadow"
+            >
               <div className="flex justify-between items-start mb-3">
                 <div>
                   <h3 className="font-medium">{model.name}</h3>
-                  <p className="text-sm text-slate-500 font-mono">{model.sku}</p>
+                  <p className="text-sm text-slate-500 font-mono">
+                    {model.sku}
+                  </p>
                 </div>
                 {model.collection && (
-                  <span className="text-xs bg-slate-100 px-2 py-1 rounded">{model.collection.nameFr}</span>
+                  <span className="text-xs bg-slate-100 px-2 py-1 rounded">
+                    {model.collection.nameFr}
+                  </span>
                 )}
               </div>
 
@@ -104,9 +118,13 @@ export default function ModelsPage() {
               <div className="flex justify-between items-center pt-3 border-t">
                 <div>
                   {model.sellingPrice ? (
-                    <span className="font-bold text-green-600">{formatCurrency(model.sellingPrice)}</span>
+                    <span className="font-bold text-green-600">
+                      {formatCurrency(model.sellingPrice)}
+                    </span>
                   ) : (
-                    <span className="text-slate-400 text-sm">Prix non défini</span>
+                    <span className="text-slate-400 text-sm">
+                      Prix non défini
+                    </span>
                   )}
                 </div>
                 <div className="flex gap-2">
diff --git a/src/app/admin/compta/page.tsx b/src/app/admin/compta/page.tsx
index fb29b47..3a28bda 100644
--- a/src/app/admin/compta/page.tsx
+++ b/src/app/admin/compta/page.tsx
@@ -42,8 +42,12 @@ export default function ComptaPage() {
       {/* Header avec titre + action */}
       <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
         <div>
-          <h1 className="text-3xl font-serif font-medium text-gray-900">Vue d'ensemble</h1>
-          <p className="text-sm text-gray-500 mt-1">Activité des 30 derniers jours</p>
+          <h1 className="text-3xl font-serif font-medium text-gray-900">
+            Vue d'ensemble
+          </h1>
+          <p className="text-sm text-gray-500 mt-1">
+            Activité des 30 derniers jours
+          </p>
         </div>
         <Link
           href="/admin/compta/purchases/new"
@@ -64,14 +68,23 @@ export default function ComptaPage() {
             <AlertTriangle size={20} />
           </div>
           <div className="flex-1">
-            <p className="text-sm font-semibold text-gray-900">Stock critique détecté</p>
+            <p className="text-sm font-semibold text-gray-900">
+              Stock critique détecté
+            </p>
             <p className="text-sm text-gray-500 mt-0.5">
-              <span className="font-medium text-amber-600">{data.stock.lowStockItems} article{data.stock.lowStockItems > 1 ? "s" : ""}</span> en rupture imminente
+              <span className="font-medium text-amber-600">
+                {data.stock.lowStockItems} article
+                {data.stock.lowStockItems > 1 ? "s" : ""}
+              </span>{" "}
+              en rupture imminente
             </p>
           </div>
           <div className="flex items-center gap-2 text-sm font-medium text-gray-900 bg-white px-4 py-2 rounded-xl border border-gray-100 shadow-sm group-hover:border-amber-200 transition-colors">
             Gérer le stock
-            <ArrowRight size={16} className="text-gray-400 group-hover:text-amber-600 group-hover:translate-x-1 transition-all" />
+            <ArrowRight
+              size={16}
+              className="text-gray-400 group-hover:text-amber-600 group-hover:translate-x-1 transition-all"
+            />
           </div>
         </Link>
       )}
@@ -90,7 +103,11 @@ export default function ComptaPage() {
           label="Achats (30j)"
           value={loading ? "—" : fmt(data?.purchases.total || 0)}
           unit="DZD"
-          sub={data?.purchases.pending ? `${data.purchases.pending} en attente` : "Tout réglé"}
+          sub={
+            data?.purchases.pending
+              ? `${data.purchases.pending} en attente`
+              : "Tout réglé"
+          }
           icon={ShoppingCart}
           color="blue"
           badge={data?.purchases.pending}
@@ -115,12 +132,34 @@ export default function ComptaPage() {
 
       {/* Accès rapides - Grille compacte */}
       <div className="pt-4">
-        <h2 className="text-lg font-serif font-medium text-gray-900 mb-6">Actions rapides</h2>
+        <h2 className="text-lg font-serif font-medium text-gray-900 mb-6">
+          Actions rapides
+        </h2>
         <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
-            <QuickAction href="/admin/compta/purchases/new" label="Nouvel achat" desc="Enregistrer une dépense" icon={ShoppingCart} />
-            <QuickAction href="/admin/compta/production/new" label="Nouveau lot" desc="Lancer une production" icon={Factory} />
-            <QuickAction href="/admin/compta/charges/new" label="Nouvelle charge" desc="Frais généraux" icon={Receipt} />
-            <QuickAction href="/admin/compta/stock" label="Voir le stock" desc="Inventaire complet" icon={Boxes} />
+          <QuickAction
+            href="/admin/compta/purchases/new"
+            label="Nouvel achat"
+            desc="Enregistrer une dépense"
+            icon={ShoppingCart}
+          />
+          <QuickAction
+            href="/admin/compta/production/new"
+            label="Nouveau lot"
+            desc="Lancer une production"
+            icon={Factory}
+          />
+          <QuickAction
+            href="/admin/compta/charges/new"
+            label="Nouvelle charge"
+            desc="Frais généraux"
+            icon={Receipt}
+          />
+          <QuickAction
+            href="/admin/compta/stock"
+            label="Voir le stock"
+            desc="Inventaire complet"
+            icon={Boxes}
+          />
         </div>
       </div>
     </div>
@@ -154,7 +193,12 @@ function KpiCard({
   return (
     <div className="bg-white p-6 rounded-2xl border border-gray-100/50 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300 group relative overflow-hidden">
       <div className="flex items-start justify-between mb-4 relative z-10">
-        <div className={cn("p-3 rounded-xl border transition-colors", colors[color])}>
+        <div
+          className={cn(
+            "p-3 rounded-xl border transition-colors",
+            colors[color],
+          )}
+        >
           <Icon size={22} strokeWidth={1.5} />
         </div>
         {badge && badge > 0 && (
@@ -165,24 +209,30 @@ function KpiCard({
         )}
       </div>
       <div className="space-y-1 relative z-10">
-        <p className="text-xs font-bold text-gray-400 uppercase tracking-widest">{label}</p>
+        <p className="text-xs font-bold text-gray-400 uppercase tracking-widest">
+          {label}
+        </p>
         <div className="flex items-baseline gap-1">
           <p className="text-2xl font-serif font-medium text-gray-900">
-            {value} 
+            {value}
           </p>
-          <span className="text-xs font-medium text-gray-400 uppercase">{unit}</span>
+          <span className="text-xs font-medium text-gray-400 uppercase">
+            {unit}
+          </span>
         </div>
         {sub && <p className="text-xs text-gray-500 font-medium mt-1">{sub}</p>}
       </div>
-      
+
       {/* Decorative background gradient */}
-      <div className={cn(
-        "absolute -right-6 -bottom-6 w-24 h-24 rounded-full opacity-0 group-hover:opacity-10 transition-opacity blur-2xl",
-        color === 'emerald' && "bg-emerald-500",
-        color === 'blue' && "bg-blue-500",
-        color === 'purple' && "bg-purple-500",
-        color === 'amber' && "bg-amber-500",
-      )} />
+      <div
+        className={cn(
+          "absolute -right-6 -bottom-6 w-24 h-24 rounded-full opacity-0 group-hover:opacity-10 transition-opacity blur-2xl",
+          color === "emerald" && "bg-emerald-500",
+          color === "blue" && "bg-blue-500",
+          color === "purple" && "bg-purple-500",
+          color === "amber" && "bg-amber-500",
+        )}
+      />
     </div>
   );
 }
@@ -207,7 +257,9 @@ function QuickAction({
         <Icon size={24} strokeWidth={1.5} />
       </div>
       <div>
-        <span className="block text-base font-medium text-gray-900 mb-1 group-hover:translate-x-1 transition-transform">{label}</span>
+        <span className="block text-base font-medium text-gray-900 mb-1 group-hover:translate-x-1 transition-transform">
+          {label}
+        </span>
         <span className="block text-xs text-gray-500">{desc}</span>
       </div>
     </Link>
diff --git a/src/app/admin/compta/production/[id]/consume/page.tsx b/src/app/admin/compta/production/[id]/consume/page.tsx
index 0ff3508..09e803e 100644
--- a/src/app/admin/compta/production/[id]/consume/page.tsx
+++ b/src/app/admin/compta/production/[id]/consume/page.tsx
@@ -3,7 +3,13 @@
 import { useState, useEffect, use } from "react";
 import { useRouter } from "next/navigation";
 import Link from "next/link";
-import { ArrowLeft, Package, AlertTriangle, CheckCircle, Play } from "lucide-react";
+import {
+  ArrowLeft,
+  Package,
+  AlertTriangle,
+  CheckCircle,
+  Play,
+} from "lucide-react";
 
 interface Requirement {
   inventoryItemId: string;
@@ -19,7 +25,12 @@ interface Requirement {
 }
 
 interface PreviewData {
-  batch: { id: string; batchNumber: string; plannedQty: number; status: string };
+  batch: {
+    id: string;
+    batchNumber: string;
+    plannedQty: number;
+    status: string;
+  };
   model: { id: string; sku: string; name: string };
   requirements: Requirement[];
   hasShortage: boolean;
@@ -27,7 +38,11 @@ interface PreviewData {
   canProceed: boolean;
 }
 
-export default function ConsumeProductionPage({ params }: { params: Promise<{ id: string }> }) {
+export default function ConsumeProductionPage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
   const { id } = use(params);
   const router = useRouter();
   const [data, setData] = useState<PreviewData | null>(null);
@@ -49,7 +64,8 @@ export default function ConsumeProductionPage({ params }: { params: Promise<{ id
     setSubmitting(true);
     try {
       const res = await fetch(`/api/v3/compta/production/${id}/consume`, {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify({}),
       });
@@ -65,31 +81,47 @@ export default function ConsumeProductionPage({ params }: { params: Promise<{ id
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
 
-  if (loading) return <div className="text-center py-12 text-slate-500">Chargement...</div>;
-  if (!data) return <div className="text-center py-12 text-red-500">Lot non trouvé</div>;
+  if (loading)
+    return (
+      <div className="text-center py-12 text-slate-500">Chargement...</div>
+    );
+  if (!data)
+    return <div className="text-center py-12 text-red-500">Lot non trouvé</div>;
 
   return (
     <div className="space-y-6">
       <header className="flex items-center gap-4">
-        <Link href={`/admin/compta/production/${id}`} className="p-2 hover:bg-slate-100 rounded-lg">
+        <Link
+          href={`/admin/compta/production/${id}`}
+          className="p-2 hover:bg-slate-100 rounded-lg"
+        >
           <ArrowLeft size={20} />
         </Link>
         <div>
-          <h1 className="text-2xl font-serif">Démarrer Production — {data.batch.batchNumber}</h1>
-          <p className="text-sm text-slate-600">{data.model.name} • {data.batch.plannedQty} unités</p>
+          <h1 className="text-2xl font-serif">
+            Démarrer Production — {data.batch.batchNumber}
+          </h1>
+          <p className="text-sm text-slate-600">
+            {data.model.name} • {data.batch.plannedQty} unités
+          </p>
         </div>
       </header>
 
       {/* Warning if shortage */}
       {data.hasShortage && (
         <div className="bg-red-50 border border-red-200 p-4 rounded-xl flex items-start gap-3">
-          <AlertTriangle className="text-red-600 flex-shrink-0 mt-0.5" size={20} />
+          <AlertTriangle
+            className="text-red-600 flex-shrink-0 mt-0.5"
+            size={20}
+          />
           <div>
             <p className="font-medium text-red-800">Stock insuffisant</p>
             <p className="text-sm text-red-700">
-              Certains articles n&apos;ont pas assez de stock disponible. Passez une commande ou réduisez la quantité.
+              Certains articles n&apos;ont pas assez de stock disponible. Passez
+              une commande ou réduisez la quantité.
             </p>
           </div>
         </div>
@@ -98,11 +130,15 @@ export default function ConsumeProductionPage({ params }: { params: Promise<{ id
       {/* Info Banner */}
       {!data.hasShortage && (
         <div className="bg-green-50 border border-green-200 p-4 rounded-xl flex items-start gap-3">
-          <CheckCircle className="text-green-600 flex-shrink-0 mt-0.5" size={20} />
+          <CheckCircle
+            className="text-green-600 flex-shrink-0 mt-0.5"
+            size={20}
+          />
           <div>
             <p className="font-medium text-green-800">Stock disponible</p>
             <p className="text-sm text-green-700">
-              Toutes les matières sont disponibles. Le stock sera automatiquement déduit au démarrage.
+              Toutes les matières sont disponibles. Le stock sera
+              automatiquement déduit au démarrage.
             </p>
           </div>
         </div>
@@ -127,7 +163,10 @@ export default function ConsumeProductionPage({ params }: { params: Promise<{ id
           </thead>
           <tbody className="divide-y">
             {data.requirements.map((req) => (
-              <tr key={req.inventoryItemId} className={req.shortage > 0 ? "bg-red-50" : ""}>
+              <tr
+                key={req.inventoryItemId}
+                className={req.shortage > 0 ? "bg-red-50" : ""}
+              >
                 <td className="px-4 py-3">
                   <div className="flex items-center gap-2">
                     <Package size={16} className="text-slate-400" />
@@ -143,13 +182,19 @@ export default function ConsumeProductionPage({ params }: { params: Promise<{ id
                 <td className="px-4 py-3 text-right">{req.available}</td>
                 <td className="px-4 py-3 text-right">
                   {req.shortage > 0 ? (
-                    <span className="text-red-600 font-medium">-{req.shortage}</span>
+                    <span className="text-red-600 font-medium">
+                      -{req.shortage}
+                    </span>
                   ) : (
                     <span className="text-green-600">✓</span>
                   )}
                 </td>
-                <td className="px-4 py-3 text-right text-sm">{formatCurrency(req.unitCost)}</td>
-                <td className="px-4 py-3 text-right font-medium">{formatCurrency(req.totalCost)}</td>
+                <td className="px-4 py-3 text-right text-sm">
+                  {formatCurrency(req.unitCost)}
+                </td>
+                <td className="px-4 py-3 text-right font-medium">
+                  {formatCurrency(req.totalCost)}
+                </td>
                 <td className="px-4 py-3 text-center">
                   {req.canConsume ? (
                     <span className="inline-flex items-center gap-1 text-green-600 text-sm">
@@ -181,7 +226,12 @@ export default function ConsumeProductionPage({ params }: { params: Promise<{ id
       {/* Actions */}
       <div className="flex justify-between items-center">
         <div className="text-sm text-slate-600">
-          Coût/unité estimé: <span className="font-bold">{formatCurrency(Math.round(data.totalMaterialsCost / data.batch.plannedQty))}</span>
+          Coût/unité estimé:{" "}
+          <span className="font-bold">
+            {formatCurrency(
+              Math.round(data.totalMaterialsCost / data.batch.plannedQty),
+            )}
+          </span>
         </div>
         <div className="flex gap-4">
           <Link
diff --git a/src/app/admin/compta/production/[id]/page.tsx b/src/app/admin/compta/production/[id]/page.tsx
index d2e8f4d..76f1518 100644
--- a/src/app/admin/compta/production/[id]/page.tsx
+++ b/src/app/admin/compta/production/[id]/page.tsx
@@ -2,7 +2,15 @@
 
 import { useState, useEffect, use } from "react";
 import Link from "next/link";
-import { ArrowLeft, Factory, Play, CheckCircle, Clock, Pause, Package } from "lucide-react";
+import {
+  ArrowLeft,
+  Factory,
+  Play,
+  CheckCircle,
+  Clock,
+  Pause,
+  Package,
+} from "lucide-react";
 
 interface Batch {
   id: string;
@@ -31,20 +39,46 @@ interface Batch {
   notes?: string;
 }
 
-const statusConfig: Record<string, { label: string; color: string; icon: React.ElementType }> = {
-  PLANNED: { label: "Planifié", color: "bg-gray-100 text-gray-700", icon: Clock },
-  IN_PROGRESS: { label: "En cours", color: "bg-blue-100 text-blue-700", icon: Play },
-  COMPLETED: { label: "Terminé", color: "bg-green-100 text-green-700", icon: CheckCircle },
+const statusConfig: Record<
+  string,
+  { label: string; color: string; icon: React.ElementType }
+> = {
+  PLANNED: {
+    label: "Planifié",
+    color: "bg-gray-100 text-gray-700",
+    icon: Clock,
+  },
+  IN_PROGRESS: {
+    label: "En cours",
+    color: "bg-blue-100 text-blue-700",
+    icon: Play,
+  },
+  COMPLETED: {
+    label: "Terminé",
+    color: "bg-green-100 text-green-700",
+    icon: CheckCircle,
+  },
   CANCELLED: { label: "Annulé", color: "bg-red-100 text-red-700", icon: Clock },
-  ON_HOLD: { label: "En pause", color: "bg-yellow-100 text-yellow-700", icon: Pause },
+  ON_HOLD: {
+    label: "En pause",
+    color: "bg-yellow-100 text-yellow-700",
+    icon: Pause,
+  },
 };
 
-export default function ProductionDetailPage({ params }: { params: Promise<{ id: string }> }) {
+export default function ProductionDetailPage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
   const { id } = use(params);
   const [batch, setBatch] = useState<Batch | null>(null);
   const [loading, setLoading] = useState(true);
   const [showCompleteModal, setShowCompleteModal] = useState(false);
-  const [completeForm, setCompleteForm] = useState({ producedQty: 0, wasteQty: 0 });
+  const [completeForm, setCompleteForm] = useState({
+    producedQty: 0,
+    wasteQty: 0,
+  });
   const [completing, setCompleting] = useState(false);
 
   useEffect(() => {
@@ -64,7 +98,8 @@ export default function ProductionDetailPage({ params }: { params: Promise<{ id:
 
   async function handleStatusChange(newStatus: string) {
     const res = await fetch(`/api/v3/compta/production/${id}`, {
-      method: "PUT", credentials: "include",
+      method: "PUT",
+      credentials: "include",
       headers: { "Content-Type": "application/json" },
       body: JSON.stringify({ status: newStatus }),
     });
@@ -94,11 +129,17 @@ export default function ProductionDetailPage({ params }: { params: Promise<{ id:
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
-  const formatDate = (d?: string) => (d ? new Date(d).toLocaleDateString("fr-FR") : "-");
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatDate = (d?: string) =>
+    d ? new Date(d).toLocaleDateString("fr-FR") : "-";
 
-  if (loading) return <div className="text-center py-12 text-slate-500">Chargement...</div>;
-  if (!batch) return <div className="text-center py-12 text-red-500">Lot non trouvé</div>;
+  if (loading)
+    return (
+      <div className="text-center py-12 text-slate-500">Chargement...</div>
+    );
+  if (!batch)
+    return <div className="text-center py-12 text-red-500">Lot non trouvé</div>;
 
   const status = statusConfig[batch.status] || statusConfig.PLANNED;
   const StatusIcon = status.icon;
@@ -107,13 +148,18 @@ export default function ProductionDetailPage({ params }: { params: Promise<{ id:
     <div className="space-y-6">
       <header className="flex items-center justify-between">
         <div className="flex items-center gap-4">
-          <Link href="/admin/compta/production" className="p-2 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/production"
+            className="p-2 hover:bg-slate-100 rounded-lg"
+          >
             <ArrowLeft size={20} />
           </Link>
           <div>
             <div className="flex items-center gap-3">
               <h1 className="text-2xl font-serif">{batch.batchNumber}</h1>
-              <span className={`inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm ${status.color}`}>
+              <span
+                className={`inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm ${status.color}`}
+              >
                 <StatusIcon size={14} /> {status.label}
               </span>
             </div>
@@ -166,7 +212,9 @@ export default function ProductionDetailPage({ params }: { params: Promise<{ id:
               </div>
               <div>
                 <p className="text-slate-500">Quantité produite</p>
-                <p className="font-medium text-lg text-green-600">{batch.producedQty} unités</p>
+                <p className="font-medium text-lg text-green-600">
+                  {batch.producedQty} unités
+                </p>
               </div>
               <div>
                 <p className="text-slate-500">Date prévue</p>
@@ -208,8 +256,12 @@ export default function ProductionDetailPage({ params }: { params: Promise<{ id:
                         </div>
                       </td>
                       <td className="px-4 py-3 text-right">{c.actualQty}</td>
-                      <td className="px-4 py-3 text-right">{formatCurrency(c.unitCost)}</td>
-                      <td className="px-4 py-3 text-right font-medium">{formatCurrency(c.totalCost)}</td>
+                      <td className="px-4 py-3 text-right">
+                        {formatCurrency(c.unitCost)}
+                      </td>
+                      <td className="px-4 py-3 text-right font-medium">
+                        {formatCurrency(c.totalCost)}
+                      </td>
                     </tr>
                   ))}
                 </tbody>
@@ -243,7 +295,9 @@ export default function ProductionDetailPage({ params }: { params: Promise<{ id:
                 <div className="border-t pt-3 flex justify-between">
                   <span className="text-slate-600">Coût/unité</span>
                   <span className="font-bold text-green-600">
-                    {formatCurrency(Math.round(batch.totalCost / batch.plannedQty))}
+                    {formatCurrency(
+                      Math.round(batch.totalCost / batch.plannedQty),
+                    )}
                   </span>
                 </div>
               )}
@@ -255,13 +309,19 @@ export default function ProductionDetailPage({ params }: { params: Promise<{ id:
             <h3 className="font-medium mb-4">Progression</h3>
             <div className="relative pt-1">
               <div className="flex mb-2 items-center justify-between text-sm">
-                <span>{batch.producedQty} / {batch.plannedQty}</span>
-                <span>{Math.round((batch.producedQty / batch.plannedQty) * 100)}%</span>
+                <span>
+                  {batch.producedQty} / {batch.plannedQty}
+                </span>
+                <span>
+                  {Math.round((batch.producedQty / batch.plannedQty) * 100)}%
+                </span>
               </div>
               <div className="overflow-hidden h-3 bg-slate-100 rounded-full">
                 <div
                   className="h-full bg-green-500 rounded-full transition-all"
-                  style={{ width: `${Math.min((batch.producedQty / batch.plannedQty) * 100, 100)}%` }}
+                  style={{
+                    width: `${Math.min((batch.producedQty / batch.plannedQty) * 100, 100)}%`,
+                  }}
                 />
               </div>
             </div>
@@ -285,7 +345,10 @@ export default function ProductionDetailPage({ params }: { params: Promise<{ id:
                   max={batch.plannedQty}
                   value={completeForm.producedQty}
                   onChange={(e) =>
-                    setCompleteForm({ ...completeForm, producedQty: parseInt(e.target.value) || 0 })
+                    setCompleteForm({
+                      ...completeForm,
+                      producedQty: parseInt(e.target.value) || 0,
+                    })
                   }
                   className="w-full px-3 py-2 border rounded-lg"
                 />
@@ -299,7 +362,10 @@ export default function ProductionDetailPage({ params }: { params: Promise<{ id:
                   min="0"
                   value={completeForm.wasteQty}
                   onChange={(e) =>
-                    setCompleteForm({ ...completeForm, wasteQty: parseInt(e.target.value) || 0 })
+                    setCompleteForm({
+                      ...completeForm,
+                      wasteQty: parseInt(e.target.value) || 0,
+                    })
                   }
                   className="w-full px-3 py-2 border rounded-lg"
                 />
@@ -310,8 +376,12 @@ export default function ProductionDetailPage({ params }: { params: Promise<{ id:
                   <span className="font-medium">{batch.plannedQty}</span>
                 </div>
                 <div className="flex justify-between">
-                  <span className="text-slate-600">Total (produit + déchets):</span>
-                  <span className="font-medium">{completeForm.producedQty + completeForm.wasteQty}</span>
+                  <span className="text-slate-600">
+                    Total (produit + déchets):
+                  </span>
+                  <span className="font-medium">
+                    {completeForm.producedQty + completeForm.wasteQty}
+                  </span>
                 </div>
               </div>
             </div>
diff --git a/src/app/admin/compta/production/new/page.tsx b/src/app/admin/compta/production/new/page.tsx
index 31555f5..b5cd092 100644
--- a/src/app/admin/compta/production/new/page.tsx
+++ b/src/app/admin/compta/production/new/page.tsx
@@ -56,11 +56,14 @@ export default function NewProductionPage() {
 
     try {
       const res = await fetch("/api/v3/compta/production", {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify({
           ...form,
-          plannedDate: form.plannedDate ? new Date(form.plannedDate).toISOString() : undefined,
+          plannedDate: form.plannedDate
+            ? new Date(form.plannedDate).toISOString()
+            : undefined,
         }),
       });
 
@@ -82,7 +85,10 @@ export default function NewProductionPage() {
   return (
     <div className="max-w-2xl mx-auto space-y-6">
       <header className="flex items-center gap-4">
-        <Link href="/admin/compta/production" className="p-2 hover:bg-slate-100 rounded-lg">
+        <Link
+          href="/admin/compta/production"
+          className="p-2 hover:bg-slate-100 rounded-lg"
+        >
           <ArrowLeft size={20} />
         </Link>
         <div>
@@ -92,23 +98,32 @@ export default function NewProductionPage() {
       </header>
 
       {error && (
-        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">{error}</div>
+        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">
+          {error}
+        </div>
       )}
 
-      <form onSubmit={handleSubmit} className="bg-white p-6 rounded-2xl shadow space-y-6">
+      <form
+        onSubmit={handleSubmit}
+        className="bg-white p-6 rounded-2xl shadow space-y-6"
+      >
         <div className="flex items-center gap-3 pb-4 border-b">
           <div className="p-3 bg-purple-100 rounded-xl">
             <Factory className="text-purple-600" size={24} />
           </div>
           <div>
             <p className="font-medium">Lot de Production</p>
-            <p className="text-sm text-slate-500">Les matières seront consommées au démarrage</p>
+            <p className="text-sm text-slate-500">
+              Les matières seront consommées au démarrage
+            </p>
           </div>
         </div>
 
         <div className="grid grid-cols-2 gap-4">
           <div className="col-span-2">
-            <label className="block text-sm font-medium text-slate-700 mb-1">Modèle *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Modèle *
+            </label>
             <select
               value={form.modelId}
               onChange={(e) => handleModelChange(e.target.value)}
@@ -125,53 +140,74 @@ export default function NewProductionPage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Quantité prévue *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Quantité prévue *
+            </label>
             <input
               type="number"
               min="1"
               value={form.plannedQty}
-              onChange={(e) => setForm({ ...form, plannedQty: parseInt(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({ ...form, plannedQty: parseInt(e.target.value) || 0 })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
               required
             />
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Date prévue</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Date prévue
+            </label>
             <input
               type="date"
               value={form.plannedDate}
-              onChange={(e) => setForm({ ...form, plannedDate: e.target.value })}
+              onChange={(e) =>
+                setForm({ ...form, plannedDate: e.target.value })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
             />
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Coût main d&apos;œuvre (total)</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Coût main d&apos;œuvre (total)
+            </label>
             <input
               type="number"
               min="0"
               value={form.laborCost}
-              onChange={(e) => setForm({ ...form, laborCost: parseFloat(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({ ...form, laborCost: parseFloat(e.target.value) || 0 })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
               placeholder="0"
             />
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Frais atelier (total)</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Frais atelier (total)
+            </label>
             <input
               type="number"
               min="0"
               value={form.overheadCost}
-              onChange={(e) => setForm({ ...form, overheadCost: parseFloat(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({
+                  ...form,
+                  overheadCost: parseFloat(e.target.value) || 0,
+                })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
               placeholder="0"
             />
           </div>
 
           <div className="col-span-2">
-            <label className="block text-sm font-medium text-slate-700 mb-1">Notes</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Notes
+            </label>
             <textarea
               value={form.notes}
               onChange={(e) => setForm({ ...form, notes: e.target.value })}
@@ -198,7 +234,10 @@ export default function NewProductionPage() {
               <div>
                 <p className="text-slate-500">Coût MO/unité</p>
                 <p className="font-medium">
-                  {form.plannedQty > 0 ? Math.round(form.laborCost / form.plannedQty) : 0} DZD
+                  {form.plannedQty > 0
+                    ? Math.round(form.laborCost / form.plannedQty)
+                    : 0}{" "}
+                  DZD
                 </p>
               </div>
             </div>
@@ -206,7 +245,10 @@ export default function NewProductionPage() {
         )}
 
         <div className="flex justify-end gap-4 pt-4 border-t">
-          <Link href="/admin/compta/production" className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/production"
+            className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg"
+          >
             Annuler
           </Link>
           <button
diff --git a/src/app/admin/compta/production/page.tsx b/src/app/admin/compta/production/page.tsx
index 441e816..cba7d02 100644
--- a/src/app/admin/compta/production/page.tsx
+++ b/src/app/admin/compta/production/page.tsx
@@ -16,12 +16,35 @@ interface Batch {
   createdAt: string;
 }
 
-const statusConfig: Record<string, { label: string; color: string; icon: React.ElementType }> = {
-  PLANNED: { label: "Planifié", color: "bg-gray-100 text-gray-700", icon: Clock },
-  IN_PROGRESS: { label: "En cours", color: "bg-blue-100 text-blue-700", icon: Play },
-  COMPLETED: { label: "Terminé", color: "bg-green-100 text-green-700", icon: CheckCircle },
-  CANCELLED: { label: "Annulé", color: "bg-red-100 text-red-700", icon: XCircle },
-  ON_HOLD: { label: "En pause", color: "bg-yellow-100 text-yellow-700", icon: Pause },
+const statusConfig: Record<
+  string,
+  { label: string; color: string; icon: React.ElementType }
+> = {
+  PLANNED: {
+    label: "Planifié",
+    color: "bg-gray-100 text-gray-700",
+    icon: Clock,
+  },
+  IN_PROGRESS: {
+    label: "En cours",
+    color: "bg-blue-100 text-blue-700",
+    icon: Play,
+  },
+  COMPLETED: {
+    label: "Terminé",
+    color: "bg-green-100 text-green-700",
+    icon: CheckCircle,
+  },
+  CANCELLED: {
+    label: "Annulé",
+    color: "bg-red-100 text-red-700",
+    icon: XCircle,
+  },
+  ON_HOLD: {
+    label: "En pause",
+    color: "bg-yellow-100 text-yellow-700",
+    icon: Pause,
+  },
 };
 
 export default function ProductionPage() {
@@ -37,7 +60,9 @@ export default function ProductionPage() {
     try {
       const params = new URLSearchParams({ limit: "20" });
       if (filter) params.set("status", filter);
-      const res = await fetch(`/api/v3/compta/production?${params}`, { credentials: "include" });
+      const res = await fetch(`/api/v3/compta/production?${params}`, {
+        credentials: "include",
+      });
       const data = await res.json();
       if (data.success) setBatches(data.items);
     } catch (err) {
@@ -47,7 +72,8 @@ export default function ProductionPage() {
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
   const formatDate = (d: string) => new Date(d).toLocaleDateString("fr-FR");
 
   return (
@@ -55,7 +81,9 @@ export default function ProductionPage() {
       <header className="flex justify-between items-center">
         <div>
           <h1 className="text-2xl font-serif">Production</h1>
-          <p className="text-sm text-slate-600">Gestion des lots de production</p>
+          <p className="text-sm text-slate-600">
+            Gestion des lots de production
+          </p>
         </div>
         <Link
           href="/admin/compta/production/new"
@@ -72,7 +100,9 @@ export default function ProductionPage() {
             key={s}
             onClick={() => setFilter(s)}
             className={`px-3 py-1.5 rounded-lg text-sm ${
-              filter === s ? "bg-harp-brown text-white" : "bg-white text-slate-700 hover:bg-slate-100"
+              filter === s
+                ? "bg-harp-brown text-white"
+                : "bg-white text-slate-700 hover:bg-slate-100"
             }`}
           >
             {s === "" ? "Tous" : statusConfig[s]?.label || s}
@@ -108,30 +138,41 @@ export default function ProductionPage() {
                     <td className="px-4 py-3 font-medium">{b.batchNumber}</td>
                     <td className="px-4 py-3">
                       <div>{b.model.name}</div>
-                      <div className="text-xs text-slate-500 font-mono">{b.model.sku}</div>
+                      <div className="text-xs text-slate-500 font-mono">
+                        {b.model.sku}
+                      </div>
                     </td>
                     <td className="px-4 py-3 text-center">
                       <span className="font-medium">{b.producedQty}</span>
                       <span className="text-slate-400"> / {b.plannedQty}</span>
                     </td>
                     <td className="px-4 py-3">
-                      <span className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs ${status.color}`}>
+                      <span
+                        className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs ${status.color}`}
+                      >
                         <StatusIcon size={12} /> {status.label}
                       </span>
                     </td>
                     <td className="px-4 py-3 text-right">
                       {b.totalCost > 0 ? (
                         <div>
-                          <div className="font-medium">{formatCurrency(b.totalCost)}</div>
+                          <div className="font-medium">
+                            {formatCurrency(b.totalCost)}
+                          </div>
                           <div className="text-xs text-slate-500">
-                            {formatCurrency(b.plannedQty > 0 ? b.totalCost / b.plannedQty : 0)}/u
+                            {formatCurrency(
+                              b.plannedQty > 0 ? b.totalCost / b.plannedQty : 0,
+                            )}
+                            /u
                           </div>
                         </div>
                       ) : (
                         <span className="text-slate-400">-</span>
                       )}
                     </td>
-                    <td className="px-4 py-3 text-sm text-slate-600">{formatDate(b.createdAt)}</td>
+                    <td className="px-4 py-3 text-sm text-slate-600">
+                      {formatDate(b.createdAt)}
+                    </td>
                     <td className="px-4 py-3">
                       <div className="flex gap-2">
                         <Link
diff --git a/src/app/admin/compta/purchases/[id]/page.tsx b/src/app/admin/compta/purchases/[id]/page.tsx
index 420fa9f..e61cf5b 100644
--- a/src/app/admin/compta/purchases/[id]/page.tsx
+++ b/src/app/admin/compta/purchases/[id]/page.tsx
@@ -2,7 +2,16 @@
 
 import { useState, useEffect, use } from "react";
 import Link from "next/link";
-import { ArrowLeft, Package, CheckCircle, Clock, AlertCircle, Truck, Edit, Trash2 } from "lucide-react";
+import {
+  ArrowLeft,
+  Package,
+  CheckCircle,
+  Clock,
+  AlertCircle,
+  Truck,
+  Edit,
+  Trash2,
+} from "lucide-react";
 import { useRouter } from "next/navigation";
 
 interface Purchase {
@@ -33,15 +42,42 @@ interface Purchase {
   notes?: string;
 }
 
-const statusConfig: Record<string, { label: string; color: string; icon: React.ElementType }> = {
-  DRAFT: { label: "Brouillon", color: "bg-gray-100 text-gray-700", icon: Clock },
-  ORDERED: { label: "Commandé", color: "bg-blue-100 text-blue-700", icon: Package },
-  PARTIAL: { label: "Partiel", color: "bg-yellow-100 text-yellow-700", icon: AlertCircle },
-  RECEIVED: { label: "Reçu", color: "bg-green-100 text-green-700", icon: CheckCircle },
-  CANCELLED: { label: "Annulé", color: "bg-red-100 text-red-700", icon: AlertCircle },
+const statusConfig: Record<
+  string,
+  { label: string; color: string; icon: React.ElementType }
+> = {
+  DRAFT: {
+    label: "Brouillon",
+    color: "bg-gray-100 text-gray-700",
+    icon: Clock,
+  },
+  ORDERED: {
+    label: "Commandé",
+    color: "bg-blue-100 text-blue-700",
+    icon: Package,
+  },
+  PARTIAL: {
+    label: "Partiel",
+    color: "bg-yellow-100 text-yellow-700",
+    icon: AlertCircle,
+  },
+  RECEIVED: {
+    label: "Reçu",
+    color: "bg-green-100 text-green-700",
+    icon: CheckCircle,
+  },
+  CANCELLED: {
+    label: "Annulé",
+    color: "bg-red-100 text-red-700",
+    icon: AlertCircle,
+  },
 };
 
-export default function PurchaseDetailPage({ params }: { params: Promise<{ id: string }> }) {
+export default function PurchaseDetailPage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
   const { id } = use(params);
   const router = useRouter();
   const [purchase, setPurchase] = useState<Purchase | null>(null);
@@ -58,7 +94,10 @@ export default function PurchaseDetailPage({ params }: { params: Promise<{ id: s
 
   async function handleDelete() {
     if (!confirm("Supprimer cet achat ?")) return;
-    const res = await fetch(`/api/v3/compta/purchases/${id}`, { method: "DELETE", credentials: "include" });
+    const res = await fetch(`/api/v3/compta/purchases/${id}`, {
+      method: "DELETE",
+      credentials: "include",
+    });
     const data = await res.json();
     if (data.success) router.push("/admin/compta/purchases");
     else alert(data.error);
@@ -66,7 +105,8 @@ export default function PurchaseDetailPage({ params }: { params: Promise<{ id: s
 
   async function handleStatusChange(newStatus: string) {
     const res = await fetch(`/api/v3/compta/purchases/${id}`, {
-      method: "PUT", credentials: "include",
+      method: "PUT",
+      credentials: "include",
       headers: { "Content-Type": "application/json" },
       body: JSON.stringify({ status: newStatus }),
     });
@@ -75,11 +115,19 @@ export default function PurchaseDetailPage({ params }: { params: Promise<{ id: s
     else alert(data.error);
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
-  const formatDate = (d?: string) => (d ? new Date(d).toLocaleDateString("fr-FR") : "-");
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatDate = (d?: string) =>
+    d ? new Date(d).toLocaleDateString("fr-FR") : "-";
 
-  if (loading) return <div className="text-center py-12 text-slate-500">Chargement...</div>;
-  if (!purchase) return <div className="text-center py-12 text-red-500">Achat non trouvé</div>;
+  if (loading)
+    return (
+      <div className="text-center py-12 text-slate-500">Chargement...</div>
+    );
+  if (!purchase)
+    return (
+      <div className="text-center py-12 text-red-500">Achat non trouvé</div>
+    );
 
   const status = statusConfig[purchase.status] || statusConfig.DRAFT;
   const StatusIcon = status.icon;
@@ -88,13 +136,18 @@ export default function PurchaseDetailPage({ params }: { params: Promise<{ id: s
     <div className="space-y-6">
       <header className="flex items-center justify-between">
         <div className="flex items-center gap-4">
-          <Link href="/admin/compta/purchases" className="p-2 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/purchases"
+            className="p-2 hover:bg-slate-100 rounded-lg"
+          >
             <ArrowLeft size={20} />
           </Link>
           <div>
             <div className="flex items-center gap-3">
               <h1 className="text-2xl font-serif">{purchase.purchaseNumber}</h1>
-              <span className={`inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm ${status.color}`}>
+              <span
+                className={`inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm ${status.color}`}
+              >
                 <StatusIcon size={14} /> {status.label}
               </span>
             </div>
@@ -111,7 +164,10 @@ export default function PurchaseDetailPage({ params }: { params: Promise<{ id: s
               >
                 Passer en commande
               </button>
-              <button onClick={handleDelete} className="p-2 text-red-600 hover:bg-red-50 rounded-lg">
+              <button
+                onClick={handleDelete}
+                className="p-2 text-red-600 hover:bg-red-50 rounded-lg"
+              >
                 <Trash2 size={18} />
               </button>
             </>
@@ -136,7 +192,9 @@ export default function PurchaseDetailPage({ params }: { params: Promise<{ id: s
               <div>
                 <p className="text-slate-500">Fournisseur</p>
                 <p className="font-medium">{purchase.supplier.name}</p>
-                <p className="text-xs text-slate-400">{purchase.supplier.code}</p>
+                <p className="text-xs text-slate-400">
+                  {purchase.supplier.code}
+                </p>
               </div>
               <div>
                 <p className="text-slate-500">N° Facture</p>
@@ -148,11 +206,15 @@ export default function PurchaseDetailPage({ params }: { params: Promise<{ id: s
               </div>
               <div>
                 <p className="text-slate-500">Livraison prévue</p>
-                <p className="font-medium">{formatDate(purchase.expectedDate)}</p>
+                <p className="font-medium">
+                  {formatDate(purchase.expectedDate)}
+                </p>
               </div>
               <div>
                 <p className="text-slate-500">Date réception</p>
-                <p className="font-medium">{formatDate(purchase.receivedDate)}</p>
+                <p className="font-medium">
+                  {formatDate(purchase.receivedDate)}
+                </p>
               </div>
               {purchase.notes && (
                 <div className="col-span-3">
@@ -166,7 +228,9 @@ export default function PurchaseDetailPage({ params }: { params: Promise<{ id: s
           {/* Items */}
           <div className="bg-white rounded-2xl shadow overflow-hidden">
             <div className="p-4 border-b">
-              <h3 className="font-medium">Articles ({purchase.items.length})</h3>
+              <h3 className="font-medium">
+                Articles ({purchase.items.length})
+              </h3>
             </div>
             <table className="w-full">
               <thead className="bg-slate-50 text-left text-sm text-slate-600">
@@ -182,19 +246,33 @@ export default function PurchaseDetailPage({ params }: { params: Promise<{ id: s
                 {purchase.items.map((item) => (
                   <tr key={item.id}>
                     <td className="px-4 py-3">
-                      <div className="font-medium">{item.inventoryItem.name}</div>
-                      <div className="text-xs text-slate-500">{item.inventoryItem.sku}</div>
+                      <div className="font-medium">
+                        {item.inventoryItem.name}
+                      </div>
+                      <div className="text-xs text-slate-500">
+                        {item.inventoryItem.sku}
+                      </div>
                     </td>
                     <td className="px-4 py-3 text-center">
                       {item.quantityOrdered} {item.unit.toLowerCase()}
                     </td>
                     <td className="px-4 py-3 text-center">
-                      <span className={item.quantityReceived >= item.quantityOrdered ? "text-green-600" : "text-orange-600"}>
+                      <span
+                        className={
+                          item.quantityReceived >= item.quantityOrdered
+                            ? "text-green-600"
+                            : "text-orange-600"
+                        }
+                      >
                         {item.quantityReceived}
                       </span>
                     </td>
-                    <td className="px-4 py-3 text-right">{formatCurrency(item.unitPrice)}</td>
-                    <td className="px-4 py-3 text-right font-medium">{formatCurrency(item.totalPrice)}</td>
+                    <td className="px-4 py-3 text-right">
+                      {formatCurrency(item.unitPrice)}
+                    </td>
+                    <td className="px-4 py-3 text-right font-medium">
+                      {formatCurrency(item.totalPrice)}
+                    </td>
                   </tr>
                 ))}
               </tbody>
@@ -231,7 +309,13 @@ export default function PurchaseDetailPage({ params }: { params: Promise<{ id: s
               )}
               <div className="border-t pt-3 flex justify-between font-bold text-lg">
                 <span>Reste à payer</span>
-                <span className={purchase.amountDue > 0 ? "text-orange-600" : "text-green-600"}>
+                <span
+                  className={
+                    purchase.amountDue > 0
+                      ? "text-orange-600"
+                      : "text-green-600"
+                  }
+                >
                   {formatCurrency(purchase.amountDue)}
                 </span>
               </div>
diff --git a/src/app/admin/compta/purchases/[id]/receive/page.tsx b/src/app/admin/compta/purchases/[id]/receive/page.tsx
index b92c17e..eed0036 100644
--- a/src/app/admin/compta/purchases/[id]/receive/page.tsx
+++ b/src/app/admin/compta/purchases/[id]/receive/page.tsx
@@ -3,7 +3,13 @@
 import { useState, useEffect, use } from "react";
 import { useRouter } from "next/navigation";
 import Link from "next/link";
-import { ArrowLeft, Package, AlertTriangle, CheckCircle, TrendingUp } from "lucide-react";
+import {
+  ArrowLeft,
+  Package,
+  AlertTriangle,
+  CheckCircle,
+  TrendingUp,
+} from "lucide-react";
 
 interface PreviewItem {
   purchaseItemId: string;
@@ -15,7 +21,11 @@ interface PreviewItem {
   remaining: number;
   unitPrice: number;
   current: { quantity: number; averageCost: number; totalValue: number };
-  afterFullReceive: { quantity: number; averageCost: number; totalValue: number } | null;
+  afterFullReceive: {
+    quantity: number;
+    averageCost: number;
+    totalValue: number;
+  } | null;
 }
 
 interface PreviewData {
@@ -29,7 +39,11 @@ interface PreviewData {
   preview: PreviewItem[];
 }
 
-export default function ReceivePurchasePage({ params }: { params: Promise<{ id: string }> }) {
+export default function ReceivePurchasePage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
   const { id } = use(params);
   const router = useRouter();
   const [data, setData] = useState<PreviewData | null>(null);
@@ -59,10 +73,14 @@ export default function ReceivePurchasePage({ params }: { params: Promise<{ id:
     try {
       const items = Object.entries(quantities)
         .filter(([, qty]) => qty > 0)
-        .map(([purchaseItemId, qty]) => ({ purchaseItemId, quantityReceived: qty }));
+        .map(([purchaseItemId, qty]) => ({
+          purchaseItemId,
+          quantityReceived: qty,
+        }));
 
       const res = await fetch(`/api/v3/compta/purchases/${id}/receive`, {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify({ items }),
       });
@@ -81,22 +99,36 @@ export default function ReceivePurchasePage({ params }: { params: Promise<{ id:
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
 
-  if (loading) return <div className="text-center py-12 text-slate-500">Chargement...</div>;
-  if (!data) return <div className="text-center py-12 text-red-500">Achat non trouvé</div>;
+  if (loading)
+    return (
+      <div className="text-center py-12 text-slate-500">Chargement...</div>
+    );
+  if (!data)
+    return (
+      <div className="text-center py-12 text-red-500">Achat non trouvé</div>
+    );
 
   const hasItemsToReceive = data.preview.some((item) => item.remaining > 0);
 
   return (
     <div className="space-y-6">
       <header className="flex items-center gap-4">
-        <Link href={`/admin/compta/purchases/${id}`} className="p-2 hover:bg-slate-100 rounded-lg">
+        <Link
+          href={`/admin/compta/purchases/${id}`}
+          className="p-2 hover:bg-slate-100 rounded-lg"
+        >
           <ArrowLeft size={20} />
         </Link>
         <div>
-          <h1 className="text-2xl font-serif">Réception — {data.purchase.purchaseNumber}</h1>
-          <p className="text-sm text-slate-600">{data.purchase.supplier.name}</p>
+          <h1 className="text-2xl font-serif">
+            Réception — {data.purchase.purchaseNumber}
+          </h1>
+          <p className="text-sm text-slate-600">
+            {data.purchase.supplier.name}
+          </p>
         </div>
       </header>
 
@@ -106,8 +138,8 @@ export default function ReceivePurchasePage({ params }: { params: Promise<{ id:
         <div>
           <p className="font-medium text-blue-800">Calcul CUMP automatique</p>
           <p className="text-sm text-blue-700">
-            Les coûts moyens pondérés (CUMP) seront recalculés automatiquement lors de la réception.
-            Vérifiez les quantités avant de valider.
+            Les coûts moyens pondérés (CUMP) seront recalculés automatiquement
+            lors de la réception. Vérifiez les quantités avant de valider.
           </p>
         </div>
       </div>
@@ -131,19 +163,26 @@ export default function ReceivePurchasePage({ params }: { params: Promise<{ id:
             {data.preview.map((item) => {
               const qty = quantities[item.purchaseItemId] || 0;
               const willReceive = qty > 0;
-              
+
               // Recalculate CUMP preview based on input quantity
               let newQty = item.current.quantity;
               let newCump = item.current.averageCost;
               if (willReceive) {
-                const currentValue = item.current.quantity * item.current.averageCost;
+                const currentValue =
+                  item.current.quantity * item.current.averageCost;
                 const incomingValue = qty * item.unitPrice;
                 newQty = item.current.quantity + qty;
-                newCump = newQty > 0 ? (currentValue + incomingValue) / newQty : item.unitPrice;
+                newCump =
+                  newQty > 0
+                    ? (currentValue + incomingValue) / newQty
+                    : item.unitPrice;
               }
 
               return (
-                <tr key={item.purchaseItemId} className={item.remaining === 0 ? "opacity-50" : ""}>
+                <tr
+                  key={item.purchaseItemId}
+                  className={item.remaining === 0 ? "opacity-50" : ""}
+                >
                   <td className="px-4 py-3">
                     <div className="flex items-center gap-2">
                       <Package size={16} className="text-slate-400" />
@@ -153,8 +192,12 @@ export default function ReceivePurchasePage({ params }: { params: Promise<{ id:
                       </div>
                     </div>
                   </td>
-                  <td className="px-4 py-3 text-center">{item.quantityOrdered}</td>
-                  <td className="px-4 py-3 text-center text-slate-500">{item.quantityReceived}</td>
+                  <td className="px-4 py-3 text-center">
+                    {item.quantityOrdered}
+                  </td>
+                  <td className="px-4 py-3 text-center text-slate-500">
+                    {item.quantityReceived}
+                  </td>
                   <td className="px-4 py-3 text-center">
                     {item.remaining > 0 ? (
                       <input
@@ -162,7 +205,13 @@ export default function ReceivePurchasePage({ params }: { params: Promise<{ id:
                         min="0"
                         max={item.remaining}
                         value={qty}
-                        onChange={(e) => setQuantities({ ...quantities, [item.purchaseItemId]: parseFloat(e.target.value) || 0 })}
+                        onChange={(e) =>
+                          setQuantities({
+                            ...quantities,
+                            [item.purchaseItemId]:
+                              parseFloat(e.target.value) || 0,
+                          })
+                        }
                         className="w-20 px-2 py-1 border rounded text-center"
                       />
                     ) : (
@@ -171,14 +220,20 @@ export default function ReceivePurchasePage({ params }: { params: Promise<{ id:
                       </span>
                     )}
                   </td>
-                  <td className="px-4 py-3 text-right">{formatCurrency(item.unitPrice)}</td>
+                  <td className="px-4 py-3 text-right">
+                    {formatCurrency(item.unitPrice)}
+                  </td>
                   <td className="px-4 py-3 text-center">
                     <div>{item.current.quantity}</div>
-                    <div className="text-xs text-slate-500">@ {formatCurrency(item.current.averageCost)}</div>
+                    <div className="text-xs text-slate-500">
+                      @ {formatCurrency(item.current.averageCost)}
+                    </div>
                   </td>
                   <td className="px-4 py-3 text-center">
                     {willReceive ? (
-                      <div className="text-green-600 font-medium">{Math.round(newQty * 100) / 100}</div>
+                      <div className="text-green-600 font-medium">
+                        {Math.round(newQty * 100) / 100}
+                      </div>
                     ) : (
                       <span className="text-slate-400">-</span>
                     )}
@@ -186,11 +241,18 @@ export default function ReceivePurchasePage({ params }: { params: Promise<{ id:
                   <td className="px-4 py-3 text-right">
                     {willReceive ? (
                       <div>
-                        <div className="font-medium text-green-600">{formatCurrency(Math.round(newCump * 100) / 100)}</div>
+                        <div className="font-medium text-green-600">
+                          {formatCurrency(Math.round(newCump * 100) / 100)}
+                        </div>
                         {newCump !== item.current.averageCost && (
                           <div className="text-xs text-slate-500">
-                            {newCump > item.current.averageCost ? "↑" : "↓"} 
-                            {Math.abs(Math.round((newCump - item.current.averageCost) * 100) / 100)} DZD
+                            {newCump > item.current.averageCost ? "↑" : "↓"}
+                            {Math.abs(
+                              Math.round(
+                                (newCump - item.current.averageCost) * 100,
+                              ) / 100,
+                            )}{" "}
+                            DZD
                           </div>
                         )}
                       </div>
@@ -215,7 +277,11 @@ export default function ReceivePurchasePage({ params }: { params: Promise<{ id:
         </Link>
         <button
           onClick={handleSubmit}
-          disabled={submitting || !hasItemsToReceive || Object.values(quantities).every((q) => q === 0)}
+          disabled={
+            submitting ||
+            !hasItemsToReceive ||
+            Object.values(quantities).every((q) => q === 0)
+          }
           className="px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 disabled:opacity-50"
         >
           {submitting ? "Enregistrement..." : "Valider la réception"}
diff --git a/src/app/admin/compta/purchases/new/page.tsx b/src/app/admin/compta/purchases/new/page.tsx
index 768f625..d3217c6 100644
--- a/src/app/admin/compta/purchases/new/page.tsx
+++ b/src/app/admin/compta/purchases/new/page.tsx
@@ -48,8 +48,12 @@ export default function NewPurchasePage() {
 
   useEffect(() => {
     Promise.all([
-      fetch("/api/v3/compta/suppliers?limit=100", { credentials: "include" }).then((r) => r.json()),
-      fetch("/api/v3/compta/inventory?limit=200", { credentials: "include" }).then((r) => r.json()),
+      fetch("/api/v3/compta/suppliers?limit=100", {
+        credentials: "include",
+      }).then((r) => r.json()),
+      fetch("/api/v3/compta/inventory?limit=200", {
+        credentials: "include",
+      }).then((r) => r.json()),
     ]).then(([suppData, invData]) => {
       if (suppData.success) setSuppliers(suppData.items);
       if (invData.success) setInventoryItems(invData.items);
@@ -57,14 +61,21 @@ export default function NewPurchasePage() {
   }, []);
 
   function addItem() {
-    setItems([...items, { inventoryItemId: "", quantityOrdered: 1, unitPrice: 0, unit: "PIECE" }]);
+    setItems([
+      ...items,
+      { inventoryItemId: "", quantityOrdered: 1, unitPrice: 0, unit: "PIECE" },
+    ]);
   }
 
   function removeItem(index: number) {
     setItems(items.filter((_, i) => i !== index));
   }
 
-  function updateItem(index: number, field: keyof PurchaseItem, value: string | number | InventoryItem | undefined) {
+  function updateItem(
+    index: number,
+    field: keyof PurchaseItem,
+    value: string | number | InventoryItem | undefined,
+  ) {
     const updated = [...items];
     // eslint-disable-next-line @typescript-eslint/no-explicit-any
     (updated[index] as any)[field] = value;
@@ -81,7 +92,10 @@ export default function NewPurchasePage() {
     setItems(updated);
   }
 
-  const subtotal = items.reduce((sum, i) => sum + i.quantityOrdered * i.unitPrice, 0);
+  const subtotal = items.reduce(
+    (sum, i) => sum + i.quantityOrdered * i.unitPrice,
+    0,
+  );
   const total = subtotal + form.taxAmount + form.shippingCost;
 
   async function handleSubmit(e: React.FormEvent) {
@@ -100,11 +114,14 @@ export default function NewPurchasePage() {
 
     try {
       const res = await fetch("/api/v3/compta/purchases", {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify({
           ...form,
-          expectedDate: form.expectedDate ? new Date(form.expectedDate).toISOString() : undefined,
+          expectedDate: form.expectedDate
+            ? new Date(form.expectedDate).toISOString()
+            : undefined,
           items: items.map((i) => ({
             inventoryItemId: i.inventoryItemId,
             quantityOrdered: i.quantityOrdered,
@@ -127,22 +144,30 @@ export default function NewPurchasePage() {
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
 
   return (
     <div className="space-y-6">
       <header className="flex items-center gap-4">
-        <Link href="/admin/compta/purchases" className="p-2 hover:bg-slate-100 rounded-lg">
+        <Link
+          href="/admin/compta/purchases"
+          className="p-2 hover:bg-slate-100 rounded-lg"
+        >
           <ArrowLeft size={20} />
         </Link>
         <div>
           <h1 className="text-2xl font-serif">Nouvel Achat</h1>
-          <p className="text-sm text-slate-600">Créer une nouvelle commande fournisseur</p>
+          <p className="text-sm text-slate-600">
+            Créer une nouvelle commande fournisseur
+          </p>
         </div>
       </header>
 
       {error && (
-        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">{error}</div>
+        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">
+          {error}
+        </div>
       )}
 
       <form onSubmit={handleSubmit} className="grid grid-cols-3 gap-6">
@@ -153,10 +178,14 @@ export default function NewPurchasePage() {
             <h3 className="font-medium mb-4">Informations générales</h3>
             <div className="grid grid-cols-2 gap-4">
               <div>
-                <label className="block text-sm font-medium text-slate-700 mb-1">Fournisseur *</label>
+                <label className="block text-sm font-medium text-slate-700 mb-1">
+                  Fournisseur *
+                </label>
                 <select
                   value={form.supplierId}
-                  onChange={(e) => setForm({ ...form, supplierId: e.target.value })}
+                  onChange={(e) =>
+                    setForm({ ...form, supplierId: e.target.value })
+                  }
                   className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
                   required
                 >
@@ -169,26 +198,36 @@ export default function NewPurchasePage() {
                 </select>
               </div>
               <div>
-                <label className="block text-sm font-medium text-slate-700 mb-1">N° Facture</label>
+                <label className="block text-sm font-medium text-slate-700 mb-1">
+                  N° Facture
+                </label>
                 <input
                   type="text"
                   value={form.invoiceNumber}
-                  onChange={(e) => setForm({ ...form, invoiceNumber: e.target.value })}
+                  onChange={(e) =>
+                    setForm({ ...form, invoiceNumber: e.target.value })
+                  }
                   className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
                   placeholder="FAC-2024-XXX"
                 />
               </div>
               <div>
-                <label className="block text-sm font-medium text-slate-700 mb-1">Date livraison prévue</label>
+                <label className="block text-sm font-medium text-slate-700 mb-1">
+                  Date livraison prévue
+                </label>
                 <input
                   type="date"
                   value={form.expectedDate}
-                  onChange={(e) => setForm({ ...form, expectedDate: e.target.value })}
+                  onChange={(e) =>
+                    setForm({ ...form, expectedDate: e.target.value })
+                  }
                   className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
                 />
               </div>
               <div>
-                <label className="block text-sm font-medium text-slate-700 mb-1">Notes</label>
+                <label className="block text-sm font-medium text-slate-700 mb-1">
+                  Notes
+                </label>
                 <input
                   type="text"
                   value={form.notes}
@@ -214,7 +253,9 @@ export default function NewPurchasePage() {
             </div>
 
             {items.length === 0 ? (
-              <p className="text-slate-500 text-center py-8">Aucun article. Cliquez sur &quot;Ajouter article&quot;</p>
+              <p className="text-slate-500 text-center py-8">
+                Aucun article. Cliquez sur &quot;Ajouter article&quot;
+              </p>
             ) : (
               <table className="w-full">
                 <thead className="text-left text-sm text-slate-600 border-b">
@@ -232,7 +273,9 @@ export default function NewPurchasePage() {
                       <td className="py-2">
                         <select
                           value={item.inventoryItemId}
-                          onChange={(e) => updateItem(index, "inventoryItemId", e.target.value)}
+                          onChange={(e) =>
+                            updateItem(index, "inventoryItemId", e.target.value)
+                          }
                           className="w-full px-2 py-1.5 border rounded text-sm"
                           required
                         >
@@ -250,7 +293,13 @@ export default function NewPurchasePage() {
                           min="0.01"
                           step="0.01"
                           value={item.quantityOrdered}
-                          onChange={(e) => updateItem(index, "quantityOrdered", parseFloat(e.target.value) || 0)}
+                          onChange={(e) =>
+                            updateItem(
+                              index,
+                              "quantityOrdered",
+                              parseFloat(e.target.value) || 0,
+                            )
+                          }
                           className="w-full px-2 py-1.5 border rounded text-sm"
                           required
                         />
@@ -261,7 +310,13 @@ export default function NewPurchasePage() {
                           min="0"
                           step="0.01"
                           value={item.unitPrice}
-                          onChange={(e) => updateItem(index, "unitPrice", parseFloat(e.target.value) || 0)}
+                          onChange={(e) =>
+                            updateItem(
+                              index,
+                              "unitPrice",
+                              parseFloat(e.target.value) || 0,
+                            )
+                          }
                           className="w-full px-2 py-1.5 border rounded text-sm"
                           required
                         />
@@ -303,7 +358,12 @@ export default function NewPurchasePage() {
                   type="number"
                   min="0"
                   value={form.taxAmount}
-                  onChange={(e) => setForm({ ...form, taxAmount: parseFloat(e.target.value) || 0 })}
+                  onChange={(e) =>
+                    setForm({
+                      ...form,
+                      taxAmount: parseFloat(e.target.value) || 0,
+                    })
+                  }
                   className="w-24 px-2 py-1 border rounded text-right text-sm"
                 />
               </div>
@@ -314,7 +374,12 @@ export default function NewPurchasePage() {
                   type="number"
                   min="0"
                   value={form.shippingCost}
-                  onChange={(e) => setForm({ ...form, shippingCost: parseFloat(e.target.value) || 0 })}
+                  onChange={(e) =>
+                    setForm({
+                      ...form,
+                      shippingCost: parseFloat(e.target.value) || 0,
+                    })
+                  }
                   className="w-24 px-2 py-1 border rounded text-right text-sm"
                 />
               </div>
diff --git a/src/app/admin/compta/purchases/page.tsx b/src/app/admin/compta/purchases/page.tsx
index ffd977c..c41b1c0 100644
--- a/src/app/admin/compta/purchases/page.tsx
+++ b/src/app/admin/compta/purchases/page.tsx
@@ -2,7 +2,14 @@
 
 import { useState, useEffect } from "react";
 import Link from "next/link";
-import { Plus, Eye, Package, Clock, CheckCircle, AlertCircle } from "lucide-react";
+import {
+  Plus,
+  Eye,
+  Package,
+  Clock,
+  CheckCircle,
+  AlertCircle,
+} from "lucide-react";
 
 interface Purchase {
   id: string;
@@ -15,12 +22,35 @@ interface Purchase {
   items: Array<{ id: string }>;
 }
 
-const statusConfig: Record<string, { label: string; color: string; icon: React.ElementType }> = {
-  DRAFT: { label: "Brouillon", color: "bg-gray-100 text-gray-700", icon: Clock },
-  ORDERED: { label: "Commandé", color: "bg-blue-100 text-blue-700", icon: Package },
-  PARTIAL: { label: "Partiel", color: "bg-yellow-100 text-yellow-700", icon: AlertCircle },
-  RECEIVED: { label: "Reçu", color: "bg-green-100 text-green-700", icon: CheckCircle },
-  CANCELLED: { label: "Annulé", color: "bg-red-100 text-red-700", icon: AlertCircle },
+const statusConfig: Record<
+  string,
+  { label: string; color: string; icon: React.ElementType }
+> = {
+  DRAFT: {
+    label: "Brouillon",
+    color: "bg-gray-100 text-gray-700",
+    icon: Clock,
+  },
+  ORDERED: {
+    label: "Commandé",
+    color: "bg-blue-100 text-blue-700",
+    icon: Package,
+  },
+  PARTIAL: {
+    label: "Partiel",
+    color: "bg-yellow-100 text-yellow-700",
+    icon: AlertCircle,
+  },
+  RECEIVED: {
+    label: "Reçu",
+    color: "bg-green-100 text-green-700",
+    icon: CheckCircle,
+  },
+  CANCELLED: {
+    label: "Annulé",
+    color: "bg-red-100 text-red-700",
+    icon: AlertCircle,
+  },
 };
 
 export default function PurchasesPage() {
@@ -36,7 +66,9 @@ export default function PurchasesPage() {
     try {
       const params = new URLSearchParams({ limit: "20" });
       if (filter) params.set("status", filter);
-      const res = await fetch(`/api/v3/compta/purchases?${params}`, { credentials: "include" });
+      const res = await fetch(`/api/v3/compta/purchases?${params}`, {
+        credentials: "include",
+      });
       const data = await res.json();
       if (data.success) setPurchases(data.items);
     } catch (err) {
@@ -46,7 +78,8 @@ export default function PurchasesPage() {
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ", { style: "decimal" }).format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ", { style: "decimal" }).format(n) + " DZD";
   const formatDate = (d: string) => new Date(d).toLocaleDateString("fr-FR");
 
   return (
@@ -54,7 +87,9 @@ export default function PurchasesPage() {
       <header className="flex justify-between items-center">
         <div>
           <h1 className="text-2xl font-serif">Achats Fournisseurs</h1>
-          <p className="text-sm text-slate-600">Gestion des commandes et réceptions</p>
+          <p className="text-sm text-slate-600">
+            Gestion des commandes et réceptions
+          </p>
         </div>
         <Link
           href="/admin/compta/purchases/new"
@@ -71,7 +106,9 @@ export default function PurchasesPage() {
             key={s}
             onClick={() => setFilter(s)}
             className={`px-3 py-1.5 rounded-lg text-sm ${
-              filter === s ? "bg-harp-brown text-white" : "bg-white text-slate-700 hover:bg-slate-100"
+              filter === s
+                ? "bg-harp-brown text-white"
+                : "bg-white text-slate-700 hover:bg-slate-100"
             }`}
           >
             {s === "" ? "Tous" : statusConfig[s]?.label || s}
@@ -84,7 +121,9 @@ export default function PurchasesPage() {
         {loading ? (
           <div className="p-8 text-center text-slate-500">Chargement...</div>
         ) : purchases.length === 0 ? (
-          <div className="p-8 text-center text-slate-500">Aucun achat trouvé</div>
+          <div className="p-8 text-center text-slate-500">
+            Aucun achat trouvé
+          </div>
         ) : (
           <table className="w-full">
             <thead className="bg-slate-50 text-left text-sm text-slate-600">
@@ -103,23 +142,33 @@ export default function PurchasesPage() {
                 const StatusIcon = status.icon;
                 return (
                   <tr key={p.id} className="hover:bg-slate-50">
-                    <td className="px-4 py-3 font-medium">{p.purchaseNumber}</td>
+                    <td className="px-4 py-3 font-medium">
+                      {p.purchaseNumber}
+                    </td>
                     <td className="px-4 py-3">
                       <div>{p.supplier.name}</div>
-                      <div className="text-xs text-slate-500">{p.supplier.code}</div>
+                      <div className="text-xs text-slate-500">
+                        {p.supplier.code}
+                      </div>
                     </td>
                     <td className="px-4 py-3">
                       <div>{formatCurrency(p.totalAmount)}</div>
                       {p.amountDue > 0 && (
-                        <div className="text-xs text-orange-600">Dû: {formatCurrency(p.amountDue)}</div>
+                        <div className="text-xs text-orange-600">
+                          Dû: {formatCurrency(p.amountDue)}
+                        </div>
                       )}
                     </td>
                     <td className="px-4 py-3">
-                      <span className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs ${status.color}`}>
+                      <span
+                        className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs ${status.color}`}
+                      >
                         <StatusIcon size={12} /> {status.label}
                       </span>
                     </td>
-                    <td className="px-4 py-3 text-sm text-slate-600">{formatDate(p.createdAt)}</td>
+                    <td className="px-4 py-3 text-sm text-slate-600">
+                      {formatDate(p.createdAt)}
+                    </td>
                     <td className="px-4 py-3">
                       <div className="flex gap-2">
                         <Link
diff --git a/src/app/admin/compta/reports/page.tsx b/src/app/admin/compta/reports/page.tsx
index bb90fa0..5734d5c 100644
--- a/src/app/admin/compta/reports/page.tsx
+++ b/src/app/admin/compta/reports/page.tsx
@@ -1,7 +1,14 @@
 "use client";
 
 import { useState, useEffect } from "react";
-import { Package, ShoppingCart, Factory, Wallet, TrendingUp, AlertTriangle } from "lucide-react";
+import {
+  Package,
+  ShoppingCart,
+  Factory,
+  Wallet,
+  TrendingUp,
+  AlertTriangle,
+} from "lucide-react";
 
 interface ReportData {
   period: { days: number; startDate: string };
@@ -62,7 +69,9 @@ export default function ReportsPage() {
   async function fetchReport() {
     try {
       setLoading(true);
-      const res = await fetch(`/api/v3/compta/reports?period=${period}`, { credentials: "include" });
+      const res = await fetch(`/api/v3/compta/reports?period=${period}`, {
+        credentials: "include",
+      });
       const result = await res.json();
       if (result.success) setData(result);
     } catch (err) {
@@ -72,14 +81,21 @@ export default function ReportsPage() {
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
 
   if (loading) {
-    return <div className="p-8 text-center text-slate-500">Chargement des rapports...</div>;
+    return (
+      <div className="p-8 text-center text-slate-500">
+        Chargement des rapports...
+      </div>
+    );
   }
 
   if (!data) {
-    return <div className="p-8 text-center text-red-500">Erreur de chargement</div>;
+    return (
+      <div className="p-8 text-center text-red-500">Erreur de chargement</div>
+    );
   }
 
   return (
@@ -87,7 +103,9 @@ export default function ReportsPage() {
       <header className="flex justify-between items-center">
         <div>
           <h1 className="text-2xl font-serif">Rapports & Analytics</h1>
-          <p className="text-sm text-slate-600">Vue d&apos;ensemble de l&apos;activité comptable</p>
+          <p className="text-sm text-slate-600">
+            Vue d&apos;ensemble de l&apos;activité comptable
+          </p>
         </div>
         <select
           value={period}
@@ -107,8 +125,12 @@ export default function ReportsPage() {
           <div className="flex items-center gap-2 text-slate-500 mb-2">
             <Package size={18} /> Stock
           </div>
-          <p className="text-2xl font-bold text-green-600">{formatCurrency(data.stock.totalValue)}</p>
-          <p className="text-sm text-slate-500">{data.stock.totalItems} articles</p>
+          <p className="text-2xl font-bold text-green-600">
+            {formatCurrency(data.stock.totalValue)}
+          </p>
+          <p className="text-sm text-slate-500">
+            {data.stock.totalItems} articles
+          </p>
           {data.stock.lowStockItems > 0 && (
             <p className="text-xs text-orange-600 flex items-center gap-1 mt-1">
               <AlertTriangle size={12} /> {data.stock.lowStockItems} en alerte
@@ -120,10 +142,16 @@ export default function ReportsPage() {
           <div className="flex items-center gap-2 text-slate-500 mb-2">
             <ShoppingCart size={18} /> Achats
           </div>
-          <p className="text-2xl font-bold">{formatCurrency(data.purchases.total)}</p>
-          <p className="text-sm text-slate-500">{data.purchases.count} commandes</p>
+          <p className="text-2xl font-bold">
+            {formatCurrency(data.purchases.total)}
+          </p>
+          <p className="text-sm text-slate-500">
+            {data.purchases.count} commandes
+          </p>
           {data.purchases.pending > 0 && (
-            <p className="text-xs text-blue-600 mt-1">{data.purchases.pending} en attente</p>
+            <p className="text-xs text-blue-600 mt-1">
+              {data.purchases.pending} en attente
+            </p>
           )}
         </div>
 
@@ -131,16 +159,24 @@ export default function ReportsPage() {
           <div className="flex items-center gap-2 text-slate-500 mb-2">
             <Factory size={18} /> Production
           </div>
-          <p className="text-2xl font-bold">{formatCurrency(data.production.totalCost)}</p>
-          <p className="text-sm text-slate-500">{data.production.totalUnits} unités</p>
+          <p className="text-2xl font-bold">
+            {formatCurrency(data.production.totalCost)}
+          </p>
+          <p className="text-sm text-slate-500">
+            {data.production.totalUnits} unités
+          </p>
         </div>
 
         <div className="bg-white p-4 rounded-xl shadow">
           <div className="flex items-center gap-2 text-slate-500 mb-2">
             <Wallet size={18} /> Avances
           </div>
-          <p className="text-2xl font-bold text-green-600">{formatCurrency(data.advances.remaining)}</p>
-          <p className="text-sm text-slate-500">sur {formatCurrency(data.advances.total)}</p>
+          <p className="text-2xl font-bold text-green-600">
+            {formatCurrency(data.advances.remaining)}
+          </p>
+          <p className="text-sm text-slate-500">
+            sur {formatCurrency(data.advances.total)}
+          </p>
         </div>
       </div>
 
@@ -151,15 +187,22 @@ export default function ReportsPage() {
         </h3>
         <div className="grid grid-cols-6 gap-3">
           {data.charges.byCategory.map((cat) => (
-            <div key={cat.category} className="text-center p-3 bg-slate-50 rounded-lg">
+            <div
+              key={cat.category}
+              className="text-center p-3 bg-slate-50 rounded-lg"
+            >
               <p className="text-xs text-slate-500 mb-1">{cat.category}</p>
-              <p className="font-bold">{formatCurrency(cat._sum.amount || 0)}</p>
+              <p className="font-bold">
+                {formatCurrency(cat._sum.amount || 0)}
+              </p>
             </div>
           ))}
         </div>
         <div className="mt-4 pt-4 border-t flex justify-between">
           <span className="text-slate-600">Total Charges</span>
-          <span className="font-bold text-lg">{formatCurrency(data.charges.total)}</span>
+          <span className="font-bold text-lg">
+            {formatCurrency(data.charges.total)}
+          </span>
         </div>
       </div>
 
@@ -169,7 +212,10 @@ export default function ReportsPage() {
           <h3 className="font-medium mb-4">Achats Récents</h3>
           <div className="space-y-3">
             {data.recent.purchases.map((p) => (
-              <div key={p.id} className="flex justify-between items-center p-2 bg-slate-50 rounded">
+              <div
+                key={p.id}
+                className="flex justify-between items-center p-2 bg-slate-50 rounded"
+              >
                 <div>
                   <p className="font-medium text-sm">{p.purchaseNumber}</p>
                   <p className="text-xs text-slate-500">{p.supplier.name}</p>
@@ -190,7 +236,10 @@ export default function ReportsPage() {
           <h3 className="font-medium mb-4">Production Récente</h3>
           <div className="space-y-3">
             {data.recent.batches.map((b) => (
-              <div key={b.id} className="flex justify-between items-center p-2 bg-slate-50 rounded">
+              <div
+                key={b.id}
+                className="flex justify-between items-center p-2 bg-slate-50 rounded"
+              >
                 <div>
                   <p className="font-medium text-sm">{b.batchNumber}</p>
                   <p className="text-xs text-slate-500">{b.model.name}</p>
diff --git a/src/app/admin/compta/stock/[id]/page.tsx b/src/app/admin/compta/stock/[id]/page.tsx
index 8ecfc78..eaa2e50 100644
--- a/src/app/admin/compta/stock/[id]/page.tsx
+++ b/src/app/admin/compta/stock/[id]/page.tsx
@@ -2,7 +2,14 @@
 
 import { useState, useEffect, use } from "react";
 import Link from "next/link";
-import { ArrowLeft, Package, TrendingUp, TrendingDown, Edit, AlertTriangle } from "lucide-react";
+import {
+  ArrowLeft,
+  Package,
+  TrendingUp,
+  TrendingDown,
+  Edit,
+  AlertTriangle,
+} from "lucide-react";
 
 interface InventoryItem {
   id: string;
@@ -52,7 +59,11 @@ const txTypeLabels: Record<string, { label: string; color: string }> = {
   TRANSFER: { label: "Transfert", color: "text-gray-600" },
 };
 
-export default function InventoryItemDetailPage({ params }: { params: Promise<{ id: string }> }) {
+export default function InventoryItemDetailPage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
   const { id } = use(params);
   const [item, setItem] = useState<InventoryItem | null>(null);
   const [loading, setLoading] = useState(true);
@@ -66,11 +77,18 @@ export default function InventoryItemDetailPage({ params }: { params: Promise<{
       .finally(() => setLoading(false));
   }, [id]);
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
   const formatDate = (d: string) => new Date(d).toLocaleString("fr-FR");
 
-  if (loading) return <div className="text-center py-12 text-slate-500">Chargement...</div>;
-  if (!item) return <div className="text-center py-12 text-red-500">Article non trouvé</div>;
+  if (loading)
+    return (
+      <div className="text-center py-12 text-slate-500">Chargement...</div>
+    );
+  if (!item)
+    return (
+      <div className="text-center py-12 text-red-500">Article non trouvé</div>
+    );
 
   const available = Number(item.quantity) - Number(item.reserved);
 
@@ -78,7 +96,10 @@ export default function InventoryItemDetailPage({ params }: { params: Promise<{
     <div className="space-y-6">
       <header className="flex items-center justify-between">
         <div className="flex items-center gap-4">
-          <Link href="/admin/compta/stock" className="p-2 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/stock"
+            className="p-2 hover:bg-slate-100 rounded-lg"
+          >
             <ArrowLeft size={20} />
           </Link>
           <div>
@@ -109,7 +130,9 @@ export default function InventoryItemDetailPage({ params }: { params: Promise<{
             <div className="grid grid-cols-3 gap-4 text-sm">
               <div>
                 <p className="text-slate-500">Type</p>
-                <p className="font-medium">{typeLabels[item.type] || item.type}</p>
+                <p className="font-medium">
+                  {typeLabels[item.type] || item.type}
+                </p>
               </div>
               <div>
                 <p className="text-slate-500">Unité</p>
@@ -132,7 +155,9 @@ export default function InventoryItemDetailPage({ params }: { params: Promise<{
           {item.bom.length > 0 && (
             <div className="bg-white rounded-2xl shadow overflow-hidden">
               <div className="p-4 border-b">
-                <h3 className="font-medium">Utilisé dans ({item.bom.length} modèles)</h3>
+                <h3 className="font-medium">
+                  Utilisé dans ({item.bom.length} modèles)
+                </h3>
               </div>
               <table className="w-full">
                 <thead className="bg-slate-50 text-left text-sm text-slate-600">
@@ -145,10 +170,15 @@ export default function InventoryItemDetailPage({ params }: { params: Promise<{
                   {item.bom.map((b) => (
                     <tr key={b.id}>
                       <td className="px-4 py-2">
-                        <Link href={`/admin/compta/models/${b.model.id}/bom`} className="hover:text-harp-brown">
+                        <Link
+                          href={`/admin/compta/models/${b.model.id}/bom`}
+                          className="hover:text-harp-brown"
+                        >
                           {b.model.name}
                         </Link>
-                        <span className="text-xs text-slate-500 ml-2">{b.model.sku}</span>
+                        <span className="text-xs text-slate-500 ml-2">
+                          {b.model.sku}
+                        </span>
                       </td>
                       <td className="px-4 py-2 text-right">{b.quantity}</td>
                     </tr>
@@ -178,21 +208,38 @@ export default function InventoryItemDetailPage({ params }: { params: Promise<{
                 </thead>
                 <tbody className="divide-y text-sm">
                   {item.transactions.slice(0, 20).map((tx) => {
-                    const txType = txTypeLabels[tx.type] || { label: tx.type, color: "text-gray-600" };
-                    const isPositive = ["PURCHASE", "PRODUCTION_IN", "RETURN"].includes(tx.type) || tx.quantity > 0;
+                    const txType = txTypeLabels[tx.type] || {
+                      label: tx.type,
+                      color: "text-gray-600",
+                    };
+                    const isPositive =
+                      ["PURCHASE", "PRODUCTION_IN", "RETURN"].includes(
+                        tx.type,
+                      ) || tx.quantity > 0;
                     return (
                       <tr key={tx.id}>
-                        <td className="px-4 py-2 text-slate-500">{formatDate(tx.createdAt)}</td>
+                        <td className="px-4 py-2 text-slate-500">
+                          {formatDate(tx.createdAt)}
+                        </td>
                         <td className="px-4 py-2">
                           <span className={txType.color}>{txType.label}</span>
                         </td>
                         <td className="px-4 py-2 text-right">
-                          <span className={`flex items-center justify-end gap-1 ${isPositive ? "text-green-600" : "text-red-600"}`}>
-                            {isPositive ? <TrendingUp size={14} /> : <TrendingDown size={14} />}
-                            {isPositive ? "+" : ""}{tx.quantity}
+                          <span
+                            className={`flex items-center justify-end gap-1 ${isPositive ? "text-green-600" : "text-red-600"}`}
+                          >
+                            {isPositive ? (
+                              <TrendingUp size={14} />
+                            ) : (
+                              <TrendingDown size={14} />
+                            )}
+                            {isPositive ? "+" : ""}
+                            {tx.quantity}
                           </span>
                         </td>
-                        <td className="px-4 py-2 text-right">{formatCurrency(tx.unitCost)}</td>
+                        <td className="px-4 py-2 text-right">
+                          {formatCurrency(tx.unitCost)}
+                        </td>
                         <td className="px-4 py-2 text-slate-500 truncate max-w-[200px]">
                           {tx.reason || tx.reference || "-"}
                         </td>
@@ -215,16 +262,22 @@ export default function InventoryItemDetailPage({ params }: { params: Promise<{
             <div className="space-y-4">
               <div>
                 <p className="text-sm text-slate-500">Quantité totale</p>
-                <p className="text-2xl font-bold">{item.quantity} {item.unit.toLowerCase()}</p>
+                <p className="text-2xl font-bold">
+                  {item.quantity} {item.unit.toLowerCase()}
+                </p>
               </div>
               <div className="grid grid-cols-2 gap-4">
                 <div>
                   <p className="text-sm text-slate-500">Disponible</p>
-                  <p className="text-lg font-medium text-green-600">{available}</p>
+                  <p className="text-lg font-medium text-green-600">
+                    {available}
+                  </p>
                 </div>
                 <div>
                   <p className="text-sm text-slate-500">Réservé</p>
-                  <p className="text-lg font-medium text-orange-600">{item.reserved}</p>
+                  <p className="text-lg font-medium text-orange-600">
+                    {item.reserved}
+                  </p>
                 </div>
               </div>
             </div>
@@ -235,11 +288,15 @@ export default function InventoryItemDetailPage({ params }: { params: Promise<{
             <div className="space-y-3 text-sm">
               <div className="flex justify-between">
                 <span className="text-slate-600">CUMP</span>
-                <span className="font-medium">{formatCurrency(item.averageCost)}</span>
+                <span className="font-medium">
+                  {formatCurrency(item.averageCost)}
+                </span>
               </div>
               <div className="border-t pt-3 flex justify-between">
                 <span className="text-slate-600">Valeur totale</span>
-                <span className="font-bold text-lg text-green-600">{formatCurrency(item.totalValue)}</span>
+                <span className="font-bold text-lg text-green-600">
+                  {formatCurrency(item.totalValue)}
+                </span>
               </div>
             </div>
           </div>
diff --git a/src/app/admin/compta/stock/new/page.tsx b/src/app/admin/compta/stock/new/page.tsx
index b8c722e..e756fd9 100644
--- a/src/app/admin/compta/stock/new/page.tsx
+++ b/src/app/admin/compta/stock/new/page.tsx
@@ -52,7 +52,8 @@ export default function NewInventoryItemPage() {
 
     try {
       const res = await fetch("/api/v3/compta/inventory", {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify(form),
       });
@@ -70,42 +71,59 @@ export default function NewInventoryItemPage() {
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
 
   return (
     <div className="max-w-2xl mx-auto space-y-6">
       <header className="flex items-center gap-4">
-        <Link href="/admin/compta/stock" className="p-2 hover:bg-slate-100 rounded-lg">
+        <Link
+          href="/admin/compta/stock"
+          className="p-2 hover:bg-slate-100 rounded-lg"
+        >
           <ArrowLeft size={20} />
         </Link>
         <div>
           <h1 className="text-2xl font-serif">Nouvel Article</h1>
-          <p className="text-sm text-slate-600">Ajouter un article à l&apos;inventaire</p>
+          <p className="text-sm text-slate-600">
+            Ajouter un article à l&apos;inventaire
+          </p>
         </div>
       </header>
 
       {error && (
-        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">{error}</div>
+        <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl">
+          {error}
+        </div>
       )}
 
-      <form onSubmit={handleSubmit} className="bg-white p-6 rounded-2xl shadow space-y-6">
+      <form
+        onSubmit={handleSubmit}
+        className="bg-white p-6 rounded-2xl shadow space-y-6"
+      >
         <div className="flex items-center gap-3 pb-4 border-b">
           <div className="p-3 bg-blue-100 rounded-xl">
             <Package className="text-blue-600" size={24} />
           </div>
           <div>
             <p className="font-medium">Article Inventaire</p>
-            <p className="text-sm text-slate-500">Matière première, accessoire ou produit fini</p>
+            <p className="text-sm text-slate-500">
+              Matière première, accessoire ou produit fini
+            </p>
           </div>
         </div>
 
         <div className="grid grid-cols-2 gap-4">
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">SKU *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              SKU *
+            </label>
             <input
               type="text"
               value={form.sku}
-              onChange={(e) => setForm({ ...form, sku: e.target.value.toUpperCase() })}
+              onChange={(e) =>
+                setForm({ ...form, sku: e.target.value.toUpperCase() })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20 font-mono"
               placeholder="TISSU-VEL-001"
               required
@@ -113,7 +131,9 @@ export default function NewInventoryItemPage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Nom *</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Nom *
+            </label>
             <input
               type="text"
               value={form.name}
@@ -125,7 +145,9 @@ export default function NewInventoryItemPage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Type</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Type
+            </label>
             <select
               value={form.type}
               onChange={(e) => setForm({ ...form, type: e.target.value })}
@@ -140,7 +162,9 @@ export default function NewInventoryItemPage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Unité</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Unité
+            </label>
             <select
               value={form.unit}
               onChange={(e) => setForm({ ...form, unit: e.target.value })}
@@ -155,42 +179,59 @@ export default function NewInventoryItemPage() {
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Quantité initiale</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Quantité initiale
+            </label>
             <input
               type="number"
               min="0"
               step="0.01"
               value={form.quantity}
-              onChange={(e) => setForm({ ...form, quantity: parseFloat(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({ ...form, quantity: parseFloat(e.target.value) || 0 })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
             />
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Coût unitaire (DZD)</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Coût unitaire (DZD)
+            </label>
             <input
               type="number"
               min="0"
               step="0.01"
               value={form.averageCost}
-              onChange={(e) => setForm({ ...form, averageCost: parseFloat(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({
+                  ...form,
+                  averageCost: parseFloat(e.target.value) || 0,
+                })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
             />
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Seuil alerte</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Seuil alerte
+            </label>
             <input
               type="number"
               min="0"
               value={form.minStock}
-              onChange={(e) => setForm({ ...form, minStock: parseFloat(e.target.value) || 0 })}
+              onChange={(e) =>
+                setForm({ ...form, minStock: parseFloat(e.target.value) || 0 })
+              }
               className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-harp-brown/20"
             />
           </div>
 
           <div>
-            <label className="block text-sm font-medium text-slate-700 mb-1">Emplacement</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Emplacement
+            </label>
             <input
               type="text"
               value={form.location}
@@ -201,7 +242,9 @@ export default function NewInventoryItemPage() {
           </div>
 
           <div className="col-span-2">
-            <label className="block text-sm font-medium text-slate-700 mb-1">Notes</label>
+            <label className="block text-sm font-medium text-slate-700 mb-1">
+              Notes
+            </label>
             <textarea
               value={form.notes}
               onChange={(e) => setForm({ ...form, notes: e.target.value })}
@@ -216,12 +259,17 @@ export default function NewInventoryItemPage() {
         {form.quantity > 0 && form.averageCost > 0 && (
           <div className="bg-slate-50 p-4 rounded-lg">
             <p className="text-sm font-medium mb-2">Valeur initiale</p>
-            <p className="text-xl font-bold text-green-600">{formatCurrency(form.quantity * form.averageCost)}</p>
+            <p className="text-xl font-bold text-green-600">
+              {formatCurrency(form.quantity * form.averageCost)}
+            </p>
           </div>
         )}
 
         <div className="flex justify-end gap-4 pt-4 border-t">
-          <Link href="/admin/compta/stock" className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg">
+          <Link
+            href="/admin/compta/stock"
+            className="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg"
+          >
             Annuler
           </Link>
           <button
diff --git a/src/app/admin/compta/stock/page.tsx b/src/app/admin/compta/stock/page.tsx
index 80a1774..e2d90ca 100644
--- a/src/app/admin/compta/stock/page.tsx
+++ b/src/app/admin/compta/stock/page.tsx
@@ -2,7 +2,16 @@
 
 import { useState, useEffect } from "react";
 import Link from "next/link";
-import { Plus, Search, Package, AlertTriangle, RefreshCw, X, Minus, PlusIcon } from "lucide-react";
+import {
+  Plus,
+  Search,
+  Package,
+  AlertTriangle,
+  RefreshCw,
+  X,
+  Minus,
+  PlusIcon,
+} from "lucide-react";
 
 interface InventoryItem {
   id: string;
@@ -38,7 +47,7 @@ export default function StockPage() {
   const [loading, setLoading] = useState(true);
   const [search, setSearch] = useState("");
   const [typeFilter, setTypeFilter] = useState("");
-  
+
   // Adjustment modal state
   const [adjustItem, setAdjustItem] = useState<InventoryItem | null>(null);
   const [adjustType, setAdjustType] = useState<"ADD" | "REMOVE" | "SET">("ADD");
@@ -55,7 +64,9 @@ export default function StockPage() {
       const params = new URLSearchParams({ limit: "50" });
       if (typeFilter) params.set("type", typeFilter);
       if (search) params.set("search", search);
-      const res = await fetch(`/api/v3/compta/inventory?${params}`, { credentials: "include" });
+      const res = await fetch(`/api/v3/compta/inventory?${params}`, {
+        credentials: "include",
+      });
       const data = await res.json();
       if (data.success) {
         setItems(data.items);
@@ -88,11 +99,12 @@ export default function StockPage() {
 
   async function handleAdjust() {
     if (!adjustItem || adjustQty <= 0 || !adjustReason.trim()) return;
-    
+
     setAdjusting(true);
     try {
       const res = await fetch("/api/v3/compta/inventory/adjustment", {
-        method: "POST", credentials: "include",
+        method: "POST",
+        credentials: "include",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify({
           inventoryItemId: adjustItem.id,
@@ -101,7 +113,7 @@ export default function StockPage() {
           reason: adjustReason.trim(),
         }),
       });
-      
+
       const result = await res.json();
       if (result.success) {
         closeAdjustModal();
@@ -117,14 +129,17 @@ export default function StockPage() {
     }
   }
 
-  const formatCurrency = (n: number) => new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
+  const formatCurrency = (n: number) =>
+    new Intl.NumberFormat("fr-DZ").format(n) + " DZD";
 
   return (
     <div className="space-y-6">
       <header className="flex justify-between items-center">
         <div>
           <h1 className="text-2xl font-serif">Inventaire Stock</h1>
-          <p className="text-sm text-slate-600">Gestion des articles et mouvements</p>
+          <p className="text-sm text-slate-600">
+            Gestion des articles et mouvements
+          </p>
         </div>
         <div className="flex gap-2">
           <Link
@@ -147,7 +162,9 @@ export default function StockPage() {
         <div className="grid grid-cols-3 gap-4">
           <div className="bg-white p-4 rounded-xl shadow">
             <p className="text-sm text-slate-500">Valeur Totale</p>
-            <p className="text-xl font-bold text-green-600">{formatCurrency(stats.totalValue)}</p>
+            <p className="text-xl font-bold text-green-600">
+              {formatCurrency(stats.totalValue)}
+            </p>
           </div>
           <div className="bg-white p-4 rounded-xl shadow">
             <p className="text-sm text-slate-500">Articles</p>
@@ -155,7 +172,9 @@ export default function StockPage() {
           </div>
           <div className="bg-white p-4 rounded-xl shadow">
             <p className="text-sm text-slate-500">Quantité Totale</p>
-            <p className="text-xl font-bold">{Math.round(stats.totalQuantity)}</p>
+            <p className="text-xl font-bold">
+              {Math.round(stats.totalQuantity)}
+            </p>
           </div>
         </div>
       )}
@@ -163,7 +182,10 @@ export default function StockPage() {
       {/* Filtres */}
       <div className="flex gap-4 items-center">
         <form onSubmit={handleSearch} className="flex-1 relative">
-          <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" size={18} />
+          <Search
+            className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"
+            size={18}
+          />
           <input
             type="text"
             placeholder="Rechercher par SKU ou nom..."
@@ -179,7 +201,9 @@ export default function StockPage() {
         >
           <option value="">Tous types</option>
           {Object.entries(typeLabels).map(([k, v]) => (
-            <option key={k} value={k}>{v}</option>
+            <option key={k} value={k}>
+              {v}
+            </option>
           ))}
         </select>
       </div>
@@ -189,7 +213,9 @@ export default function StockPage() {
         {loading ? (
           <div className="p-8 text-center text-slate-500">Chargement...</div>
         ) : items.length === 0 ? (
-          <div className="p-8 text-center text-slate-500">Aucun article trouvé</div>
+          <div className="p-8 text-center text-slate-500">
+            Aucun article trouvé
+          </div>
         ) : (
           <table className="w-full">
             <thead className="bg-slate-50 text-left text-sm text-slate-600">
@@ -208,7 +234,10 @@ export default function StockPage() {
               {items.map((item) => (
                 <tr key={item.id} className="hover:bg-slate-50">
                   <td className="px-4 py-3">
-                    <Link href={`/admin/compta/stock/${item.id}`} className="font-mono text-sm hover:text-harp-brown">
+                    <Link
+                      href={`/admin/compta/stock/${item.id}`}
+                      className="font-mono text-sm hover:text-harp-brown"
+                    >
                       {item.sku}
                     </Link>
                   </td>
@@ -217,19 +246,30 @@ export default function StockPage() {
                       <Package size={16} className="text-slate-400" />
                       {item.name}
                       {item.available < 10 && (
-                        <span title="Stock bas"><AlertTriangle size={14} className="text-orange-500" /></span>
+                        <span title="Stock bas">
+                          <AlertTriangle
+                            size={14}
+                            className="text-orange-500"
+                          />
+                        </span>
                       )}
                     </div>
                   </td>
-                  <td className="px-4 py-3 text-sm text-slate-600">{typeLabels[item.type] || item.type}</td>
+                  <td className="px-4 py-3 text-sm text-slate-600">
+                    {typeLabels[item.type] || item.type}
+                  </td>
                   <td className="px-4 py-3 text-right font-medium">
                     {item.quantity} {item.unit.toLowerCase()}
                   </td>
                   <td className="px-4 py-3 text-right text-sm text-orange-600">
                     {item.reserved > 0 ? item.reserved : "-"}
                   </td>
-                  <td className="px-4 py-3 text-right text-sm">{formatCurrency(item.averageCost)}</td>
-                  <td className="px-4 py-3 text-right font-medium text-green-600">{formatCurrency(item.totalValue)}</td>
+                  <td className="px-4 py-3 text-right text-sm">
+                    {formatCurrency(item.averageCost)}
+                  </td>
+                  <td className="px-4 py-3 text-right font-medium text-green-600">
+                    {formatCurrency(item.totalValue)}
+                  </td>
                   <td className="px-4 py-3">
                     <button
                       onClick={() => openAdjustModal(item)}
@@ -251,7 +291,10 @@ export default function StockPage() {
           <div className="bg-white rounded-2xl shadow-xl w-full max-w-md p-6 space-y-4">
             <div className="flex justify-between items-center">
               <h2 className="text-lg font-semibold">Ajuster le stock</h2>
-              <button onClick={closeAdjustModal} className="p-1 hover:bg-slate-100 rounded">
+              <button
+                onClick={closeAdjustModal}
+                className="p-1 hover:bg-slate-100 rounded"
+              >
                 <X size={20} />
               </button>
             </div>
@@ -260,18 +303,22 @@ export default function StockPage() {
               <div className="font-medium">{adjustItem.name}</div>
               <div className="text-sm text-slate-500">{adjustItem.sku}</div>
               <div className="text-sm mt-1">
-                Stock actuel : <span className="font-bold">{adjustItem.quantity}</span> {adjustItem.unit.toLowerCase()}
+                Stock actuel :{" "}
+                <span className="font-bold">{adjustItem.quantity}</span>{" "}
+                {adjustItem.unit.toLowerCase()}
               </div>
             </div>
 
             <div>
-              <label className="block text-sm font-medium mb-2">Type d'ajustement</label>
+              <label className="block text-sm font-medium mb-2">
+                Type d'ajustement
+              </label>
               <div className="flex gap-2">
                 <button
                   onClick={() => setAdjustType("ADD")}
                   className={`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 ${
-                    adjustType === "ADD" 
-                      ? "bg-green-100 text-green-700 border-2 border-green-300" 
+                    adjustType === "ADD"
+                      ? "bg-green-100 text-green-700 border-2 border-green-300"
                       : "bg-slate-100 text-slate-700"
                   }`}
                 >
@@ -280,8 +327,8 @@ export default function StockPage() {
                 <button
                   onClick={() => setAdjustType("REMOVE")}
                   className={`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 ${
-                    adjustType === "REMOVE" 
-                      ? "bg-red-100 text-red-700 border-2 border-red-300" 
+                    adjustType === "REMOVE"
+                      ? "bg-red-100 text-red-700 border-2 border-red-300"
                       : "bg-slate-100 text-slate-700"
                   }`}
                 >
@@ -303,7 +350,8 @@ export default function StockPage() {
               />
               {adjustType === "REMOVE" && adjustQty > adjustItem.available && (
                 <p className="text-red-500 text-xs mt-1">
-                  Quantité supérieure au stock disponible ({adjustItem.available})
+                  Quantité supérieure au stock disponible (
+                  {adjustItem.available})
                 </p>
               )}
             </div>
diff --git a/src/app/admin/docs/page.tsx b/src/app/admin/docs/page.tsx
index 6f67ce6..a4b1565 100644
--- a/src/app/admin/docs/page.tsx
+++ b/src/app/admin/docs/page.tsx
@@ -18,7 +18,8 @@ export default function ApiDocsPage() {
 
       // Add Swagger UI JS
       const script = document.createElement("script");
-      script.src = "https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js";
+      script.src =
+        "https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js";
       script.onload = () => {
         // @ts-expect-error SwaggerUIBundle is loaded from CDN
         if (window.SwaggerUIBundle && containerRef.current) {
@@ -47,7 +48,8 @@ export default function ApiDocsPage() {
 
       // Add standalone preset
       const presetScript = document.createElement("script");
-      presetScript.src = "https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js";
+      presetScript.src =
+        "https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js";
       document.body.appendChild(presetScript);
     };
 
@@ -72,7 +74,9 @@ export default function ApiDocsPage() {
                   <FileCode size={24} className="text-green-600" />
                   API Documentation
                 </h1>
-                <p className="text-sm text-gray-500">HARP Accounting API - OpenAPI 3.1</p>
+                <p className="text-sm text-gray-500">
+                  HARP Accounting API - OpenAPI 3.1
+                </p>
               </div>
             </div>
             <div className="flex items-center gap-3">
@@ -104,103 +108,103 @@ export default function ApiDocsPage() {
           margin: 0 auto;
           padding: 20px;
         }
-        
+
         .swagger-ui .topbar {
           display: none;
         }
-        
+
         .swagger-ui .info {
           margin: 20px 0;
         }
-        
+
         .swagger-ui .info .title {
           font-size: 2rem;
           font-weight: 700;
         }
-        
+
         .swagger-ui .scheme-container {
           background: #f8fafc;
           padding: 15px;
           border-radius: 8px;
         }
-        
+
         .swagger-ui .opblock-tag {
           border-bottom: 1px solid #e5e7eb;
           font-size: 1.25rem;
         }
-        
+
         .swagger-ui .opblock {
           border-radius: 8px;
-          box-shadow: 0 1px 3px rgba(0,0,0,0.1);
+          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
           margin-bottom: 10px;
         }
-        
+
         .swagger-ui .opblock .opblock-summary {
           border-radius: 8px;
         }
-        
+
         .swagger-ui .opblock.opblock-get .opblock-summary {
           border-color: #3b82f6;
         }
-        
+
         .swagger-ui .opblock.opblock-get .opblock-summary-method {
           background: #3b82f6;
         }
-        
+
         .swagger-ui .opblock.opblock-post .opblock-summary {
           border-color: #22c55e;
         }
-        
+
         .swagger-ui .opblock.opblock-post .opblock-summary-method {
           background: #22c55e;
         }
-        
+
         .swagger-ui .opblock.opblock-put .opblock-summary {
           border-color: #f59e0b;
         }
-        
+
         .swagger-ui .opblock.opblock-put .opblock-summary-method {
           background: #f59e0b;
         }
-        
+
         .swagger-ui .opblock.opblock-delete .opblock-summary {
           border-color: #ef4444;
         }
-        
+
         .swagger-ui .opblock.opblock-delete .opblock-summary-method {
           background: #ef4444;
         }
-        
+
         .swagger-ui .btn {
           border-radius: 6px;
         }
-        
+
         .swagger-ui .btn.execute {
           background: #d97706;
           border-color: #d97706;
         }
-        
+
         .swagger-ui .btn.execute:hover {
           background: #b45309;
         }
-        
+
         .swagger-ui select {
           border-radius: 6px;
         }
-        
-        .swagger-ui input[type=text], 
+
+        .swagger-ui input[type="text"],
         .swagger-ui textarea {
           border-radius: 6px;
         }
-        
+
         .swagger-ui .model-box {
           border-radius: 8px;
         }
-        
+
         .swagger-ui section.models {
           border-radius: 8px;
         }
-        
+
         .swagger-ui section.models.is-open h4 {
           border-radius: 8px 8px 0 0;
         }
diff --git a/src/app/admin/layout.tsx b/src/app/admin/layout.tsx
index b32e6bb..463a353 100644
--- a/src/app/admin/layout.tsx
+++ b/src/app/admin/layout.tsx
@@ -2,166 +2,212 @@
 
 import Link from "next/link";
 import Image from "next/image";
-import { LayoutDashboard, ShoppingBag, Package, FolderOpen, LogOut, Menu, X, ExternalLink, Loader2, Truck, Settings, Calculator, Users, Palette } from "lucide-react";
+import {
+  LayoutDashboard,
+  ShoppingBag,
+  Package,
+  FolderOpen,
+  LogOut,
+  Menu,
+  X,
+  ExternalLink,
+  Loader2,
+  Truck,
+  Settings,
+  Calculator,
+  Users,
+  Palette,
+} from "lucide-react";
 import { usePathname, useRouter } from "next/navigation";
 import { useState, useEffect } from "react";
 import { useSession, signOut } from "next-auth/react";
 import { cn } from "@/lib/utils";
 
-export default function AdminLayout({ children }: { children: React.ReactNode }) {
-    const pathname = usePathname();
-    const router = useRouter();
-    const [sidebarOpen, setSidebarOpen] = useState(false);
-    const { data: session, status } = useSession();
-    
-    // Redirect to login if not authenticated (in useEffect to avoid setState during render)
-    useEffect(() => {
-        if (status === "unauthenticated" && pathname !== "/admin/login") {
-            router.push("/admin/login");
-        }
-    }, [status, pathname, router]);
+export default function AdminLayout({
+  children,
+}: {
+  children: React.ReactNode;
+}) {
+  const pathname = usePathname();
+  const router = useRouter();
+  const [sidebarOpen, setSidebarOpen] = useState(false);
+  const { data: session, status } = useSession();
 
-    // Don't show admin layout on login page
-    if (pathname === "/admin/login") {
-        return <>{children}</>;
+  // Redirect to login if not authenticated (in useEffect to avoid setState during render)
+  useEffect(() => {
+    if (status === "unauthenticated" && pathname !== "/admin/login") {
+      router.push("/admin/login");
     }
+  }, [status, pathname, router]);
 
-    // Show loading state
-    if (status === "loading" || status === "unauthenticated") {
-        return (
-            <div className="min-h-screen flex items-center justify-center bg-white">
-                <div className="text-center">
-                    <Loader2 size={32} className="animate-spin text-gray-900 mx-auto mb-4" />
-                    <p className="text-xs uppercase tracking-widest text-gray-400">
-                        {status === "loading" ? "Chargement..." : "Redirection..."}
-                    </p>
-                </div>
-            </div>
-        );
-    }
+  // Don't show admin layout on login page
+  if (pathname === "/admin/login") {
+    return <>{children}</>;
+  }
 
-    const links = [
-        { href: "/admin", label: "Dashboard", icon: LayoutDashboard },
-        { href: "/admin/orders", label: "Commandes", icon: ShoppingBag },
-        { href: "/admin/clients", label: "Clients", icon: Users },
-        { href: "/admin/shipping", label: "Livraison", icon: Truck },
-        { href: "/admin/products", label: "Produits", icon: Package },
-        { href: "/admin/collections", label: "Collections", icon: FolderOpen },
-        { href: "/admin/compta", label: "Comptabilité", icon: Calculator },
-        { href: "/admin/settings/customization", label: "Personnalisation", icon: Palette },
-        { href: "/admin/settings", label: "Paramètres", icon: Settings },
-    ];
+  // Show loading state
+  if (status === "loading" || status === "unauthenticated") {
+    return (
+      <div className="min-h-screen flex items-center justify-center bg-white">
+        <div className="text-center">
+          <Loader2
+            size={32}
+            className="animate-spin text-gray-900 mx-auto mb-4"
+          />
+          <p className="text-xs uppercase tracking-widest text-gray-400">
+            {status === "loading" ? "Chargement..." : "Redirection..."}
+          </p>
+        </div>
+      </div>
+    );
+  }
 
-    const isActive = (href: string) => {
-        if (href === "/admin") return pathname === "/admin";
-        return pathname.startsWith(href);
-    };
+  const links = [
+    { href: "/admin", label: "Dashboard", icon: LayoutDashboard },
+    { href: "/admin/orders", label: "Commandes", icon: ShoppingBag },
+    { href: "/admin/clients", label: "Clients", icon: Users },
+    { href: "/admin/shipping", label: "Livraison", icon: Truck },
+    { href: "/admin/products", label: "Produits", icon: Package },
+    { href: "/admin/collections", label: "Collections", icon: FolderOpen },
+    { href: "/admin/compta", label: "Comptabilité", icon: Calculator },
+    {
+      href: "/admin/settings/customization",
+      label: "Personnalisation",
+      icon: Palette,
+    },
+    { href: "/admin/settings", label: "Paramètres", icon: Settings },
+  ];
 
-    return (
-        <div className="flex min-h-screen bg-gray-50/50">
-            {/* Mobile overlay */}
-            {sidebarOpen && (
-                <div 
-                    className="fixed inset-0 bg-black/20 backdrop-blur-sm z-40 lg:hidden"
-                    onClick={() => setSidebarOpen(false)}
-                />
-            )}
+  const isActive = (href: string) => {
+    if (href === "/admin") return pathname === "/admin";
+    return pathname.startsWith(href);
+  };
 
-            {/* Sidebar */}
-            <aside className={cn(
-                "fixed lg:static inset-y-0 left-0 z-50 w-72 bg-white border-r border-gray-100 flex flex-col transition-transform duration-300 lg:transform-none",
-                sidebarOpen ? 'translate-x-0' : '-translate-x-full lg:translate-x-0'
-            )}>
-                <div className="p-8 border-b border-gray-50">
-                    <div className="flex items-center justify-between">
-                        <div className="flex items-center gap-3">
-                            <Image 
-                                src="/logo.svg" 
-                                alt="HARP" 
-                                width={40} 
-                                height={40}
-                                className="h-8 w-auto"
-                            />
-                            <div className="h-8 w-px bg-gray-200 mx-1" />
-                            <p className="text-xs font-serif font-medium text-gray-400 tracking-widest uppercase pt-1">Admin</p>
-                        </div>
-                        <button 
-                            onClick={() => setSidebarOpen(false)}
-                            className="lg:hidden p-2 text-gray-400 hover:text-gray-900"
-                        >
-                            <X size={20} />
-                        </button>
-                    </div>
-                </div>
+  return (
+    <div className="flex min-h-screen bg-gray-50/50">
+      {/* Mobile overlay */}
+      {sidebarOpen && (
+        <div
+          className="fixed inset-0 bg-black/20 backdrop-blur-sm z-40 lg:hidden"
+          onClick={() => setSidebarOpen(false)}
+        />
+      )}
 
-                <nav className="flex-1 p-6 space-y-1">
-                    <p className="text-[10px] font-bold text-gray-300 uppercase tracking-[0.2em] px-3 mb-4">Menu</p>
-                    {links.map((link) => {
-                        const active = isActive(link.href);
-                        return (
-                            <Link
-                                key={link.href}
-                                href={link.href}
-                                onClick={() => setSidebarOpen(false)}
-                                className={cn(
-                                    "flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200 group",
-                                    active
-                                        ? "bg-gray-900 text-white shadow-sm"
-                                        : "text-gray-500 hover:bg-gray-50 hover:text-gray-900"
-                                )}
-                            >
-                                <link.icon size={18} className={active ? "text-white" : "text-gray-400 group-hover:text-gray-900"} />
-                                <span className="text-sm font-medium">{link.label}</span>
-                            </Link>
-                        );
-                    })}
-                </nav>
+      {/* Sidebar */}
+      <aside
+        className={cn(
+          "fixed lg:static inset-y-0 left-0 z-50 w-72 bg-white border-r border-gray-100 flex flex-col transition-transform duration-300 lg:transform-none",
+          sidebarOpen ? "translate-x-0" : "-translate-x-full lg:translate-x-0",
+        )}
+      >
+        <div className="p-8 border-b border-gray-50">
+          <div className="flex items-center justify-between">
+            <div className="flex items-center gap-3">
+              <Image
+                src="/logo.svg"
+                alt="HARP"
+                width={40}
+                height={40}
+                className="h-8 w-auto"
+              />
+              <div className="h-8 w-px bg-gray-200 mx-1" />
+              <p className="text-xs font-serif font-medium text-gray-400 tracking-widest uppercase pt-1">
+                Admin
+              </p>
+            </div>
+            <button
+              onClick={() => setSidebarOpen(false)}
+              className="lg:hidden p-2 text-gray-400 hover:text-gray-900"
+            >
+              <X size={20} />
+            </button>
+          </div>
+        </div>
 
-                <div className="p-6 border-t border-gray-50 space-y-2">
-                    <Link 
-                        href="/" 
-                        target="_blank"
-                        className="flex items-center gap-3 px-3 py-2.5 text-gray-500 hover:bg-gray-50 hover:text-gray-900 rounded-lg transition-colors group"
-                    >
-                        <ExternalLink size={18} className="text-gray-400 group-hover:text-gray-900" />
-                        <span className="text-sm font-medium">Voir le site</span>
-                    </Link>
-                    <button 
-                        onClick={() => signOut({ callbackUrl: "/admin/login" })}
-                        className="w-full flex items-center gap-3 px-3 py-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors"
-                    >
-                        <LogOut size={18} />
-                        <span className="text-sm font-medium">Déconnexion</span>
-                    </button>
-                </div>
-            </aside>
+        <nav className="flex-1 p-6 space-y-1">
+          <p className="text-[10px] font-bold text-gray-300 uppercase tracking-[0.2em] px-3 mb-4">
+            Menu
+          </p>
+          {links.map((link) => {
+            const active = isActive(link.href);
+            return (
+              <Link
+                key={link.href}
+                href={link.href}
+                onClick={() => setSidebarOpen(false)}
+                className={cn(
+                  "flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200 group",
+                  active
+                    ? "bg-gray-900 text-white shadow-sm"
+                    : "text-gray-500 hover:bg-gray-50 hover:text-gray-900",
+                )}
+              >
+                <link.icon
+                  size={18}
+                  className={
+                    active
+                      ? "text-white"
+                      : "text-gray-400 group-hover:text-gray-900"
+                  }
+                />
+                <span className="text-sm font-medium">{link.label}</span>
+              </Link>
+            );
+          })}
+        </nav>
 
-            {/* Main Content */}
-            <div className="flex-1 flex flex-col min-h-screen">
-                {/* Top bar */}
-                <header className="bg-white border-b border-gray-100 px-8 py-4 flex items-center justify-between lg:justify-end sticky top-0 z-30">
-                    <button 
-                        onClick={() => setSidebarOpen(true)}
-                        className="lg:hidden p-2 text-gray-500 hover:bg-gray-50 rounded-lg"
-                    >
-                        <Menu size={24} />
-                    </button>
-                    <div className="flex items-center gap-4">
-                        <div className="text-right hidden sm:block">
-                            <p className="text-sm font-medium text-gray-900">{session?.user?.name || "Administrateur"}</p>
-                            <p className="text-xs text-gray-400">{session?.user?.email || ""}</p>
-                        </div>
-                        <div className="w-9 h-9 bg-gray-100 rounded-full flex items-center justify-center font-serif font-bold text-gray-600 border border-gray-200">
-                            {session?.user?.name?.charAt(0) || "A"}
-                        </div>
-                    </div>
-                </header>
+        <div className="p-6 border-t border-gray-50 space-y-2">
+          <Link
+            href="/"
+            target="_blank"
+            className="flex items-center gap-3 px-3 py-2.5 text-gray-500 hover:bg-gray-50 hover:text-gray-900 rounded-lg transition-colors group"
+          >
+            <ExternalLink
+              size={18}
+              className="text-gray-400 group-hover:text-gray-900"
+            />
+            <span className="text-sm font-medium">Voir le site</span>
+          </Link>
+          <button
+            onClick={() => signOut({ callbackUrl: "/admin/login" })}
+            className="w-full flex items-center gap-3 px-3 py-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors"
+          >
+            <LogOut size={18} />
+            <span className="text-sm font-medium">Déconnexion</span>
+          </button>
+        </div>
+      </aside>
 
-                {/* Page content */}
-                <main className="flex-1 p-6 lg:p-10 overflow-y-auto bg-white">
-                    {children}
-                </main>
+      {/* Main Content */}
+      <div className="flex-1 flex flex-col min-h-screen">
+        {/* Top bar */}
+        <header className="bg-white border-b border-gray-100 px-8 py-4 flex items-center justify-between lg:justify-end sticky top-0 z-30">
+          <button
+            onClick={() => setSidebarOpen(true)}
+            className="lg:hidden p-2 text-gray-500 hover:bg-gray-50 rounded-lg"
+          >
+            <Menu size={24} />
+          </button>
+          <div className="flex items-center gap-4">
+            <div className="text-right hidden sm:block">
+              <p className="text-sm font-medium text-gray-900">
+                {session?.user?.name || "Administrateur"}
+              </p>
+              <p className="text-xs text-gray-400">
+                {session?.user?.email || ""}
+              </p>
             </div>
-        </div>
-    );
+            <div className="w-9 h-9 bg-gray-100 rounded-full flex items-center justify-center font-serif font-bold text-gray-600 border border-gray-200">
+              {session?.user?.name?.charAt(0) || "A"}
+            </div>
+          </div>
+        </header>
+
+        {/* Page content */}
+        <main className="flex-1 p-6 lg:p-10 overflow-y-auto bg-white">
+          {children}
+        </main>
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/admin/login/page.tsx b/src/app/admin/login/page.tsx
index 0ab61c0..4a2c7d6 100644
--- a/src/app/admin/login/page.tsx
+++ b/src/app/admin/login/page.tsx
@@ -3,136 +3,163 @@
 import { useState } from "react";
 import { signIn } from "next-auth/react";
 import { useRouter, useSearchParams } from "next/navigation";
-import { Lock, Mail, Eye, EyeOff, AlertCircle, ArrowRight, ArrowLeft, Loader2 } from "lucide-react";
+import {
+  Lock,
+  Mail,
+  Eye,
+  EyeOff,
+  AlertCircle,
+  ArrowRight,
+  ArrowLeft,
+  Loader2,
+} from "lucide-react";
 import Link from "next/link";
 import Image from "next/image";
 
 export default function AdminLoginPage() {
-    const router = useRouter();
-    const searchParams = useSearchParams();
-    const callbackUrl = searchParams.get("callbackUrl") || "/admin";
-    
-    const [email, setEmail] = useState("");
-    const [password, setPassword] = useState("");
-    const [showPassword, setShowPassword] = useState(false);
-    const [error, setError] = useState("");
-    const [loading, setLoading] = useState(false);
+  const router = useRouter();
+  const searchParams = useSearchParams();
+  const callbackUrl = searchParams.get("callbackUrl") || "/admin";
 
-    const handleSubmit = async (e: React.FormEvent) => {
-        e.preventDefault();
-        setError("");
-        setLoading(true);
+  const [email, setEmail] = useState("");
+  const [password, setPassword] = useState("");
+  const [showPassword, setShowPassword] = useState(false);
+  const [error, setError] = useState("");
+  const [loading, setLoading] = useState(false);
 
-        try {
-            const result = await signIn("admin-login", {
-                email,
-                password,
-                redirect: false,
-            });
+  const handleSubmit = async (e: React.FormEvent) => {
+    e.preventDefault();
+    setError("");
+    setLoading(true);
 
-            if (result?.error) {
-                setError("Email ou mot de passe incorrect");
-            } else {
-                router.push(callbackUrl);
-                router.refresh();
-            }
-        } catch {
-            setError("Une erreur est survenue");
-        } finally {
-            setLoading(false);
-        }
-    };
+    try {
+      const result = await signIn("admin-login", {
+        email,
+        password,
+        redirect: false,
+      });
 
-    return (
-        <div className="min-h-screen bg-white flex items-center justify-center p-6">
-            <div className="w-full max-w-sm space-y-10">
-                {/* Header */}
-                <div className="text-center space-y-4">
-                    <div className="inline-flex items-center justify-center w-16 h-16 bg-gray-900 rounded-full mb-4">
-                        <span className="font-serif text-2xl text-white font-bold italic">H</span>
-                    </div>
-                    <h1 className="text-3xl font-serif font-medium text-gray-900">
-                        Administration
-                    </h1>
-                    <p className="text-gray-500 text-sm">
-                        Connectez-vous pour gérer votre boutique
-                    </p>
-                </div>
+      if (result?.error) {
+        setError("Email ou mot de passe incorrect");
+      } else {
+        router.push(callbackUrl);
+        router.refresh();
+      }
+    } catch {
+      setError("Une erreur est survenue");
+    } finally {
+      setLoading(false);
+    }
+  };
 
-                {error && (
-                    <div className="p-4 bg-red-50 border border-red-100 rounded-xl flex items-center gap-3 text-red-600 text-sm animate-in slide-in-from-top-2">
-                        <AlertCircle size={18} />
-                        <span>{error}</span>
-                    </div>
-                )}
-
-                <form onSubmit={handleSubmit} className="space-y-6">
-                    <div className="space-y-2">
-                        <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Email</label>
-                        <div className="relative">
-                            <input
-                                type="email"
-                                value={email}
-                                onChange={(e) => setEmail(e.target.value)}
-                                placeholder="admin@harp.dz"
-                                required
-                                className="w-full bg-gray-50 border-none p-4 pl-12 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                            <Mail size={18} className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400" />
-                        </div>
-                    </div>
+  return (
+    <div className="min-h-screen bg-white flex items-center justify-center p-6">
+      <div className="w-full max-w-sm space-y-10">
+        {/* Header */}
+        <div className="text-center space-y-4">
+          <div className="inline-flex items-center justify-center w-16 h-16 bg-gray-900 rounded-full mb-4">
+            <span className="font-serif text-2xl text-white font-bold italic">
+              H
+            </span>
+          </div>
+          <h1 className="text-3xl font-serif font-medium text-gray-900">
+            Administration
+          </h1>
+          <p className="text-gray-500 text-sm">
+            Connectez-vous pour gérer votre boutique
+          </p>
+        </div>
 
-                    <div className="space-y-2">
-                        <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Mot de passe</label>
-                        <div className="relative">
-                            <input
-                                type={showPassword ? "text" : "password"}
-                                value={password}
-                                onChange={(e) => setPassword(e.target.value)}
-                                placeholder="••••••••"
-                                required
-                                className="w-full bg-gray-50 border-none p-4 pl-12 pr-12 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                            <Lock size={18} className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400" />
-                            <button
-                                type="button"
-                                onClick={() => setShowPassword(!showPassword)}
-                                className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors"
-                            >
-                                {showPassword ? <EyeOff size={18} /> : <Eye size={18} />}
-                            </button>
-                        </div>
-                    </div>
+        {error && (
+          <div className="p-4 bg-red-50 border border-red-100 rounded-xl flex items-center gap-3 text-red-600 text-sm animate-in slide-in-from-top-2">
+            <AlertCircle size={18} />
+            <span>{error}</span>
+          </div>
+        )}
 
-                    <button
-                        type="submit"
-                        disabled={loading}
-                        className="w-full bg-gray-900 text-white py-4 rounded-xl font-medium hover:bg-gray-800 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-gray-900/10 group"
-                    >
-                        {loading ? (
-                            <>
-                                <Loader2 size={18} className="animate-spin" />
-                                Connexion...
-                            </>
-                        ) : (
-                            <>
-                                Se connecter
-                                <ArrowRight size={18} className="group-hover:translate-x-1 transition-transform" />
-                            </>
-                        )}
-                    </button>
-                </form>
+        <form onSubmit={handleSubmit} className="space-y-6">
+          <div className="space-y-2">
+            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+              Email
+            </label>
+            <div className="relative">
+              <input
+                type="email"
+                value={email}
+                onChange={(e) => setEmail(e.target.value)}
+                placeholder="admin@harp.dz"
+                required
+                className="w-full bg-gray-50 border-none p-4 pl-12 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+              <Mail
+                size={18}
+                className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"
+              />
+            </div>
+          </div>
 
-                <div className="text-center pt-8 border-t border-gray-50">
-                    <Link 
-                        href="/" 
-                        className="inline-flex items-center gap-2 text-sm text-gray-400 hover:text-gray-900 transition-colors group"
-                    >
-                        <ArrowLeft size={16} className="group-hover:-translate-x-1 transition-transform" />
-                        Retour au site
-                    </Link>
-                </div>
+          <div className="space-y-2">
+            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+              Mot de passe
+            </label>
+            <div className="relative">
+              <input
+                type={showPassword ? "text" : "password"}
+                value={password}
+                onChange={(e) => setPassword(e.target.value)}
+                placeholder="••••••••"
+                required
+                className="w-full bg-gray-50 border-none p-4 pl-12 pr-12 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+              <Lock
+                size={18}
+                className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"
+              />
+              <button
+                type="button"
+                onClick={() => setShowPassword(!showPassword)}
+                className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors"
+              >
+                {showPassword ? <EyeOff size={18} /> : <Eye size={18} />}
+              </button>
             </div>
+          </div>
+
+          <button
+            type="submit"
+            disabled={loading}
+            className="w-full bg-gray-900 text-white py-4 rounded-xl font-medium hover:bg-gray-800 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-gray-900/10 group"
+          >
+            {loading ? (
+              <>
+                <Loader2 size={18} className="animate-spin" />
+                Connexion...
+              </>
+            ) : (
+              <>
+                Se connecter
+                <ArrowRight
+                  size={18}
+                  className="group-hover:translate-x-1 transition-transform"
+                />
+              </>
+            )}
+          </button>
+        </form>
+
+        <div className="text-center pt-8 border-t border-gray-50">
+          <Link
+            href="/"
+            className="inline-flex items-center gap-2 text-sm text-gray-400 hover:text-gray-900 transition-colors group"
+          >
+            <ArrowLeft
+              size={16}
+              className="group-hover:-translate-x-1 transition-transform"
+            />
+            Retour au site
+          </Link>
         </div>
-    );
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/admin/orders/page.tsx b/src/app/admin/orders/page.tsx
index d0299f7..e049891 100644
--- a/src/app/admin/orders/page.tsx
+++ b/src/app/admin/orders/page.tsx
@@ -1,613 +1,820 @@
 "use client";
 
 import React, { useState, useEffect } from "react";
-import { ChevronDown, ChevronUp, Clock, CheckCircle, Truck, XCircle, Package, Search, RefreshCw, ExternalLink, LucideIcon, Lock, Unlock, Send, AlertTriangle } from "lucide-react";
+import {
+  ChevronDown,
+  ChevronUp,
+  Clock,
+  CheckCircle,
+  Truck,
+  XCircle,
+  Package,
+  Search,
+  RefreshCw,
+  ExternalLink,
+  LucideIcon,
+  Lock,
+  Unlock,
+  Send,
+  AlertTriangle,
+} from "lucide-react";
 import { cn } from "@/lib/utils";
 
 interface OrderItem {
-    id: string;
-    productName: string;
-    size: string;
-    color: string;
-    quantity: number;
-    price: number;
+  id: string;
+  productName: string;
+  size: string;
+  color: string;
+  quantity: number;
+  price: number;
 }
 
 interface Order {
-    id: string;
-    customerName: string;
-    customerPhone: string;
-    customerAddress: string;
-    customerCity: string;
-    customerWilaya: string;
-    deliveryProvider?: string;
-    deliveryType?: string;
-    shippingPrice?: number;
-    trackingNumber?: string;
-    trackingStatus?: string;
-    total: number;
-    status: string;
-    items: OrderItem[];
-    createdAt: string;
+  id: string;
+  customerName: string;
+  customerPhone: string;
+  customerAddress: string;
+  customerCity: string;
+  customerWilaya: string;
+  deliveryProvider?: string;
+  deliveryType?: string;
+  shippingPrice?: number;
+  trackingNumber?: string;
+  trackingStatus?: string;
+  total: number;
+  status: string;
+  items: OrderItem[];
+  createdAt: string;
 }
 
 export default function AdminOrdersPage() {
-    const [orders, setOrders] = useState<Order[]>([]);
-    const [loading, setLoading] = useState(true);
-    const [expandedOrder, setExpandedOrder] = useState<string | null>(null);
-    const [statusFilter, setStatusFilter] = useState<string>("ALL");
-    const [syncingOrderId, setSyncingOrderId] = useState<string | null>(null);
-    const [syncingAll, setSyncingAll] = useState(false);
-    const [searchTerm, setSearchTerm] = useState("");
-    const [reservingOrderId, setReservingOrderId] = useState<string | null>(null);
-    const [shippingOrderId, setShippingOrderId] = useState<string | null>(null);
-
-    useEffect(() => {
-        fetch("/api/orders?pageSize=100")
-            .then((res) => {
-                if (res.ok) return res.json();
-                return { items: [] };
-            })
-            .then((data) => {
-                const ordersList = Array.isArray(data) ? data : (data.items || []);
-                setOrders(ordersList);
-                setLoading(false);
-            })
-            .catch((err) => {
-                console.error("Failed to fetch orders", err);
-                setLoading(false);
-            });
-    }, []);
-
-    const toggleOrder = (id: string) => {
-        setExpandedOrder(expandedOrder === id ? null : id);
-    };
+  const [orders, setOrders] = useState<Order[]>([]);
+  const [loading, setLoading] = useState(true);
+  const [expandedOrder, setExpandedOrder] = useState<string | null>(null);
+  const [statusFilter, setStatusFilter] = useState<string>("ALL");
+  const [syncingOrderId, setSyncingOrderId] = useState<string | null>(null);
+  const [syncingAll, setSyncingAll] = useState(false);
+  const [searchTerm, setSearchTerm] = useState("");
+  const [reservingOrderId, setReservingOrderId] = useState<string | null>(null);
+  const [shippingOrderId, setShippingOrderId] = useState<string | null>(null);
 
-    const handleStatusUpdate = async (id: string, newStatus: string) => {
-        try {
-            const res = await fetch(`/api/orders/${id}`, {
-                method: "PATCH",
-                headers: { "Content-Type": "application/json" },
-                body: JSON.stringify({ status: newStatus }),
-            });
-
-            if (res.ok) {
-                const data = await res.json();
-                setOrders(orders.map(o => o.id === id ? { 
-                    ...o, 
-                    status: newStatus,
-                    trackingNumber: data.trackingNumber || o.trackingNumber,
-                    trackingStatus: data.trackingStatus || o.trackingStatus,
-                } : o));
-
-                if (data.shipmentCreated) {
-                    const provider = data.deliveryProvider || 'transporteur';
-                    const message = `✅ Commande confirmée !\n\n📦 Expédition créée sur ${provider}\n🔢 Tracking: ${data.trackingNumber}`;
-                    
-                    if (data.label) {
-                        const openLabel = confirm(message + '\n\nVoulez-vous ouvrir le bordereau ?');
-                        if (openLabel) {
-                            window.open(data.label, '_blank');
-                        }
-                    } else {
-                        alert(message);
-                    }
-                } else if (data.shipmentError) {
-                    alert(`⚠️ Commande confirmée mais erreur création expédition:\n${data.shipmentError}\n\nVous pouvez créer l'expédition manuellement depuis la page Livraison.`);
-                } else if (newStatus === 'CONFIRMED') {
-                    alert('✅ Commande confirmée !');
-                }
-            } else {
-                alert("Erreur lors de la mise à jour du statut");
-            }
-        } catch (error) {
-            console.error("Error updating status:", error);
-            alert("Erreur lors de la mise à jour du statut");
-        }
-    };
+  useEffect(() => {
+    fetch("/api/orders?pageSize=100")
+      .then((res) => {
+        if (res.ok) return res.json();
+        return { items: [] };
+      })
+      .then((data) => {
+        const ordersList = Array.isArray(data) ? data : data.items || [];
+        setOrders(ordersList);
+        setLoading(false);
+      })
+      .catch((err) => {
+        console.error("Failed to fetch orders", err);
+        setLoading(false);
+      });
+  }, []);
+
+  const toggleOrder = (id: string) => {
+    setExpandedOrder(expandedOrder === id ? null : id);
+  };
 
-    const handleSyncOrder = async (orderId: string) => {
-        setSyncingOrderId(orderId);
-        try {
-            const res = await fetch('/api/tracking', {
-                method: 'POST',
-                headers: { 'Content-Type': 'application/json' },
-                body: JSON.stringify({ orderId })
-            });
-            
-            if (res.ok) {
-                const data = await res.json();
-                if (data.newStatus) {
-                    setOrders(orders.map(o => o.id === orderId ? {
-                        ...o,
-                        trackingStatus: data.newStatus,
-                        status: data.orderStatus || o.status
-                    } : o));
+  const handleStatusUpdate = async (id: string, newStatus: string) => {
+    try {
+      const res = await fetch(`/api/orders/${id}`, {
+        method: "PATCH",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify({ status: newStatus }),
+      });
+
+      if (res.ok) {
+        const data = await res.json();
+        setOrders(
+          orders.map((o) =>
+            o.id === id
+              ? {
+                  ...o,
+                  status: newStatus,
+                  trackingNumber: data.trackingNumber || o.trackingNumber,
+                  trackingStatus: data.trackingStatus || o.trackingStatus,
                 }
-            }
-        } catch (error) {
-            console.error('Sync error:', error);
-        } finally {
-            setSyncingOrderId(null);
-        }
-    };
+              : o,
+          ),
+        );
 
-    const handleSyncAll = async () => {
-        setSyncingAll(true);
-        const ordersWithTracking = orders.filter(o => o.trackingNumber);
-        
-        for (const order of ordersWithTracking) {
-            await handleSyncOrder(order.id);
-            await new Promise(resolve => setTimeout(resolve, 500));
-        }
-        
-        setSyncingAll(false);
-        alert(`✅ ${ordersWithTracking.length} commande(s) synchronisée(s)`);
-    };
+        if (data.shipmentCreated) {
+          const provider = data.deliveryProvider || "transporteur";
+          const message = `✅ Commande confirmée !\n\n📦 Expédition créée sur ${provider}\n🔢 Tracking: ${data.trackingNumber}`;
 
-    const handleReserveStock = async (orderId: string) => {
-        setReservingOrderId(orderId);
-        try {
-            const res = await fetch(`/api/orders/${orderId}/reserve`, {
-                method: 'POST',
-                headers: { 'Content-Type': 'application/json' }
-            });
-            
-            const data = await res.json();
-            
-            if (res.ok) {
-                setOrders(orders.map(o => o.id === orderId ? {
-                    ...o,
-                    status: 'CONFIRMED'
-                } : o));
-                alert(`✅ Stock réservé avec succès!\n\n${data.reservedItems || 0} matières réservées`);
-            } else {
-                alert(`❌ Erreur: ${data.error}`);
+          if (data.label) {
+            const openLabel = confirm(
+              message + "\n\nVoulez-vous ouvrir le bordereau ?",
+            );
+            if (openLabel) {
+              window.open(data.label, "_blank");
             }
-        } catch (error) {
-            console.error('Reserve error:', error);
-            alert('Erreur lors de la réservation du stock');
-        } finally {
-            setReservingOrderId(null);
+          } else {
+            alert(message);
+          }
+        } else if (data.shipmentError) {
+          alert(
+            `⚠️ Commande confirmée mais erreur création expédition:\n${data.shipmentError}\n\nVous pouvez créer l'expédition manuellement depuis la page Livraison.`,
+          );
+        } else if (newStatus === "CONFIRMED") {
+          alert("✅ Commande confirmée !");
         }
-    };
+      } else {
+        alert("Erreur lors de la mise à jour du statut");
+      }
+    } catch (error) {
+      console.error("Error updating status:", error);
+      alert("Erreur lors de la mise à jour du statut");
+    }
+  };
 
-    const handleShipOrder = async (orderId: string) => {
-        setShippingOrderId(orderId);
-        try {
-            const res = await fetch(`/api/orders/${orderId}/ship`, {
-                method: 'POST',
-                headers: { 'Content-Type': 'application/json' }
-            });
-            
-            const data = await res.json();
-            
-            if (res.ok) {
-                setOrders(orders.map(o => o.id === orderId ? {
-                    ...o,
-                    status: 'SHIPPED'
-                } : o));
-                alert(`✅ Commande expédiée!\n\nStock consommé avec succès.`);
-            } else {
-                alert(`❌ Erreur: ${data.error}`);
-            }
-        } catch (error) {
-            console.error('Ship error:', error);
-            alert('Erreur lors de l\'expédition');
-        } finally {
-            setShippingOrderId(null);
-        }
-    };
+  const handleSyncOrder = async (orderId: string) => {
+    setSyncingOrderId(orderId);
+    try {
+      const res = await fetch("/api/tracking", {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify({ orderId }),
+      });
 
-    const handleCancelReservation = async (orderId: string) => {
-        if (!confirm('Annuler la réservation de stock pour cette commande?')) return;
-        
-        try {
-            const res = await fetch(`/api/orders/${orderId}/ship`, {
-                method: 'DELETE'
-            });
-            
-            const data = await res.json();
-            
-            if (res.ok) {
-                setOrders(orders.map(o => o.id === orderId ? {
+      if (res.ok) {
+        const data = await res.json();
+        if (data.newStatus) {
+          setOrders(
+            orders.map((o) =>
+              o.id === orderId
+                ? {
                     ...o,
-                    status: 'PENDING'
-                } : o));
-                alert(`✅ Réservation annulée`);
-            } else {
-                alert(`❌ Erreur: ${data.error}`);
-            }
-        } catch (error) {
-            console.error('Cancel reservation error:', error);
-            alert('Erreur lors de l\'annulation');
+                    trackingStatus: data.newStatus,
+                    status: data.orderStatus || o.status,
+                  }
+                : o,
+            ),
+          );
         }
-    };
+      }
+    } catch (error) {
+      console.error("Sync error:", error);
+    } finally {
+      setSyncingOrderId(null);
+    }
+  };
+
+  const handleSyncAll = async () => {
+    setSyncingAll(true);
+    const ordersWithTracking = orders.filter((o) => o.trackingNumber);
+
+    for (const order of ordersWithTracking) {
+      await handleSyncOrder(order.id);
+      await new Promise((resolve) => setTimeout(resolve, 500));
+    }
+
+    setSyncingAll(false);
+    alert(`✅ ${ordersWithTracking.length} commande(s) synchronisée(s)`);
+  };
 
-    const getStatusBadge = (status: string) => {
-        const badges: Record<string, { bg: string; text: string; icon: LucideIcon; label: string }> = {
-            PENDING: { bg: "bg-amber-50", text: "text-amber-700", icon: Clock, label: "En attente" },
-            CONFIRMED: { bg: "bg-blue-50", text: "text-blue-700", icon: CheckCircle, label: "Confirmée" },
-            SHIPPED: { bg: "bg-purple-50", text: "text-purple-700", icon: Truck, label: "Expédiée" },
-            DELIVERED: { bg: "bg-emerald-50", text: "text-emerald-700", icon: CheckCircle, label: "Livrée" },
-            CANCELLED: { bg: "bg-red-50", text: "text-red-700", icon: XCircle, label: "Annulée" }
-        };
-        const badge = badges[status] || badges.PENDING;
-        const Icon = badge.icon;
-        return (
-            <span className={cn("inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium", badge.bg, badge.text)}>
-                <Icon size={12} />
-                {badge.label}
-            </span>
+  const handleReserveStock = async (orderId: string) => {
+    setReservingOrderId(orderId);
+    try {
+      const res = await fetch(`/api/orders/${orderId}/reserve`, {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+      });
+
+      const data = await res.json();
+
+      if (res.ok) {
+        setOrders(
+          orders.map((o) =>
+            o.id === orderId
+              ? {
+                  ...o,
+                  status: "CONFIRMED",
+                }
+              : o,
+          ),
         );
-    };
+        alert(
+          `✅ Stock réservé avec succès!\n\n${data.reservedItems || 0} matières réservées`,
+        );
+      } else {
+        alert(`❌ Erreur: ${data.error}`);
+      }
+    } catch (error) {
+      console.error("Reserve error:", error);
+      alert("Erreur lors de la réservation du stock");
+    } finally {
+      setReservingOrderId(null);
+    }
+  };
 
-    const statusFilters = [
-        { value: "ALL", label: "Toutes" },
-        { value: "PENDING", label: "En attente" },
-        { value: "CONFIRMED", label: "Confirmées" },
-        { value: "SHIPPED", label: "Expédiées" },
-        { value: "DELIVERED", label: "Livrées" },
-        { value: "CANCELLED", label: "Annulées" },
-    ];
-
-    const filteredOrders = orders.filter(order => {
-        const matchesStatus = statusFilter === "ALL" || order.status === statusFilter;
-        const matchesSearch = searchTerm === "" || 
-            order.customerName?.toLowerCase().includes(searchTerm.toLowerCase()) ||
-            order.customerPhone?.includes(searchTerm) ||
-            order.id.toLowerCase().includes(searchTerm.toLowerCase());
-        return matchesStatus && matchesSearch;
-    });
-
-    const orderStats = {
-        total: orders.length,
-        pending: orders.filter(o => o.status === "PENDING").length,
-        confirmed: orders.filter(o => o.status === "CONFIRMED").length,
-        shipped: orders.filter(o => o.status === "SHIPPED").length,
-        delivered: orders.filter(o => o.status === "DELIVERED").length,
-    };
+  const handleShipOrder = async (orderId: string) => {
+    setShippingOrderId(orderId);
+    try {
+      const res = await fetch(`/api/orders/${orderId}/ship`, {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+      });
 
+      const data = await res.json();
+
+      if (res.ok) {
+        setOrders(
+          orders.map((o) =>
+            o.id === orderId
+              ? {
+                  ...o,
+                  status: "SHIPPED",
+                }
+              : o,
+          ),
+        );
+        alert(`✅ Commande expédiée!\n\nStock consommé avec succès.`);
+      } else {
+        alert(`❌ Erreur: ${data.error}`);
+      }
+    } catch (error) {
+      console.error("Ship error:", error);
+      alert("Erreur lors de l'expédition");
+    } finally {
+      setShippingOrderId(null);
+    }
+  };
+
+  const handleCancelReservation = async (orderId: string) => {
+    if (!confirm("Annuler la réservation de stock pour cette commande?"))
+      return;
+
+    try {
+      const res = await fetch(`/api/orders/${orderId}/ship`, {
+        method: "DELETE",
+      });
+
+      const data = await res.json();
+
+      if (res.ok) {
+        setOrders(
+          orders.map((o) =>
+            o.id === orderId
+              ? {
+                  ...o,
+                  status: "PENDING",
+                }
+              : o,
+          ),
+        );
+        alert(`✅ Réservation annulée`);
+      } else {
+        alert(`❌ Erreur: ${data.error}`);
+      }
+    } catch (error) {
+      console.error("Cancel reservation error:", error);
+      alert("Erreur lors de l'annulation");
+    }
+  };
+
+  const getStatusBadge = (status: string) => {
+    const badges: Record<
+      string,
+      { bg: string; text: string; icon: LucideIcon; label: string }
+    > = {
+      PENDING: {
+        bg: "bg-amber-50",
+        text: "text-amber-700",
+        icon: Clock,
+        label: "En attente",
+      },
+      CONFIRMED: {
+        bg: "bg-blue-50",
+        text: "text-blue-700",
+        icon: CheckCircle,
+        label: "Confirmée",
+      },
+      SHIPPED: {
+        bg: "bg-purple-50",
+        text: "text-purple-700",
+        icon: Truck,
+        label: "Expédiée",
+      },
+      DELIVERED: {
+        bg: "bg-emerald-50",
+        text: "text-emerald-700",
+        icon: CheckCircle,
+        label: "Livrée",
+      },
+      CANCELLED: {
+        bg: "bg-red-50",
+        text: "text-red-700",
+        icon: XCircle,
+        label: "Annulée",
+      },
+    };
+    const badge = badges[status] || badges.PENDING;
+    const Icon = badge.icon;
     return (
-        <div className="space-y-8">
-            <div className="flex flex-col sm:flex-row sm:items-end justify-between gap-4">
-                <div>
-                    <h1 className="text-3xl font-serif font-medium text-gray-900">Commandes</h1>
-                    <p className="text-gray-500 text-sm mt-1">{orders.length} commande{orders.length > 1 ? 's' : ''} au total</p>
-                </div>
-                <button
-                    onClick={handleSyncAll}
-                    disabled={syncingAll}
-                    className="inline-flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 text-sm font-medium shadow-sm"
-                >
-                    <RefreshCw size={16} className={syncingAll ? 'animate-spin' : ''} />
-                    {syncingAll ? 'Synchronisation...' : 'Sync Livraisons'}
-                </button>
-            </div>
-
-            {/* Stats Cards */}
-            <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
-                <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
-                    <p className="text-2xl font-bold text-gray-900">{orderStats.total}</p>
-                    <p className="text-xs text-gray-500 uppercase tracking-wider mt-1">Total</p>
-                </div>
-                <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
-                    <p className="text-2xl font-bold text-amber-600">{orderStats.pending}</p>
-                    <p className="text-xs text-gray-500 uppercase tracking-wider mt-1">En attente</p>
-                </div>
-                <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
-                    <p className="text-2xl font-bold text-blue-600">{orderStats.confirmed}</p>
-                    <p className="text-xs text-gray-500 uppercase tracking-wider mt-1">Confirmées</p>
-                </div>
-                <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
-                    <p className="text-2xl font-bold text-purple-600">{orderStats.shipped}</p>
-                    <p className="text-xs text-gray-500 uppercase tracking-wider mt-1">Expédiées</p>
-                </div>
-                <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
-                    <p className="text-2xl font-bold text-emerald-600">{orderStats.delivered}</p>
-                    <p className="text-xs text-gray-500 uppercase tracking-wider mt-1">Livrées</p>
-                </div>
-            </div>
-
-            {/* Search & Filters */}
-            <div className="bg-white rounded-xl shadow-sm border border-gray-100 p-1">
-                <div className="flex flex-col md:flex-row gap-2">
-                    <div className="relative flex-1">
-                        <Search size={16} className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" />
-                        <input
-                            type="text"
-                            placeholder="Rechercher par nom, téléphone ou ID..."
-                            value={searchTerm}
-                            onChange={(e) => setSearchTerm(e.target.value)}
-                            className="w-full pl-9 pr-4 py-2.5 bg-transparent text-sm outline-none"
-                        />
+      <span
+        className={cn(
+          "inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium",
+          badge.bg,
+          badge.text,
+        )}
+      >
+        <Icon size={12} />
+        {badge.label}
+      </span>
+    );
+  };
+
+  const statusFilters = [
+    { value: "ALL", label: "Toutes" },
+    { value: "PENDING", label: "En attente" },
+    { value: "CONFIRMED", label: "Confirmées" },
+    { value: "SHIPPED", label: "Expédiées" },
+    { value: "DELIVERED", label: "Livrées" },
+    { value: "CANCELLED", label: "Annulées" },
+  ];
+
+  const filteredOrders = orders.filter((order) => {
+    const matchesStatus =
+      statusFilter === "ALL" || order.status === statusFilter;
+    const matchesSearch =
+      searchTerm === "" ||
+      order.customerName?.toLowerCase().includes(searchTerm.toLowerCase()) ||
+      order.customerPhone?.includes(searchTerm) ||
+      order.id.toLowerCase().includes(searchTerm.toLowerCase());
+    return matchesStatus && matchesSearch;
+  });
+
+  const orderStats = {
+    total: orders.length,
+    pending: orders.filter((o) => o.status === "PENDING").length,
+    confirmed: orders.filter((o) => o.status === "CONFIRMED").length,
+    shipped: orders.filter((o) => o.status === "SHIPPED").length,
+    delivered: orders.filter((o) => o.status === "DELIVERED").length,
+  };
+
+  return (
+    <div className="space-y-8">
+      <div className="flex flex-col sm:flex-row sm:items-end justify-between gap-4">
+        <div>
+          <h1 className="text-3xl font-serif font-medium text-gray-900">
+            Commandes
+          </h1>
+          <p className="text-gray-500 text-sm mt-1">
+            {orders.length} commande{orders.length > 1 ? "s" : ""} au total
+          </p>
+        </div>
+        <button
+          onClick={handleSyncAll}
+          disabled={syncingAll}
+          className="inline-flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 text-sm font-medium shadow-sm"
+        >
+          <RefreshCw size={16} className={syncingAll ? "animate-spin" : ""} />
+          {syncingAll ? "Synchronisation..." : "Sync Livraisons"}
+        </button>
+      </div>
+
+      {/* Stats Cards */}
+      <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
+        <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
+          <p className="text-2xl font-bold text-gray-900">{orderStats.total}</p>
+          <p className="text-xs text-gray-500 uppercase tracking-wider mt-1">
+            Total
+          </p>
+        </div>
+        <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
+          <p className="text-2xl font-bold text-amber-600">
+            {orderStats.pending}
+          </p>
+          <p className="text-xs text-gray-500 uppercase tracking-wider mt-1">
+            En attente
+          </p>
+        </div>
+        <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
+          <p className="text-2xl font-bold text-blue-600">
+            {orderStats.confirmed}
+          </p>
+          <p className="text-xs text-gray-500 uppercase tracking-wider mt-1">
+            Confirmées
+          </p>
+        </div>
+        <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
+          <p className="text-2xl font-bold text-purple-600">
+            {orderStats.shipped}
+          </p>
+          <p className="text-xs text-gray-500 uppercase tracking-wider mt-1">
+            Expédiées
+          </p>
+        </div>
+        <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
+          <p className="text-2xl font-bold text-emerald-600">
+            {orderStats.delivered}
+          </p>
+          <p className="text-xs text-gray-500 uppercase tracking-wider mt-1">
+            Livrées
+          </p>
+        </div>
+      </div>
+
+      {/* Search & Filters */}
+      <div className="bg-white rounded-xl shadow-sm border border-gray-100 p-1">
+        <div className="flex flex-col md:flex-row gap-2">
+          <div className="relative flex-1">
+            <Search
+              size={16}
+              className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
+            />
+            <input
+              type="text"
+              placeholder="Rechercher par nom, téléphone ou ID..."
+              value={searchTerm}
+              onChange={(e) => setSearchTerm(e.target.value)}
+              className="w-full pl-9 pr-4 py-2.5 bg-transparent text-sm outline-none"
+            />
+          </div>
+          <div className="flex gap-1 overflow-x-auto pb-2 md:pb-0 p-1">
+            {statusFilters.map((filter) => (
+              <button
+                key={filter.value}
+                onClick={() => setStatusFilter(filter.value)}
+                className={cn(
+                  "px-3 py-1.5 rounded-lg text-xs font-medium whitespace-nowrap transition-all",
+                  statusFilter === filter.value
+                    ? "bg-gray-900 text-white"
+                    : "text-gray-600 hover:bg-gray-50",
+                )}
+              >
+                {filter.label}
+              </button>
+            ))}
+          </div>
+        </div>
+      </div>
+
+      {/* Orders Table */}
+      <div className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
+        <table className="w-full text-left">
+          <thead>
+            <tr className="border-b border-gray-100 text-xs uppercase tracking-widest text-gray-500 bg-gray-50/50">
+              <th className="py-4 px-6 font-medium">Commande</th>
+              <th className="py-4 px-6 font-medium">Client</th>
+              <th className="py-4 px-6 font-medium">Date</th>
+              <th className="py-4 px-6 font-medium">Total</th>
+              <th className="py-4 px-6 font-medium">Statut</th>
+              <th className="py-4 px-6 font-medium"></th>
+            </tr>
+          </thead>
+          <tbody className="text-sm divide-y divide-gray-50">
+            {loading ? (
+              <tr>
+                <td colSpan={6} className="py-12 text-center">
+                  <div className="flex flex-col items-center gap-3">
+                    <div className="w-6 h-6 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin" />
+                    <p className="text-gray-400 text-xs uppercase tracking-wider">
+                      Chargement...
+                    </p>
+                  </div>
+                </td>
+              </tr>
+            ) : filteredOrders.length === 0 ? (
+              <tr>
+                <td colSpan={6} className="py-16 text-center">
+                  <div className="flex flex-col items-center gap-3">
+                    <div className="w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center">
+                      <Package size={20} className="text-gray-400" />
                     </div>
-                    <div className="flex gap-1 overflow-x-auto pb-2 md:pb-0 p-1">
-                        {statusFilters.map((filter) => (
-                            <button
-                                key={filter.value}
-                                onClick={() => setStatusFilter(filter.value)}
-                                className={cn(
-                                    "px-3 py-1.5 rounded-lg text-xs font-medium whitespace-nowrap transition-all",
-                                    statusFilter === filter.value
-                                        ? "bg-gray-900 text-white"
-                                        : "text-gray-600 hover:bg-gray-50"
-                                )}
-                            >
-                                {filter.label}
-                            </button>
-                        ))}
+                    <div>
+                      <p className="text-gray-900 font-medium">
+                        Aucune commande trouvée
+                      </p>
+                      <p className="text-gray-400 text-xs mt-1">
+                        Essayez de modifier vos filtres de recherche
+                      </p>
                     </div>
-                </div>
-            </div>
-
-            {/* Orders Table */}
-            <div className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
-                <table className="w-full text-left">
-                    <thead>
-                        <tr className="border-b border-gray-100 text-xs uppercase tracking-widest text-gray-500 bg-gray-50/50">
-                            <th className="py-4 px-6 font-medium">Commande</th>
-                            <th className="py-4 px-6 font-medium">Client</th>
-                            <th className="py-4 px-6 font-medium">Date</th>
-                            <th className="py-4 px-6 font-medium">Total</th>
-                            <th className="py-4 px-6 font-medium">Statut</th>
-                            <th className="py-4 px-6 font-medium"></th>
-                        </tr>
-                    </thead>
-                    <tbody className="text-sm divide-y divide-gray-50">
-                        {loading ? (
-                            <tr>
-                                <td colSpan={6} className="py-12 text-center">
-                                    <div className="flex flex-col items-center gap-3">
-                                        <div className="w-6 h-6 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin" />
-                                        <p className="text-gray-400 text-xs uppercase tracking-wider">Chargement...</p>
+                  </div>
+                </td>
+              </tr>
+            ) : (
+              filteredOrders.map((order) => (
+                <React.Fragment key={order.id}>
+                  <tr
+                    className={cn(
+                      "hover:bg-gray-50/50 cursor-pointer transition-colors",
+                      expandedOrder === order.id ? "bg-gray-50/50" : "",
+                    )}
+                    onClick={() => toggleOrder(order.id)}
+                  >
+                    <td className="py-4 px-6">
+                      <span className="font-mono text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">
+                        #{order.id.slice(-8).toUpperCase()}
+                      </span>
+                    </td>
+                    <td className="py-4 px-6">
+                      <div>
+                        <p className="font-medium text-gray-900">
+                          {order.customerName}
+                        </p>
+                        <p className="text-xs text-gray-500">
+                          {order.customerPhone}
+                        </p>
+                      </div>
+                    </td>
+                    <td className="py-4 px-6 text-gray-500">
+                      {new Date(order.createdAt).toLocaleDateString("fr-FR", {
+                        day: "numeric",
+                        month: "short",
+                      })}
+                    </td>
+                    <td className="py-4 px-6 font-medium text-gray-900">
+                      {order.total?.toLocaleString()} DZD
+                    </td>
+                    <td className="py-4 px-6">
+                      {getStatusBadge(order.status)}
+                    </td>
+                    <td className="py-4 px-6 text-right text-gray-400">
+                      {expandedOrder === order.id ? (
+                        <ChevronUp size={16} />
+                      ) : (
+                        <ChevronDown size={16} />
+                      )}
+                    </td>
+                  </tr>
+                  {expandedOrder === order.id && (
+                    <tr className="bg-gray-50/30">
+                      <td colSpan={6} className="p-6">
+                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
+                          {/* Customer Info */}
+                          <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
+                            <h4 className="font-serif font-medium text-gray-900 mb-4 flex items-center gap-2">
+                              <Package size={16} className="text-gray-400" />
+                              Livraison
+                            </h4>
+                            <div className="space-y-3 text-sm">
+                              <div>
+                                <p className="text-gray-900 font-medium">
+                                  {order.customerAddress}
+                                </p>
+                                <p className="text-gray-500">
+                                  {order.customerCity}, Wilaya{" "}
+                                  {order.customerWilaya}
+                                </p>
+                              </div>
+                              <div className="pt-3 border-t border-gray-50">
+                                <div className="flex justify-between text-xs mb-1">
+                                  <span className="text-gray-500">
+                                    Transporteur
+                                  </span>
+                                  <span className="font-medium text-gray-900">
+                                    {order.deliveryProvider}
+                                  </span>
+                                </div>
+                                <div className="flex justify-between text-xs mb-1">
+                                  <span className="text-gray-500">Type</span>
+                                  <span className="font-medium text-gray-900">
+                                    {order.deliveryType === "HOME"
+                                      ? "Domicile"
+                                      : "Bureau"}
+                                  </span>
+                                </div>
+                                <div className="flex justify-between text-xs">
+                                  <span className="text-gray-500">Frais</span>
+                                  <span className="font-medium text-gray-900">
+                                    {order.shippingPrice} DZD
+                                  </span>
+                                </div>
+                              </div>
+                              {/* Tracking Info */}
+                              {order.trackingNumber && (
+                                <div className="pt-3 mt-3 border-t border-gray-50">
+                                  <div className="flex items-center justify-between">
+                                    <div>
+                                      <p className="text-xs text-gray-400 uppercase tracking-wider mb-1">
+                                        Tracking
+                                      </p>
+                                      <p className="font-mono text-sm font-medium text-gray-900 bg-gray-50 px-2 py-1 rounded inline-block">
+                                        {order.trackingNumber}
+                                      </p>
                                     </div>
-                                </td>
-                            </tr>
-                        ) : filteredOrders.length === 0 ? (
-                            <tr>
-                                <td colSpan={6} className="py-16 text-center">
-                                    <div className="flex flex-col items-center gap-3">
-                                        <div className="w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center">
-                                            <Package size={20} className="text-gray-400" />
-                                        </div>
-                                        <div>
-                                            <p className="text-gray-900 font-medium">Aucune commande trouvée</p>
-                                            <p className="text-gray-400 text-xs mt-1">
-                                                Essayez de modifier vos filtres de recherche
-                                            </p>
-                                        </div>
+                                    <div className="flex items-center gap-1">
+                                      <button
+                                        onClick={(e) => {
+                                          e.stopPropagation();
+                                          handleSyncOrder(order.id);
+                                        }}
+                                        disabled={syncingOrderId === order.id}
+                                        className="p-2 hover:bg-gray-50 rounded-lg transition-colors text-gray-400 hover:text-gray-900"
+                                        title="Actualiser"
+                                      >
+                                        <RefreshCw
+                                          size={14}
+                                          className={
+                                            syncingOrderId === order.id
+                                              ? "animate-spin"
+                                              : ""
+                                          }
+                                        />
+                                      </button>
+                                      <a
+                                        href={`/suivi?tracking=${order.trackingNumber}`}
+                                        target="_blank"
+                                        onClick={(e) => e.stopPropagation()}
+                                        className="p-2 hover:bg-gray-50 rounded-lg transition-colors text-gray-400 hover:text-gray-900"
+                                        title="Voir le suivi"
+                                      >
+                                        <ExternalLink size={14} />
+                                      </a>
                                     </div>
-                                </td>
-                            </tr>
-                        ) : (
-                            filteredOrders.map((order) => (
-                                <React.Fragment key={order.id}>
-                                    <tr
-                                        className={cn(
-                                            "hover:bg-gray-50/50 cursor-pointer transition-colors",
-                                            expandedOrder === order.id ? "bg-gray-50/50" : ""
-                                        )}
-                                        onClick={() => toggleOrder(order.id)}
+                                  </div>
+                                  {order.trackingStatus && (
+                                    <p className="text-xs text-emerald-600 mt-2 flex items-center gap-1.5 font-medium bg-emerald-50 px-2 py-1 rounded-md border border-emerald-100">
+                                      <Truck size={12} /> {order.trackingStatus}
+                                    </p>
+                                  )}
+                                </div>
+                              )}
+                            </div>
+                          </div>
+
+                          {/* Items */}
+                          <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
+                            <h4 className="font-serif font-medium text-gray-900 mb-4 flex items-center gap-2">
+                              <Package size={16} className="text-gray-400" />
+                              Articles ({order.items?.length || 0})
+                            </h4>
+                            <div className="space-y-3">
+                              {order.items?.map((item: any) => (
+                                <div
+                                  key={item.id}
+                                  className="flex justify-between text-sm group"
+                                >
+                                  <div>
+                                    <p className="font-medium text-gray-900">
+                                      {item.productName}
+                                    </p>
+                                    <p className="text-xs text-gray-500">
+                                      {item.size} • {item.color} • x
+                                      {item.quantity}
+                                    </p>
+                                  </div>
+                                  <span className="font-medium text-gray-900">
+                                    {(
+                                      item.price * item.quantity
+                                    ).toLocaleString()}{" "}
+                                    DZD
+                                  </span>
+                                </div>
+                              ))}
+                            </div>
+                            <div className="mt-4 pt-3 border-t border-gray-50 flex justify-between items-center">
+                              <span className="text-sm text-gray-500">
+                                Total
+                              </span>
+                              <span className="text-lg font-serif font-bold text-gray-900">
+                                {order.total?.toLocaleString()} DZD
+                              </span>
+                            </div>
+                          </div>
+
+                          {/* Status Update */}
+                          <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
+                            <h4 className="font-serif font-medium text-gray-900 mb-4 flex items-center gap-2">
+                              <RefreshCw size={16} className="text-gray-400" />
+                              Mise à jour
+                            </h4>
+                            <div className="space-y-4">
+                              <div>
+                                <label className="block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2">
+                                  Statut
+                                </label>
+                                <select
+                                  value={order.status}
+                                  onChange={(e) => {
+                                    e.stopPropagation();
+                                    handleStatusUpdate(
+                                      order.id,
+                                      e.target.value,
+                                    );
+                                  }}
+                                  onClick={(e) => e.stopPropagation()}
+                                  className="w-full border border-gray-200 p-2.5 rounded-lg text-sm focus:border-gray-900 outline-none bg-white transition-colors"
+                                >
+                                  <option value="PENDING">En attente</option>
+                                  <option value="CONFIRMED">Confirmée</option>
+                                  <option value="SHIPPED">Expédiée</option>
+                                  <option value="DELIVERED">Livrée</option>
+                                  <option value="CANCELLED">Annulée</option>
+                                </select>
+                              </div>
+
+                              {/* Stock Actions */}
+                              <div className="pt-4 border-t border-gray-50">
+                                <label className="block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2">
+                                  Actions Stock
+                                </label>
+                                <div className="space-y-2">
+                                  {order.status === "PENDING" && (
+                                    <button
+                                      onClick={(e) => {
+                                        e.stopPropagation();
+                                        handleReserveStock(order.id);
+                                      }}
+                                      disabled={reservingOrderId === order.id}
+                                      className="w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-50 text-blue-700 border border-blue-100 rounded-lg hover:bg-blue-100 disabled:opacity-50 transition-all text-sm font-medium"
                                     >
-                                        <td className="py-4 px-6">
-                                            <span className="font-mono text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">
-                                                #{order.id.slice(-8).toUpperCase()}
-                                            </span>
-                                        </td>
-                                        <td className="py-4 px-6">
-                                            <div>
-                                                <p className="font-medium text-gray-900">{order.customerName}</p>
-                                                <p className="text-xs text-gray-500">{order.customerPhone}</p>
-                                            </div>
-                                        </td>
-                                        <td className="py-4 px-6 text-gray-500">
-                                            {new Date(order.createdAt).toLocaleDateString('fr-FR', {
-                                                day: 'numeric',
-                                                month: 'short'
-                                            })}
-                                        </td>
-                                        <td className="py-4 px-6 font-medium text-gray-900">
-                                            {order.total?.toLocaleString()} DZD
-                                        </td>
-                                        <td className="py-4 px-6">
-                                            {getStatusBadge(order.status)}
-                                        </td>
-                                        <td className="py-4 px-6 text-right text-gray-400">
-                                            {expandedOrder === order.id ? <ChevronUp size={16} /> : <ChevronDown size={16} />}
-                                        </td>
-                                    </tr>
-                                    {expandedOrder === order.id && (
-                                        <tr className="bg-gray-50/30">
-                                            <td colSpan={6} className="p-6">
-                                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
-                                                    {/* Customer Info */}
-                                                    <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
-                                                        <h4 className="font-serif font-medium text-gray-900 mb-4 flex items-center gap-2">
-                                                            <Package size={16} className="text-gray-400" />
-                                                            Livraison
-                                                        </h4>
-                                                        <div className="space-y-3 text-sm">
-                                                            <div>
-                                                                <p className="text-gray-900 font-medium">{order.customerAddress}</p>
-                                                                <p className="text-gray-500">{order.customerCity}, Wilaya {order.customerWilaya}</p>
-                                                            </div>
-                                                            <div className="pt-3 border-t border-gray-50">
-                                                                <div className="flex justify-between text-xs mb-1">
-                                                                    <span className="text-gray-500">Transporteur</span>
-                                                                    <span className="font-medium text-gray-900">{order.deliveryProvider}</span>
-                                                                </div>
-                                                                <div className="flex justify-between text-xs mb-1">
-                                                                    <span className="text-gray-500">Type</span>
-                                                                    <span className="font-medium text-gray-900">{order.deliveryType === "HOME" ? "Domicile" : "Bureau"}</span>
-                                                                </div>
-                                                                <div className="flex justify-between text-xs">
-                                                                    <span className="text-gray-500">Frais</span>
-                                                                    <span className="font-medium text-gray-900">{order.shippingPrice} DZD</span>
-                                                                </div>
-                                                            </div>
-                                                            {/* Tracking Info */}
-                                                            {order.trackingNumber && (
-                                                                <div className="pt-3 mt-3 border-t border-gray-50">
-                                                                    <div className="flex items-center justify-between">
-                                                                        <div>
-                                                                            <p className="text-xs text-gray-400 uppercase tracking-wider mb-1">Tracking</p>
-                                                                            <p className="font-mono text-sm font-medium text-gray-900 bg-gray-50 px-2 py-1 rounded inline-block">{order.trackingNumber}</p>
-                                                                        </div>
-                                                                        <div className="flex items-center gap-1">
-                                                                            <button
-                                                                                onClick={(e) => {
-                                                                                    e.stopPropagation();
-                                                                                    handleSyncOrder(order.id);
-                                                                                }}
-                                                                                disabled={syncingOrderId === order.id}
-                                                                                className="p-2 hover:bg-gray-50 rounded-lg transition-colors text-gray-400 hover:text-gray-900"
-                                                                                title="Actualiser"
-                                                                            >
-                                                                                <RefreshCw size={14} className={syncingOrderId === order.id ? 'animate-spin' : ''} />
-                                                                            </button>
-                                                                            <a
-                                                                                href={`/suivi?tracking=${order.trackingNumber}`}
-                                                                                target="_blank"
-                                                                                onClick={(e) => e.stopPropagation()}
-                                                                                className="p-2 hover:bg-gray-50 rounded-lg transition-colors text-gray-400 hover:text-gray-900"
-                                                                                title="Voir le suivi"
-                                                                            >
-                                                                                <ExternalLink size={14} />
-                                                                            </a>
-                                                                        </div>
-                                                                    </div>
-                                                                    {order.trackingStatus && (
-                                                                        <p className="text-xs text-emerald-600 mt-2 flex items-center gap-1.5 font-medium bg-emerald-50 px-2 py-1 rounded-md border border-emerald-100">
-                                                                            <Truck size={12} /> {order.trackingStatus}
-                                                                        </p>
-                                                                    )}
-                                                                </div>
-                                                            )}
-                                                        </div>
-                                                    </div>
-
-                                                    {/* Items */}
-                                                    <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
-                                                        <h4 className="font-serif font-medium text-gray-900 mb-4 flex items-center gap-2">
-                                                            <Package size={16} className="text-gray-400" />
-                                                            Articles ({order.items?.length || 0})
-                                                        </h4>
-                                                        <div className="space-y-3">
-                                                            {order.items?.map((item: any) => (
-                                                                <div key={item.id} className="flex justify-between text-sm group">
-                                                                    <div>
-                                                                        <p className="font-medium text-gray-900">{item.productName}</p>
-                                                                        <p className="text-xs text-gray-500">{item.size} • {item.color} • x{item.quantity}</p>
-                                                                    </div>
-                                                                    <span className="font-medium text-gray-900">{(item.price * item.quantity).toLocaleString()} DZD</span>
-                                                                </div>
-                                                            ))}
-                                                        </div>
-                                                        <div className="mt-4 pt-3 border-t border-gray-50 flex justify-between items-center">
-                                                            <span className="text-sm text-gray-500">Total</span>
-                                                            <span className="text-lg font-serif font-bold text-gray-900">{order.total?.toLocaleString()} DZD</span>
-                                                        </div>
-                                                    </div>
-
-                                                    {/* Status Update */}
-                                                    <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
-                                                        <h4 className="font-serif font-medium text-gray-900 mb-4 flex items-center gap-2">
-                                                            <RefreshCw size={16} className="text-gray-400" />
-                                                            Mise à jour
-                                                        </h4>
-                                                        <div className="space-y-4">
-                                                            <div>
-                                                                <label className="block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2">Statut</label>
-                                                                <select
-                                                                    value={order.status}
-                                                                    onChange={(e) => {
-                                                                        e.stopPropagation();
-                                                                        handleStatusUpdate(order.id, e.target.value);
-                                                                    }}
-                                                                    onClick={(e) => e.stopPropagation()}
-                                                                    className="w-full border border-gray-200 p-2.5 rounded-lg text-sm focus:border-gray-900 outline-none bg-white transition-colors"
-                                                                >
-                                                                    <option value="PENDING">En attente</option>
-                                                                    <option value="CONFIRMED">Confirmée</option>
-                                                                    <option value="SHIPPED">Expédiée</option>
-                                                                    <option value="DELIVERED">Livrée</option>
-                                                                    <option value="CANCELLED">Annulée</option>
-                                                                </select>
-                                                            </div>
-
-                                                            {/* Stock Actions */}
-                                                            <div className="pt-4 border-t border-gray-50">
-                                                                <label className="block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2">Actions Stock</label>
-                                                                <div className="space-y-2">
-                                                                    {order.status === 'PENDING' && (
-                                                                        <button
-                                                                            onClick={(e) => {
-                                                                                e.stopPropagation();
-                                                                                handleReserveStock(order.id);
-                                                                            }}
-                                                                            disabled={reservingOrderId === order.id}
-                                                                            className="w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-50 text-blue-700 border border-blue-100 rounded-lg hover:bg-blue-100 disabled:opacity-50 transition-all text-sm font-medium"
-                                                                        >
-                                                                            <Lock size={14} className={reservingOrderId === order.id ? 'animate-pulse' : ''} />
-                                                                            {reservingOrderId === order.id ? 'Réservation...' : 'Réserver le stock'}
-                                                                        </button>
-                                                                    )}
-                                                                    
-                                                                    {order.status === 'CONFIRMED' && (
-                                                                        <>
-                                                                            <button
-                                                                                onClick={(e) => {
-                                                                                    e.stopPropagation();
-                                                                                    handleShipOrder(order.id);
-                                                                                }}
-                                                                                disabled={shippingOrderId === order.id}
-                                                                                className="w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-emerald-50 text-emerald-700 border border-emerald-100 rounded-lg hover:bg-emerald-100 disabled:opacity-50 transition-all text-sm font-medium"
-                                                                            >
-                                                                                <Send size={14} className={shippingOrderId === order.id ? 'animate-pulse' : ''} />
-                                                                                {shippingOrderId === order.id ? 'Expédition...' : 'Expédier (consommer stock)'}
-                                                                            </button>
-                                                                            <button
-                                                                                onClick={(e) => {
-                                                                                    e.stopPropagation();
-                                                                                    handleCancelReservation(order.id);
-                                                                                }}
-                                                                                className="w-full flex items-center justify-center gap-2 px-4 py-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors text-sm"
-                                                                            >
-                                                                                <Unlock size={14} />
-                                                                                Annuler réservation
-                                                                            </button>
-                                                                        </>
-                                                                    )}
-                                                                </div>
-                                                            </div>
-
-                                                            <div className="pt-3 border-t border-gray-50">
-                                                                <div className="flex justify-between text-sm">
-                                                                    <span className="text-gray-500">Sous-total</span>
-                                                                    <span>{(order.total - (order.shippingPrice || 0)).toLocaleString()} DZD</span>
-                                                                </div>
-                                                                <div className="flex justify-between text-sm mt-1">
-                                                                    <span className="text-gray-500">Livraison</span>
-                                                                    <span>{order.shippingPrice?.toLocaleString()} DZD</span>
-                                                                </div>
-                                                                <div className="flex justify-between font-serif font-bold text-lg mt-3 pt-3 border-t border-gray-50 text-gray-900">
-                                                                    <span>Total</span>
-                                                                    <span>{order.total?.toLocaleString()} DZD</span>
-                                                                </div>
-                                                            </div>
-                                                        </div>
-                                                    </div>
-                                                </div>
-                                            </td>
-                                        </tr>
-                                    )}
-                                </React.Fragment>
-                            ))
-                        )}
-                    </tbody>
-                </table>
-            </div>
-        </div>
-    );
+                                      <Lock
+                                        size={14}
+                                        className={
+                                          reservingOrderId === order.id
+                                            ? "animate-pulse"
+                                            : ""
+                                        }
+                                      />
+                                      {reservingOrderId === order.id
+                                        ? "Réservation..."
+                                        : "Réserver le stock"}
+                                    </button>
+                                  )}
+
+                                  {order.status === "CONFIRMED" && (
+                                    <>
+                                      <button
+                                        onClick={(e) => {
+                                          e.stopPropagation();
+                                          handleShipOrder(order.id);
+                                        }}
+                                        disabled={shippingOrderId === order.id}
+                                        className="w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-emerald-50 text-emerald-700 border border-emerald-100 rounded-lg hover:bg-emerald-100 disabled:opacity-50 transition-all text-sm font-medium"
+                                      >
+                                        <Send
+                                          size={14}
+                                          className={
+                                            shippingOrderId === order.id
+                                              ? "animate-pulse"
+                                              : ""
+                                          }
+                                        />
+                                        {shippingOrderId === order.id
+                                          ? "Expédition..."
+                                          : "Expédier (consommer stock)"}
+                                      </button>
+                                      <button
+                                        onClick={(e) => {
+                                          e.stopPropagation();
+                                          handleCancelReservation(order.id);
+                                        }}
+                                        className="w-full flex items-center justify-center gap-2 px-4 py-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors text-sm"
+                                      >
+                                        <Unlock size={14} />
+                                        Annuler réservation
+                                      </button>
+                                    </>
+                                  )}
+                                </div>
+                              </div>
+
+                              <div className="pt-3 border-t border-gray-50">
+                                <div className="flex justify-between text-sm">
+                                  <span className="text-gray-500">
+                                    Sous-total
+                                  </span>
+                                  <span>
+                                    {(
+                                      order.total - (order.shippingPrice || 0)
+                                    ).toLocaleString()}{" "}
+                                    DZD
+                                  </span>
+                                </div>
+                                <div className="flex justify-between text-sm mt-1">
+                                  <span className="text-gray-500">
+                                    Livraison
+                                  </span>
+                                  <span>
+                                    {order.shippingPrice?.toLocaleString()} DZD
+                                  </span>
+                                </div>
+                                <div className="flex justify-between font-serif font-bold text-lg mt-3 pt-3 border-t border-gray-50 text-gray-900">
+                                  <span>Total</span>
+                                  <span>
+                                    {order.total?.toLocaleString()} DZD
+                                  </span>
+                                </div>
+                              </div>
+                            </div>
+                          </div>
+                        </div>
+                      </td>
+                    </tr>
+                  )}
+                </React.Fragment>
+              ))
+            )}
+          </tbody>
+        </table>
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/admin/page.tsx b/src/app/admin/page.tsx
index f303dc3..627f53a 100644
--- a/src/app/admin/page.tsx
+++ b/src/app/admin/page.tsx
@@ -2,430 +2,592 @@
 
 import { useState, useEffect } from "react";
 import Link from "next/link";
-import { 
-    ShoppingBag, 
-    Package, 
-    DollarSign, 
-    ArrowUpRight,
-    Clock,
-    CheckCircle,
-    Truck,
-    XCircle,
-    Plus,
-    Eye,
-    BarChart3,
-    FolderOpen,
-    RefreshCw,
-    MoreHorizontal
+import {
+  ShoppingBag,
+  Package,
+  DollarSign,
+  ArrowUpRight,
+  Clock,
+  CheckCircle,
+  Truck,
+  XCircle,
+  Plus,
+  Eye,
+  BarChart3,
+  FolderOpen,
+  RefreshCw,
+  MoreHorizontal,
 } from "lucide-react";
 import { cn } from "@/lib/utils";
 
 interface DashboardStats {
-    totalOrders: number;
-    pendingOrders: number;
-    confirmedOrders: number;
-    shippedOrders: number;
-    deliveredOrders: number;
-    totalProducts: number;
-    lowStockProducts: number;
-    totalRevenue: number;
-    recentOrders: any[];
-    topProducts: any[];
+  totalOrders: number;
+  pendingOrders: number;
+  confirmedOrders: number;
+  shippedOrders: number;
+  deliveredOrders: number;
+  totalProducts: number;
+  lowStockProducts: number;
+  totalRevenue: number;
+  recentOrders: any[];
+  topProducts: any[];
 }
 
 export default function AdminDashboard() {
-    const [stats, setStats] = useState<DashboardStats>({
-        totalOrders: 0,
-        pendingOrders: 0,
-        confirmedOrders: 0,
-        shippedOrders: 0,
-        deliveredOrders: 0,
-        totalProducts: 0,
-        lowStockProducts: 0,
-        totalRevenue: 0,
-        recentOrders: [],
-        topProducts: []
-    });
-    const [loading, setLoading] = useState(true);
-    const [refreshing, setRefreshing] = useState(false);
+  const [stats, setStats] = useState<DashboardStats>({
+    totalOrders: 0,
+    pendingOrders: 0,
+    confirmedOrders: 0,
+    shippedOrders: 0,
+    deliveredOrders: 0,
+    totalProducts: 0,
+    lowStockProducts: 0,
+    totalRevenue: 0,
+    recentOrders: [],
+    topProducts: [],
+  });
+  const [loading, setLoading] = useState(true);
+  const [refreshing, setRefreshing] = useState(false);
 
-    const fetchDashboardData = async (isRefresh = false) => {
-        if (isRefresh) setRefreshing(true);
-        try {
-            const [ordersRes, productsRes] = await Promise.all([
-                fetch("/api/orders?pageSize=100"),
-                fetch("/api/products?pageSize=100")
-            ]);
+  const fetchDashboardData = async (isRefresh = false) => {
+    if (isRefresh) setRefreshing(true);
+    try {
+      const [ordersRes, productsRes] = await Promise.all([
+        fetch("/api/orders?pageSize=100"),
+        fetch("/api/products?pageSize=100"),
+      ]);
 
-            const ordersData = await ordersRes.json();
-            const productsData = await productsRes.json();
+      const ordersData = await ordersRes.json();
+      const productsData = await productsRes.json();
 
-            // Handle paginated response format { items, meta }
-            const ordersArray = Array.isArray(ordersData) ? ordersData : (ordersData.items || []);
-            const productsArray = Array.isArray(productsData) ? productsData : (productsData.items || []);
+      // Handle paginated response format { items, meta }
+      const ordersArray = Array.isArray(ordersData)
+        ? ordersData
+        : ordersData.items || [];
+      const productsArray = Array.isArray(productsData)
+        ? productsData
+        : productsData.items || [];
 
-            const pendingOrders = ordersArray.filter((o: any) => o.status === "PENDING").length;
-            const confirmedOrders = ordersArray.filter((o: any) => o.status === "CONFIRMED").length;
-            const shippedOrders = ordersArray.filter((o: any) => o.status === "SHIPPED").length;
-            const deliveredOrders = ordersArray.filter((o: any) => o.status === "DELIVERED").length;
-            const lowStockProducts = productsArray.filter((p: any) => (p.stock || 0) < 5).length;
-            const totalRevenue = ordersArray
-                .filter((o: any) => o.status !== "CANCELLED")
-                .reduce((acc: number, o: any) => acc + (o.total || 0), 0);
+      const pendingOrders = ordersArray.filter(
+        (o: any) => o.status === "PENDING",
+      ).length;
+      const confirmedOrders = ordersArray.filter(
+        (o: any) => o.status === "CONFIRMED",
+      ).length;
+      const shippedOrders = ordersArray.filter(
+        (o: any) => o.status === "SHIPPED",
+      ).length;
+      const deliveredOrders = ordersArray.filter(
+        (o: any) => o.status === "DELIVERED",
+      ).length;
+      const lowStockProducts = productsArray.filter(
+        (p: any) => (p.stock || 0) < 5,
+      ).length;
+      const totalRevenue = ordersArray
+        .filter((o: any) => o.status !== "CANCELLED")
+        .reduce((acc: number, o: any) => acc + (o.total || 0), 0);
 
-            setStats({
-                totalOrders: ordersArray.length,
-                pendingOrders,
-                confirmedOrders,
-                shippedOrders,
-                deliveredOrders,
-                totalProducts: productsArray.length,
-                lowStockProducts,
-                totalRevenue,
-                recentOrders: ordersArray.slice(0, 5),
-                topProducts: productsArray.slice(0, 4)
-            });
-        } catch (error) {
-            console.error("Error fetching dashboard data:", error);
-        } finally {
-            setLoading(false);
-            setRefreshing(false);
-        }
-    };
+      setStats({
+        totalOrders: ordersArray.length,
+        pendingOrders,
+        confirmedOrders,
+        shippedOrders,
+        deliveredOrders,
+        totalProducts: productsArray.length,
+        lowStockProducts,
+        totalRevenue,
+        recentOrders: ordersArray.slice(0, 5),
+        topProducts: productsArray.slice(0, 4),
+      });
+    } catch (error) {
+      console.error("Error fetching dashboard data:", error);
+    } finally {
+      setLoading(false);
+      setRefreshing(false);
+    }
+  };
 
-    useEffect(() => {
-        fetchDashboardData();
-    }, []);
+  useEffect(() => {
+    fetchDashboardData();
+  }, []);
 
-    const getGreeting = () => {
-        const hour = new Date().getHours();
-        if (hour < 12) return "Bonjour";
-        if (hour < 18) return "Bon après-midi";
-        return "Bonsoir";
-    };
+  const getGreeting = () => {
+    const hour = new Date().getHours();
+    if (hour < 12) return "Bonjour";
+    if (hour < 18) return "Bon après-midi";
+    return "Bonsoir";
+  };
 
-    const getStatusBadge = (status: string) => {
-        const badges: Record<string, { bg: string; text: string; icon: any; label: string }> = {
-            PENDING: { bg: "bg-amber-50", text: "text-amber-700", icon: Clock, label: "En attente" },
-            CONFIRMED: { bg: "bg-blue-50", text: "text-blue-700", icon: CheckCircle, label: "Confirmée" },
-            SHIPPED: { bg: "bg-purple-50", text: "text-purple-700", icon: Truck, label: "Expédiée" },
-            DELIVERED: { bg: "bg-emerald-50", text: "text-emerald-700", icon: CheckCircle, label: "Livrée" },
-            CANCELLED: { bg: "bg-red-50", text: "text-red-700", icon: XCircle, label: "Annulée" }
-        };
-        const badge = badges[status] || badges.PENDING;
-        return (
-            <span className={cn("inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium", badge.bg, badge.text)}>
-                <badge.icon size={12} />
-                {badge.label}
-            </span>
-        );
+  const getStatusBadge = (status: string) => {
+    const badges: Record<
+      string,
+      { bg: string; text: string; icon: any; label: string }
+    > = {
+      PENDING: {
+        bg: "bg-amber-50",
+        text: "text-amber-700",
+        icon: Clock,
+        label: "En attente",
+      },
+      CONFIRMED: {
+        bg: "bg-blue-50",
+        text: "text-blue-700",
+        icon: CheckCircle,
+        label: "Confirmée",
+      },
+      SHIPPED: {
+        bg: "bg-purple-50",
+        text: "text-purple-700",
+        icon: Truck,
+        label: "Expédiée",
+      },
+      DELIVERED: {
+        bg: "bg-emerald-50",
+        text: "text-emerald-700",
+        icon: CheckCircle,
+        label: "Livrée",
+      },
+      CANCELLED: {
+        bg: "bg-red-50",
+        text: "text-red-700",
+        icon: XCircle,
+        label: "Annulée",
+      },
     };
+    const badge = badges[status] || badges.PENDING;
+    return (
+      <span
+        className={cn(
+          "inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium",
+          badge.bg,
+          badge.text,
+        )}
+      >
+        <badge.icon size={12} />
+        {badge.label}
+      </span>
+    );
+  };
 
-    if (loading) {
-        return (
-            <div className="animate-pulse space-y-8">
-                <div className="h-12 bg-gray-50 rounded-xl w-1/3"></div>
-                <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
-                    {[1, 2, 3, 4].map((i) => (
-                        <div key={i} className="bg-gray-50 rounded-xl h-32" />
-                    ))}
-                </div>
-                <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
-                    <div className="lg:col-span-2 bg-gray-50 rounded-xl h-96" />
-                    <div className="bg-gray-50 rounded-xl h-96" />
-                </div>
-            </div>
-        );
-    }
-
+  if (loading) {
     return (
-        <div className="space-y-10">
-            {/* Header */}
-            <div className="flex flex-col md:flex-row md:items-end justify-between gap-4">
-                <div>
-                    <p className="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">
-                        {new Date().toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' })}
-                    </p>
-                    <h1 className="text-3xl font-serif font-medium text-gray-900">{getGreeting()}, Admin</h1>
-                </div>
-                <div className="flex items-center gap-3">
-                    <button
-                        onClick={() => fetchDashboardData(true)}
-                        disabled={refreshing}
-                        className="p-2.5 text-gray-400 hover:text-gray-900 bg-white border border-gray-200 hover:border-gray-300 rounded-lg transition-all"
+      <div className="animate-pulse space-y-8">
+        <div className="h-12 bg-gray-50 rounded-xl w-1/3"></div>
+        <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
+          {[1, 2, 3, 4].map((i) => (
+            <div key={i} className="bg-gray-50 rounded-xl h-32" />
+          ))}
+        </div>
+        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
+          <div className="lg:col-span-2 bg-gray-50 rounded-xl h-96" />
+          <div className="bg-gray-50 rounded-xl h-96" />
+        </div>
+      </div>
+    );
+  }
+
+  return (
+    <div className="space-y-10">
+      {/* Header */}
+      <div className="flex flex-col md:flex-row md:items-end justify-between gap-4">
+        <div>
+          <p className="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">
+            {new Date().toLocaleDateString("fr-FR", {
+              weekday: "long",
+              day: "numeric",
+              month: "long",
+            })}
+          </p>
+          <h1 className="text-3xl font-serif font-medium text-gray-900">
+            {getGreeting()}, Admin
+          </h1>
+        </div>
+        <div className="flex items-center gap-3">
+          <button
+            onClick={() => fetchDashboardData(true)}
+            disabled={refreshing}
+            className="p-2.5 text-gray-400 hover:text-gray-900 bg-white border border-gray-200 hover:border-gray-300 rounded-lg transition-all"
+          >
+            <RefreshCw size={18} className={refreshing ? "animate-spin" : ""} />
+          </button>
+          <Link
+            href="/admin/products/new"
+            className="inline-flex items-center gap-2 bg-gray-900 text-white px-5 py-2.5 rounded-lg hover:bg-gray-800 transition-all text-sm font-medium shadow-sm"
+          >
+            <Plus size={18} />
+            Nouveau produit
+          </Link>
+        </div>
+      </div>
+
+      {/* KPI Cards */}
+      <div className="grid grid-cols-2 lg:grid-cols-4 gap-6">
+        <KpiCard
+          label="Revenu Total"
+          value={`${stats.totalRevenue.toLocaleString()} DZD`}
+          icon={DollarSign}
+          color="emerald"
+          trend="+12% vs mois dernier"
+        />
+        <KpiCard
+          label="Commandes"
+          value={stats.totalOrders.toString()}
+          icon={ShoppingBag}
+          color="blue"
+          badge={
+            stats.pendingOrders > 0
+              ? `${stats.pendingOrders} en attente`
+              : undefined
+          }
+        />
+        <KpiCard
+          label="Produits"
+          value={stats.totalProducts.toString()}
+          icon={Package}
+          color="purple"
+          alert={
+            stats.lowStockProducts > 0
+              ? `${stats.lowStockProducts} stock bas`
+              : undefined
+          }
+        />
+        <KpiCard
+          label="Livrées"
+          value={stats.deliveredOrders.toString()}
+          icon={CheckCircle}
+          color="gray"
+          sub="Commandes finalisées"
+        />
+      </div>
+
+      {/* Order Pipeline */}
+      <div className="bg-white rounded-xl border border-gray-100 p-8 shadow-sm">
+        <div className="flex items-center justify-between mb-8">
+          <h3 className="font-serif font-medium text-xl text-gray-900">
+            Pipeline des commandes
+          </h3>
+          <Link
+            href="/admin/orders"
+            className="text-sm text-gray-400 hover:text-gray-900 flex items-center gap-1 transition-colors"
+          >
+            Voir détails <ArrowUpRight size={14} />
+          </Link>
+        </div>
+        <div className="grid grid-cols-2 md:grid-cols-4 gap-6">
+          <PipelineStep
+            label="En attente"
+            count={stats.pendingOrders}
+            color="amber"
+            icon={Clock}
+          />
+          <PipelineStep
+            label="Confirmées"
+            count={stats.confirmedOrders}
+            color="blue"
+            icon={CheckCircle}
+          />
+          <PipelineStep
+            label="Expédiées"
+            count={stats.shippedOrders}
+            color="purple"
+            icon={Truck}
+          />
+          <PipelineStep
+            label="Livrées"
+            count={stats.deliveredOrders}
+            color="emerald"
+            icon={CheckCircle}
+            isLast
+          />
+        </div>
+      </div>
+
+      {/* Main Content Grid */}
+      <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
+        {/* Recent Orders Table */}
+        <div className="lg:col-span-2 space-y-6">
+          <div className="flex items-center justify-between">
+            <h3 className="font-serif font-medium text-xl text-gray-900">
+              Commandes récentes
+            </h3>
+          </div>
+
+          <div className="bg-white rounded-xl border border-gray-100 overflow-hidden shadow-sm">
+            <table className="w-full text-left">
+              <thead>
+                <tr className="border-b border-gray-100 bg-gray-50/50 text-xs uppercase tracking-widest text-gray-500">
+                  <th className="py-4 px-6 font-medium">Réf</th>
+                  <th className="py-4 px-6 font-medium">Client</th>
+                  <th className="py-4 px-6 font-medium">Montant</th>
+                  <th className="py-4 px-6 font-medium">Statut</th>
+                  <th className="py-4 px-6 font-medium text-right"></th>
+                </tr>
+              </thead>
+              <tbody className="divide-y divide-gray-50">
+                {stats.recentOrders.length === 0 ? (
+                  <tr>
+                    <td
+                      colSpan={5}
+                      className="py-12 text-center text-gray-400 text-sm"
                     >
-                        <RefreshCw size={18} className={refreshing ? 'animate-spin' : ''} />
-                    </button>
-                    <Link
-                        href="/admin/products/new"
-                        className="inline-flex items-center gap-2 bg-gray-900 text-white px-5 py-2.5 rounded-lg hover:bg-gray-800 transition-all text-sm font-medium shadow-sm"
+                      Aucune commande récente
+                    </td>
+                  </tr>
+                ) : (
+                  stats.recentOrders.map((order) => (
+                    <tr
+                      key={order.id}
+                      className="hover:bg-gray-50/50 transition-colors group"
                     >
-                        <Plus size={18} />
-                        Nouveau produit
-                    </Link>
-                </div>
-            </div>
-
-            {/* KPI Cards */}
-            <div className="grid grid-cols-2 lg:grid-cols-4 gap-6">
-                <KpiCard 
-                    label="Revenu Total" 
-                    value={`${stats.totalRevenue.toLocaleString()} DZD`}
-                    icon={DollarSign}
-                    color="emerald"
-                    trend="+12% vs mois dernier"
-                />
-                <KpiCard 
-                    label="Commandes" 
-                    value={stats.totalOrders.toString()}
-                    icon={ShoppingBag}
-                    color="blue"
-                    badge={stats.pendingOrders > 0 ? `${stats.pendingOrders} en attente` : undefined}
-                />
-                <KpiCard 
-                    label="Produits" 
-                    value={stats.totalProducts.toString()}
-                    icon={Package}
-                    color="purple"
-                    alert={stats.lowStockProducts > 0 ? `${stats.lowStockProducts} stock bas` : undefined}
-                />
-                <KpiCard 
-                    label="Livrées" 
-                    value={stats.deliveredOrders.toString()}
-                    icon={CheckCircle}
-                    color="gray"
-                    sub="Commandes finalisées"
-                />
-            </div>
+                      <td className="py-4 px-6">
+                        <span className="font-mono text-xs text-gray-500">
+                          #{order.id.slice(-6).toUpperCase()}
+                        </span>
+                      </td>
+                      <td className="py-4 px-6">
+                        <div className="flex flex-col">
+                          <span className="text-sm font-medium text-gray-900">
+                            {order.customerName}
+                          </span>
+                          <span className="text-xs text-gray-400">
+                            {new Date(order.createdAt).toLocaleDateString()}
+                          </span>
+                        </div>
+                      </td>
+                      <td className="py-4 px-6 text-sm font-medium text-gray-900">
+                        {order.total?.toLocaleString()} DZD
+                      </td>
+                      <td className="py-4 px-6">
+                        {getStatusBadge(order.status)}
+                      </td>
+                      <td className="py-4 px-6 text-right">
+                        <Link
+                          href={`/admin/orders`}
+                          className="text-gray-300 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 inline-flex transition-all"
+                        >
+                          <ArrowUpRight size={18} />
+                        </Link>
+                      </td>
+                    </tr>
+                  ))
+                )}
+              </tbody>
+            </table>
+          </div>
+        </div>
 
-            {/* Order Pipeline */}
-            <div className="bg-white rounded-xl border border-gray-100 p-8 shadow-sm">
-                <div className="flex items-center justify-between mb-8">
-                    <h3 className="font-serif font-medium text-xl text-gray-900">Pipeline des commandes</h3>
-                    <Link href="/admin/orders" className="text-sm text-gray-400 hover:text-gray-900 flex items-center gap-1 transition-colors">
-                        Voir détails <ArrowUpRight size={14} />
-                    </Link>
+        {/* Side Column */}
+        <div className="space-y-8">
+          {/* Quick Actions */}
+          <div className="space-y-6">
+            <h3 className="font-serif font-medium text-xl text-gray-900">
+              Actions rapides
+            </h3>
+            <div className="bg-white rounded-xl border border-gray-100 p-6 shadow-sm space-y-3">
+              <Link
+                href="/admin/products/new"
+                className="flex items-center gap-4 p-3 rounded-xl hover:bg-gray-50 transition-colors group"
+              >
+                <div className="p-2.5 bg-gray-100 text-gray-500 rounded-lg group-hover:bg-gray-900 group-hover:text-white transition-colors">
+                  <Plus size={20} />
                 </div>
-                <div className="grid grid-cols-2 md:grid-cols-4 gap-6">
-                    <PipelineStep 
-                        label="En attente" 
-                        count={stats.pendingOrders} 
-                        color="amber" 
-                        icon={Clock} 
-                    />
-                    <PipelineStep 
-                        label="Confirmées" 
-                        count={stats.confirmedOrders} 
-                        color="blue" 
-                        icon={CheckCircle} 
-                    />
-                    <PipelineStep 
-                        label="Expédiées" 
-                        count={stats.shippedOrders} 
-                        color="purple" 
-                        icon={Truck} 
-                    />
-                    <PipelineStep 
-                        label="Livrées" 
-                        count={stats.deliveredOrders} 
-                        color="emerald" 
-                        icon={CheckCircle} 
-                        isLast 
-                    />
+                <span className="text-sm font-medium text-gray-600 group-hover:text-gray-900">
+                  Ajouter un produit
+                </span>
+              </Link>
+              <Link
+                href="/admin/collections/new"
+                className="flex items-center gap-4 p-3 rounded-xl hover:bg-gray-50 transition-colors group"
+              >
+                <div className="p-2.5 bg-gray-100 text-gray-500 rounded-lg group-hover:bg-gray-900 group-hover:text-white transition-colors">
+                  <FolderOpen size={20} />
                 </div>
-            </div>
-
-            {/* Main Content Grid */}
-            <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
-                {/* Recent Orders Table */}
-                <div className="lg:col-span-2 space-y-6">
-                    <div className="flex items-center justify-between">
-                        <h3 className="font-serif font-medium text-xl text-gray-900">Commandes récentes</h3>
-                    </div>
-                    
-                    <div className="bg-white rounded-xl border border-gray-100 overflow-hidden shadow-sm">
-                        <table className="w-full text-left">
-                            <thead>
-                                <tr className="border-b border-gray-100 bg-gray-50/50 text-xs uppercase tracking-widest text-gray-500">
-                                    <th className="py-4 px-6 font-medium">Réf</th>
-                                    <th className="py-4 px-6 font-medium">Client</th>
-                                    <th className="py-4 px-6 font-medium">Montant</th>
-                                    <th className="py-4 px-6 font-medium">Statut</th>
-                                    <th className="py-4 px-6 font-medium text-right"></th>
-                                </tr>
-                            </thead>
-                            <tbody className="divide-y divide-gray-50">
-                                {stats.recentOrders.length === 0 ? (
-                                    <tr>
-                                        <td colSpan={5} className="py-12 text-center text-gray-400 text-sm">
-                                            Aucune commande récente
-                                        </td>
-                                    </tr>
-                                ) : (
-                                    stats.recentOrders.map((order) => (
-                                        <tr key={order.id} className="hover:bg-gray-50/50 transition-colors group">
-                                            <td className="py-4 px-6">
-                                                <span className="font-mono text-xs text-gray-500">
-                                                    #{order.id.slice(-6).toUpperCase()}
-                                                </span>
-                                            </td>
-                                            <td className="py-4 px-6">
-                                                <div className="flex flex-col">
-                                                    <span className="text-sm font-medium text-gray-900">{order.customerName}</span>
-                                                    <span className="text-xs text-gray-400">{new Date(order.createdAt).toLocaleDateString()}</span>
-                                                </div>
-                                            </td>
-                                            <td className="py-4 px-6 text-sm font-medium text-gray-900">
-                                                {order.total?.toLocaleString()} DZD
-                                            </td>
-                                            <td className="py-4 px-6">
-                                                {getStatusBadge(order.status)}
-                                            </td>
-                                            <td className="py-4 px-6 text-right">
-                                                <Link href={`/admin/orders`} className="text-gray-300 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 inline-flex transition-all">
-                                                    <ArrowUpRight size={18} />
-                                                </Link>
-                                            </td>
-                                        </tr>
-                                    ))
-                                )}
-                            </tbody>
-                        </table>
-                    </div>
+                <span className="text-sm font-medium text-gray-600 group-hover:text-gray-900">
+                  Nouvelle collection
+                </span>
+              </Link>
+              <Link
+                href="/admin/orders"
+                className="flex items-center gap-4 p-3 rounded-xl hover:bg-gray-50 transition-colors group"
+              >
+                <div className="p-2.5 bg-gray-100 text-gray-500 rounded-lg group-hover:bg-gray-900 group-hover:text-white transition-colors">
+                  <ShoppingBag size={20} />
                 </div>
+                <span className="text-sm font-medium text-gray-600 group-hover:text-gray-900">
+                  Gérer les commandes
+                </span>
+              </Link>
+              <div className="h-px bg-gray-100 my-2" />
+              <Link
+                href="/"
+                target="_blank"
+                className="flex items-center gap-4 p-3 rounded-xl hover:bg-gray-50 transition-colors group"
+              >
+                <div className="p-2.5 bg-gray-50 text-gray-400 rounded-lg group-hover:text-gray-600 transition-colors">
+                  <Eye size={20} />
+                </div>
+                <span className="text-sm font-medium text-gray-500 group-hover:text-gray-900">
+                  Voir la boutique
+                </span>
+              </Link>
+            </div>
+          </div>
 
-                {/* Side Column */}
-                <div className="space-y-8">
-                    {/* Quick Actions */}
-                    <div className="space-y-6">
-                        <h3 className="font-serif font-medium text-xl text-gray-900">Actions rapides</h3>
-                        <div className="bg-white rounded-xl border border-gray-100 p-6 shadow-sm space-y-3">
-                            <Link href="/admin/products/new" className="flex items-center gap-4 p-3 rounded-xl hover:bg-gray-50 transition-colors group">
-                                <div className="p-2.5 bg-gray-100 text-gray-500 rounded-lg group-hover:bg-gray-900 group-hover:text-white transition-colors">
-                                    <Plus size={20} />
-                                </div>
-                                <span className="text-sm font-medium text-gray-600 group-hover:text-gray-900">Ajouter un produit</span>
-                            </Link>
-                            <Link href="/admin/collections/new" className="flex items-center gap-4 p-3 rounded-xl hover:bg-gray-50 transition-colors group">
-                                <div className="p-2.5 bg-gray-100 text-gray-500 rounded-lg group-hover:bg-gray-900 group-hover:text-white transition-colors">
-                                    <FolderOpen size={20} />
-                                </div>
-                                <span className="text-sm font-medium text-gray-600 group-hover:text-gray-900">Nouvelle collection</span>
-                            </Link>
-                            <Link href="/admin/orders" className="flex items-center gap-4 p-3 rounded-xl hover:bg-gray-50 transition-colors group">
-                                <div className="p-2.5 bg-gray-100 text-gray-500 rounded-lg group-hover:bg-gray-900 group-hover:text-white transition-colors">
-                                    <ShoppingBag size={20} />
-                                </div>
-                                <span className="text-sm font-medium text-gray-600 group-hover:text-gray-900">Gérer les commandes</span>
-                            </Link>
-                            <div className="h-px bg-gray-100 my-2" />
-                            <Link href="/" target="_blank" className="flex items-center gap-4 p-3 rounded-xl hover:bg-gray-50 transition-colors group">
-                                <div className="p-2.5 bg-gray-50 text-gray-400 rounded-lg group-hover:text-gray-600 transition-colors">
-                                    <Eye size={20} />
-                                </div>
-                                <span className="text-sm font-medium text-gray-500 group-hover:text-gray-900">Voir la boutique</span>
-                            </Link>
-                        </div>
-                    </div>
-
-                    {/* Top Products */}
-                    <div className="space-y-6">
-                        <div className="flex items-center justify-between">
-                            <h3 className="font-serif font-medium text-xl text-gray-900">Produits populaires</h3>
+          {/* Top Products */}
+          <div className="space-y-6">
+            <div className="flex items-center justify-between">
+              <h3 className="font-serif font-medium text-xl text-gray-900">
+                Produits populaires
+              </h3>
+            </div>
+            <div className="bg-white rounded-xl border border-gray-100 p-6 shadow-sm">
+              {stats.topProducts.length === 0 ? (
+                <p className="text-sm text-gray-400 text-center py-4">
+                  Aucun produit
+                </p>
+              ) : (
+                <div className="space-y-4">
+                  {stats.topProducts.map((product: any) => {
+                    const images = JSON.parse(product.images || "[]");
+                    return (
+                      <Link
+                        key={product.id}
+                        href={`/admin/products/${product.id}/edit`}
+                        className="flex items-center gap-4 group"
+                      >
+                        <div className="w-12 h-12 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0">
+                          {images[0] ? (
+                            // eslint-disable-next-line @next/next/no-img-element
+                            <img
+                              src={images[0]}
+                              alt=""
+                              className="w-full h-full object-cover"
+                            />
+                          ) : (
+                            <Package
+                              size={20}
+                              className="m-auto text-gray-300"
+                            />
+                          )}
                         </div>
-                        <div className="bg-white rounded-xl border border-gray-100 p-6 shadow-sm">
-                            {stats.topProducts.length === 0 ? (
-                                <p className="text-sm text-gray-400 text-center py-4">Aucun produit</p>
-                            ) : (
-                                <div className="space-y-4">
-                                    {stats.topProducts.map((product: any) => {
-                                        const images = JSON.parse(product.images || '[]');
-                                        return (
-                                            <Link key={product.id} href={`/admin/products/${product.id}/edit`} className="flex items-center gap-4 group">
-                                                <div className="w-12 h-12 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0">
-                                                    {images[0] ? (
-                                                        // eslint-disable-next-line @next/next/no-img-element
-                                                        <img src={images[0]} alt="" className="w-full h-full object-cover" />
-                                                    ) : (
-                                                        <Package size={20} className="m-auto text-gray-300" />
-                                                    )}
-                                                </div>
-                                                <div className="flex-1 min-w-0">
-                                                    <p className="text-sm font-medium text-gray-900 truncate group-hover:text-harp-brown transition-colors">{product.nameFr}</p>
-                                                    <p className="text-xs text-gray-500">{product.price?.toLocaleString()} DZD</p>
-                                                </div>
-                                                <MoreHorizontal size={16} className="text-gray-300 group-hover:text-gray-600" />
-                                            </Link>
-                                        )
-                                    })}
-                                </div>
-                            )}
+                        <div className="flex-1 min-w-0">
+                          <p className="text-sm font-medium text-gray-900 truncate group-hover:text-harp-brown transition-colors">
+                            {product.nameFr}
+                          </p>
+                          <p className="text-xs text-gray-500">
+                            {product.price?.toLocaleString()} DZD
+                          </p>
                         </div>
-                    </div>
+                        <MoreHorizontal
+                          size={16}
+                          className="text-gray-300 group-hover:text-gray-600"
+                        />
+                      </Link>
+                    );
+                  })}
                 </div>
+              )}
             </div>
+          </div>
         </div>
-    );
+      </div>
+    </div>
+  );
 }
 
-function KpiCard({ label, value, icon: Icon, color, trend, badge, alert, sub }: any) {
-    const colors: any = {
-        emerald: "bg-emerald-50 text-emerald-600",
-        blue: "bg-blue-50 text-blue-600",
-        purple: "bg-purple-50 text-purple-600",
-        gray: "bg-gray-100 text-gray-600",
-    };
+function KpiCard({
+  label,
+  value,
+  icon: Icon,
+  color,
+  trend,
+  badge,
+  alert,
+  sub,
+}: any) {
+  const colors: any = {
+    emerald: "bg-emerald-50 text-emerald-600",
+    blue: "bg-blue-50 text-blue-600",
+    purple: "bg-purple-50 text-purple-600",
+    gray: "bg-gray-100 text-gray-600",
+  };
 
-    return (
-        <div className="bg-white p-6 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-all group">
-            <div className="flex items-start justify-between mb-6">
-                <div className={cn("p-3 rounded-xl transition-colors", colors[color] || 'bg-gray-50 text-gray-600')}>
-                    <Icon size={22} />
-                </div>
-                {badge && <span className="text-[10px] bg-blue-50 text-blue-600 px-2.5 py-1 rounded-full font-semibold tracking-wide border border-blue-100">{badge}</span>}
-                {alert && <span className="text-[10px] bg-red-50 text-red-600 px-2.5 py-1 rounded-full font-semibold tracking-wide border border-red-100">{alert}</span>}
-            </div>
-            <div>
-                <h3 className="text-sm font-medium text-gray-500 mb-2">{label}</h3>
-                <p className="text-3xl font-serif font-medium text-gray-900">{value}</p>
-                {trend && <p className="text-xs text-emerald-600 font-medium mt-2 flex items-center gap-1">
-                    <ArrowUpRight size={12} /> {trend}
-                </p>}
-                {sub && <p className="text-xs text-gray-400 mt-2">{sub}</p>}
-            </div>
+  return (
+    <div className="bg-white p-6 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-all group">
+      <div className="flex items-start justify-between mb-6">
+        <div
+          className={cn(
+            "p-3 rounded-xl transition-colors",
+            colors[color] || "bg-gray-50 text-gray-600",
+          )}
+        >
+          <Icon size={22} />
         </div>
-    );
+        {badge && (
+          <span className="text-[10px] bg-blue-50 text-blue-600 px-2.5 py-1 rounded-full font-semibold tracking-wide border border-blue-100">
+            {badge}
+          </span>
+        )}
+        {alert && (
+          <span className="text-[10px] bg-red-50 text-red-600 px-2.5 py-1 rounded-full font-semibold tracking-wide border border-red-100">
+            {alert}
+          </span>
+        )}
+      </div>
+      <div>
+        <h3 className="text-sm font-medium text-gray-500 mb-2">{label}</h3>
+        <p className="text-3xl font-serif font-medium text-gray-900">{value}</p>
+        {trend && (
+          <p className="text-xs text-emerald-600 font-medium mt-2 flex items-center gap-1">
+            <ArrowUpRight size={12} /> {trend}
+          </p>
+        )}
+        {sub && <p className="text-xs text-gray-400 mt-2">{sub}</p>}
+      </div>
+    </div>
+  );
 }
 
 function PipelineStep({ label, count, color, icon: Icon, isLast }: any) {
-    const colors: any = {
-        amber: "hover:border-amber-200 hover:bg-amber-50/50",
-        blue: "hover:border-blue-200 hover:bg-blue-50/50",
-        purple: "hover:border-purple-200 hover:bg-purple-50/50",
-        emerald: "hover:border-emerald-200 hover:bg-emerald-50/50",
-    };
+  const colors: any = {
+    amber: "hover:border-amber-200 hover:bg-amber-50/50",
+    blue: "hover:border-blue-200 hover:bg-blue-50/50",
+    purple: "hover:border-purple-200 hover:bg-purple-50/50",
+    emerald: "hover:border-emerald-200 hover:bg-emerald-50/50",
+  };
 
-    const iconColors: any = {
-        amber: "text-amber-600 bg-amber-50",
-        blue: "text-blue-600 bg-blue-50",
-        purple: "text-purple-600 bg-purple-50",
-        emerald: "text-emerald-600 bg-emerald-50",
-    };
+  const iconColors: any = {
+    amber: "text-amber-600 bg-amber-50",
+    blue: "text-blue-600 bg-blue-50",
+    purple: "text-purple-600 bg-purple-50",
+    emerald: "text-emerald-600 bg-emerald-50",
+  };
 
-    return (
-        <div className={cn(
-            "relative flex flex-col items-center text-center p-6 rounded-xl border border-gray-100 transition-all duration-300 cursor-pointer bg-white",
-            colors[color]
-        )}>
-            <div className={cn("p-3 rounded-full mb-4 transition-colors", iconColors[color])}>
-                <Icon size={24} />
-            </div>
-            <span className="text-3xl font-serif font-medium text-gray-900 mb-1">{count}</span>
-            <span className="text-xs font-bold uppercase tracking-widest text-gray-400">{label}</span>
-            
-            {!isLast && (
-                <div className="hidden md:block absolute top-1/2 -right-3 w-6 h-px bg-gray-200 z-10" />
-            )}
-        </div>
-    );
+  return (
+    <div
+      className={cn(
+        "relative flex flex-col items-center text-center p-6 rounded-xl border border-gray-100 transition-all duration-300 cursor-pointer bg-white",
+        colors[color],
+      )}
+    >
+      <div
+        className={cn(
+          "p-3 rounded-full mb-4 transition-colors",
+          iconColors[color],
+        )}
+      >
+        <Icon size={24} />
+      </div>
+      <span className="text-3xl font-serif font-medium text-gray-900 mb-1">
+        {count}
+      </span>
+      <span className="text-xs font-bold uppercase tracking-widest text-gray-400">
+        {label}
+      </span>
+
+      {!isLast && (
+        <div className="hidden md:block absolute top-1/2 -right-3 w-6 h-px bg-gray-200 z-10" />
+      )}
+    </div>
+  );
 }
diff --git a/src/app/admin/products/[id]/edit/page.tsx b/src/app/admin/products/[id]/edit/page.tsx
index 266d6af..d455493 100644
--- a/src/app/admin/products/[id]/edit/page.tsx
+++ b/src/app/admin/products/[id]/edit/page.tsx
@@ -2,511 +2,619 @@
 
 import { useState, useEffect, use, useRef } from "react";
 import { useRouter } from "next/navigation";
-import { ArrowLeft, Upload, X, Plus, Image as ImageIcon, Video, Loader2, Link as LinkIcon, Save } from "lucide-react";
+import {
+  ArrowLeft,
+  Upload,
+  X,
+  Plus,
+  Image as ImageIcon,
+  Video,
+  Loader2,
+  Link as LinkIcon,
+  Save,
+} from "lucide-react";
 import Link from "next/link";
 import { cn } from "@/lib/utils";
 
 interface Collection {
-    id: string;
-    nameFr: string;
-    nameAr: string;
+  id: string;
+  nameFr: string;
+  nameAr: string;
 }
 
 interface UploadedMedia {
-    url: string;
-    type: 'image' | 'video';
-    uploading?: boolean;
+  url: string;
+  type: "image" | "video";
+  uploading?: boolean;
 }
 
-export default function EditProductPage({ params }: { params: Promise<{ id: string }> }) {
-    const { id } = use(params);
-    const router = useRouter();
-    const fileInputRef = useRef<HTMLInputElement>(null);
-    const [loading, setLoading] = useState(true);
-    const [saving, setSaving] = useState(false);
-    const [collections, setCollections] = useState<Collection[]>([]);
-    const [mediaItems, setMediaItems] = useState<UploadedMedia[]>([]);
-    const [uploadMode, setUploadMode] = useState<'file' | 'url'>('file');
-    const [newImageUrl, setNewImageUrl] = useState("");
-    const [formData, setFormData] = useState({
-        nameFr: "",
-        nameAr: "",
-        descriptionFr: "",
-        descriptionAr: "",
-        price: "",
-        stock: "0",
-        sizes: "",
-        colors: "",
-        collectionId: "",
-        showSizeGuide: true,
-    });
-
-    useEffect(() => {
-        // Fetch collections
-        fetch("/api/collections")
-            .then(res => res.json())
-            .then(data => setCollections(Array.isArray(data) ? data : []))
-            .catch(err => console.error("Error fetching collections:", err));
-
-        // Fetch product
-        const fetchProduct = async () => {
-            try {
-                const res = await fetch(`/api/products/${id}`);
-                if (!res.ok) throw new Error("Product not found");
-                const data = await res.json();
-
-                const images = JSON.parse(data.images);
-                setMediaItems(images.map((url: string) => ({
-                    url,
-                    type: url.match(/\.(mp4|webm|mov)$/i) ? 'video' : 'image'
-                })));
-
-                setFormData({
-                    nameFr: data.nameFr,
-                    nameAr: data.nameAr,
-                    descriptionFr: data.descriptionFr,
-                    descriptionAr: data.descriptionAr,
-                    price: data.price.toString(),
-                    stock: (data.stock || 0).toString(),
-                    sizes: JSON.parse(data.sizes).join(", "),
-                    colors: JSON.parse(data.colors).join(", "),
-                    collectionId: data.collectionId || "",
-                    showSizeGuide: data.showSizeGuide !== false,
-                });
-            } catch (error) {
-                console.error("Error fetching product:", error);
-                alert("Erreur lors du chargement du produit");
-                router.push("/admin/products");
-            } finally {
-                setLoading(false);
-            }
-        };
-
-        fetchProduct();
-    }, [id, router]);
-
-    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {
-        setFormData({ ...formData, [e.target.name]: e.target.value });
-    };
-
-    const handleFileUpload = async (files: FileList | null) => {
-        if (!files || files.length === 0) return;
-
-        for (const file of Array.from(files)) {
-            const isVideo = file.type.startsWith('video/');
-            const isImage = file.type.startsWith('image/');
-            
-            if (!isVideo && !isImage) continue;
-
-            const tempUrl = URL.createObjectURL(file);
-            setMediaItems(prev => [...prev, { url: tempUrl, type: isVideo ? 'video' : 'image', uploading: true }]);
-
-            try {
-                const formData = new FormData();
-                formData.append('file', file);
-
-                const response = await fetch('/api/upload', { method: 'POST', body: formData });
+export default function EditProductPage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
+  const { id } = use(params);
+  const router = useRouter();
+  const fileInputRef = useRef<HTMLInputElement>(null);
+  const [loading, setLoading] = useState(true);
+  const [saving, setSaving] = useState(false);
+  const [collections, setCollections] = useState<Collection[]>([]);
+  const [mediaItems, setMediaItems] = useState<UploadedMedia[]>([]);
+  const [uploadMode, setUploadMode] = useState<"file" | "url">("file");
+  const [newImageUrl, setNewImageUrl] = useState("");
+  const [formData, setFormData] = useState({
+    nameFr: "",
+    nameAr: "",
+    descriptionFr: "",
+    descriptionAr: "",
+    price: "",
+    stock: "0",
+    sizes: "",
+    colors: "",
+    collectionId: "",
+    showSizeGuide: true,
+  });
+
+  useEffect(() => {
+    // Fetch collections
+    fetch("/api/collections")
+      .then((res) => res.json())
+      .then((data) => setCollections(Array.isArray(data) ? data : []))
+      .catch((err) => console.error("Error fetching collections:", err));
+
+    // Fetch product
+    const fetchProduct = async () => {
+      try {
+        const res = await fetch(`/api/products/${id}`);
+        if (!res.ok) throw new Error("Product not found");
+        const data = await res.json();
+
+        const images = JSON.parse(data.images);
+        setMediaItems(
+          images.map((url: string) => ({
+            url,
+            type: url.match(/\.(mp4|webm|mov)$/i) ? "video" : "image",
+          })),
+        );
 
-                if (response.ok) {
-                    const data = await response.json();
-                    setMediaItems(prev => prev.map(item => 
-                        item.url === tempUrl ? { url: data.url, type: isVideo ? 'video' : 'image', uploading: false } : item
-                    ));
-                } else {
-                    setMediaItems(prev => prev.filter(item => item.url !== tempUrl));
-                }
-            } catch (error) {
-                setMediaItems(prev => prev.filter(item => item.url !== tempUrl));
-            }
-        }
+        setFormData({
+          nameFr: data.nameFr,
+          nameAr: data.nameAr,
+          descriptionFr: data.descriptionFr,
+          descriptionAr: data.descriptionAr,
+          price: data.price.toString(),
+          stock: (data.stock || 0).toString(),
+          sizes: JSON.parse(data.sizes).join(", "),
+          colors: JSON.parse(data.colors).join(", "),
+          collectionId: data.collectionId || "",
+          showSizeGuide: data.showSizeGuide !== false,
+        });
+      } catch (error) {
+        console.error("Error fetching product:", error);
+        alert("Erreur lors du chargement du produit");
+        router.push("/admin/products");
+      } finally {
+        setLoading(false);
+      }
     };
 
-    const addImageUrl = () => {
-        if (newImageUrl.trim() && !mediaItems.find(m => m.url === newImageUrl.trim())) {
-            const isVideo = newImageUrl.match(/\.(mp4|webm|mov)$/i);
-            setMediaItems([...mediaItems, { url: newImageUrl.trim(), type: isVideo ? 'video' : 'image' }]);
-            setNewImageUrl("");
+    fetchProduct();
+  }, [id, router]);
+
+  const handleChange = (
+    e: React.ChangeEvent<
+      HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement
+    >,
+  ) => {
+    setFormData({ ...formData, [e.target.name]: e.target.value });
+  };
+
+  const handleFileUpload = async (files: FileList | null) => {
+    if (!files || files.length === 0) return;
+
+    for (const file of Array.from(files)) {
+      const isVideo = file.type.startsWith("video/");
+      const isImage = file.type.startsWith("image/");
+
+      if (!isVideo && !isImage) continue;
+
+      const tempUrl = URL.createObjectURL(file);
+      setMediaItems((prev) => [
+        ...prev,
+        { url: tempUrl, type: isVideo ? "video" : "image", uploading: true },
+      ]);
+
+      try {
+        const formData = new FormData();
+        formData.append("file", file);
+
+        const response = await fetch("/api/upload", {
+          method: "POST",
+          body: formData,
+        });
+
+        if (response.ok) {
+          const data = await response.json();
+          setMediaItems((prev) =>
+            prev.map((item) =>
+              item.url === tempUrl
+                ? {
+                    url: data.url,
+                    type: isVideo ? "video" : "image",
+                    uploading: false,
+                  }
+                : item,
+            ),
+          );
+        } else {
+          setMediaItems((prev) => prev.filter((item) => item.url !== tempUrl));
         }
-    };
+      } catch (error) {
+        setMediaItems((prev) => prev.filter((item) => item.url !== tempUrl));
+      }
+    }
+  };
+
+  const addImageUrl = () => {
+    if (
+      newImageUrl.trim() &&
+      !mediaItems.find((m) => m.url === newImageUrl.trim())
+    ) {
+      const isVideo = newImageUrl.match(/\.(mp4|webm|mov)$/i);
+      setMediaItems([
+        ...mediaItems,
+        { url: newImageUrl.trim(), type: isVideo ? "video" : "image" },
+      ]);
+      setNewImageUrl("");
+    }
+  };
 
-    const removeMedia = (index: number) => {
-        setMediaItems(mediaItems.filter((_, i) => i !== index));
-    };
+  const removeMedia = (index: number) => {
+    setMediaItems(mediaItems.filter((_, i) => i !== index));
+  };
 
-    const handleSubmit = async (e: React.FormEvent) => {
-        e.preventDefault();
-        
-        const completedMedia = mediaItems.filter(m => !m.uploading);
-        if (completedMedia.length === 0) {
-            alert("Veuillez ajouter au moins une image ou vidéo");
-            return;
-        }
+  const handleSubmit = async (e: React.FormEvent) => {
+    e.preventDefault();
 
-        setSaving(true);
-
-        try {
-            const response = await fetch(`/api/products/${id}`, {
-                method: "PUT",
-                headers: { "Content-Type": "application/json" },
-                body: JSON.stringify({
-                    ...formData,
-                    price: parseFloat(formData.price),
-                    stock: parseInt(formData.stock) || 0,
-                    images: completedMedia.map(m => m.url),
-                    sizes: formData.sizes.split(",").map((s: string) => s.trim()),
-                    colors: formData.colors.split(",").map((s: string) => s.trim()),
-                    collectionId: formData.collectionId || null,
-                    showSizeGuide: formData.showSizeGuide,
-                }),
-            });
-
-            if (response.ok) {
-                router.push("/admin/products");
-            } else {
-                const error = await response.json();
-                alert(error.details?.join(", ") || "Erreur lors de la modification");
-            }
-        } catch (error) {
-            console.error("Error updating product:", error);
-            alert("Erreur lors de la modification du produit");
-        } finally {
-            setSaving(false);
-        }
-    };
+    const completedMedia = mediaItems.filter((m) => !m.uploading);
+    if (completedMedia.length === 0) {
+      alert("Veuillez ajouter au moins une image ou vidéo");
+      return;
+    }
 
-    if (loading) {
-        return (
-            <div className="min-h-[400px] flex flex-col items-center justify-center">
-                <Loader2 size={32} className="animate-spin text-gray-300 mb-4" />
-                <p className="text-sm text-gray-500 uppercase tracking-widest">Chargement...</p>
-            </div>
-        );
+    setSaving(true);
+
+    try {
+      const response = await fetch(`/api/products/${id}`, {
+        method: "PUT",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify({
+          ...formData,
+          price: parseFloat(formData.price),
+          stock: parseInt(formData.stock) || 0,
+          images: completedMedia.map((m) => m.url),
+          sizes: formData.sizes.split(",").map((s: string) => s.trim()),
+          colors: formData.colors.split(",").map((s: string) => s.trim()),
+          collectionId: formData.collectionId || null,
+          showSizeGuide: formData.showSizeGuide,
+        }),
+      });
+
+      if (response.ok) {
+        router.push("/admin/products");
+      } else {
+        const error = await response.json();
+        alert(error.details?.join(", ") || "Erreur lors de la modification");
+      }
+    } catch (error) {
+      console.error("Error updating product:", error);
+      alert("Erreur lors de la modification du produit");
+    } finally {
+      setSaving(false);
     }
+  };
 
+  if (loading) {
     return (
-        <div className="max-w-4xl mx-auto space-y-8">
-            <div>
-                <Link href="/admin/products" className="inline-flex items-center gap-2 text-gray-400 hover:text-gray-900 transition-colors mb-6">
-                    <ArrowLeft size={16} />
-                    <span className="text-sm font-medium">Retour aux produits</span>
-                </Link>
-
-                <h1 className="text-3xl font-serif font-medium text-gray-900">Modifier le Produit</h1>
-                <p className="text-gray-500 text-sm mt-2">Mettez à jour les informations du produit</p>
+      <div className="min-h-[400px] flex flex-col items-center justify-center">
+        <Loader2 size={32} className="animate-spin text-gray-300 mb-4" />
+        <p className="text-sm text-gray-500 uppercase tracking-widest">
+          Chargement...
+        </p>
+      </div>
+    );
+  }
+
+  return (
+    <div className="max-w-4xl mx-auto space-y-8">
+      <div>
+        <Link
+          href="/admin/products"
+          className="inline-flex items-center gap-2 text-gray-400 hover:text-gray-900 transition-colors mb-6"
+        >
+          <ArrowLeft size={16} />
+          <span className="text-sm font-medium">Retour aux produits</span>
+        </Link>
+
+        <h1 className="text-3xl font-serif font-medium text-gray-900">
+          Modifier le Produit
+        </h1>
+        <p className="text-gray-500 text-sm mt-2">
+          Mettez à jour les informations du produit
+        </p>
+      </div>
+
+      <form onSubmit={handleSubmit} className="space-y-8">
+        {/* Basic Info */}
+        <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
+          <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">
+            Informations de base
+          </h2>
+
+          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Nom (Français)
+              </label>
+              <input
+                required
+                name="nameFr"
+                value={formData.nameFr}
+                onChange={handleChange}
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
             </div>
+            <div className="space-y-2" dir="rtl">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                الاسم (بالعربية)
+              </label>
+              <input
+                required
+                name="nameAr"
+                value={formData.nameAr}
+                onChange={handleChange}
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+            </div>
+          </div>
+
+          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Description (Français)
+              </label>
+              <textarea
+                required
+                name="descriptionFr"
+                value={formData.descriptionFr}
+                onChange={handleChange}
+                rows={4}
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all resize-none placeholder:text-gray-400"
+              />
+            </div>
+            <div className="space-y-2" dir="rtl">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                الوصف (بالعربية)
+              </label>
+              <textarea
+                required
+                name="descriptionAr"
+                value={formData.descriptionAr}
+                onChange={handleChange}
+                rows={4}
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all resize-none placeholder:text-gray-400"
+              />
+            </div>
+          </div>
+        </div>
 
-            <form onSubmit={handleSubmit} className="space-y-8">
-                {/* Basic Info */}
-                <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
-                    <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">Informations de base</h2>
-                    
-                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Nom (Français)</label>
-                            <input
-                                required
-                                name="nameFr"
-                                value={formData.nameFr}
-                                onChange={handleChange}
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                        <div className="space-y-2" dir="rtl">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">الاسم (بالعربية)</label>
-                            <input
-                                required
-                                name="nameAr"
-                                value={formData.nameAr}
-                                onChange={handleChange}
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                    </div>
-
-                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Description (Français)</label>
-                            <textarea
-                                required
-                                name="descriptionFr"
-                                value={formData.descriptionFr}
-                                onChange={handleChange}
-                                rows={4}
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all resize-none placeholder:text-gray-400"
-                            />
-                        </div>
-                        <div className="space-y-2" dir="rtl">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">الوصف (بالعربية)</label>
-                            <textarea
-                                required
-                                name="descriptionAr"
-                                value={formData.descriptionAr}
-                                onChange={handleChange}
-                                rows={4}
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all resize-none placeholder:text-gray-400"
-                            />
-                        </div>
-                    </div>
-                </div>
-
-                {/* Price, Stock & Collection */}
-                <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
-                    <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">Prix, Stock & Collection</h2>
-                    
-                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Prix (DZD)</label>
-                            <div className="relative">
-                                <input
-                                    required
-                                    type="number"
-                                    name="price"
-                                    value={formData.price}
-                                    onChange={handleChange}
-                                    className="w-full bg-gray-50 border-none p-3 pr-16 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                                />
-                                <span className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs font-medium">DZD</span>
-                            </div>
-                        </div>
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Stock disponible</label>
-                            <input
-                                required
-                                type="number"
-                                name="stock"
-                                value={formData.stock}
-                                onChange={handleChange}
-                                min="0"
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Collection</label>
-                            <select
-                                name="collectionId"
-                                value={formData.collectionId}
-                                onChange={handleChange}
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all text-gray-600"
-                            >
-                                <option value="">-- Aucune collection --</option>
-                                {collections.map((collection) => (
-                                    <option key={collection.id} value={collection.id}>
-                                        {collection.nameFr}
-                                    </option>
-                                ))}
-                            </select>
-                        </div>
-                    </div>
-                </div>
+        {/* Price, Stock & Collection */}
+        <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
+          <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">
+            Prix, Stock & Collection
+          </h2>
+
+          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Prix (DZD)
+              </label>
+              <div className="relative">
+                <input
+                  required
+                  type="number"
+                  name="price"
+                  value={formData.price}
+                  onChange={handleChange}
+                  className="w-full bg-gray-50 border-none p-3 pr-16 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+                />
+                <span className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs font-medium">
+                  DZD
+                </span>
+              </div>
+            </div>
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Stock disponible
+              </label>
+              <input
+                required
+                type="number"
+                name="stock"
+                value={formData.stock}
+                onChange={handleChange}
+                min="0"
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+            </div>
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Collection
+              </label>
+              <select
+                name="collectionId"
+                value={formData.collectionId}
+                onChange={handleChange}
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all text-gray-600"
+              >
+                <option value="">-- Aucune collection --</option>
+                {collections.map((collection) => (
+                  <option key={collection.id} value={collection.id}>
+                    {collection.nameFr}
+                  </option>
+                ))}
+              </select>
+            </div>
+          </div>
+        </div>
 
-                {/* Images & Videos */}
-                <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
-                    <div className="flex items-center justify-between border-b border-gray-50 pb-4">
-                        <h2 className="text-lg font-medium text-gray-900">Images & Vidéos</h2>
-                        <div className="flex bg-gray-100 rounded-lg p-1">
-                            <button
-                                type="button"
-                                onClick={() => setUploadMode('file')}
-                                className={cn(
-                                    "px-3 py-1.5 rounded-md text-xs font-medium transition-all",
-                                    uploadMode === 'file' 
-                                        ? 'bg-white text-gray-900 shadow-sm' 
-                                        : 'text-gray-500 hover:text-gray-900'
-                                )}
-                            >
-                                <Upload size={14} className="inline mr-1.5" />
-                                Upload
-                            </button>
-                            <button
-                                type="button"
-                                onClick={() => setUploadMode('url')}
-                                className={cn(
-                                    "px-3 py-1.5 rounded-md text-xs font-medium transition-all",
-                                    uploadMode === 'url' 
-                                        ? 'bg-white text-gray-900 shadow-sm' 
-                                        : 'text-gray-500 hover:text-gray-900'
-                                )}
-                            >
-                                <LinkIcon size={14} className="inline mr-1.5" />
-                                URL
-                            </button>
-                        </div>
-                    </div>
-                    
-                    {uploadMode === 'file' ? (
-                        <div className="mb-4">
-                            <input
-                                ref={fileInputRef}
-                                type="file"
-                                multiple
-                                accept="image/*,video/*"
-                                onChange={(e) => handleFileUpload(e.target.files)}
-                                className="hidden"
-                            />
-                            <button
-                                type="button"
-                                onClick={() => fileInputRef.current?.click()}
-                                className="w-full border-2 border-dashed border-gray-200 rounded-xl p-8 hover:border-gray-400 hover:bg-gray-50 transition-all group"
-                            >
-                                <div className="text-center">
-                                    <div className="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-white transition-colors">
-                                        <Upload size={24} className="text-gray-400 group-hover:text-gray-900" />
-                                    </div>
-                                    <p className="text-gray-900 font-medium">Cliquez pour uploader</p>
-                                    <p className="text-gray-400 text-xs mt-1">Images (JPG, PNG, WebP) ou Vidéos (MP4, WebM)</p>
-                                </div>
-                            </button>
-                        </div>
-                    ) : (
-                        <div className="flex gap-3 mb-4">
-                            <input
-                                type="url"
-                                value={newImageUrl}
-                                onChange={(e) => setNewImageUrl(e.target.value)}
-                                placeholder="https://exemple.com/image.jpg"
-                                className="flex-1 bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                                onKeyDown={(e) => e.key === 'Enter' && (e.preventDefault(), addImageUrl())}
-                            />
-                            <button
-                                type="button"
-                                onClick={addImageUrl}
-                                className="px-6 py-3 bg-gray-900 text-white rounded-xl hover:bg-gray-800 transition-colors flex items-center gap-2 text-sm font-medium"
-                            >
-                                <Plus size={18} />
-                                Ajouter
-                            </button>
-                        </div>
-                    )}
-
-                    {mediaItems.length > 0 ? (
-                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
-                            {mediaItems.map((media, index) => (
-                                <div key={index} className="relative group aspect-[3/4] bg-gray-100 rounded-xl overflow-hidden">
-                                    {media.type === 'video' ? (
-                                        <video src={media.url} className="w-full h-full object-cover" muted />
-                                    ) : (
-                                        /* eslint-disable-next-line @next/next/no-img-element */
-                                        <img src={media.url} alt="" className="w-full h-full object-cover" />
-                                    )}
-                                    
-                                    {/* Uploading overlay */}
-                                    {media.uploading && (
-                                        <div className="absolute inset-0 bg-black/50 flex items-center justify-center">
-                                            <Loader2 size={32} className="text-white animate-spin" />
-                                        </div>
-                                    )}
-
-                                    {/* Type badge */}
-                                    {media.type === 'video' && (
-                                        <div className="absolute top-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs flex items-center gap-1">
-                                            <Video size={12} />
-                                            Vidéo
-                                        </div>
-                                    )}
-                                    
-                                    {!media.uploading && (
-                                        <button
-                                            type="button"
-                                            onClick={() => removeMedia(index)}
-                                            className="absolute top-2 right-2 p-1.5 bg-white/90 text-red-500 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity shadow-sm"
-                                        >
-                                            <X size={14} />
-                                        </button>
-                                    )}
-                                    
-                                    {/* Primary badge */}
-                                    {index === 0 && !media.uploading && (
-                                        <span className="absolute bottom-2 left-2 bg-gray-900/90 text-white text-[10px] uppercase tracking-wider font-bold px-2 py-1 rounded">
-                                            Principal
-                                        </span>
-                                    )}
-                                </div>
-                            ))}
-                        </div>
-                    ) : (
-                        <div className="border border-dashed border-gray-200 rounded-xl p-8 text-center bg-gray-50/50">
-                            <div className="w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3 shadow-sm">
-                                <ImageIcon size={20} className="text-gray-300" />
-                            </div>
-                            <p className="text-gray-500 text-sm">Aucun média ajouté</p>
-                            <p className="text-gray-400 text-xs">Uploadez des images ou vidéos</p>
-                        </div>
-                    )}
+        {/* Images & Videos */}
+        <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
+          <div className="flex items-center justify-between border-b border-gray-50 pb-4">
+            <h2 className="text-lg font-medium text-gray-900">
+              Images & Vidéos
+            </h2>
+            <div className="flex bg-gray-100 rounded-lg p-1">
+              <button
+                type="button"
+                onClick={() => setUploadMode("file")}
+                className={cn(
+                  "px-3 py-1.5 rounded-md text-xs font-medium transition-all",
+                  uploadMode === "file"
+                    ? "bg-white text-gray-900 shadow-sm"
+                    : "text-gray-500 hover:text-gray-900",
+                )}
+              >
+                <Upload size={14} className="inline mr-1.5" />
+                Upload
+              </button>
+              <button
+                type="button"
+                onClick={() => setUploadMode("url")}
+                className={cn(
+                  "px-3 py-1.5 rounded-md text-xs font-medium transition-all",
+                  uploadMode === "url"
+                    ? "bg-white text-gray-900 shadow-sm"
+                    : "text-gray-500 hover:text-gray-900",
+                )}
+              >
+                <LinkIcon size={14} className="inline mr-1.5" />
+                URL
+              </button>
+            </div>
+          </div>
+
+          {uploadMode === "file" ? (
+            <div className="mb-4">
+              <input
+                ref={fileInputRef}
+                type="file"
+                multiple
+                accept="image/*,video/*"
+                onChange={(e) => handleFileUpload(e.target.files)}
+                className="hidden"
+              />
+              <button
+                type="button"
+                onClick={() => fileInputRef.current?.click()}
+                className="w-full border-2 border-dashed border-gray-200 rounded-xl p-8 hover:border-gray-400 hover:bg-gray-50 transition-all group"
+              >
+                <div className="text-center">
+                  <div className="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-white transition-colors">
+                    <Upload
+                      size={24}
+                      className="text-gray-400 group-hover:text-gray-900"
+                    />
+                  </div>
+                  <p className="text-gray-900 font-medium">
+                    Cliquez pour uploader
+                  </p>
+                  <p className="text-gray-400 text-xs mt-1">
+                    Images (JPG, PNG, WebP) ou Vidéos (MP4, WebM)
+                  </p>
                 </div>
-
-                {/* Variants */}
-                <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
-                    <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">Variantes</h2>
-                    
-                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Tailles (séparées par des virgules)</label>
-                            <input
-                                required
-                                name="sizes"
-                                value={formData.sizes}
-                                onChange={handleChange}
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Couleurs (séparées par des virgules)</label>
-                            <input
-                                required
-                                name="colors"
-                                value={formData.colors}
-                                onChange={handleChange}
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
+              </button>
+            </div>
+          ) : (
+            <div className="flex gap-3 mb-4">
+              <input
+                type="url"
+                value={newImageUrl}
+                onChange={(e) => setNewImageUrl(e.target.value)}
+                placeholder="https://exemple.com/image.jpg"
+                className="flex-1 bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+                onKeyDown={(e) =>
+                  e.key === "Enter" && (e.preventDefault(), addImageUrl())
+                }
+              />
+              <button
+                type="button"
+                onClick={addImageUrl}
+                className="px-6 py-3 bg-gray-900 text-white rounded-xl hover:bg-gray-800 transition-colors flex items-center gap-2 text-sm font-medium"
+              >
+                <Plus size={18} />
+                Ajouter
+              </button>
+            </div>
+          )}
+
+          {mediaItems.length > 0 ? (
+            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
+              {mediaItems.map((media, index) => (
+                <div
+                  key={index}
+                  className="relative group aspect-[3/4] bg-gray-100 rounded-xl overflow-hidden"
+                >
+                  {media.type === "video" ? (
+                    <video
+                      src={media.url}
+                      className="w-full h-full object-cover"
+                      muted
+                    />
+                  ) : (
+                    /* eslint-disable-next-line @next/next/no-img-element */
+                    <img
+                      src={media.url}
+                      alt=""
+                      className="w-full h-full object-cover"
+                    />
+                  )}
+
+                  {/* Uploading overlay */}
+                  {media.uploading && (
+                    <div className="absolute inset-0 bg-black/50 flex items-center justify-center">
+                      <Loader2 size={32} className="text-white animate-spin" />
                     </div>
+                  )}
 
-                    {/* Size Guide Toggle */}
-                    <div className="mt-6 pt-6 border-t border-gray-50">
-                        <label className="flex items-center justify-between cursor-pointer">
-                            <div>
-                                <span className="text-sm font-medium text-gray-900">Afficher le guide des tailles</span>
-                                <p className="text-xs text-gray-500 mt-0.5">Permet aux clients de voir les mesures</p>
-                            </div>
-                            <div className="relative">
-                                <input
-                                    type="checkbox"
-                                    checked={formData.showSizeGuide}
-                                    onChange={(e) => setFormData({ ...formData, showSizeGuide: e.target.checked })}
-                                    className="sr-only peer"
-                                />
-                                <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gray-900"></div>
-                            </div>
-                        </label>
+                  {/* Type badge */}
+                  {media.type === "video" && (
+                    <div className="absolute top-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs flex items-center gap-1">
+                      <Video size={12} />
+                      Vidéo
                     </div>
-                </div>
+                  )}
 
-                <div className="flex items-center justify-end gap-4 pt-4 pb-10">
-                    <Link
-                        href="/admin/products"
-                        className="px-6 py-3 text-gray-500 hover:text-gray-900 font-medium transition-colors text-sm"
-                    >
-                        Annuler
-                    </Link>
+                  {!media.uploading && (
                     <button
-                        type="submit"
-                        disabled={saving}
-                        className="bg-gray-900 text-white px-8 py-3 rounded-xl hover:bg-gray-800 transition-all disabled:opacity-50 flex items-center gap-2 text-sm font-medium shadow-sm"
+                      type="button"
+                      onClick={() => removeMedia(index)}
+                      className="absolute top-2 right-2 p-1.5 bg-white/90 text-red-500 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity shadow-sm"
                     >
-                        {saving ? (
-                            <>
-                                <Loader2 size={16} className="animate-spin" />
-                                Enregistrement...
-                            </>
-                        ) : (
-                            <>
-                                <Save size={18} />
-                                Enregistrer
-                            </>
-                        )}
+                      <X size={14} />
                     </button>
+                  )}
+
+                  {/* Primary badge */}
+                  {index === 0 && !media.uploading && (
+                    <span className="absolute bottom-2 left-2 bg-gray-900/90 text-white text-[10px] uppercase tracking-wider font-bold px-2 py-1 rounded">
+                      Principal
+                    </span>
+                  )}
                 </div>
-            </form>
+              ))}
+            </div>
+          ) : (
+            <div className="border border-dashed border-gray-200 rounded-xl p-8 text-center bg-gray-50/50">
+              <div className="w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3 shadow-sm">
+                <ImageIcon size={20} className="text-gray-300" />
+              </div>
+              <p className="text-gray-500 text-sm">Aucun média ajouté</p>
+              <p className="text-gray-400 text-xs">
+                Uploadez des images ou vidéos
+              </p>
+            </div>
+          )}
         </div>
-    );
+
+        {/* Variants */}
+        <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
+          <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">
+            Variantes
+          </h2>
+
+          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Tailles (séparées par des virgules)
+              </label>
+              <input
+                required
+                name="sizes"
+                value={formData.sizes}
+                onChange={handleChange}
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+            </div>
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Couleurs (séparées par des virgules)
+              </label>
+              <input
+                required
+                name="colors"
+                value={formData.colors}
+                onChange={handleChange}
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+            </div>
+          </div>
+
+          {/* Size Guide Toggle */}
+          <div className="mt-6 pt-6 border-t border-gray-50">
+            <label className="flex items-center justify-between cursor-pointer">
+              <div>
+                <span className="text-sm font-medium text-gray-900">
+                  Afficher le guide des tailles
+                </span>
+                <p className="text-xs text-gray-500 mt-0.5">
+                  Permet aux clients de voir les mesures
+                </p>
+              </div>
+              <div className="relative">
+                <input
+                  type="checkbox"
+                  checked={formData.showSizeGuide}
+                  onChange={(e) =>
+                    setFormData({
+                      ...formData,
+                      showSizeGuide: e.target.checked,
+                    })
+                  }
+                  className="sr-only peer"
+                />
+                <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gray-900"></div>
+              </div>
+            </label>
+          </div>
+        </div>
+
+        <div className="flex items-center justify-end gap-4 pt-4 pb-10">
+          <Link
+            href="/admin/products"
+            className="px-6 py-3 text-gray-500 hover:text-gray-900 font-medium transition-colors text-sm"
+          >
+            Annuler
+          </Link>
+          <button
+            type="submit"
+            disabled={saving}
+            className="bg-gray-900 text-white px-8 py-3 rounded-xl hover:bg-gray-800 transition-all disabled:opacity-50 flex items-center gap-2 text-sm font-medium shadow-sm"
+          >
+            {saving ? (
+              <>
+                <Loader2 size={16} className="animate-spin" />
+                Enregistrement...
+              </>
+            ) : (
+              <>
+                <Save size={18} />
+                Enregistrer
+              </>
+            )}
+          </button>
+        </div>
+      </form>
+    </div>
+  );
 }
diff --git a/src/app/admin/products/new/page.tsx b/src/app/admin/products/new/page.tsx
index e4a57c0..45fc5a9 100644
--- a/src/app/admin/products/new/page.tsx
+++ b/src/app/admin/products/new/page.tsx
@@ -2,563 +2,679 @@
 
 import { useState, useEffect, useRef } from "react";
 import { useRouter } from "next/navigation";
-import { ArrowLeft, Upload, X, Plus, Image as ImageIcon, Video, Loader2, Link as LinkIcon } from "lucide-react";
+import {
+  ArrowLeft,
+  Upload,
+  X,
+  Plus,
+  Image as ImageIcon,
+  Video,
+  Loader2,
+  Link as LinkIcon,
+} from "lucide-react";
 import Link from "next/link";
 import { cn } from "@/lib/utils";
 
 interface Collection {
-    id: string;
-    nameFr: string;
-    nameAr: string;
+  id: string;
+  nameFr: string;
+  nameAr: string;
 }
 
 interface UploadedMedia {
-    url: string;
-    type: 'image' | 'video';
-    uploading?: boolean;
+  url: string;
+  type: "image" | "video";
+  uploading?: boolean;
 }
 
 export default function NewProductPage() {
-    const router = useRouter();
-    const fileInputRef = useRef<HTMLInputElement>(null);
-    const [loading, setLoading] = useState(false);
-    const [collections, setCollections] = useState<Collection[]>([]);
-    const [mediaItems, setMediaItems] = useState<UploadedMedia[]>([]);
-    const [uploadMode, setUploadMode] = useState<'file' | 'url'>('file');
-    const [newImageUrl, setNewImageUrl] = useState("");
-    const [formData, setFormData] = useState({
-        nameFr: "",
-        nameAr: "",
-        descriptionFr: "",
-        descriptionAr: "",
-        price: "",
-        stock: "10",
-        sizes: "S, M, L, XL",
-        colors: "Beige, Noir, Kaki",
-        collectionId: "",
-        showSizeGuide: true,
-        freeShipping: false,
-        freeShippingThreshold: "",
-    });
-
-    useEffect(() => {
-        fetch("/api/collections")
-            .then(res => res.json())
-            .then(data => setCollections(Array.isArray(data) ? data : []))
-            .catch(err => console.error("Error fetching collections:", err));
-    }, []);
-
-    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {
-        setFormData({ ...formData, [e.target.name]: e.target.value });
-    };
-
-    const handleFileUpload = async (files: FileList | null) => {
-        if (!files || files.length === 0) return;
-
-        for (const file of Array.from(files)) {
-            const isVideo = file.type.startsWith('video/');
-            const isImage = file.type.startsWith('image/');
-            
-            if (!isVideo && !isImage) {
-                alert(`Le fichier ${file.name} n'est pas une image ou vidéo valide`);
-                continue;
-            }
-
-            // Add placeholder with uploading state
-            const tempId = Date.now() + Math.random();
-            const tempUrl = URL.createObjectURL(file);
-            
-            setMediaItems(prev => [...prev, { 
-                url: tempUrl, 
-                type: isVideo ? 'video' : 'image',
-                uploading: true 
-            }]);
-
-            try {
-                const formData = new FormData();
-                formData.append('file', file);
-
-                const response = await fetch('/api/upload', {
-                    method: 'POST',
-                    body: formData,
-                });
-
-                if (response.ok) {
-                    const data = await response.json();
-                    // Replace temp URL with real URL
-                    setMediaItems(prev => prev.map(item => 
-                        item.url === tempUrl 
-                            ? { url: data.url, type: isVideo ? 'video' : 'image', uploading: false }
-                            : item
-                    ));
-                } else {
-                    // Remove failed upload
-                    setMediaItems(prev => prev.filter(item => item.url !== tempUrl));
-                    alert(`Erreur lors de l'upload de ${file.name}`);
-                }
-            } catch (error) {
-                console.error('Upload error:', error);
-                setMediaItems(prev => prev.filter(item => item.url !== tempUrl));
-                alert(`Erreur lors de l'upload de ${file.name}`);
-            }
-        }
-    };
+  const router = useRouter();
+  const fileInputRef = useRef<HTMLInputElement>(null);
+  const [loading, setLoading] = useState(false);
+  const [collections, setCollections] = useState<Collection[]>([]);
+  const [mediaItems, setMediaItems] = useState<UploadedMedia[]>([]);
+  const [uploadMode, setUploadMode] = useState<"file" | "url">("file");
+  const [newImageUrl, setNewImageUrl] = useState("");
+  const [formData, setFormData] = useState({
+    nameFr: "",
+    nameAr: "",
+    descriptionFr: "",
+    descriptionAr: "",
+    price: "",
+    stock: "10",
+    sizes: "S, M, L, XL",
+    colors: "Beige, Noir, Kaki",
+    collectionId: "",
+    showSizeGuide: true,
+    freeShipping: false,
+    freeShippingThreshold: "",
+  });
 
-    const addImageUrl = () => {
-        if (newImageUrl.trim() && !mediaItems.find(m => m.url === newImageUrl.trim())) {
-            const isVideo = newImageUrl.includes('.mp4') || newImageUrl.includes('.webm') || newImageUrl.includes('.mov');
-            setMediaItems([...mediaItems, { url: newImageUrl.trim(), type: isVideo ? 'video' : 'image' }]);
-            setNewImageUrl("");
-        }
-    };
-
-    const removeMedia = (index: number) => {
-        setMediaItems(mediaItems.filter((_, i) => i !== index));
-    };
-
-    const handleSubmit = async (e: React.FormEvent) => {
-        e.preventDefault();
-        
-        const completedMedia = mediaItems.filter(m => !m.uploading);
-        if (completedMedia.length === 0) {
-            alert("Veuillez ajouter au moins une image ou vidéo");
-            return;
-        }
+  useEffect(() => {
+    fetch("/api/collections")
+      .then((res) => res.json())
+      .then((data) => setCollections(Array.isArray(data) ? data : []))
+      .catch((err) => console.error("Error fetching collections:", err));
+  }, []);
+
+  const handleChange = (
+    e: React.ChangeEvent<
+      HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement
+    >,
+  ) => {
+    setFormData({ ...formData, [e.target.name]: e.target.value });
+  };
+
+  const handleFileUpload = async (files: FileList | null) => {
+    if (!files || files.length === 0) return;
+
+    for (const file of Array.from(files)) {
+      const isVideo = file.type.startsWith("video/");
+      const isImage = file.type.startsWith("image/");
+
+      if (!isVideo && !isImage) {
+        alert(`Le fichier ${file.name} n'est pas une image ou vidéo valide`);
+        continue;
+      }
 
-        setLoading(true);
-
-        try {
-            const response = await fetch("/api/products", {
-                method: "POST",
-                headers: { "Content-Type": "application/json" },
-                body: JSON.stringify({
-                    ...formData,
-                    price: parseInt(formData.price),
-                    stock: parseInt(formData.stock) || 0,
-                    images: completedMedia.map(m => m.url),
-                    sizes: formData.sizes.split(",").map((s) => s.trim()),
-                    colors: formData.colors.split(",").map((s) => s.trim()),
-                    collectionId: formData.collectionId || null,
-                    showSizeGuide: formData.showSizeGuide,
-                    freeShipping: formData.freeShipping,
-                    freeShippingThreshold: formData.freeShipping ? (parseFloat(formData.freeShippingThreshold) || 0) : 0,
-                }),
-            });
-
-            if (response.ok) {
-                router.push("/admin/products");
-            } else {
-                const error = await response.json();
-                alert(error.error || "Erreur lors de la création du produit");
-            }
-        } catch (error) {
-            console.error("Error creating product:", error);
-            alert("Erreur lors de la création du produit");
-        } finally {
-            setLoading(false);
+      // Add placeholder with uploading state
+      const tempId = Date.now() + Math.random();
+      const tempUrl = URL.createObjectURL(file);
+
+      setMediaItems((prev) => [
+        ...prev,
+        {
+          url: tempUrl,
+          type: isVideo ? "video" : "image",
+          uploading: true,
+        },
+      ]);
+
+      try {
+        const formData = new FormData();
+        formData.append("file", file);
+
+        const response = await fetch("/api/upload", {
+          method: "POST",
+          body: formData,
+        });
+
+        if (response.ok) {
+          const data = await response.json();
+          // Replace temp URL with real URL
+          setMediaItems((prev) =>
+            prev.map((item) =>
+              item.url === tempUrl
+                ? {
+                    url: data.url,
+                    type: isVideo ? "video" : "image",
+                    uploading: false,
+                  }
+                : item,
+            ),
+          );
+        } else {
+          // Remove failed upload
+          setMediaItems((prev) => prev.filter((item) => item.url !== tempUrl));
+          alert(`Erreur lors de l'upload de ${file.name}`);
         }
-    };
-
-    return (
-        <div className="max-w-4xl mx-auto space-y-8">
-            <div>
-                <Link href="/admin/products" className="inline-flex items-center gap-2 text-gray-400 hover:text-gray-900 transition-colors mb-6">
-                    <ArrowLeft size={16} />
-                    <span className="text-sm font-medium">Retour aux produits</span>
-                </Link>
-
-                <h1 className="text-3xl font-serif font-medium text-gray-900">Nouveau Produit</h1>
-                <p className="text-gray-500 text-sm mt-2">Remplissez les informations du produit</p>
+      } catch (error) {
+        console.error("Upload error:", error);
+        setMediaItems((prev) => prev.filter((item) => item.url !== tempUrl));
+        alert(`Erreur lors de l'upload de ${file.name}`);
+      }
+    }
+  };
+
+  const addImageUrl = () => {
+    if (
+      newImageUrl.trim() &&
+      !mediaItems.find((m) => m.url === newImageUrl.trim())
+    ) {
+      const isVideo =
+        newImageUrl.includes(".mp4") ||
+        newImageUrl.includes(".webm") ||
+        newImageUrl.includes(".mov");
+      setMediaItems([
+        ...mediaItems,
+        { url: newImageUrl.trim(), type: isVideo ? "video" : "image" },
+      ]);
+      setNewImageUrl("");
+    }
+  };
+
+  const removeMedia = (index: number) => {
+    setMediaItems(mediaItems.filter((_, i) => i !== index));
+  };
+
+  const handleSubmit = async (e: React.FormEvent) => {
+    e.preventDefault();
+
+    const completedMedia = mediaItems.filter((m) => !m.uploading);
+    if (completedMedia.length === 0) {
+      alert("Veuillez ajouter au moins une image ou vidéo");
+      return;
+    }
+
+    setLoading(true);
+
+    try {
+      const response = await fetch("/api/products", {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify({
+          ...formData,
+          price: parseInt(formData.price),
+          stock: parseInt(formData.stock) || 0,
+          images: completedMedia.map((m) => m.url),
+          sizes: formData.sizes.split(",").map((s) => s.trim()),
+          colors: formData.colors.split(",").map((s) => s.trim()),
+          collectionId: formData.collectionId || null,
+          showSizeGuide: formData.showSizeGuide,
+          freeShipping: formData.freeShipping,
+          freeShippingThreshold: formData.freeShipping
+            ? parseFloat(formData.freeShippingThreshold) || 0
+            : 0,
+        }),
+      });
+
+      if (response.ok) {
+        router.push("/admin/products");
+      } else {
+        const error = await response.json();
+        alert(error.error || "Erreur lors de la création du produit");
+      }
+    } catch (error) {
+      console.error("Error creating product:", error);
+      alert("Erreur lors de la création du produit");
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  return (
+    <div className="max-w-4xl mx-auto space-y-8">
+      <div>
+        <Link
+          href="/admin/products"
+          className="inline-flex items-center gap-2 text-gray-400 hover:text-gray-900 transition-colors mb-6"
+        >
+          <ArrowLeft size={16} />
+          <span className="text-sm font-medium">Retour aux produits</span>
+        </Link>
+
+        <h1 className="text-3xl font-serif font-medium text-gray-900">
+          Nouveau Produit
+        </h1>
+        <p className="text-gray-500 text-sm mt-2">
+          Remplissez les informations du produit
+        </p>
+      </div>
+
+      <form onSubmit={handleSubmit} className="space-y-8">
+        {/* Basic Info */}
+        <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
+          <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">
+            Informations de base
+          </h2>
+
+          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Nom (Français) *
+              </label>
+              <input
+                required
+                name="nameFr"
+                value={formData.nameFr}
+                onChange={handleChange}
+                placeholder="Ex: Trench Classique Beige"
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
             </div>
+            <div className="space-y-2" dir="rtl">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                الاسم (بالعربية) *
+              </label>
+              <input
+                required
+                name="nameAr"
+                value={formData.nameAr}
+                onChange={handleChange}
+                placeholder="مثال: معطف كلاسيكي بيج"
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+            </div>
+          </div>
 
-            <form onSubmit={handleSubmit} className="space-y-8">
-                {/* Basic Info */}
-                <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
-                    <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">Informations de base</h2>
-                    
-                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Nom (Français) *</label>
-                            <input
-                                required
-                                name="nameFr"
-                                value={formData.nameFr}
-                                onChange={handleChange}
-                                placeholder="Ex: Trench Classique Beige"
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                        <div className="space-y-2" dir="rtl">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">الاسم (بالعربية) *</label>
-                            <input
-                                required
-                                name="nameAr"
-                                value={formData.nameAr}
-                                onChange={handleChange}
-                                placeholder="مثال: معطف كلاسيكي بيج"
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                    </div>
+          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Description (Français) *
+              </label>
+              <textarea
+                required
+                name="descriptionFr"
+                value={formData.descriptionFr}
+                onChange={handleChange}
+                rows={4}
+                placeholder="Décrivez le produit..."
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all resize-none placeholder:text-gray-400"
+              />
+            </div>
+            <div className="space-y-2" dir="rtl">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                الوصف (بالعربية) *
+              </label>
+              <textarea
+                required
+                name="descriptionAr"
+                value={formData.descriptionAr}
+                onChange={handleChange}
+                rows={4}
+                placeholder="وصف المنتج..."
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all resize-none placeholder:text-gray-400"
+              />
+            </div>
+          </div>
+        </div>
 
-                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Description (Français) *</label>
-                            <textarea
-                                required
-                                name="descriptionFr"
-                                value={formData.descriptionFr}
-                                onChange={handleChange}
-                                rows={4}
-                                placeholder="Décrivez le produit..."
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all resize-none placeholder:text-gray-400"
-                            />
-                        </div>
-                        <div className="space-y-2" dir="rtl">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">الوصف (بالعربية) *</label>
-                            <textarea
-                                required
-                                name="descriptionAr"
-                                value={formData.descriptionAr}
-                                onChange={handleChange}
-                                rows={4}
-                                placeholder="وصف المنتج..."
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all resize-none placeholder:text-gray-400"
-                            />
-                        </div>
-                    </div>
-                </div>
+        {/* Price, Stock & Collection */}
+        <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
+          <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">
+            Prix, Stock & Collection
+          </h2>
 
-                {/* Price, Stock & Collection */}
-                <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
-                    <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">Prix, Stock & Collection</h2>
-                    
-                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Prix (DZD) *</label>
-                            <div className="relative">
-                                <input
-                                    required
-                                    type="number"
-                                    name="price"
-                                    value={formData.price}
-                                    onChange={handleChange}
-                                    placeholder="12500"
-                                    min="0"
-                                    className="w-full bg-gray-50 border-none p-3 pr-16 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                                />
-                                <span className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs font-medium">DZD</span>
-                            </div>
-                        </div>
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Stock disponible *</label>
-                            <input
-                                required
-                                type="number"
-                                name="stock"
-                                value={formData.stock}
-                                onChange={handleChange}
-                                placeholder="10"
-                                min="0"
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                        </div>
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Collection</label>
-                            <select
-                                name="collectionId"
-                                value={formData.collectionId}
-                                onChange={handleChange}
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all text-gray-600"
-                            >
-                                <option value="">-- Aucune collection --</option>
-                                {collections.map((collection) => (
-                                    <option key={collection.id} value={collection.id}>
-                                        {collection.nameFr}
-                                    </option>
-                                ))}
-                            </select>
-                        </div>
-                    </div>
+          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Prix (DZD) *
+              </label>
+              <div className="relative">
+                <input
+                  required
+                  type="number"
+                  name="price"
+                  value={formData.price}
+                  onChange={handleChange}
+                  placeholder="12500"
+                  min="0"
+                  className="w-full bg-gray-50 border-none p-3 pr-16 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+                />
+                <span className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs font-medium">
+                  DZD
+                </span>
+              </div>
+            </div>
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Stock disponible *
+              </label>
+              <input
+                required
+                type="number"
+                name="stock"
+                value={formData.stock}
+                onChange={handleChange}
+                placeholder="10"
+                min="0"
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+            </div>
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Collection
+              </label>
+              <select
+                name="collectionId"
+                value={formData.collectionId}
+                onChange={handleChange}
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all text-gray-600"
+              >
+                <option value="">-- Aucune collection --</option>
+                {collections.map((collection) => (
+                  <option key={collection.id} value={collection.id}>
+                    {collection.nameFr}
+                  </option>
+                ))}
+              </select>
+            </div>
+          </div>
+        </div>
+
+        {/* Images & Videos */}
+        <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
+          <div className="flex items-center justify-between border-b border-gray-50 pb-4">
+            <h2 className="text-lg font-medium text-gray-900">
+              Images & Vidéos
+            </h2>
+            <div className="flex bg-gray-100 rounded-lg p-1">
+              <button
+                type="button"
+                onClick={() => setUploadMode("file")}
+                className={cn(
+                  "px-3 py-1.5 rounded-md text-xs font-medium transition-all",
+                  uploadMode === "file"
+                    ? "bg-white text-gray-900 shadow-sm"
+                    : "text-gray-500 hover:text-gray-900",
+                )}
+              >
+                <Upload size={14} className="inline mr-1.5" />
+                Upload
+              </button>
+              <button
+                type="button"
+                onClick={() => setUploadMode("url")}
+                className={cn(
+                  "px-3 py-1.5 rounded-md text-xs font-medium transition-all",
+                  uploadMode === "url"
+                    ? "bg-white text-gray-900 shadow-sm"
+                    : "text-gray-500 hover:text-gray-900",
+                )}
+              >
+                <LinkIcon size={14} className="inline mr-1.5" />
+                URL
+              </button>
+            </div>
+          </div>
+
+          {uploadMode === "file" ? (
+            <div className="mb-4">
+              <input
+                ref={fileInputRef}
+                type="file"
+                multiple
+                accept="image/*,video/*"
+                onChange={(e) => handleFileUpload(e.target.files)}
+                className="hidden"
+              />
+              <button
+                type="button"
+                onClick={() => fileInputRef.current?.click()}
+                className="w-full border-2 border-dashed border-gray-200 rounded-xl p-12 hover:border-gray-400 hover:bg-gray-50 transition-all group"
+              >
+                <div className="text-center">
+                  <div className="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-white transition-colors">
+                    <Upload
+                      size={24}
+                      className="text-gray-400 group-hover:text-gray-900"
+                    />
+                  </div>
+                  <p className="text-gray-900 font-medium">
+                    Cliquez pour uploader
+                  </p>
+                  <p className="text-gray-400 text-xs mt-1">
+                    Images (JPG, PNG, WebP) ou Vidéos (MP4, WebM)
+                  </p>
                 </div>
+              </button>
+            </div>
+          ) : (
+            <div className="flex gap-3 mb-4">
+              <input
+                type="url"
+                value={newImageUrl}
+                onChange={(e) => setNewImageUrl(e.target.value)}
+                placeholder="https://exemple.com/image.jpg"
+                className="flex-1 bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+                onKeyDown={(e) =>
+                  e.key === "Enter" && (e.preventDefault(), addImageUrl())
+                }
+              />
+              <button
+                type="button"
+                onClick={addImageUrl}
+                className="px-6 py-3 bg-gray-900 text-white rounded-xl hover:bg-gray-800 transition-colors flex items-center gap-2 text-sm font-medium"
+              >
+                <Plus size={18} />
+                Ajouter
+              </button>
+            </div>
+          )}
 
-                {/* Images & Videos */}
-                <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
-                    <div className="flex items-center justify-between border-b border-gray-50 pb-4">
-                        <h2 className="text-lg font-medium text-gray-900">Images & Vidéos</h2>
-                        <div className="flex bg-gray-100 rounded-lg p-1">
-                            <button
-                                type="button"
-                                onClick={() => setUploadMode('file')}
-                                className={cn(
-                                    "px-3 py-1.5 rounded-md text-xs font-medium transition-all",
-                                    uploadMode === 'file' 
-                                        ? 'bg-white text-gray-900 shadow-sm' 
-                                        : 'text-gray-500 hover:text-gray-900'
-                                )}
-                            >
-                                <Upload size={14} className="inline mr-1.5" />
-                                Upload
-                            </button>
-                            <button
-                                type="button"
-                                onClick={() => setUploadMode('url')}
-                                className={cn(
-                                    "px-3 py-1.5 rounded-md text-xs font-medium transition-all",
-                                    uploadMode === 'url' 
-                                        ? 'bg-white text-gray-900 shadow-sm' 
-                                        : 'text-gray-500 hover:text-gray-900'
-                                )}
-                            >
-                                <LinkIcon size={14} className="inline mr-1.5" />
-                                URL
-                            </button>
-                        </div>
-                    </div>
-                    
-                    {uploadMode === 'file' ? (
-                        <div className="mb-4">
-                            <input
-                                ref={fileInputRef}
-                                type="file"
-                                multiple
-                                accept="image/*,video/*"
-                                onChange={(e) => handleFileUpload(e.target.files)}
-                                className="hidden"
-                            />
-                            <button
-                                type="button"
-                                onClick={() => fileInputRef.current?.click()}
-                                className="w-full border-2 border-dashed border-gray-200 rounded-xl p-12 hover:border-gray-400 hover:bg-gray-50 transition-all group"
-                            >
-                                <div className="text-center">
-                                    <div className="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-white transition-colors">
-                                        <Upload size={24} className="text-gray-400 group-hover:text-gray-900" />
-                                    </div>
-                                    <p className="text-gray-900 font-medium">Cliquez pour uploader</p>
-                                    <p className="text-gray-400 text-xs mt-1">Images (JPG, PNG, WebP) ou Vidéos (MP4, WebM)</p>
-                                </div>
-                            </button>
-                        </div>
-                    ) : (
-                        <div className="flex gap-3 mb-4">
-                            <input
-                                type="url"
-                                value={newImageUrl}
-                                onChange={(e) => setNewImageUrl(e.target.value)}
-                                placeholder="https://exemple.com/image.jpg"
-                                className="flex-1 bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                                onKeyDown={(e) => e.key === 'Enter' && (e.preventDefault(), addImageUrl())}
-                            />
-                            <button
-                                type="button"
-                                onClick={addImageUrl}
-                                className="px-6 py-3 bg-gray-900 text-white rounded-xl hover:bg-gray-800 transition-colors flex items-center gap-2 text-sm font-medium"
-                            >
-                                <Plus size={18} />
-                                Ajouter
-                            </button>
-                        </div>
-                    )}
-
-                    {/* Free Shipping Toggle */}
-                    <div className="mb-6 p-5 bg-emerald-50/50 rounded-xl border border-emerald-100">
-                        <label className="flex items-center justify-between cursor-pointer">
-                            <div className="flex items-center gap-4">
-                                <div className="w-10 h-10 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-600">
-                                    <span className="text-lg">🚚</span>
-                                </div>
-                                <div>
-                                    <span className="text-sm font-bold text-gray-900">Livraison gratuite</span>
-                                    <p className="text-xs text-gray-500 mt-0.5">Ce produit sera livré gratuitement</p>
-                                </div>
-                            </div>
-                            <div className="relative">
-                                <input
-                                    type="checkbox"
-                                    checked={formData.freeShipping}
-                                    onChange={(e) => setFormData({ ...formData, freeShipping: e.target.checked, freeShippingThreshold: e.target.checked ? formData.freeShippingThreshold : "" })}
-                                    className="sr-only peer"
-                                />
-                                <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500"></div>
-                            </div>
-                        </label>
-                        
-                        {/* Threshold input - shown when free shipping is enabled */}
-                        {formData.freeShipping && (
-                            <div className="mt-4 pt-4 border-t border-emerald-100/50 animate-in slide-in-from-top-2 duration-200">
-                                <label className="block text-xs font-bold text-gray-500 uppercase tracking-widest mb-2">
-                                    Seuil minimum (optionnel)
-                                </label>
-                                <div className="flex items-center gap-3">
-                                    <span className="text-sm text-gray-500">À partir de</span>
-                                    <div className="relative flex-1 max-w-[200px]">
-                                        <input
-                                            type="number"
-                                            value={formData.freeShippingThreshold}
-                                            onChange={(e) => setFormData({ ...formData, freeShippingThreshold: e.target.value })}
-                                            placeholder="0"
-                                            min="0"
-                                            className="w-full border border-emerald-200 bg-white p-2 pr-14 rounded-lg focus:ring-2 focus:ring-emerald-100 outline-none text-sm"
-                                        />
-                                        <span className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs font-medium">DZD</span>
-                                    </div>
-                                </div>
-                                <p className="text-xs text-emerald-600 mt-2 font-medium">
-                                    {formData.freeShippingThreshold && parseInt(formData.freeShippingThreshold) > 0 
-                                        ? `Livraison gratuite pour les commandes de ${parseInt(formData.freeShippingThreshold).toLocaleString()} DZD et plus`
-                                        : "Laissez vide ou 0 pour livraison gratuite sans condition"}
-                                </p>
-                            </div>
-                        )}
-                    </div>
+          {/* Free Shipping Toggle */}
+          <div className="mb-6 p-5 bg-emerald-50/50 rounded-xl border border-emerald-100">
+            <label className="flex items-center justify-between cursor-pointer">
+              <div className="flex items-center gap-4">
+                <div className="w-10 h-10 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-600">
+                  <span className="text-lg">🚚</span>
+                </div>
+                <div>
+                  <span className="text-sm font-bold text-gray-900">
+                    Livraison gratuite
+                  </span>
+                  <p className="text-xs text-gray-500 mt-0.5">
+                    Ce produit sera livré gratuitement
+                  </p>
+                </div>
+              </div>
+              <div className="relative">
+                <input
+                  type="checkbox"
+                  checked={formData.freeShipping}
+                  onChange={(e) =>
+                    setFormData({
+                      ...formData,
+                      freeShipping: e.target.checked,
+                      freeShippingThreshold: e.target.checked
+                        ? formData.freeShippingThreshold
+                        : "",
+                    })
+                  }
+                  className="sr-only peer"
+                />
+                <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500"></div>
+              </div>
+            </label>
 
-                    {mediaItems.length > 0 ? (
-                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
-                            {mediaItems.map((media, index) => (
-                                <div key={index} className="relative group aspect-[3/4] bg-gray-100 rounded-xl overflow-hidden">
-                                    {media.type === 'video' ? (
-                                        <video
-                                            src={media.url}
-                                            className="w-full h-full object-cover"
-                                            muted
-                                        />
-                                    ) : (
-                                        /* eslint-disable-next-line @next/next/no-img-element */
-                                        <img
-                                            src={media.url}
-                                            alt={`Media ${index + 1}`}
-                                            className="w-full h-full object-cover"
-                                            onError={(e) => {
-                                                (e.target as HTMLImageElement).src = `https://placehold.co/300x400/F5F1EC/4A3A2A?text=Error`;
-                                            }}
-                                        />
-                                    )}
-                                    
-                                    {/* Uploading overlay */}
-                                    {media.uploading && (
-                                        <div className="absolute inset-0 bg-black/50 flex items-center justify-center">
-                                            <Loader2 size={32} className="text-white animate-spin" />
-                                        </div>
-                                    )}
-                                    
-                                    {/* Type badge */}
-                                    {media.type === 'video' && (
-                                        <div className="absolute top-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs flex items-center gap-1">
-                                            <Video size={12} />
-                                            Vidéo
-                                        </div>
-                                    )}
-                                    
-                                    {/* Remove button */}
-                                    {!media.uploading && (
-                                        <button
-                                            type="button"
-                                            onClick={() => removeMedia(index)}
-                                            className="absolute top-2 right-2 p-1.5 bg-white/90 text-red-500 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity shadow-sm"
-                                        >
-                                            <X size={14} />
-                                        </button>
-                                    )}
-                                    
-                                    {/* Primary badge */}
-                                    {index === 0 && !media.uploading && (
-                                        <span className="absolute bottom-2 left-2 bg-gray-900/90 text-white text-[10px] uppercase tracking-wider font-bold px-2 py-1 rounded">
-                                            Principal
-                                        </span>
-                                    )}
-                                </div>
-                            ))}
-                        </div>
-                    ) : (
-                        <div className="border border-dashed border-gray-200 rounded-xl p-8 text-center bg-gray-50/50">
-                            <div className="w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3 shadow-sm">
-                                <ImageIcon size={20} className="text-gray-300" />
-                            </div>
-                            <p className="text-gray-500 text-sm">Aucun média ajouté</p>
-                            <p className="text-gray-400 text-xs">Uploadez des images ou vidéos</p>
-                        </div>
-                    )}
+            {/* Threshold input - shown when free shipping is enabled */}
+            {formData.freeShipping && (
+              <div className="mt-4 pt-4 border-t border-emerald-100/50 animate-in slide-in-from-top-2 duration-200">
+                <label className="block text-xs font-bold text-gray-500 uppercase tracking-widest mb-2">
+                  Seuil minimum (optionnel)
+                </label>
+                <div className="flex items-center gap-3">
+                  <span className="text-sm text-gray-500">À partir de</span>
+                  <div className="relative flex-1 max-w-[200px]">
+                    <input
+                      type="number"
+                      value={formData.freeShippingThreshold}
+                      onChange={(e) =>
+                        setFormData({
+                          ...formData,
+                          freeShippingThreshold: e.target.value,
+                        })
+                      }
+                      placeholder="0"
+                      min="0"
+                      className="w-full border border-emerald-200 bg-white p-2 pr-14 rounded-lg focus:ring-2 focus:ring-emerald-100 outline-none text-sm"
+                    />
+                    <span className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs font-medium">
+                      DZD
+                    </span>
+                  </div>
                 </div>
+                <p className="text-xs text-emerald-600 mt-2 font-medium">
+                  {formData.freeShippingThreshold &&
+                  parseInt(formData.freeShippingThreshold) > 0
+                    ? `Livraison gratuite pour les commandes de ${parseInt(formData.freeShippingThreshold).toLocaleString()} DZD et plus`
+                    : "Laissez vide ou 0 pour livraison gratuite sans condition"}
+                </p>
+              </div>
+            )}
+          </div>
 
-                {/* Variants */}
-                <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
-                    <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">Variantes</h2>
-                    
-                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Tailles disponibles *</label>
-                            <input
-                                required
-                                name="sizes"
-                                value={formData.sizes}
-                                onChange={handleChange}
-                                placeholder="S, M, L, XL"
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                            <p className="text-xs text-gray-400 mt-1 pl-1">Séparez par des virgules</p>
-                        </div>
-                        <div className="space-y-2">
-                            <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">Couleurs disponibles *</label>
-                            <input
-                                required
-                                name="colors"
-                                value={formData.colors}
-                                onChange={handleChange}
-                                placeholder="Beige, Noir, Kaki"
-                                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
-                            />
-                            <p className="text-xs text-gray-400 mt-1 pl-1">Séparez par des virgules</p>
-                        </div>
+          {mediaItems.length > 0 ? (
+            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
+              {mediaItems.map((media, index) => (
+                <div
+                  key={index}
+                  className="relative group aspect-[3/4] bg-gray-100 rounded-xl overflow-hidden"
+                >
+                  {media.type === "video" ? (
+                    <video
+                      src={media.url}
+                      className="w-full h-full object-cover"
+                      muted
+                    />
+                  ) : (
+                    /* eslint-disable-next-line @next/next/no-img-element */
+                    <img
+                      src={media.url}
+                      alt={`Media ${index + 1}`}
+                      className="w-full h-full object-cover"
+                      onError={(e) => {
+                        (e.target as HTMLImageElement).src =
+                          `https://placehold.co/300x400/F5F1EC/4A3A2A?text=Error`;
+                      }}
+                    />
+                  )}
+
+                  {/* Uploading overlay */}
+                  {media.uploading && (
+                    <div className="absolute inset-0 bg-black/50 flex items-center justify-center">
+                      <Loader2 size={32} className="text-white animate-spin" />
                     </div>
+                  )}
 
-                    {/* Size Guide Toggle */}
-                    <div className="mt-6 pt-6 border-t border-gray-50">
-                        <label className="flex items-center justify-between cursor-pointer">
-                            <div>
-                                <span className="text-sm font-medium text-gray-900">Afficher le guide des tailles</span>
-                                <p className="text-xs text-gray-500 mt-0.5">Permet aux clients de voir les mesures</p>
-                            </div>
-                            <div className="relative">
-                                <input
-                                    type="checkbox"
-                                    checked={formData.showSizeGuide}
-                                    onChange={(e) => setFormData({ ...formData, showSizeGuide: e.target.checked })}
-                                    className="sr-only peer"
-                                />
-                                <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gray-900"></div>
-                            </div>
-                        </label>
+                  {/* Type badge */}
+                  {media.type === "video" && (
+                    <div className="absolute top-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs flex items-center gap-1">
+                      <Video size={12} />
+                      Vidéo
                     </div>
-                </div>
+                  )}
 
-                {/* Submit */}
-                <div className="flex items-center justify-end gap-4 pt-4 pb-10">
-                    <Link
-                        href="/admin/products"
-                        className="px-6 py-3 text-gray-500 hover:text-gray-900 font-medium transition-colors text-sm"
-                    >
-                        Annuler
-                    </Link>
+                  {/* Remove button */}
+                  {!media.uploading && (
                     <button
-                        type="submit"
-                        disabled={loading}
-                        className="bg-gray-900 text-white px-8 py-3 rounded-xl hover:bg-gray-800 transition-all disabled:opacity-50 flex items-center gap-2 text-sm font-medium shadow-sm"
+                      type="button"
+                      onClick={() => removeMedia(index)}
+                      className="absolute top-2 right-2 p-1.5 bg-white/90 text-red-500 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity shadow-sm"
                     >
-                        {loading ? (
-                            <>
-                                <Loader2 size={16} className="animate-spin" />
-                                Création...
-                            </>
-                        ) : (
-                            <>
-                                <Plus size={18} />
-                                Créer le produit
-                            </>
-                        )}
+                      <X size={14} />
                     </button>
+                  )}
+
+                  {/* Primary badge */}
+                  {index === 0 && !media.uploading && (
+                    <span className="absolute bottom-2 left-2 bg-gray-900/90 text-white text-[10px] uppercase tracking-wider font-bold px-2 py-1 rounded">
+                      Principal
+                    </span>
+                  )}
                 </div>
-            </form>
+              ))}
+            </div>
+          ) : (
+            <div className="border border-dashed border-gray-200 rounded-xl p-8 text-center bg-gray-50/50">
+              <div className="w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3 shadow-sm">
+                <ImageIcon size={20} className="text-gray-300" />
+              </div>
+              <p className="text-gray-500 text-sm">Aucun média ajouté</p>
+              <p className="text-gray-400 text-xs">
+                Uploadez des images ou vidéos
+              </p>
+            </div>
+          )}
+        </div>
+
+        {/* Variants */}
+        <div className="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-6">
+          <h2 className="text-lg font-medium text-gray-900 border-b border-gray-50 pb-4">
+            Variantes
+          </h2>
+
+          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Tailles disponibles *
+              </label>
+              <input
+                required
+                name="sizes"
+                value={formData.sizes}
+                onChange={handleChange}
+                placeholder="S, M, L, XL"
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+              <p className="text-xs text-gray-400 mt-1 pl-1">
+                Séparez par des virgules
+              </p>
+            </div>
+            <div className="space-y-2">
+              <label className="text-xs font-bold text-gray-500 uppercase tracking-widest">
+                Couleurs disponibles *
+              </label>
+              <input
+                required
+                name="colors"
+                value={formData.colors}
+                onChange={handleChange}
+                placeholder="Beige, Noir, Kaki"
+                className="w-full bg-gray-50 border-none p-3 rounded-xl focus:ring-2 focus:ring-gray-200 outline-none transition-all placeholder:text-gray-400"
+              />
+              <p className="text-xs text-gray-400 mt-1 pl-1">
+                Séparez par des virgules
+              </p>
+            </div>
+          </div>
+
+          {/* Size Guide Toggle */}
+          <div className="mt-6 pt-6 border-t border-gray-50">
+            <label className="flex items-center justify-between cursor-pointer">
+              <div>
+                <span className="text-sm font-medium text-gray-900">
+                  Afficher le guide des tailles
+                </span>
+                <p className="text-xs text-gray-500 mt-0.5">
+                  Permet aux clients de voir les mesures
+                </p>
+              </div>
+              <div className="relative">
+                <input
+                  type="checkbox"
+                  checked={formData.showSizeGuide}
+                  onChange={(e) =>
+                    setFormData({
+                      ...formData,
+                      showSizeGuide: e.target.checked,
+                    })
+                  }
+                  className="sr-only peer"
+                />
+                <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gray-900"></div>
+              </div>
+            </label>
+          </div>
+        </div>
+
+        {/* Submit */}
+        <div className="flex items-center justify-end gap-4 pt-4 pb-10">
+          <Link
+            href="/admin/products"
+            className="px-6 py-3 text-gray-500 hover:text-gray-900 font-medium transition-colors text-sm"
+          >
+            Annuler
+          </Link>
+          <button
+            type="submit"
+            disabled={loading}
+            className="bg-gray-900 text-white px-8 py-3 rounded-xl hover:bg-gray-800 transition-all disabled:opacity-50 flex items-center gap-2 text-sm font-medium shadow-sm"
+          >
+            {loading ? (
+              <>
+                <Loader2 size={16} className="animate-spin" />
+                Création...
+              </>
+            ) : (
+              <>
+                <Plus size={18} />
+                Créer le produit
+              </>
+            )}
+          </button>
         </div>
-    );
+      </form>
+    </div>
+  );
 }
diff --git a/src/app/admin/products/page.tsx b/src/app/admin/products/page.tsx
index 29fc0f8..d93498d 100644
--- a/src/app/admin/products/page.tsx
+++ b/src/app/admin/products/page.tsx
@@ -1,186 +1,220 @@
 "use client";
 
 import Link from "next/link";
-import { Plus, Edit, Trash2, Package, Search, Filter, AlertCircle, Tag } from "lucide-react";
+import {
+  Plus,
+  Edit,
+  Trash2,
+  Package,
+  Search,
+  Filter,
+  AlertCircle,
+  Tag,
+} from "lucide-react";
 import { useState, useEffect } from "react";
 import { cn } from "@/lib/utils";
 
 export default function AdminProductsPage() {
-    const [products, setProducts] = useState<any[]>([]);
-    const [loading, setLoading] = useState(true);
-    const [searchQuery, setSearchQuery] = useState("");
+  const [products, setProducts] = useState<any[]>([]);
+  const [loading, setLoading] = useState(true);
+  const [searchQuery, setSearchQuery] = useState("");
 
-    useEffect(() => {
-        fetch("/api/products?pageSize=100")
-            .then((res) => res.json())
-            .then((data) => {
-                const productsList = Array.isArray(data) ? data : (data.items || []);
-                setProducts(productsList);
-                setLoading(false);
-            })
-            .catch((err) => {
-                console.error("Failed to fetch products", err);
-                setLoading(false);
-            });
-    }, []);
+  useEffect(() => {
+    fetch("/api/products?pageSize=100")
+      .then((res) => res.json())
+      .then((data) => {
+        const productsList = Array.isArray(data) ? data : data.items || [];
+        setProducts(productsList);
+        setLoading(false);
+      })
+      .catch((err) => {
+        console.error("Failed to fetch products", err);
+        setLoading(false);
+      });
+  }, []);
 
-    const handleDelete = async (id: string) => {
-        if (!confirm("Êtes-vous sûr de vouloir supprimer ce produit ?")) return;
+  const handleDelete = async (id: string) => {
+    if (!confirm("Êtes-vous sûr de vouloir supprimer ce produit ?")) return;
 
-        try {
-            const res = await fetch(`/api/products/${id}`, {
-                method: "DELETE",
-            });
+    try {
+      const res = await fetch(`/api/products/${id}`, {
+        method: "DELETE",
+      });
 
-            if (res.ok) {
-                setProducts(products.filter((p) => p.id !== id));
-            } else {
-                alert("Erreur lors de la suppression");
-            }
-        } catch (error) {
-            console.error("Error deleting product:", error);
-            alert("Erreur lors de la suppression");
-        }
-    };
+      if (res.ok) {
+        setProducts(products.filter((p) => p.id !== id));
+      } else {
+        alert("Erreur lors de la suppression");
+      }
+    } catch (error) {
+      console.error("Error deleting product:", error);
+      alert("Erreur lors de la suppression");
+    }
+  };
 
-    const filteredProducts = products.filter(p => 
-        p.nameFr.toLowerCase().includes(searchQuery.toLowerCase()) ||
-        p.collection?.nameFr?.toLowerCase().includes(searchQuery.toLowerCase())
-    );
+  const filteredProducts = products.filter(
+    (p) =>
+      p.nameFr.toLowerCase().includes(searchQuery.toLowerCase()) ||
+      p.collection?.nameFr?.toLowerCase().includes(searchQuery.toLowerCase()),
+  );
 
-    return (
-        <div className="space-y-8">
-            {/* Header */}
-            <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
-                <div>
-                    <h1 className="text-3xl font-serif font-medium text-gray-900">Produits</h1>
-                    <p className="text-gray-500 text-sm mt-1">Gérez votre catalogue produit</p>
-                </div>
-                <Link
-                    href="/admin/products/new"
-                    className="inline-flex items-center gap-2 bg-gray-900 text-white px-5 py-2.5 rounded-lg hover:bg-gray-800 transition-all text-sm font-medium shadow-sm"
-                >
-                    <Plus size={18} />
-                    Nouveau produit
-                </Link>
-            </div>
+  return (
+    <div className="space-y-8">
+      {/* Header */}
+      <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
+        <div>
+          <h1 className="text-3xl font-serif font-medium text-gray-900">
+            Produits
+          </h1>
+          <p className="text-gray-500 text-sm mt-1">
+            Gérez votre catalogue produit
+          </p>
+        </div>
+        <Link
+          href="/admin/products/new"
+          className="inline-flex items-center gap-2 bg-gray-900 text-white px-5 py-2.5 rounded-lg hover:bg-gray-800 transition-all text-sm font-medium shadow-sm"
+        >
+          <Plus size={18} />
+          Nouveau produit
+        </Link>
+      </div>
 
-            {/* Stats & Filters */}
-            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
-                <div className="bg-white p-5 rounded-xl border border-gray-100 flex items-center gap-4 shadow-sm">
-                    <div className="p-3 bg-purple-50 text-purple-600 rounded-xl">
-                        <Package size={24} />
-                    </div>
-                    <div>
-                        <p className="text-sm text-gray-500 font-medium">Total Produits</p>
-                        <p className="text-2xl font-serif font-medium text-gray-900">{products.length}</p>
-                    </div>
-                </div>
-                
-                <div className="md:col-span-2 bg-white p-1 rounded-xl border border-gray-100 shadow-sm flex items-center">
-                    <div className="relative flex-1">
-                        <Search size={18} className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" />
-                        <input 
-                            type="text" 
-                            placeholder="Rechercher par nom, collection..." 
-                            className="w-full pl-10 pr-4 py-3 bg-transparent border-none text-sm focus:ring-0 outline-none placeholder:text-gray-400"
-                            value={searchQuery}
-                            onChange={(e) => setSearchQuery(e.target.value)}
+      {/* Stats & Filters */}
+      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
+        <div className="bg-white p-5 rounded-xl border border-gray-100 flex items-center gap-4 shadow-sm">
+          <div className="p-3 bg-purple-50 text-purple-600 rounded-xl">
+            <Package size={24} />
+          </div>
+          <div>
+            <p className="text-sm text-gray-500 font-medium">Total Produits</p>
+            <p className="text-2xl font-serif font-medium text-gray-900">
+              {products.length}
+            </p>
+          </div>
+        </div>
+
+        <div className="md:col-span-2 bg-white p-1 rounded-xl border border-gray-100 shadow-sm flex items-center">
+          <div className="relative flex-1">
+            <Search
+              size={18}
+              className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
+            />
+            <input
+              type="text"
+              placeholder="Rechercher par nom, collection..."
+              className="w-full pl-10 pr-4 py-3 bg-transparent border-none text-sm focus:ring-0 outline-none placeholder:text-gray-400"
+              value={searchQuery}
+              onChange={(e) => setSearchQuery(e.target.value)}
+            />
+          </div>
+          <div className="pr-1">
+            <button className="p-2.5 text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded-lg transition-colors">
+              <Filter size={18} />
+            </button>
+          </div>
+        </div>
+      </div>
+
+      {/* Table */}
+      <div className="bg-white rounded-xl border border-gray-100 overflow-hidden shadow-sm">
+        <table className="w-full text-left">
+          <thead>
+            <tr className="border-b border-gray-100 bg-gray-50/50 text-xs uppercase tracking-widest text-gray-500">
+              <th className="py-4 px-6 font-medium">Produit</th>
+              <th className="py-4 px-6 font-medium">Collection</th>
+              <th className="py-4 px-6 font-medium">Prix</th>
+              <th className="py-4 px-6 font-medium">Stock</th>
+              <th className="py-4 px-6 font-medium text-right">Actions</th>
+            </tr>
+          </thead>
+          <tbody className="divide-y divide-gray-50 text-sm">
+            {loading ? (
+              <tr>
+                <td colSpan={5} className="py-16 text-center text-gray-400">
+                  Chargement...
+                </td>
+              </tr>
+            ) : filteredProducts.length === 0 ? (
+              <tr>
+                <td colSpan={5} className="py-16 text-center text-gray-400">
+                  Aucun produit trouvé.
+                </td>
+              </tr>
+            ) : (
+              filteredProducts.map((product) => (
+                <tr
+                  key={product.id}
+                  className="hover:bg-gray-50/50 transition-colors group"
+                >
+                  <td className="py-4 px-6">
+                    <div className="flex items-center gap-4">
+                      <div className="w-12 h-14 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 border border-gray-100">
+                        {/* eslint-disable-next-line @next/next/no-img-element */}
+                        <img
+                          src={JSON.parse(product.images || "[]")[0]}
+                          alt={product.nameFr}
+                          className="w-full h-full object-cover"
                         />
+                      </div>
+                      <span className="font-medium text-gray-900">
+                        {product.nameFr}
+                      </span>
                     </div>
-                    <div className="pr-1">
-                        <button className="p-2.5 text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded-lg transition-colors">
-                            <Filter size={18} />
-                        </button>
-                    </div>
-                </div>
-            </div>
-
-            {/* Table */}
-            <div className="bg-white rounded-xl border border-gray-100 overflow-hidden shadow-sm">
-                <table className="w-full text-left">
-                    <thead>
-                        <tr className="border-b border-gray-100 bg-gray-50/50 text-xs uppercase tracking-widest text-gray-500">
-                            <th className="py-4 px-6 font-medium">Produit</th>
-                            <th className="py-4 px-6 font-medium">Collection</th>
-                            <th className="py-4 px-6 font-medium">Prix</th>
-                            <th className="py-4 px-6 font-medium">Stock</th>
-                            <th className="py-4 px-6 font-medium text-right">Actions</th>
-                        </tr>
-                    </thead>
-                    <tbody className="divide-y divide-gray-50 text-sm">
-                        {loading ? (
-                            <tr>
-                                <td colSpan={5} className="py-16 text-center text-gray-400">Chargement...</td>
-                            </tr>
-                        ) : filteredProducts.length === 0 ? (
-                            <tr>
-                                <td colSpan={5} className="py-16 text-center text-gray-400">Aucun produit trouvé.</td>
-                            </tr>
-                        ) : (
-                            filteredProducts.map((product) => (
-                                <tr key={product.id} className="hover:bg-gray-50/50 transition-colors group">
-                                    <td className="py-4 px-6">
-                                        <div className="flex items-center gap-4">
-                                            <div className="w-12 h-14 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 border border-gray-100">
-                                                {/* eslint-disable-next-line @next/next/no-img-element */}
-                                                <img
-                                                    src={JSON.parse(product.images || "[]")[0]}
-                                                    alt={product.nameFr}
-                                                    className="w-full h-full object-cover"
-                                                />
-                                            </div>
-                                            <span className="font-medium text-gray-900">{product.nameFr}</span>
-                                        </div>
-                                    </td>
-                                    <td className="py-4 px-6">
-                                        {product.collection ? (
-                                            <span className="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-gray-50 text-gray-600 text-xs font-medium border border-gray-100">
-                                                <Tag size={12} />
-                                                {product.collection.nameFr}
-                                            </span>
-                                        ) : (
-                                            <span className="text-gray-400">—</span>
-                                        )}
-                                    </td>
-                                    <td className="py-4 px-6 font-medium text-gray-900">{product.price?.toLocaleString()} DZD</td>
-                                    <td className="py-4 px-6">
-                                        <div className="flex items-center gap-2">
-                                            <span className={cn(
-                                                "inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium border",
-                                                (product.stock || 0) === 0 ? 'bg-red-50 text-red-700 border-red-100' :
-                                                (product.stock || 0) < 5 ? 'bg-amber-50 text-amber-700 border-amber-100' :
-                                                'bg-emerald-50 text-emerald-700 border-emerald-100'
-                                            )}>
-                                                {product.stock || 0} en stock
-                                            </span>
-                                            {(product.stock || 0) < 5 && (
-                                                <AlertCircle size={14} className="text-amber-500" />
-                                            )}
-                                        </div>
-                                    </td>
-                                    <td className="py-4 px-6 text-right">
-                                        <div className="flex justify-end items-center gap-2 opacity-0 group-hover:opacity-100 transition-all translate-x-2 group-hover:translate-x-0">
-                                            <Link
-                                                href={`/admin/products/${product.id}/edit`}
-                                                className="p-2 text-gray-400 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"
-                                            >
-                                                <Edit size={16} />
-                                            </Link>
-                                            <button
-                                                onClick={() => handleDelete(product.id)}
-                                                className="p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors"
-                                            >
-                                                <Trash2 size={16} />
-                                            </button>
-                                        </div>
-                                    </td>
-                                </tr>
-                            ))
+                  </td>
+                  <td className="py-4 px-6">
+                    {product.collection ? (
+                      <span className="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-gray-50 text-gray-600 text-xs font-medium border border-gray-100">
+                        <Tag size={12} />
+                        {product.collection.nameFr}
+                      </span>
+                    ) : (
+                      <span className="text-gray-400">—</span>
+                    )}
+                  </td>
+                  <td className="py-4 px-6 font-medium text-gray-900">
+                    {product.price?.toLocaleString()} DZD
+                  </td>
+                  <td className="py-4 px-6">
+                    <div className="flex items-center gap-2">
+                      <span
+                        className={cn(
+                          "inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium border",
+                          (product.stock || 0) === 0
+                            ? "bg-red-50 text-red-700 border-red-100"
+                            : (product.stock || 0) < 5
+                              ? "bg-amber-50 text-amber-700 border-amber-100"
+                              : "bg-emerald-50 text-emerald-700 border-emerald-100",
                         )}
-                    </tbody>
-                </table>
-            </div>
-        </div>
-    );
+                      >
+                        {product.stock || 0} en stock
+                      </span>
+                      {(product.stock || 0) < 5 && (
+                        <AlertCircle size={14} className="text-amber-500" />
+                      )}
+                    </div>
+                  </td>
+                  <td className="py-4 px-6 text-right">
+                    <div className="flex justify-end items-center gap-2 opacity-0 group-hover:opacity-100 transition-all translate-x-2 group-hover:translate-x-0">
+                      <Link
+                        href={`/admin/products/${product.id}/edit`}
+                        className="p-2 text-gray-400 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"
+                      >
+                        <Edit size={16} />
+                      </Link>
+                      <button
+                        onClick={() => handleDelete(product.id)}
+                        className="p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors"
+                      >
+                        <Trash2 size={16} />
+                      </button>
+                    </div>
+                  </td>
+                </tr>
+              ))
+            )}
+          </tbody>
+        </table>
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/admin/settings/customization/page.tsx b/src/app/admin/settings/customization/page.tsx
index dc8ef50..dc6db64 100644
--- a/src/app/admin/settings/customization/page.tsx
+++ b/src/app/admin/settings/customization/page.tsx
@@ -22,7 +22,9 @@ export default async function CustomizationPage() {
 
       {/* Hero Section */}
       <div className="bg-gray-50 rounded-2xl p-6">
-        <h2 className="text-lg font-semibold text-harp-brown mb-4">Section Hero</h2>
+        <h2 className="text-lg font-semibold text-harp-brown mb-4">
+          Section Hero
+        </h2>
         <AdminHeroEditor initial={settings} />
       </div>
     </div>
diff --git a/src/app/admin/settings/page.tsx b/src/app/admin/settings/page.tsx
index f2a9bfa..439e8ea 100644
--- a/src/app/admin/settings/page.tsx
+++ b/src/app/admin/settings/page.tsx
@@ -13,7 +13,10 @@ export default function SettingsPage() {
   const [settings, setSettings] = useState<SiteSettings | null>(null);
   const [loading, setLoading] = useState(true);
   const [saving, setSaving] = useState(false);
-  const [message, setMessage] = useState<{ type: "success" | "error"; text: string } | null>(null);
+  const [message, setMessage] = useState<{
+    type: "success" | "error";
+    text: string;
+  } | null>(null);
 
   useEffect(() => {
     fetch("/api/settings")
@@ -27,7 +30,7 @@ export default function SettingsPage() {
 
   const handleToggle = async (enabled: boolean) => {
     if (!settings) return;
-    
+
     setSaving(true);
     setMessage(null);
 
@@ -43,8 +46,8 @@ export default function SettingsPage() {
         setSettings(updated);
         setMessage({
           type: "success",
-          text: enabled 
-            ? "Promo activée ! La bannière est maintenant visible." 
+          text: enabled
+            ? "Promo activée ! La bannière est maintenant visible."
             : "Promo désactivée.",
         });
       } else {
@@ -69,8 +72,12 @@ export default function SettingsPage() {
     <div className="max-w-4xl space-y-8">
       {/* Header */}
       <div>
-        <h1 className="text-3xl font-serif font-medium text-gray-900">Paramètres</h1>
-        <p className="text-gray-500 text-sm mt-2">Configuration générale de votre boutique</p>
+        <h1 className="text-3xl font-serif font-medium text-gray-900">
+          Paramètres
+        </h1>
+        <p className="text-gray-500 text-sm mt-2">
+          Configuration générale de votre boutique
+        </p>
       </div>
 
       {message && (
@@ -79,10 +86,15 @@ export default function SettingsPage() {
             "p-4 rounded-xl text-sm font-medium border flex items-center gap-2 animate-in slide-in-from-top-2",
             message.type === "success"
               ? "bg-emerald-50 text-emerald-700 border-emerald-100"
-              : "bg-red-50 text-red-700 border-red-100"
+              : "bg-red-50 text-red-700 border-red-100",
           )}
         >
-          <div className={cn("w-1.5 h-1.5 rounded-full", message.type === "success" ? "bg-emerald-500" : "bg-red-500")} />
+          <div
+            className={cn(
+              "w-1.5 h-1.5 rounded-full",
+              message.type === "success" ? "bg-emerald-500" : "bg-red-500",
+            )}
+          />
           {message.text}
         </div>
       )}
@@ -92,11 +104,15 @@ export default function SettingsPage() {
         <div className="p-8 border-b border-gray-50">
           <div className="flex items-center gap-4 mb-2">
             <div className="p-3 bg-emerald-50 text-emerald-600 rounded-xl">
-                <Truck size={24} />
+              <Truck size={24} />
             </div>
             <div>
-                <h2 className="text-lg font-medium text-gray-900">Promo Livraison Gratuite</h2>
-                <p className="text-sm text-gray-500">Activez une offre promotionnelle pour la livraison gratuite</p>
+              <h2 className="text-lg font-medium text-gray-900">
+                Promo Livraison Gratuite
+              </h2>
+              <p className="text-sm text-gray-500">
+                Activez une offre promotionnelle pour la livraison gratuite
+              </p>
             </div>
           </div>
         </div>
@@ -104,7 +120,9 @@ export default function SettingsPage() {
         <div className="p-8 space-y-8">
           <div className="flex items-center justify-between">
             <div>
-              <h3 className="font-medium text-gray-900">Activer la promotion</h3>
+              <h3 className="font-medium text-gray-900">
+                Activer la promotion
+              </h3>
               <p className="text-sm text-gray-500 mt-1">
                 Affiche une bannière "Livraison offerte" sur tout le site
               </p>
@@ -124,14 +142,16 @@ export default function SettingsPage() {
           {/* Prévisualisation */}
           {settings?.freeShippingPromoEnabled && (
             <div className="bg-gray-50/50 rounded-xl p-6 border border-gray-100 animate-in fade-in duration-300">
-              <p className="text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 text-center">Prévisualisation</p>
-              
+              <p className="text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 text-center">
+                Prévisualisation
+              </p>
+
               <div className="bg-gray-900 text-white py-3 px-4 rounded-lg text-center shadow-sm max-w-md mx-auto">
                 <div className="flex items-center justify-center gap-2">
-                    <Zap size={14} className="text-emerald-400 fill-current" />
-                    <p className="text-sm font-medium tracking-wide">
+                  <Zap size={14} className="text-emerald-400 fill-current" />
+                  <p className="text-sm font-medium tracking-wide">
                     Livraison offerte · Du jeudi soir au samedi soir
-                    </p>
+                  </p>
                 </div>
               </div>
               <p className="text-xs text-gray-400 mt-4 text-center">
@@ -143,18 +163,23 @@ export default function SettingsPage() {
           {/* Textes de la promo */}
           {settings?.freeShippingPromoEnabled && (
             <div className="animate-in slide-in-from-top-4 duration-300 delay-100">
-              <h4 className="text-xs font-bold text-gray-900 uppercase tracking-widest mb-4">Fonctionnalités actives</h4>
+              <h4 className="text-xs font-bold text-gray-900 uppercase tracking-widest mb-4">
+                Fonctionnalités actives
+              </h4>
               <ul className="grid grid-cols-1 md:grid-cols-2 gap-4">
                 {[
-                    "Bannière promotionnelle (FR + AR)",
-                    "Badge 'Livraison offerte' sur les produits",
-                    "Message incitatif dans le panier",
-                    "Réduction automatique au checkout"
+                  "Bannière promotionnelle (FR + AR)",
+                  "Badge 'Livraison offerte' sur les produits",
+                  "Message incitatif dans le panier",
+                  "Réduction automatique au checkout",
                 ].map((item, i) => (
-                    <li key={i} className="flex items-center gap-3 text-sm text-gray-600 bg-gray-50 p-3 rounded-xl border border-gray-100/50">
-                        <div className="w-2 h-2 bg-emerald-500 rounded-full shadow-sm ring-2 ring-emerald-100" />
-                        {item}
-                    </li>
+                  <li
+                    key={i}
+                    className="flex items-center gap-3 text-sm text-gray-600 bg-gray-50 p-3 rounded-xl border border-gray-100/50"
+                  >
+                    <div className="w-2 h-2 bg-emerald-500 rounded-full shadow-sm ring-2 ring-emerald-100" />
+                    {item}
+                  </li>
                 ))}
               </ul>
             </div>
diff --git a/src/app/admin/shipping/page.tsx b/src/app/admin/shipping/page.tsx
index a7749f3..67649ce 100644
--- a/src/app/admin/shipping/page.tsx
+++ b/src/app/admin/shipping/page.tsx
@@ -3,574 +3,680 @@
 import { useState, useEffect } from "react";
 import { useSession } from "next-auth/react";
 import Link from "next/link";
-import { 
-    Truck, 
-    Package, 
-    RefreshCw, 
-    CheckCircle, 
-    ExternalLink,
-    Send,
-    MapPin,
-    Phone,
-    Clock,
-    Loader2,
-    ArrowLeft,
-    Wifi,
-    WifiOff,
-    ChevronDown,
-    Box
+import {
+  Truck,
+  Package,
+  RefreshCw,
+  CheckCircle,
+  ExternalLink,
+  Send,
+  MapPin,
+  Phone,
+  Clock,
+  Loader2,
+  ArrowLeft,
+  Wifi,
+  WifiOff,
+  ChevronDown,
+  Box,
 } from "lucide-react";
 import { cn } from "@/lib/utils";
 
-type DeliveryProvider = 'zrexpress' | 'yalidine';
+type DeliveryProvider = "zrexpress" | "yalidine";
 
 interface Order {
-    id: string;
-    customerName: string;
-    customerPhone: string;
-    customerAddress: string;
-    customerCity: string;
-    customerWilaya: string;
-    deliveryType: string;
-    deliveryProvider: string | null;
-    trackingNumber: string | null;
-    trackingStatus: string | null;
-    total: number;
-    status: string;
-    createdAt: string;
-    items: any[];
+  id: string;
+  customerName: string;
+  customerPhone: string;
+  customerAddress: string;
+  customerCity: string;
+  customerWilaya: string;
+  deliveryType: string;
+  deliveryProvider: string | null;
+  trackingNumber: string | null;
+  trackingStatus: string | null;
+  total: number;
+  status: string;
+  createdAt: string;
+  items: any[];
 }
 
 interface ProviderStatus {
-    zrexpress: boolean | null;
-    yalidine: boolean | null;
+  zrexpress: boolean | null;
+  yalidine: boolean | null;
 }
 
 export default function ShippingPage() {
-    const [orders, setOrders] = useState<Order[]>([]);
-    const [loading, setLoading] = useState(true);
-    const [providerStatus, setProviderStatus] = useState<ProviderStatus>({
-        zrexpress: null,
-        yalidine: null
-    });
-    const [syncing, setSyncing] = useState<string | null>(null);
-    const [creating, setCreating] = useState<string | null>(null);
-    const [filter, setFilter] = useState<'all' | 'pending' | 'shipped'>('all');
-    const [showProviderMenu, setShowProviderMenu] = useState<string | null>(null);
-
-    // Vérifier la connexion aux deux services
-    const checkConnections = async () => {
-        // Check ZR Express
-        try {
-            const zrRes = await fetch('/api/shipping');
-            if (zrRes.ok) {
-                const zrData = await zrRes.json();
-                setProviderStatus(prev => ({ ...prev, zrexpress: zrData.connected || false }));
-            } else if (zrRes.status === 401) {
-                console.log('Shipping API: waiting for authentication...');
-            } else {
-                setProviderStatus(prev => ({ ...prev, zrexpress: false }));
-            }
-        } catch {
-            setProviderStatus(prev => ({ ...prev, zrexpress: false }));
-        }
+  const [orders, setOrders] = useState<Order[]>([]);
+  const [loading, setLoading] = useState(true);
+  const [providerStatus, setProviderStatus] = useState<ProviderStatus>({
+    zrexpress: null,
+    yalidine: null,
+  });
+  const [syncing, setSyncing] = useState<string | null>(null);
+  const [creating, setCreating] = useState<string | null>(null);
+  const [filter, setFilter] = useState<"all" | "pending" | "shipped">("all");
+  const [showProviderMenu, setShowProviderMenu] = useState<string | null>(null);
 
-        // Check Yalidine
-        try {
-            const yalRes = await fetch('/api/shipping/yalidine');
-            if (yalRes.ok) {
-                const yalData = await yalRes.json();
-                setProviderStatus(prev => ({ ...prev, yalidine: yalData.connected || false }));
-            } else if (yalRes.status === 401) {
-                console.log('Yalidine API: waiting for authentication...');
-            } else {
-                setProviderStatus(prev => ({ ...prev, yalidine: false }));
-            }
-        } catch {
-            setProviderStatus(prev => ({ ...prev, yalidine: false }));
-        }
-    };
+  // Vérifier la connexion aux deux services
+  const checkConnections = async () => {
+    // Check ZR Express
+    try {
+      const zrRes = await fetch("/api/shipping");
+      if (zrRes.ok) {
+        const zrData = await zrRes.json();
+        setProviderStatus((prev) => ({
+          ...prev,
+          zrexpress: zrData.connected || false,
+        }));
+      } else if (zrRes.status === 401) {
+        console.log("Shipping API: waiting for authentication...");
+      } else {
+        setProviderStatus((prev) => ({ ...prev, zrexpress: false }));
+      }
+    } catch {
+      setProviderStatus((prev) => ({ ...prev, zrexpress: false }));
+    }
 
-    // Charger les commandes
-    const fetchOrders = async () => {
-        try {
-            const res = await fetch('/api/orders?pageSize=100');
-            const data = await res.json();
-            const ordersList = Array.isArray(data) ? data : (data.items || []);
-            setOrders(ordersList);
-        } catch (error) {
-            console.error('Error fetching orders:', error);
-        } finally {
-            setLoading(false);
-        }
-    };
+    // Check Yalidine
+    try {
+      const yalRes = await fetch("/api/shipping/yalidine");
+      if (yalRes.ok) {
+        const yalData = await yalRes.json();
+        setProviderStatus((prev) => ({
+          ...prev,
+          yalidine: yalData.connected || false,
+        }));
+      } else if (yalRes.status === 401) {
+        console.log("Yalidine API: waiting for authentication...");
+      } else {
+        setProviderStatus((prev) => ({ ...prev, yalidine: false }));
+      }
+    } catch {
+      setProviderStatus((prev) => ({ ...prev, yalidine: false }));
+    }
+  };
 
-    const { status } = useSession();
+  // Charger les commandes
+  const fetchOrders = async () => {
+    try {
+      const res = await fetch("/api/orders?pageSize=100");
+      const data = await res.json();
+      const ordersList = Array.isArray(data) ? data : data.items || [];
+      setOrders(ordersList);
+    } catch (error) {
+      console.error("Error fetching orders:", error);
+    } finally {
+      setLoading(false);
+    }
+  };
 
-    useEffect(() => {
-        if (status === "authenticated") {
-            checkConnections();
-        }
+  const { status } = useSession();
+
+  useEffect(() => {
+    if (status === "authenticated") {
+      checkConnections();
+    }
+    fetchOrders();
+  }, [status]);
+
+  // Créer une expédition avec le provider sélectionné
+  const createShipment = async (order: Order, provider: DeliveryProvider) => {
+    setCreating(order.id);
+    setShowProviderMenu(null);
+
+    try {
+      const productsList = order.items
+        .map((item: any) => `${item.quantity}x ${item.productName}`)
+        .join(", ");
+
+      let apiUrl = "/api/shipping";
+      let providerName = "ZR Express";
+      let requestBody: any = {};
+
+      if (provider === "yalidine") {
+        apiUrl = "/api/shipping/yalidine";
+        providerName = "Yalidine";
+        requestBody = {
+          orderId: order.id,
+          orderData: {
+            customerName: order.customerName,
+            customerPhone: order.customerPhone,
+            address: order.customerAddress,
+            commune: order.customerCity,
+            wilaya: order.customerWilaya,
+            total: order.total,
+            deliveryType:
+              order.deliveryType === "STOP_DESK" ? "STOP_DESK" : "DOMICILE",
+            items: order.items,
+            fromWilaya: "Alger",
+          },
+        };
+      } else {
+        requestBody = {
+          orderId: order.id,
+          orderData: {
+            customerName: order.customerName,
+            customerPhone: order.customerPhone,
+            address: order.customerAddress,
+            commune: order.customerCity,
+            wilayaId: getWilayaId(order.customerWilaya),
+            total: order.total,
+            deliveryType: order.deliveryType || "DOMICILE",
+            products: productsList,
+          },
+        };
+      }
+
+      const res = await fetch(apiUrl, {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify(requestBody),
+      });
+
+      const data = await res.json();
+
+      if (data.success) {
+        await fetch(`/api/orders/${order.id}`, {
+          method: "PUT",
+          headers: { "Content-Type": "application/json" },
+          body: JSON.stringify({
+            trackingNumber: data.tracking,
+            status: "CONFIRMED",
+            deliveryProvider: providerName,
+          }),
+        });
         fetchOrders();
-    }, [status]);
-
-    // Créer une expédition avec le provider sélectionné
-    const createShipment = async (order: Order, provider: DeliveryProvider) => {
-        setCreating(order.id);
-        setShowProviderMenu(null);
-        
-        try {
-            const productsList = order.items
-                .map((item: any) => `${item.quantity}x ${item.productName}`)
-                .join(', ');
-
-            let apiUrl = '/api/shipping';
-            let providerName = 'ZR Express';
-            let requestBody: any = {};
-
-            if (provider === 'yalidine') {
-                apiUrl = '/api/shipping/yalidine';
-                providerName = 'Yalidine';
-                requestBody = {
-                    orderId: order.id,
-                    orderData: {
-                        customerName: order.customerName,
-                        customerPhone: order.customerPhone,
-                        address: order.customerAddress,
-                        commune: order.customerCity,
-                        wilaya: order.customerWilaya,
-                        total: order.total,
-                        deliveryType: order.deliveryType === 'STOP_DESK' ? 'STOP_DESK' : 'DOMICILE',
-                        items: order.items,
-                        fromWilaya: 'Alger',
-                    }
-                };
-            } else {
-                requestBody = {
-                    orderId: order.id,
-                    orderData: {
-                        customerName: order.customerName,
-                        customerPhone: order.customerPhone,
-                        address: order.customerAddress,
-                        commune: order.customerCity,
-                        wilayaId: getWilayaId(order.customerWilaya),
-                        total: order.total,
-                        deliveryType: order.deliveryType || 'DOMICILE',
-                        products: productsList,
-                    }
-                };
-            }
-
-            const res = await fetch(apiUrl, {
-                method: 'POST',
-                headers: { 'Content-Type': 'application/json' },
-                body: JSON.stringify(requestBody)
-            });
-
-            const data = await res.json();
-            
-            if (data.success) {
-                await fetch(`/api/orders/${order.id}`, {
-                    method: 'PUT',
-                    headers: { 'Content-Type': 'application/json' },
-                    body: JSON.stringify({
-                        trackingNumber: data.tracking,
-                        status: 'CONFIRMED',
-                        deliveryProvider: providerName
-                    })
-                });
-                fetchOrders();
-                
-                if (data.label) {
-                    const openLabel = confirm(`✅ Expédition créée via ${providerName}!\nTracking: ${data.tracking}\n\nVoulez-vous ouvrir le bordereau ?`);
-                    if (openLabel) {
-                        window.open(data.label, '_blank');
-                    }
-                } else {
-                    alert(`✅ Expédition créée via ${providerName}!\nTracking: ${data.tracking}`);
-                }
-            } else {
-                alert('❌ Erreur: ' + (data.error || 'Échec de création'));
-            }
-        } catch (error) {
-            console.error('Error creating shipment:', error);
-            alert('❌ Erreur de connexion');
-        } finally {
-            setCreating(null);
-        }
-    };
 
-    // Synchroniser le statut (détecte automatiquement le provider)
-    const syncTracking = async (order: Order) => {
-        if (!order.trackingNumber) return;
-        
-        setSyncing(order.id);
-        try {
-            const isYalidine = order.deliveryProvider === 'Yalidine' || order.trackingNumber.startsWith('yal-');
-            
-            let trackingStatus = '';
-            
-            if (isYalidine) {
-                const res = await fetch('/api/shipping/yalidine/track', {
-                    method: 'POST',
-                    headers: { 'Content-Type': 'application/json' },
-                    body: JSON.stringify({
-                        trackingNumbers: [order.trackingNumber]
-                    })
-                });
-                const data = await res.json();
-                if (data.success && data.data?.[0]) {
-                    trackingStatus = data.data[0].last_status;
-                }
-            } else {
-                const res = await fetch('/api/shipping/track', {
-                    method: 'POST',
-                    headers: { 'Content-Type': 'application/json' },
-                    body: JSON.stringify({
-                        trackingNumbers: [order.trackingNumber]
-                    })
-                });
-                const data = await res.json();
-                if (data.success && data.data?.[0]) {
-                    trackingStatus = data.data[0].Situation;
-                }
-            }
-
-            if (trackingStatus) {
-                await fetch(`/api/orders/${order.id}`, {
-                    method: 'PUT',
-                    headers: { 'Content-Type': 'application/json' },
-                    body: JSON.stringify({ trackingStatus })
-                });
-                fetchOrders();
-            }
-        } catch (error) {
-            console.error('Error syncing:', error);
-        } finally {
-            setSyncing(null);
+        if (data.label) {
+          const openLabel = confirm(
+            `✅ Expédition créée via ${providerName}!\nTracking: ${data.tracking}\n\nVoulez-vous ouvrir le bordereau ?`,
+          );
+          if (openLabel) {
+            window.open(data.label, "_blank");
+          }
+        } else {
+          alert(
+            `✅ Expédition créée via ${providerName}!\nTracking: ${data.tracking}`,
+          );
         }
-    };
+      } else {
+        alert("❌ Erreur: " + (data.error || "Échec de création"));
+      }
+    } catch (error) {
+      console.error("Error creating shipment:", error);
+      alert("❌ Erreur de connexion");
+    } finally {
+      setCreating(null);
+    }
+  };
+
+  // Synchroniser le statut (détecte automatiquement le provider)
+  const syncTracking = async (order: Order) => {
+    if (!order.trackingNumber) return;
 
-    // Obtenir le lien de suivi selon le provider
-    const getTrackingUrl = (order: Order): string => {
-        if (!order.trackingNumber) return '#';
-        const isYalidine = order.deliveryProvider === 'Yalidine' || order.trackingNumber.startsWith('yal-');
-        if (isYalidine) {
-            return `https://yalidine.app/track/${order.trackingNumber}`;
+    setSyncing(order.id);
+    try {
+      const isYalidine =
+        order.deliveryProvider === "Yalidine" ||
+        order.trackingNumber.startsWith("yal-");
+
+      let trackingStatus = "";
+
+      if (isYalidine) {
+        const res = await fetch("/api/shipping/yalidine/track", {
+          method: "POST",
+          headers: { "Content-Type": "application/json" },
+          body: JSON.stringify({
+            trackingNumbers: [order.trackingNumber],
+          }),
+        });
+        const data = await res.json();
+        if (data.success && data.data?.[0]) {
+          trackingStatus = data.data[0].last_status;
         }
-        return `https://procolis.com/suivi/${order.trackingNumber}`;
-    };
+      } else {
+        const res = await fetch("/api/shipping/track", {
+          method: "POST",
+          headers: { "Content-Type": "application/json" },
+          body: JSON.stringify({
+            trackingNumbers: [order.trackingNumber],
+          }),
+        });
+        const data = await res.json();
+        if (data.success && data.data?.[0]) {
+          trackingStatus = data.data[0].Situation;
+        }
+      }
 
-    // Helper pour obtenir l'ID de wilaya
-    const getWilayaId = (wilayaName: string): string => {
-        const wilayas: Record<string, string> = {
-            'alger': '16', 'oran': '31', 'constantine': '25', 'blida': '9',
-            'sétif': '19', 'annaba': '23', 'batna': '5', 'tizi ouzou': '15',
-        };
-        return wilayas[wilayaName.toLowerCase()] || '16';
-    };
+      if (trackingStatus) {
+        await fetch(`/api/orders/${order.id}`, {
+          method: "PUT",
+          headers: { "Content-Type": "application/json" },
+          body: JSON.stringify({ trackingStatus }),
+        });
+        fetchOrders();
+      }
+    } catch (error) {
+      console.error("Error syncing:", error);
+    } finally {
+      setSyncing(null);
+    }
+  };
 
-    const filteredOrders = orders.filter(order => {
-        if (filter === 'pending') return !order.trackingNumber && order.status !== 'CANCELLED';
-        if (filter === 'shipped') return !!order.trackingNumber;
-        return true;
-    });
-
-    const getStatusColor = (status: string) => {
-        const colors: Record<string, string> = {
-            'PENDING': 'bg-yellow-50 text-yellow-700 border-yellow-100',
-            'CONFIRMED': 'bg-blue-50 text-blue-700 border-blue-100',
-            'SHIPPED': 'bg-purple-50 text-purple-700 border-purple-100',
-            'DELIVERED': 'bg-green-50 text-green-700 border-green-100',
-            'CANCELLED': 'bg-red-50 text-red-700 border-red-100',
-        };
-        return colors[status] || 'bg-gray-50 text-gray-700 border-gray-100';
+  // Obtenir le lien de suivi selon le provider
+  const getTrackingUrl = (order: Order): string => {
+    if (!order.trackingNumber) return "#";
+    const isYalidine =
+      order.deliveryProvider === "Yalidine" ||
+      order.trackingNumber.startsWith("yal-");
+    if (isYalidine) {
+      return `https://yalidine.app/track/${order.trackingNumber}`;
+    }
+    return `https://procolis.com/suivi/${order.trackingNumber}`;
+  };
+
+  // Helper pour obtenir l'ID de wilaya
+  const getWilayaId = (wilayaName: string): string => {
+    const wilayas: Record<string, string> = {
+      alger: "16",
+      oran: "31",
+      constantine: "25",
+      blida: "9",
+      sétif: "19",
+      annaba: "23",
+      batna: "5",
+      "tizi ouzou": "15",
     };
+    return wilayas[wilayaName.toLowerCase()] || "16";
+  };
 
-    if (loading) {
-        return (
-            <div className="flex items-center justify-center h-[60vh]">
-                <Loader2 size={32} className="animate-spin text-gray-300" />
-            </div>
-        );
-    }
+  const filteredOrders = orders.filter((order) => {
+    if (filter === "pending")
+      return !order.trackingNumber && order.status !== "CANCELLED";
+    if (filter === "shipped") return !!order.trackingNumber;
+    return true;
+  });
+
+  const getStatusColor = (status: string) => {
+    const colors: Record<string, string> = {
+      PENDING: "bg-yellow-50 text-yellow-700 border-yellow-100",
+      CONFIRMED: "bg-blue-50 text-blue-700 border-blue-100",
+      SHIPPED: "bg-purple-50 text-purple-700 border-purple-100",
+      DELIVERED: "bg-green-50 text-green-700 border-green-100",
+      CANCELLED: "bg-red-50 text-red-700 border-red-100",
+    };
+    return colors[status] || "bg-gray-50 text-gray-700 border-gray-100";
+  };
 
+  if (loading) {
     return (
-        <div className="space-y-8">
-            {/* Header */}
-            <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
-                <div>
-                    <div className="flex items-center gap-3 mb-2">
-                        <Link href="/admin" className="text-gray-400 hover:text-gray-900 transition-colors">
-                            <ArrowLeft size={20} />
-                        </Link>
-                        <h1 className="text-3xl font-serif font-medium text-gray-900">Gestion des Livraisons</h1>
-                    </div>
-                    <p className="text-gray-500 text-sm">Gérez vos expéditions via Yalidine et ZR Express</p>
-                </div>
-                
-                {/* Connection Status - Both Providers */}
-                <div className="flex gap-3">
-                    {/* Yalidine Status */}
-                    <div className={cn(
-                        "flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium border",
-                        providerStatus.yalidine === true ? 'bg-emerald-50 text-emerald-700 border-emerald-100' : 
-                        providerStatus.yalidine === false ? 'bg-red-50 text-red-700 border-red-100' : 
-                        'bg-gray-50 text-gray-600 border-gray-100'
-                    )}>
-                        {providerStatus.yalidine === true ? <Wifi size={12} /> : 
-                         providerStatus.yalidine === false ? <WifiOff size={12} /> : 
-                         <Loader2 size={12} className="animate-spin" />}
-                        <span>Yalidine</span>
-                    </div>
-                    
-                    {/* ZR Express Status */}
-                    <div className={cn(
-                        "flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium border",
-                        providerStatus.zrexpress === true ? 'bg-emerald-50 text-emerald-700 border-emerald-100' : 
-                        providerStatus.zrexpress === false ? 'bg-red-50 text-red-700 border-red-100' : 
-                        'bg-gray-50 text-gray-600 border-gray-100'
-                    )}>
-                        {providerStatus.zrexpress === true ? <Wifi size={12} /> : 
-                         providerStatus.zrexpress === false ? <WifiOff size={12} /> : 
-                         <Loader2 size={12} className="animate-spin" />}
-                        <span>ZR Express</span>
-                    </div>
-                </div>
-            </div>
-
-            {/* Stats */}
-            <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
-                <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm flex items-center gap-4">
-                    <div className="p-3 bg-amber-50 text-amber-600 rounded-xl">
-                        <Clock size={24} />
-                    </div>
-                    <div>
-                        <p className="text-sm text-gray-500 font-medium">À expédier</p>
-                        <p className="text-2xl font-serif font-medium text-gray-900">
-                            {orders.filter(o => !o.trackingNumber && o.status !== 'CANCELLED').length}
-                        </p>
-                    </div>
-                </div>
-                <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm flex items-center gap-4">
-                    <div className="p-3 bg-purple-50 text-purple-600 rounded-xl">
-                        <Truck size={24} />
-                    </div>
-                    <div>
-                        <p className="text-sm text-gray-500 font-medium">En transit</p>
-                        <p className="text-2xl font-serif font-medium text-gray-900">
-                            {orders.filter(o => o.trackingNumber && o.status === 'SHIPPED').length}
-                        </p>
-                    </div>
-                </div>
-                <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm flex items-center gap-4">
-                    <div className="p-3 bg-emerald-50 text-emerald-600 rounded-xl">
-                        <CheckCircle size={24} />
-                    </div>
-                    <div>
-                        <p className="text-sm text-gray-500 font-medium">Livrées</p>
-                        <p className="text-2xl font-serif font-medium text-gray-900">
-                            {orders.filter(o => o.status === 'DELIVERED').length}
-                        </p>
-                    </div>
-                </div>
-                <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm flex items-center gap-4">
-                    <div className="p-3 bg-blue-50 text-blue-600 rounded-xl">
-                        <Box size={24} />
-                    </div>
-                    <div>
-                        <p className="text-sm text-gray-500 font-medium">Total expédiées</p>
-                        <p className="text-2xl font-serif font-medium text-gray-900">
-                            {orders.filter(o => o.trackingNumber).length}
-                        </p>
-                    </div>
-                </div>
-            </div>
-
-            {/* Filters */}
-            <div className="flex gap-2 border-b border-gray-100 pb-4">
-                {[
-                    { key: 'all', label: 'Toutes' },
-                    { key: 'pending', label: 'À expédier' },
-                    { key: 'shipped', label: 'Expédiées' },
-                ].map((f) => (
-                    <button
-                        key={f.key}
-                        onClick={() => setFilter(f.key as any)}
+      <div className="flex items-center justify-center h-[60vh]">
+        <Loader2 size={32} className="animate-spin text-gray-300" />
+      </div>
+    );
+  }
+
+  return (
+    <div className="space-y-8">
+      {/* Header */}
+      <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
+        <div>
+          <div className="flex items-center gap-3 mb-2">
+            <Link
+              href="/admin"
+              className="text-gray-400 hover:text-gray-900 transition-colors"
+            >
+              <ArrowLeft size={20} />
+            </Link>
+            <h1 className="text-3xl font-serif font-medium text-gray-900">
+              Gestion des Livraisons
+            </h1>
+          </div>
+          <p className="text-gray-500 text-sm">
+            Gérez vos expéditions via Yalidine et ZR Express
+          </p>
+        </div>
+
+        {/* Connection Status - Both Providers */}
+        <div className="flex gap-3">
+          {/* Yalidine Status */}
+          <div
+            className={cn(
+              "flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium border",
+              providerStatus.yalidine === true
+                ? "bg-emerald-50 text-emerald-700 border-emerald-100"
+                : providerStatus.yalidine === false
+                  ? "bg-red-50 text-red-700 border-red-100"
+                  : "bg-gray-50 text-gray-600 border-gray-100",
+            )}
+          >
+            {providerStatus.yalidine === true ? (
+              <Wifi size={12} />
+            ) : providerStatus.yalidine === false ? (
+              <WifiOff size={12} />
+            ) : (
+              <Loader2 size={12} className="animate-spin" />
+            )}
+            <span>Yalidine</span>
+          </div>
+
+          {/* ZR Express Status */}
+          <div
+            className={cn(
+              "flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium border",
+              providerStatus.zrexpress === true
+                ? "bg-emerald-50 text-emerald-700 border-emerald-100"
+                : providerStatus.zrexpress === false
+                  ? "bg-red-50 text-red-700 border-red-100"
+                  : "bg-gray-50 text-gray-600 border-gray-100",
+            )}
+          >
+            {providerStatus.zrexpress === true ? (
+              <Wifi size={12} />
+            ) : providerStatus.zrexpress === false ? (
+              <WifiOff size={12} />
+            ) : (
+              <Loader2 size={12} className="animate-spin" />
+            )}
+            <span>ZR Express</span>
+          </div>
+        </div>
+      </div>
+
+      {/* Stats */}
+      <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
+        <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm flex items-center gap-4">
+          <div className="p-3 bg-amber-50 text-amber-600 rounded-xl">
+            <Clock size={24} />
+          </div>
+          <div>
+            <p className="text-sm text-gray-500 font-medium">À expédier</p>
+            <p className="text-2xl font-serif font-medium text-gray-900">
+              {
+                orders.filter(
+                  (o) => !o.trackingNumber && o.status !== "CANCELLED",
+                ).length
+              }
+            </p>
+          </div>
+        </div>
+        <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm flex items-center gap-4">
+          <div className="p-3 bg-purple-50 text-purple-600 rounded-xl">
+            <Truck size={24} />
+          </div>
+          <div>
+            <p className="text-sm text-gray-500 font-medium">En transit</p>
+            <p className="text-2xl font-serif font-medium text-gray-900">
+              {
+                orders.filter((o) => o.trackingNumber && o.status === "SHIPPED")
+                  .length
+              }
+            </p>
+          </div>
+        </div>
+        <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm flex items-center gap-4">
+          <div className="p-3 bg-emerald-50 text-emerald-600 rounded-xl">
+            <CheckCircle size={24} />
+          </div>
+          <div>
+            <p className="text-sm text-gray-500 font-medium">Livrées</p>
+            <p className="text-2xl font-serif font-medium text-gray-900">
+              {orders.filter((o) => o.status === "DELIVERED").length}
+            </p>
+          </div>
+        </div>
+        <div className="bg-white p-5 rounded-xl border border-gray-100 shadow-sm flex items-center gap-4">
+          <div className="p-3 bg-blue-50 text-blue-600 rounded-xl">
+            <Box size={24} />
+          </div>
+          <div>
+            <p className="text-sm text-gray-500 font-medium">Total expédiées</p>
+            <p className="text-2xl font-serif font-medium text-gray-900">
+              {orders.filter((o) => o.trackingNumber).length}
+            </p>
+          </div>
+        </div>
+      </div>
+
+      {/* Filters */}
+      <div className="flex gap-2 border-b border-gray-100 pb-4">
+        {[
+          { key: "all", label: "Toutes" },
+          { key: "pending", label: "À expédier" },
+          { key: "shipped", label: "Expédiées" },
+        ].map((f) => (
+          <button
+            key={f.key}
+            onClick={() => setFilter(f.key as any)}
+            className={cn(
+              "px-4 py-2 rounded-full text-sm font-medium transition-all",
+              filter === f.key
+                ? "bg-gray-900 text-white shadow-sm"
+                : "text-gray-500 hover:text-gray-900 hover:bg-gray-50",
+            )}
+          >
+            {f.label}
+          </button>
+        ))}
+      </div>
+
+      {/* Orders Table */}
+      <div className="bg-white rounded-xl border border-gray-100 overflow-hidden shadow-sm">
+        <div className="overflow-x-auto">
+          <table className="w-full text-left">
+            <thead>
+              <tr className="border-b border-gray-100 bg-gray-50/50 text-xs uppercase tracking-widest text-gray-500">
+                <th className="py-4 px-6 font-medium">Commande</th>
+                <th className="py-4 px-6 font-medium">Client</th>
+                <th className="py-4 px-6 font-medium">Destination</th>
+                <th className="py-4 px-6 font-medium">Tracking</th>
+                <th className="py-4 px-6 font-medium">Statut</th>
+                <th className="py-4 px-6 font-medium text-right">Actions</th>
+              </tr>
+            </thead>
+            <tbody className="divide-y divide-gray-50 text-sm">
+              {filteredOrders.length === 0 ? (
+                <tr>
+                  <td colSpan={6} className="py-16 text-center text-gray-400">
+                    Aucune commande trouvée
+                  </td>
+                </tr>
+              ) : (
+                filteredOrders.map((order) => (
+                  <tr
+                    key={order.id}
+                    className="hover:bg-gray-50/50 transition-colors group"
+                  >
+                    <td className="py-4 px-6">
+                      <div className="font-mono text-xs text-gray-500 mb-1">
+                        #{order.id.slice(-8).toUpperCase()}
+                      </div>
+                      <div className="text-xs text-gray-400">
+                        {new Date(order.createdAt).toLocaleDateString("fr-FR", {
+                          day: "numeric",
+                          month: "short",
+                        })}
+                      </div>
+                    </td>
+                    <td className="py-4 px-6">
+                      <p className="font-medium text-gray-900">
+                        {order.customerName}
+                      </p>
+                      <p className="text-xs text-gray-500 flex items-center gap-1 mt-0.5">
+                        <Phone size={10} />
+                        {order.customerPhone}
+                      </p>
+                    </td>
+                    <td className="py-4 px-6">
+                      <div className="flex items-start gap-1.5">
+                        <MapPin
+                          size={14}
+                          className="text-gray-400 mt-0.5 flex-shrink-0"
+                        />
+                        <div>
+                          <p className="text-sm text-gray-900 font-medium">
+                            {order.customerCity}, {order.customerWilaya}
+                          </p>
+                          <p className="text-xs text-gray-500 truncate max-w-[180px]">
+                            {order.customerAddress}
+                          </p>
+                        </div>
+                      </div>
+                    </td>
+                    <td className="py-4 px-6">
+                      {order.trackingNumber ? (
+                        <div className="space-y-1">
+                          <span className="inline-flex items-center gap-1.5 font-mono text-xs bg-gray-50 text-gray-700 px-2 py-1 rounded border border-gray-100">
+                            <Package size={10} className="text-gray-400" />
+                            {order.trackingNumber}
+                          </span>
+                          {order.trackingStatus && (
+                            <p className="text-[10px] text-gray-500 font-medium uppercase tracking-wide">
+                              {order.trackingStatus}
+                            </p>
+                          )}
+                        </div>
+                      ) : (
+                        <span className="text-gray-300 text-xs italic">
+                          Non expédié
+                        </span>
+                      )}
+                    </td>
+                    <td className="py-4 px-6">
+                      <span
                         className={cn(
-                            "px-4 py-2 rounded-full text-sm font-medium transition-all",
-                            filter === f.key
-                                ? 'bg-gray-900 text-white shadow-sm'
-                                : 'text-gray-500 hover:text-gray-900 hover:bg-gray-50'
+                          "inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border",
+                          getStatusColor(order.status),
+                        )}
+                      >
+                        {order.status === "DELIVERED" && (
+                          <CheckCircle size={12} />
                         )}
-                    >
-                        {f.label}
-                    </button>
-                ))}
-            </div>
-
-            {/* Orders Table */}
-            <div className="bg-white rounded-xl border border-gray-100 overflow-hidden shadow-sm">
-                <div className="overflow-x-auto">
-                    <table className="w-full text-left">
-                        <thead>
-                            <tr className="border-b border-gray-100 bg-gray-50/50 text-xs uppercase tracking-widest text-gray-500">
-                                <th className="py-4 px-6 font-medium">Commande</th>
-                                <th className="py-4 px-6 font-medium">Client</th>
-                                <th className="py-4 px-6 font-medium">Destination</th>
-                                <th className="py-4 px-6 font-medium">Tracking</th>
-                                <th className="py-4 px-6 font-medium">Statut</th>
-                                <th className="py-4 px-6 font-medium text-right">Actions</th>
-                            </tr>
-                        </thead>
-                        <tbody className="divide-y divide-gray-50 text-sm">
-                            {filteredOrders.length === 0 ? (
-                                <tr>
-                                    <td colSpan={6} className="py-16 text-center text-gray-400">
-                                        Aucune commande trouvée
-                                    </td>
-                                </tr>
-                            ) : (
-                                filteredOrders.map((order) => (
-                                    <tr key={order.id} className="hover:bg-gray-50/50 transition-colors group">
-                                        <td className="py-4 px-6">
-                                            <div className="font-mono text-xs text-gray-500 mb-1">
-                                                #{order.id.slice(-8).toUpperCase()}
-                                            </div>
-                                            <div className="text-xs text-gray-400">
-                                                {new Date(order.createdAt).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' })}
-                                            </div>
-                                        </td>
-                                        <td className="py-4 px-6">
-                                            <p className="font-medium text-gray-900">{order.customerName}</p>
-                                            <p className="text-xs text-gray-500 flex items-center gap-1 mt-0.5">
-                                                <Phone size={10} />
-                                                {order.customerPhone}
-                                            </p>
-                                        </td>
-                                        <td className="py-4 px-6">
-                                            <div className="flex items-start gap-1.5">
-                                                <MapPin size={14} className="text-gray-400 mt-0.5 flex-shrink-0" />
-                                                <div>
-                                                    <p className="text-sm text-gray-900 font-medium">
-                                                        {order.customerCity}, {order.customerWilaya}
-                                                    </p>
-                                                    <p className="text-xs text-gray-500 truncate max-w-[180px]">
-                                                        {order.customerAddress}
-                                                    </p>
-                                                </div>
-                                            </div>
-                                        </td>
-                                        <td className="py-4 px-6">
-                                            {order.trackingNumber ? (
-                                                <div className="space-y-1">
-                                                    <span className="inline-flex items-center gap-1.5 font-mono text-xs bg-gray-50 text-gray-700 px-2 py-1 rounded border border-gray-100">
-                                                        <Package size={10} className="text-gray-400" />
-                                                        {order.trackingNumber}
-                                                    </span>
-                                                    {order.trackingStatus && (
-                                                        <p className="text-[10px] text-gray-500 font-medium uppercase tracking-wide">
-                                                            {order.trackingStatus}
-                                                        </p>
-                                                    )}
-                                                </div>
-                                            ) : (
-                                                <span className="text-gray-300 text-xs italic">Non expédié</span>
-                                            )}
-                                        </td>
-                                        <td className="py-4 px-6">
-                                            <span className={cn(
-                                                "inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border",
-                                                getStatusColor(order.status)
-                                            )}>
-                                                {order.status === 'DELIVERED' && <CheckCircle size={12} />}
-                                                {order.status === 'SHIPPED' && <Truck size={12} />}
-                                                {order.status === 'PENDING' && <Clock size={12} />}
-                                                {order.status === 'CONFIRMED' && <CheckCircle size={12} />}
-                                                {order.status === 'CANCELLED' && <WifiOff size={12} />}
-                                                {order.status}
-                                            </span>
-                                        </td>
-                                        <td className="py-4 px-6 text-right">
-                                            <div className="flex items-center justify-end gap-2">
-                                                {!order.trackingNumber && order.status !== 'CANCELLED' ? (
-                                                    <div className="relative">
-                                                        <button
-                                                            onClick={() => setShowProviderMenu(showProviderMenu === order.id ? null : order.id)}
-                                                            disabled={creating === order.id}
-                                                            className="inline-flex items-center gap-2 px-4 py-2 bg-gray-900 text-white text-xs font-medium rounded-lg hover:bg-gray-800 disabled:opacity-50 transition-all shadow-sm"
-                                                        >
-                                                            {creating === order.id ? (
-                                                                <Loader2 size={14} className="animate-spin" />
-                                                            ) : (
-                                                                <Send size={14} />
-                                                            )}
-                                                            Expédier
-                                                            <ChevronDown size={14} className={showProviderMenu === order.id ? 'rotate-180' : ''} />
-                                                        </button>
-                                                        
-                                                        {/* Provider Selection Dropdown */}
-                                                        {showProviderMenu === order.id && (
-                                                            <div className="absolute right-0 top-full mt-2 bg-white rounded-xl shadow-xl border border-gray-100 py-1.5 z-20 min-w-[180px] overflow-hidden animate-in fade-in zoom-in-95 duration-200 origin-top-right">
-                                                                <p className="px-4 py-2 text-[10px] font-bold text-gray-400 uppercase tracking-widest">Choisir le transporteur</p>
-                                                                <button
-                                                                    onClick={() => createShipment(order, 'yalidine')}
-                                                                    disabled={!providerStatus.yalidine}
-                                                                    className="w-full px-4 py-2.5 text-left text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 transition-colors"
-                                                                >
-                                                                    <div className={`w-2 h-2 rounded-full ring-2 ring-offset-1 ${providerStatus.yalidine ? 'bg-emerald-500 ring-emerald-100' : 'bg-red-500 ring-red-100'}`} />
-                                                                    <span className="font-medium text-gray-700">Yalidine</span>
-                                                                </button>
-                                                                <button
-                                                                    onClick={() => createShipment(order, 'zrexpress')}
-                                                                    disabled={!providerStatus.zrexpress}
-                                                                    className="w-full px-4 py-2.5 text-left text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 transition-colors"
-                                                                >
-                                                                    <div className={`w-2 h-2 rounded-full ring-2 ring-offset-1 ${providerStatus.zrexpress ? 'bg-emerald-500 ring-emerald-100' : 'bg-red-500 ring-red-100'}`} />
-                                                                    <span className="font-medium text-gray-700">ZR Express</span>
-                                                                </button>
-                                                            </div>
-                                                        )}
-                                                    </div>
-                                                ) : order.trackingNumber ? (
-                                                    <div className="flex items-center justify-end gap-1">
-                                                        {/* Provider Badge */}
-                                                        <span className={cn(
-                                                            "text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded-md border mr-1",
-                                                            order.deliveryProvider === 'Yalidine' 
-                                                                ? 'bg-blue-50 text-blue-700 border-blue-100' 
-                                                                : 'bg-orange-50 text-orange-700 border-orange-100'
-                                                        )}>
-                                                            {order.deliveryProvider || 'ZR'}
-                                                        </span>
-                                                        <button
-                                                            onClick={() => syncTracking(order)}
-                                                            disabled={syncing === order.id}
-                                                            className="p-2 text-gray-400 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"
-                                                            title="Synchroniser le statut"
-                                                        >
-                                                            <RefreshCw size={16} className={syncing === order.id ? 'animate-spin' : ''} />
-                                                        </button>
-                                                        <a
-                                                            href={getTrackingUrl(order)}
-                                                            target="_blank"
-                                                            rel="noopener noreferrer"
-                                                            className="p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"
-                                                            title="Suivre le colis"
-                                                        >
-                                                            <ExternalLink size={16} />
-                                                        </a>
-                                                    </div>
-                                                ) : null}
-                                            </div>
-                                        </td>
-                                    </tr>
-                                ))
+                        {order.status === "SHIPPED" && <Truck size={12} />}
+                        {order.status === "PENDING" && <Clock size={12} />}
+                        {order.status === "CONFIRMED" && (
+                          <CheckCircle size={12} />
+                        )}
+                        {order.status === "CANCELLED" && <WifiOff size={12} />}
+                        {order.status}
+                      </span>
+                    </td>
+                    <td className="py-4 px-6 text-right">
+                      <div className="flex items-center justify-end gap-2">
+                        {!order.trackingNumber &&
+                        order.status !== "CANCELLED" ? (
+                          <div className="relative">
+                            <button
+                              onClick={() =>
+                                setShowProviderMenu(
+                                  showProviderMenu === order.id
+                                    ? null
+                                    : order.id,
+                                )
+                              }
+                              disabled={creating === order.id}
+                              className="inline-flex items-center gap-2 px-4 py-2 bg-gray-900 text-white text-xs font-medium rounded-lg hover:bg-gray-800 disabled:opacity-50 transition-all shadow-sm"
+                            >
+                              {creating === order.id ? (
+                                <Loader2 size={14} className="animate-spin" />
+                              ) : (
+                                <Send size={14} />
+                              )}
+                              Expédier
+                              <ChevronDown
+                                size={14}
+                                className={
+                                  showProviderMenu === order.id
+                                    ? "rotate-180"
+                                    : ""
+                                }
+                              />
+                            </button>
+
+                            {/* Provider Selection Dropdown */}
+                            {showProviderMenu === order.id && (
+                              <div className="absolute right-0 top-full mt-2 bg-white rounded-xl shadow-xl border border-gray-100 py-1.5 z-20 min-w-[180px] overflow-hidden animate-in fade-in zoom-in-95 duration-200 origin-top-right">
+                                <p className="px-4 py-2 text-[10px] font-bold text-gray-400 uppercase tracking-widest">
+                                  Choisir le transporteur
+                                </p>
+                                <button
+                                  onClick={() =>
+                                    createShipment(order, "yalidine")
+                                  }
+                                  disabled={!providerStatus.yalidine}
+                                  className="w-full px-4 py-2.5 text-left text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 transition-colors"
+                                >
+                                  <div
+                                    className={`w-2 h-2 rounded-full ring-2 ring-offset-1 ${providerStatus.yalidine ? "bg-emerald-500 ring-emerald-100" : "bg-red-500 ring-red-100"}`}
+                                  />
+                                  <span className="font-medium text-gray-700">
+                                    Yalidine
+                                  </span>
+                                </button>
+                                <button
+                                  onClick={() =>
+                                    createShipment(order, "zrexpress")
+                                  }
+                                  disabled={!providerStatus.zrexpress}
+                                  className="w-full px-4 py-2.5 text-left text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 transition-colors"
+                                >
+                                  <div
+                                    className={`w-2 h-2 rounded-full ring-2 ring-offset-1 ${providerStatus.zrexpress ? "bg-emerald-500 ring-emerald-100" : "bg-red-500 ring-red-100"}`}
+                                  />
+                                  <span className="font-medium text-gray-700">
+                                    ZR Express
+                                  </span>
+                                </button>
+                              </div>
                             )}
-                        </tbody>
-                    </table>
-                </div>
-            </div>
+                          </div>
+                        ) : order.trackingNumber ? (
+                          <div className="flex items-center justify-end gap-1">
+                            {/* Provider Badge */}
+                            <span
+                              className={cn(
+                                "text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded-md border mr-1",
+                                order.deliveryProvider === "Yalidine"
+                                  ? "bg-blue-50 text-blue-700 border-blue-100"
+                                  : "bg-orange-50 text-orange-700 border-orange-100",
+                              )}
+                            >
+                              {order.deliveryProvider || "ZR"}
+                            </span>
+                            <button
+                              onClick={() => syncTracking(order)}
+                              disabled={syncing === order.id}
+                              className="p-2 text-gray-400 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"
+                              title="Synchroniser le statut"
+                            >
+                              <RefreshCw
+                                size={16}
+                                className={
+                                  syncing === order.id ? "animate-spin" : ""
+                                }
+                              />
+                            </button>
+                            <a
+                              href={getTrackingUrl(order)}
+                              target="_blank"
+                              rel="noopener noreferrer"
+                              className="p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"
+                              title="Suivre le colis"
+                            >
+                              <ExternalLink size={16} />
+                            </a>
+                          </div>
+                        ) : null}
+                      </div>
+                    </td>
+                  </tr>
+                ))
+              )}
+            </tbody>
+          </table>
         </div>
-    );
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/api/accounting/advances/[id]/apply/route.ts b/src/app/api/accounting/advances/[id]/apply/route.ts
index c7aab07..3da7561 100644
--- a/src/app/api/accounting/advances/[id]/apply/route.ts
+++ b/src/app/api/accounting/advances/[id]/apply/route.ts
@@ -17,7 +17,7 @@ const ApplySchema = z.object({
 // POST - Appliquer l'avance à un achat
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -27,11 +27,11 @@ export async function POST(
     const validation = ApplySchema.safeParse(body);
     if (!validation.success) {
       return NextResponse.json(
-        { 
+        {
           error: "Données invalides",
           details: validation.error.flatten().fieldErrors,
         },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -54,7 +54,7 @@ export async function POST(
     console.error("Error applying advance:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de l'application" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
diff --git a/src/app/api/accounting/advances/[id]/route.ts b/src/app/api/accounting/advances/[id]/route.ts
index 0b390f8..a22c5d6 100644
--- a/src/app/api/accounting/advances/[id]/route.ts
+++ b/src/app/api/accounting/advances/[id]/route.ts
@@ -10,17 +10,17 @@ import { getAdvanceById, refundAdvance } from "@/lib/accounting/services";
 // GET - Récupérer une avance par ID
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
-    
+
     const advance = await getAdvanceById(id);
-    
+
     if (!advance) {
       return NextResponse.json(
         { error: "Avance non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
@@ -29,7 +29,7 @@ export async function GET(
     console.error("Error fetching advance:", error);
     return NextResponse.json(
       { error: "Erreur lors de la récupération de l'avance" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -37,7 +37,7 @@ export async function GET(
 // PUT - Mettre à jour une avance (non utilisée uniquement)
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -50,14 +50,14 @@ export async function PUT(
     if (!existing) {
       return NextResponse.json(
         { error: "Avance non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (Number(existing.amountUsed) > 0) {
       return NextResponse.json(
         { error: "Cette avance a déjà été utilisée et ne peut être modifiée" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -65,7 +65,8 @@ export async function PUT(
       where: { id },
       data: {
         amount: data.amount !== undefined ? data.amount : existing.amount,
-        amountRemaining: data.amount !== undefined ? data.amount : existing.amountRemaining,
+        amountRemaining:
+          data.amount !== undefined ? data.amount : existing.amountRemaining,
         paymentDate: data.paymentDate ? new Date(data.paymentDate) : undefined,
         paymentMethod: data.paymentMethod,
         reference: data.reference,
@@ -79,7 +80,7 @@ export async function PUT(
     console.error("Error updating advance:", error);
     return NextResponse.json(
       { error: "Erreur lors de la mise à jour" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -87,7 +88,7 @@ export async function PUT(
 // PATCH - Actions sur l'avance (refund)
 export async function PATCH(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -100,14 +101,14 @@ export async function PATCH(
       default:
         return NextResponse.json(
           { error: `Action inconnue: ${action}` },
-          { status: 400 }
+          { status: 400 },
         );
     }
   } catch (error: any) {
     console.error("Error patching advance:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de l'action" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
@@ -115,7 +116,7 @@ export async function PATCH(
 // DELETE - Supprimer une avance (non utilisée uniquement)
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -127,14 +128,14 @@ export async function DELETE(
     if (!existing) {
       return NextResponse.json(
         { error: "Avance non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (Number(existing.amountUsed) > 0) {
       return NextResponse.json(
         { error: "Cette avance a déjà été utilisée et ne peut être supprimée" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -145,7 +146,7 @@ export async function DELETE(
     console.error("Error deleting advance:", error);
     return NextResponse.json(
       { error: "Erreur lors de la suppression" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/advances/route.ts b/src/app/api/accounting/advances/route.ts
index b0016d2..91cbb40 100644
--- a/src/app/api/accounting/advances/route.ts
+++ b/src/app/api/accounting/advances/route.ts
@@ -5,7 +5,7 @@ import { prisma } from "@/lib/prisma";
 async function generateAdvanceNumber(): Promise<string> {
   const year = new Date().getFullYear();
   const prefix = `AVA-${year}-`;
-  
+
   const last = await prisma.supplierAdvance.findFirst({
     where: { advanceNumber: { startsWith: prefix } },
     orderBy: { advanceNumber: "desc" },
@@ -44,11 +44,14 @@ export async function GET(req: NextRequest) {
     const totals = {
       total: advances.reduce((sum, a) => sum + Number(a.amount), 0),
       used: advances.reduce((sum, a) => sum + Number(a.amountUsed), 0),
-      available: advances.reduce((sum, a) => sum + Number(a.amountRemaining), 0),
+      available: advances.reduce(
+        (sum, a) => sum + Number(a.amountRemaining),
+        0,
+      ),
     };
 
     // Map to expected format for UI
-    const mappedAdvances = advances.map(a => ({
+    const mappedAdvances = advances.map((a) => ({
       ...a,
       date: a.paymentDate,
       currency: "DZD",
@@ -59,7 +62,7 @@ export async function GET(req: NextRequest) {
     console.error("Error fetching advances:", error);
     return NextResponse.json(
       { error: "Failed to fetch advances" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -72,7 +75,7 @@ export async function POST(req: NextRequest) {
     if (!data.supplierId || !data.amount || data.amount <= 0) {
       return NextResponse.json(
         { error: "supplierId and amount are required" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -113,7 +116,7 @@ export async function POST(req: NextRequest) {
     console.error("Error creating advance:", error);
     return NextResponse.json(
       { error: "Failed to create advance" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/charges/[id]/route.ts b/src/app/api/accounting/charges/[id]/route.ts
index e255a43..918c26e 100644
--- a/src/app/api/accounting/charges/[id]/route.ts
+++ b/src/app/api/accounting/charges/[id]/route.ts
@@ -9,11 +9,11 @@ import { prisma } from "@/lib/prisma";
 // GET - Récupérer une charge par ID
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
-    
+
     const charge = await prisma.charge.findUnique({
       where: { id },
       include: {
@@ -21,11 +21,11 @@ export async function GET(
         collection: { select: { id: true, nameFr: true } },
       },
     });
-    
+
     if (!charge) {
       return NextResponse.json(
         { error: "Charge non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
@@ -34,7 +34,7 @@ export async function GET(
     console.error("Error fetching charge:", error);
     return NextResponse.json(
       { error: "Erreur lors de la récupération de la charge" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -42,7 +42,7 @@ export async function GET(
 // PUT - Mettre à jour une charge
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -55,7 +55,7 @@ export async function PUT(
     if (!existing) {
       return NextResponse.json(
         { error: "Charge non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
@@ -104,7 +104,7 @@ export async function PUT(
     console.error("Error updating charge:", error);
     return NextResponse.json(
       { error: "Erreur lors de la mise à jour" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -112,7 +112,7 @@ export async function PUT(
 // DELETE - Supprimer une charge
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -124,7 +124,7 @@ export async function DELETE(
     if (!existing) {
       return NextResponse.json(
         { error: "Charge non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
@@ -145,7 +145,7 @@ export async function DELETE(
     console.error("Error deleting charge:", error);
     return NextResponse.json(
       { error: "Erreur lors de la suppression" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/charges/route.ts b/src/app/api/accounting/charges/route.ts
index 3abe9e4..08c5767 100644
--- a/src/app/api/accounting/charges/route.ts
+++ b/src/app/api/accounting/charges/route.ts
@@ -5,7 +5,7 @@ import { prisma } from "@/lib/prisma";
 async function generateChargeNumber(): Promise<string> {
   const year = new Date().getFullYear();
   const prefix = `CHG-${year}-`;
-  
+
   const last = await prisma.charge.findFirst({
     where: { chargeNumber: { startsWith: prefix } },
     orderBy: { chargeNumber: "desc" },
@@ -29,7 +29,11 @@ export async function GET(req: NextRequest) {
     const modelId = searchParams.get("modelId");
     const collectionId = searchParams.get("collectionId");
 
-    const where: { category?: string; modelId?: string; collectionId?: string } = {};
+    const where: {
+      category?: string;
+      modelId?: string;
+      collectionId?: string;
+    } = {};
     if (category) where.category = category;
     if (modelId) where.modelId = modelId;
     if (collectionId) where.collectionId = collectionId;
@@ -44,7 +48,7 @@ export async function GET(req: NextRequest) {
     });
 
     // Map to expected format
-    const mappedCharges = charges.map(c => ({
+    const mappedCharges = charges.map((c) => ({
       ...c,
       currency: "DZD",
     }));
@@ -55,8 +59,8 @@ export async function GET(req: NextRequest) {
       return acc;
     }, {});
 
-    return NextResponse.json({ 
-      charges: mappedCharges, 
+    return NextResponse.json({
+      charges: mappedCharges,
       byCategory,
       total: charges.reduce((sum, c) => sum + Number(c.amount), 0),
     });
@@ -64,7 +68,7 @@ export async function GET(req: NextRequest) {
     console.error("Error fetching charges:", error);
     return NextResponse.json(
       { error: "Failed to fetch charges" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -77,7 +81,7 @@ export async function POST(req: NextRequest) {
     if (!data.category || !data.description || !data.amount) {
       return NextResponse.json(
         { error: "category, description, and amount are required" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -127,7 +131,7 @@ export async function POST(req: NextRequest) {
     console.error("Error creating charge:", error);
     return NextResponse.json(
       { error: "Failed to create charge" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/inventory/[id]/route.ts b/src/app/api/accounting/inventory/[id]/route.ts
index 80144cd..cb63724 100644
--- a/src/app/api/accounting/inventory/[id]/route.ts
+++ b/src/app/api/accounting/inventory/[id]/route.ts
@@ -4,34 +4,31 @@ import { prisma } from "@/lib/prisma";
 // GET single inventory item
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
-    
+
     const item = await prisma.inventoryItem.findUnique({
       where: { id },
       include: {
         bomItems: {
-          include: { model: true }
+          include: { model: true },
         },
         purchaseItems: {
           include: { purchase: true },
           orderBy: { createdAt: "desc" },
-          take: 10
+          take: 10,
         },
         transactions: {
           orderBy: { createdAt: "desc" },
-          take: 20
-        }
-      }
+          take: 20,
+        },
+      },
     });
 
     if (!item) {
-      return NextResponse.json(
-        { error: "Item not found" },
-        { status: 404 }
-      );
+      return NextResponse.json({ error: "Item not found" }, { status: 404 });
     }
 
     return NextResponse.json(item);
@@ -39,7 +36,7 @@ export async function GET(
     console.error("Error fetching inventory item:", error);
     return NextResponse.json(
       { error: "Failed to fetch inventory item" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -47,7 +44,7 @@ export async function GET(
 // PUT update inventory item
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -71,7 +68,7 @@ export async function PUT(
     console.error("Error updating inventory item:", error);
     return NextResponse.json(
       { error: "Failed to update inventory item" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -79,25 +76,25 @@ export async function PUT(
 // DELETE inventory item
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
 
     // Check if item is used in any BOM
     const bomCount = await prisma.bomItem.count({
-      where: { inventoryItemId: id }
+      where: { inventoryItemId: id },
     });
 
     if (bomCount > 0) {
       return NextResponse.json(
         { error: "Cannot delete: item is used in Bill of Materials" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
     await prisma.inventoryItem.delete({
-      where: { id }
+      where: { id },
     });
 
     return NextResponse.json({ success: true });
@@ -105,7 +102,7 @@ export async function DELETE(
     console.error("Error deleting inventory item:", error);
     return NextResponse.json(
       { error: "Failed to delete inventory item" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/inventory/adjustment/route.ts b/src/app/api/accounting/inventory/adjustment/route.ts
index 34ac91f..f3413f6 100644
--- a/src/app/api/accounting/inventory/adjustment/route.ts
+++ b/src/app/api/accounting/inventory/adjustment/route.ts
@@ -25,15 +25,16 @@ export async function POST(req: NextRequest) {
     const validation = AdjustmentSchema.safeParse(body);
     if (!validation.success) {
       return NextResponse.json(
-        { 
+        {
           error: "Données invalides",
           details: validation.error.flatten().fieldErrors,
         },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
-    const { inventoryItemId, quantity, reason, notes, createdBy } = validation.data;
+    const { inventoryItemId, quantity, reason, notes, createdBy } =
+      validation.data;
 
     // Créer l'ajustement
     const result = await createAdjustment(
@@ -41,20 +42,20 @@ export async function POST(req: NextRequest) {
       quantity,
       reason,
       notes,
-      createdBy
+      createdBy,
     );
 
     return NextResponse.json({
       success: true,
       transaction: result.transaction,
       item: result.item,
-      message: `Ajustement de ${quantity >= 0 ? '+' : ''}${quantity} effectué`,
+      message: `Ajustement de ${quantity >= 0 ? "+" : ""}${quantity} effectué`,
     });
   } catch (error: any) {
     console.error("Error creating adjustment:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de l'ajustement" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
diff --git a/src/app/api/accounting/inventory/reconcile/route.ts b/src/app/api/accounting/inventory/reconcile/route.ts
index 9739b69..904dbdb 100644
--- a/src/app/api/accounting/inventory/reconcile/route.ts
+++ b/src/app/api/accounting/inventory/reconcile/route.ts
@@ -39,7 +39,7 @@ export async function GET(req: NextRequest) {
           select: { id: true, sku: true, name: true },
         });
         return { ...rec, inventoryItem: item };
-      })
+      }),
     );
 
     return NextResponse.json({
@@ -50,7 +50,7 @@ export async function GET(req: NextRequest) {
     console.error("Error fetching reconciliations:", error);
     return NextResponse.json(
       { error: "Erreur lors de la récupération des réconciliations" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -64,11 +64,11 @@ export async function POST(req: NextRequest) {
     const validation = ReconcileSchema.safeParse(body);
     if (!validation.success) {
       return NextResponse.json(
-        { 
+        {
           error: "Données invalides",
           details: validation.error.flatten().fieldErrors,
         },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -80,9 +80,9 @@ export async function POST(req: NextRequest) {
     // Statistiques
     const stats = {
       total: results.length,
-      ok: results.filter(r => r.status === "OK").length,
-      warning: results.filter(r => r.status === "WARNING").length,
-      critical: results.filter(r => r.status === "CRITICAL").length,
+      ok: results.filter((r) => r.status === "OK").length,
+      warning: results.filter((r) => r.status === "WARNING").length,
+      critical: results.filter((r) => r.status === "CRITICAL").length,
     };
 
     return NextResponse.json({
@@ -95,7 +95,7 @@ export async function POST(req: NextRequest) {
     console.error("Error during reconciliation:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de la réconciliation" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
@@ -108,7 +108,7 @@ export async function PATCH(req: NextRequest) {
     if (!reconciliationId || !status) {
       return NextResponse.json(
         { error: "reconciliationId et status requis" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -127,7 +127,7 @@ export async function PATCH(req: NextRequest) {
     console.error("Error updating reconciliation:", error);
     return NextResponse.json(
       { error: "Erreur lors de la mise à jour" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/inventory/route.ts b/src/app/api/accounting/inventory/route.ts
index 6e401a1..42f12e5 100644
--- a/src/app/api/accounting/inventory/route.ts
+++ b/src/app/api/accounting/inventory/route.ts
@@ -5,7 +5,6 @@ import { parsePagination, paginatedResponse } from "@/lib/pagination";
 // GET all inventory items with optional filters
 export async function GET(req: NextRequest) {
   try {
-    
     const { searchParams } = new URL(req.url);
     const { page, pageSize, skip } = parsePagination(searchParams);
     const type = searchParams.get("type");
@@ -16,11 +15,11 @@ export async function GET(req: NextRequest) {
       type?: string;
       OR?: Array<{ name?: { contains: string }; sku?: { contains: string } }>;
     } = {};
-    
+
     if (type) {
       where.type = type;
     }
-    
+
     if (search) {
       where.OR = [
         { name: { contains: search } },
@@ -36,24 +35,26 @@ export async function GET(req: NextRequest) {
         orderBy: { createdAt: "desc" },
         include: {
           _count: {
-            select: { bomItems: true, purchaseItems: true }
-          }
-        }
+            select: { bomItems: true, purchaseItems: true },
+          },
+        },
       });
 
-      items = items.filter((item) => 
-        item.threshold !== null && item.quantity <= item.threshold
+      items = items.filter(
+        (item) => item.threshold !== null && item.quantity <= item.threshold,
       );
 
       const total = items.length;
       const paginatedItems = items.slice(skip, skip + pageSize);
-      
+
       const itemsWithValue = paginatedItems.map((item) => ({
         ...item,
         totalValue: Number(item.quantity) * Number(item.averageCost),
       }));
 
-      return NextResponse.json(paginatedResponse(itemsWithValue, page, pageSize, total));
+      return NextResponse.json(
+        paginatedResponse(itemsWithValue, page, pageSize, total),
+      );
     }
 
     const [items, total] = await Promise.all([
@@ -64,9 +65,9 @@ export async function GET(req: NextRequest) {
         take: pageSize,
         include: {
           _count: {
-            select: { bomItems: true, purchaseItems: true }
-          }
-        }
+            select: { bomItems: true, purchaseItems: true },
+          },
+        },
       }),
       prisma.inventoryItem.count({ where }),
     ]);
@@ -77,36 +78,40 @@ export async function GET(req: NextRequest) {
       totalValue: Number(item.quantity) * Number(item.averageCost),
     }));
 
-    return NextResponse.json(paginatedResponse(itemsWithValue, page, pageSize, total));
+    return NextResponse.json(
+      paginatedResponse(itemsWithValue, page, pageSize, total),
+    );
   } catch (error) {
     console.error("Error fetching inventory:", error);
-    return NextResponse.json({ error: "Failed to fetch inventory" }, { status: 500 });
+    return NextResponse.json(
+      { error: "Failed to fetch inventory" },
+      { status: 500 },
+    );
   }
 }
 
 // POST create new inventory item
 export async function POST(req: NextRequest) {
   try {
-    
     const data = await req.json();
 
     // Validate required fields
     if (!data.sku || !data.name || !data.type || !data.unit) {
       return NextResponse.json(
         { error: "SKU, name, type and unit are required" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
     // Check if SKU already exists
     const existing = await prisma.inventoryItem.findUnique({
-      where: { sku: data.sku }
+      where: { sku: data.sku },
     });
 
     if (existing) {
       return NextResponse.json(
         { error: "SKU already exists" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -132,6 +137,9 @@ export async function POST(req: NextRequest) {
     return NextResponse.json(item, { status: 201 });
   } catch (error) {
     console.error("Error creating inventory item:", error);
-    return NextResponse.json({ error: "Failed to create inventory item" }, { status: 500 });
+    return NextResponse.json(
+      { error: "Failed to create inventory item" },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/accounting/inventory/transactions/route.ts b/src/app/api/accounting/inventory/transactions/route.ts
index 3d0fe66..c3514d6 100644
--- a/src/app/api/accounting/inventory/transactions/route.ts
+++ b/src/app/api/accounting/inventory/transactions/route.ts
@@ -16,7 +16,7 @@ export async function GET(req: NextRequest) {
       direction?: string;
       type?: string;
     } = {};
-    
+
     if (inventoryItemId) where.inventoryItemId = inventoryItemId;
     if (direction) where.direction = direction;
     if (type) where.type = type;
@@ -47,7 +47,7 @@ export async function GET(req: NextRequest) {
     console.error("Error fetching transactions:", error);
     return NextResponse.json(
       { error: "Failed to fetch transactions" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/marketing/route.ts b/src/app/api/accounting/marketing/route.ts
index 9229bc9..097fafa 100644
--- a/src/app/api/accounting/marketing/route.ts
+++ b/src/app/api/accounting/marketing/route.ts
@@ -19,7 +19,8 @@ export async function GET(req: NextRequest) {
     if (modelId) where.modelId = modelId;
     if (startDate || endDate) {
       where.date = {};
-      if (startDate) (where.date as Record<string, Date>).gte = new Date(startDate);
+      if (startDate)
+        (where.date as Record<string, Date>).gte = new Date(startDate);
       if (endDate) (where.date as Record<string, Date>).lte = new Date(endDate);
     }
 
@@ -54,7 +55,7 @@ export async function GET(req: NextRequest) {
     console.error("Error fetching marketing expenses:", error);
     return NextResponse.json(
       { error: "Failed to fetch marketing expenses" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -67,7 +68,7 @@ export async function POST(req: NextRequest) {
     if (!data.category || data.amount === undefined) {
       return NextResponse.json(
         { error: "Category and amount are required" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -90,7 +91,8 @@ export async function POST(req: NextRequest) {
       data: {
         chargeNumber,
         category: data.category, // ADS | SHOOTING | INFLUENCER
-        description: data.campaign || data.description || `Marketing ${data.category}`,
+        description:
+          data.campaign || data.description || `Marketing ${data.category}`,
         amount: data.amount,
         currency: data.currency || "DZD",
         date: data.date ? new Date(data.date) : new Date(),
@@ -110,7 +112,7 @@ export async function POST(req: NextRequest) {
     console.error("Error creating marketing expense:", error);
     return NextResponse.json(
       { error: "Failed to create marketing expense" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/models/[id]/bom/route.ts b/src/app/api/accounting/models/[id]/bom/route.ts
index d997081..183b712 100644
--- a/src/app/api/accounting/models/[id]/bom/route.ts
+++ b/src/app/api/accounting/models/[id]/bom/route.ts
@@ -4,7 +4,7 @@ import { prisma } from "@/lib/prisma";
 // GET BOM for a model
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -12,34 +12,35 @@ export async function GET(
     const bom = await prisma.bomItem.findMany({
       where: { modelId: id },
       include: { inventoryItem: true },
-      orderBy: { createdAt: "asc" }
+      orderBy: { createdAt: "asc" },
     });
 
     // Add calculated cost per item
-    const bomWithCosts = bom.map(item => ({
+    const bomWithCosts = bom.map((item) => ({
       ...item,
-      costPerUnit: Number(item.quantity) * (Number(item.inventoryItem.averageCost) || 0)
+      costPerUnit:
+        Number(item.quantity) * (Number(item.inventoryItem.averageCost) || 0),
     }));
 
-    const totalMaterialCost = bomWithCosts.reduce((sum, item) => sum + item.costPerUnit, 0);
+    const totalMaterialCost = bomWithCosts.reduce(
+      (sum, item) => sum + item.costPerUnit,
+      0,
+    );
 
     return NextResponse.json({
       items: bomWithCosts,
-      totalMaterialCost
+      totalMaterialCost,
     });
   } catch (error) {
     console.error("Error fetching BOM:", error);
-    return NextResponse.json(
-      { error: "Failed to fetch BOM" },
-      { status: 500 }
-    );
+    return NextResponse.json({ error: "Failed to fetch BOM" }, { status: 500 });
   }
 }
 
 // POST add item to BOM
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -48,7 +49,7 @@ export async function POST(
     if (!data.inventoryItemId || !data.quantity) {
       return NextResponse.json(
         { error: "Inventory item and quantity are required" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -56,8 +57,8 @@ export async function POST(
     const existing = await prisma.bomItem.findFirst({
       where: {
         modelId: id,
-        inventoryItemId: data.inventoryItemId
-      }
+        inventoryItemId: data.inventoryItemId,
+      },
     });
 
     if (existing) {
@@ -65,7 +66,7 @@ export async function POST(
       const updated = await prisma.bomItem.update({
         where: { id: existing.id },
         data: { quantity: data.quantity, notes: data.notes },
-        include: { inventoryItem: true }
+        include: { inventoryItem: true },
       });
       return NextResponse.json(updated);
     }
@@ -77,7 +78,7 @@ export async function POST(
         quantity: data.quantity,
         notes: data.notes,
       },
-      include: { inventoryItem: true }
+      include: { inventoryItem: true },
     });
 
     return NextResponse.json(bomItem, { status: 201 });
@@ -85,7 +86,7 @@ export async function POST(
     console.error("Error adding BOM item:", error);
     return NextResponse.json(
       { error: "Failed to add BOM item" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -93,7 +94,7 @@ export async function POST(
 // DELETE remove item from BOM
 export async function DELETE(
   req: NextRequest,
-  _context: { params: Promise<{ id: string }> }
+  _context: { params: Promise<{ id: string }> },
 ) {
   try {
     const { searchParams } = new URL(req.url);
@@ -102,12 +103,12 @@ export async function DELETE(
     if (!bomItemId) {
       return NextResponse.json(
         { error: "BOM item ID is required" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
     await prisma.bomItem.delete({
-      where: { id: bomItemId }
+      where: { id: bomItemId },
     });
 
     return NextResponse.json({ success: true });
@@ -115,7 +116,7 @@ export async function DELETE(
     console.error("Error deleting BOM item:", error);
     return NextResponse.json(
       { error: "Failed to delete BOM item" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/models/[id]/costs/route.ts b/src/app/api/accounting/models/[id]/costs/route.ts
index 9759007..9d29289 100644
--- a/src/app/api/accounting/models/[id]/costs/route.ts
+++ b/src/app/api/accounting/models/[id]/costs/route.ts
@@ -9,7 +9,7 @@ import { computeCostPerUnit, simulatePrice } from "@/lib/accounting/services";
 // GET - Calculer les coûts d'un modèle
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -21,7 +21,7 @@ export async function GET(
     console.error("Error computing costs:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors du calcul des coûts" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
@@ -29,13 +29,19 @@ export async function GET(
 // POST - Simuler les coûts avec des paramètres modifiés
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
     const body = await req.json();
 
-    const { overrides, estimatedUnits, laborCost, packagingCost, marginTarget } = body;
+    const {
+      overrides,
+      estimatedUnits,
+      laborCost,
+      packagingCost,
+      marginTarget,
+    } = body;
 
     const simulation = await simulatePrice(id, {
       overrides,
@@ -50,7 +56,7 @@ export async function POST(
     console.error("Error simulating costs:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de la simulation" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
diff --git a/src/app/api/accounting/models/[id]/costs/snapshot/route.ts b/src/app/api/accounting/models/[id]/costs/snapshot/route.ts
index 360da37..5fbb88f 100644
--- a/src/app/api/accounting/models/[id]/costs/snapshot/route.ts
+++ b/src/app/api/accounting/models/[id]/costs/snapshot/route.ts
@@ -10,7 +10,7 @@ import { prisma } from "@/lib/prisma";
 // POST - Créer un snapshot
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -27,7 +27,7 @@ export async function POST(
     console.error("Error creating snapshot:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de la création du snapshot" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
@@ -35,7 +35,7 @@ export async function POST(
 // GET - Lister les snapshots d'un modèle
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -51,7 +51,7 @@ export async function GET(
     console.error("Error fetching snapshots:", error);
     return NextResponse.json(
       { error: "Erreur lors de la récupération des snapshots" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/models/[id]/route.ts b/src/app/api/accounting/models/[id]/route.ts
index e08cb97..99bc3d0 100644
--- a/src/app/api/accounting/models/[id]/route.ts
+++ b/src/app/api/accounting/models/[id]/route.ts
@@ -4,7 +4,7 @@ import { prisma } from "@/lib/prisma";
 // GET single model with full details
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -15,7 +15,7 @@ export async function GET(
         bom: { include: { inventoryItem: true } },
         charges: true,
         collection: true,
-      }
+      },
     });
 
     if (!model) {
@@ -26,28 +26,57 @@ export async function GET(
 
     // Calculate detailed cost breakdown
     const fabricCost = model.bom
-      .filter(item => item.inventoryItem.type === "FABRIC")
-      .reduce((sum, item) => sum + (Number(item.quantity) * Number(item.wasteFactor) * (Number(item.inventoryItem.averageCost) || 0)), 0);
+      .filter((item) => item.inventoryItem.type === "FABRIC")
+      .reduce(
+        (sum, item) =>
+          sum +
+          Number(item.quantity) *
+            Number(item.wasteFactor) *
+            (Number(item.inventoryItem.averageCost) || 0),
+        0,
+      );
 
     const accessoryCost = model.bom
-      .filter(item => item.inventoryItem.type === "ACCESSORY")
-      .reduce((sum, item) => sum + (Number(item.quantity) * (Number(item.inventoryItem.averageCost) || 0)), 0);
+      .filter((item) => item.inventoryItem.type === "ACCESSORY")
+      .reduce(
+        (sum, item) =>
+          sum +
+          Number(item.quantity) * (Number(item.inventoryItem.averageCost) || 0),
+        0,
+      );
 
     const packagingBom = model.bom
-      .filter(item => item.inventoryItem.type === "PACKAGING")
-      .reduce((sum, item) => sum + (Number(item.quantity) * (Number(item.inventoryItem.averageCost) || 0)), 0);
-
-    const packagingDirect = (Number(model.packagingBox) || 0) + (Number(model.packagingBag) || 0) +
-      (Number(model.packagingLabel) || 0) + (Number(model.packagingTag) || 0) +
-      (Number(model.packagingCard) || 0) + (Number(model.packagingOther) || 0);
+      .filter((item) => item.inventoryItem.type === "PACKAGING")
+      .reduce(
+        (sum, item) =>
+          sum +
+          Number(item.quantity) * (Number(item.inventoryItem.averageCost) || 0),
+        0,
+      );
+
+    const packagingDirect =
+      (Number(model.packagingBox) || 0) +
+      (Number(model.packagingBag) || 0) +
+      (Number(model.packagingLabel) || 0) +
+      (Number(model.packagingTag) || 0) +
+      (Number(model.packagingCard) || 0) +
+      (Number(model.packagingOther) || 0);
     const packagingCost = packagingBom + packagingDirect;
 
-    const chargesTotal = model.charges.reduce((sum, c) => sum + Number(c.amount), 0);
+    const chargesTotal = model.charges.reduce(
+      (sum, c) => sum + Number(c.amount),
+      0,
+    );
     const chargesPerUnit = chargesTotal / estimatedUnits;
 
-    const totalCost = fabricCost + accessoryCost + packagingCost + 
-      (Number(model.laborCost) || 0) + (Number(model.otherCost) || 0) + 
-      (Number(model.returnMargin) || 150) + chargesPerUnit;
+    const totalCost =
+      fabricCost +
+      accessoryCost +
+      packagingCost +
+      (Number(model.laborCost) || 0) +
+      (Number(model.otherCost) || 0) +
+      (Number(model.returnMargin) || 150) +
+      chargesPerUnit;
 
     return NextResponse.json({
       ...model,
@@ -61,27 +90,37 @@ export async function GET(
         chargesTotal,
         chargesPerUnit: Math.round(chargesPerUnit * 100) / 100,
         totalCostPerUnit: Math.round(totalCost * 100) / 100,
-        margin: model.sellingPrice ? Math.round((Number(model.sellingPrice) - totalCost) * 100) / 100 : null,
-        marginPercent: model.sellingPrice 
-          ? Math.round(((Number(model.sellingPrice) - totalCost) / Number(model.sellingPrice) * 100) * 10) / 10
+        margin: model.sellingPrice
+          ? Math.round((Number(model.sellingPrice) - totalCost) * 100) / 100
+          : null,
+        marginPercent: model.sellingPrice
+          ? Math.round(
+              ((Number(model.sellingPrice) - totalCost) /
+                Number(model.sellingPrice)) *
+                100 *
+                10,
+            ) / 10
           : null,
         suggestedPrices: {
-          margin30: Math.ceil((totalCost / 0.7) / 100) * 100,
-          margin40: Math.ceil((totalCost / 0.6) / 100) * 100,
-          margin50: Math.ceil((totalCost / 0.5) / 100) * 100,
-        }
-      }
+          margin30: Math.ceil(totalCost / 0.7 / 100) * 100,
+          margin40: Math.ceil(totalCost / 0.6 / 100) * 100,
+          margin50: Math.ceil(totalCost / 0.5 / 100) * 100,
+        },
+      },
     });
   } catch (error) {
     console.error("Error fetching model:", error);
-    return NextResponse.json({ error: "Failed to fetch model" }, { status: 500 });
+    return NextResponse.json(
+      { error: "Failed to fetch model" },
+      { status: 500 },
+    );
   }
 }
 
 // PUT update model
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -93,8 +132,12 @@ export async function PUT(
         name: data.name,
         description: data.description,
         image: data.image,
-        sellingPrice: data.sellingPrice ? parseFloat(data.sellingPrice) : undefined,
-        targetPrice: data.targetPrice ? parseFloat(data.targetPrice) : undefined,
+        sellingPrice: data.sellingPrice
+          ? parseFloat(data.sellingPrice)
+          : undefined,
+        targetPrice: data.targetPrice
+          ? parseFloat(data.targetPrice)
+          : undefined,
         productId: data.productId,
         collectionId: data.collectionId,
       },
@@ -103,36 +146,51 @@ export async function PUT(
     return NextResponse.json(model);
   } catch (error) {
     console.error("Error updating model:", error);
-    return NextResponse.json({ error: "Failed to update model" }, { status: 500 });
+    return NextResponse.json(
+      { error: "Failed to update model" },
+      { status: 500 },
+    );
   }
 }
 
 // PATCH partial update model (for packaging, costs, etc.)
 export async function PATCH(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
     const data = await req.json();
 
     const updateData: Record<string, number | string | null | boolean> = {};
-    
+
     // Packaging fields (new schema)
-    if (data.packagingBox !== undefined) updateData.packagingBox = parseFloat(data.packagingBox) || 0;
-    if (data.packagingBag !== undefined) updateData.packagingBag = parseFloat(data.packagingBag) || 0;
-    if (data.packagingLabel !== undefined) updateData.packagingLabel = parseFloat(data.packagingLabel) || 0;
-    if (data.packagingTag !== undefined) updateData.packagingTag = parseFloat(data.packagingTag) || 0;
-    if (data.packagingCard !== undefined) updateData.packagingCard = parseFloat(data.packagingCard) || 0;
-    if (data.packagingOther !== undefined) updateData.packagingOther = parseFloat(data.packagingOther) || 0;
-    
+    if (data.packagingBox !== undefined)
+      updateData.packagingBox = parseFloat(data.packagingBox) || 0;
+    if (data.packagingBag !== undefined)
+      updateData.packagingBag = parseFloat(data.packagingBag) || 0;
+    if (data.packagingLabel !== undefined)
+      updateData.packagingLabel = parseFloat(data.packagingLabel) || 0;
+    if (data.packagingTag !== undefined)
+      updateData.packagingTag = parseFloat(data.packagingTag) || 0;
+    if (data.packagingCard !== undefined)
+      updateData.packagingCard = parseFloat(data.packagingCard) || 0;
+    if (data.packagingOther !== undefined)
+      updateData.packagingOther = parseFloat(data.packagingOther) || 0;
+
     // Cost fields
-    if (data.laborCost !== undefined) updateData.laborCost = parseFloat(data.laborCost) || 0;
-    if (data.otherCost !== undefined) updateData.otherCost = parseFloat(data.otherCost) || 0;
-    if (data.returnMargin !== undefined) updateData.returnMargin = parseFloat(data.returnMargin) || 150;
-    if (data.sellingPrice !== undefined) updateData.sellingPrice = parseFloat(data.sellingPrice) || null;
-    if (data.targetPrice !== undefined) updateData.targetPrice = parseFloat(data.targetPrice) || null;
-    if (data.estimatedUnits !== undefined) updateData.estimatedUnits = parseInt(data.estimatedUnits) || 100;
+    if (data.laborCost !== undefined)
+      updateData.laborCost = parseFloat(data.laborCost) || 0;
+    if (data.otherCost !== undefined)
+      updateData.otherCost = parseFloat(data.otherCost) || 0;
+    if (data.returnMargin !== undefined)
+      updateData.returnMargin = parseFloat(data.returnMargin) || 150;
+    if (data.sellingPrice !== undefined)
+      updateData.sellingPrice = parseFloat(data.sellingPrice) || null;
+    if (data.targetPrice !== undefined)
+      updateData.targetPrice = parseFloat(data.targetPrice) || null;
+    if (data.estimatedUnits !== undefined)
+      updateData.estimatedUnits = parseInt(data.estimatedUnits) || 100;
 
     const model = await prisma.model.update({
       where: { id },
@@ -142,26 +200,32 @@ export async function PATCH(
     return NextResponse.json(model);
   } catch (error) {
     console.error("Error patching model:", error);
-    return NextResponse.json({ error: "Failed to update model" }, { status: 500 });
+    return NextResponse.json(
+      { error: "Failed to update model" },
+      { status: 500 },
+    );
   }
 }
 
 // DELETE model (soft delete by setting isActive to false)
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
 
     await prisma.model.update({
       where: { id },
-      data: { isActive: false }
+      data: { isActive: false },
     });
 
     return NextResponse.json({ success: true });
   } catch (error) {
     console.error("Error deleting model:", error);
-    return NextResponse.json({ error: "Failed to delete model" }, { status: 500 });
+    return NextResponse.json(
+      { error: "Failed to delete model" },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/accounting/models/route.ts b/src/app/api/accounting/models/route.ts
index 3d1931f..4e0dda5 100644
--- a/src/app/api/accounting/models/route.ts
+++ b/src/app/api/accounting/models/route.ts
@@ -34,12 +34,12 @@ export async function GET(req: NextRequest) {
       where,
       include: {
         bom: {
-          include: { inventoryItem: true }
+          include: { inventoryItem: true },
         },
         charges: true,
         collection: true,
       },
-      orderBy: { createdAt: "desc" }
+      orderBy: { createdAt: "desc" },
     });
 
     // Calculate cost per unit for each model
@@ -49,24 +49,48 @@ export async function GET(req: NextRequest) {
       // Fabric costs from BOM (type FABRIC)
       const fabricCost = model.bom
         .filter((b: BomItemWithInventory) => b.inventoryItem.type === "FABRIC")
-        .reduce((sum: number, item: BomItemWithInventory) => 
-          sum + (Number(item.quantity) * Number(item.wasteFactor) * (Number(item.inventoryItem.averageCost) || 0)), 0);
+        .reduce(
+          (sum: number, item: BomItemWithInventory) =>
+            sum +
+            Number(item.quantity) *
+              Number(item.wasteFactor) *
+              (Number(item.inventoryItem.averageCost) || 0),
+          0,
+        );
 
       // Accessory costs from BOM (type ACCESSORY)
       const accessoryCost = model.bom
-        .filter((b: BomItemWithInventory) => b.inventoryItem.type === "ACCESSORY")
-        .reduce((sum: number, item: BomItemWithInventory) => 
-          sum + (Number(item.quantity) * (Number(item.inventoryItem.averageCost) || 0)), 0);
+        .filter(
+          (b: BomItemWithInventory) => b.inventoryItem.type === "ACCESSORY",
+        )
+        .reduce(
+          (sum: number, item: BomItemWithInventory) =>
+            sum +
+            Number(item.quantity) *
+              (Number(item.inventoryItem.averageCost) || 0),
+          0,
+        );
 
       // Packaging costs from BOM (type PACKAGING) + direct packaging
       const packagingBom = model.bom
-        .filter((b: BomItemWithInventory) => b.inventoryItem.type === "PACKAGING")
-        .reduce((sum: number, item: BomItemWithInventory) => 
-          sum + (Number(item.quantity) * (Number(item.inventoryItem.averageCost) || 0)), 0);
-
-      const packagingDirect = (Number(model.packagingBox) || 0) + (Number(model.packagingBag) || 0) + 
-        (Number(model.packagingLabel) || 0) + (Number(model.packagingTag) || 0) + 
-        (Number(model.packagingCard) || 0) + (Number(model.packagingOther) || 0);
+        .filter(
+          (b: BomItemWithInventory) => b.inventoryItem.type === "PACKAGING",
+        )
+        .reduce(
+          (sum: number, item: BomItemWithInventory) =>
+            sum +
+            Number(item.quantity) *
+              (Number(item.inventoryItem.averageCost) || 0),
+          0,
+        );
+
+      const packagingDirect =
+        (Number(model.packagingBox) || 0) +
+        (Number(model.packagingBag) || 0) +
+        (Number(model.packagingLabel) || 0) +
+        (Number(model.packagingTag) || 0) +
+        (Number(model.packagingCard) || 0) +
+        (Number(model.packagingOther) || 0);
       const packagingCost = packagingBom + packagingDirect;
 
       // Direct costs per unit from model config
@@ -75,11 +99,15 @@ export async function GET(req: NextRequest) {
       const returnMargin = Number(model.returnMargin) || 150;
 
       // Charges per unit (from Charge model)
-      const chargesTotal = model.charges.reduce((sum: number, c: ChargeItem) => sum + Number(c.amount), 0);
+      const chargesTotal = model.charges.reduce(
+        (sum: number, c: ChargeItem) => sum + Number(c.amount),
+        0,
+      );
       const chargesPerUnit = chargesTotal / estimatedUnits;
 
       const materialCost = fabricCost + accessoryCost + packagingCost;
-      const totalCost = materialCost + laborCost + otherCost + returnMargin + chargesPerUnit;
+      const totalCost =
+        materialCost + laborCost + otherCost + returnMargin + chargesPerUnit;
 
       return {
         ...model,
@@ -94,16 +122,23 @@ export async function GET(req: NextRequest) {
           chargesTotal,
           chargesPerUnit: Math.round(chargesPerUnit * 100) / 100,
           totalCost: Math.round(totalCost * 100) / 100,
-          margin: model.sellingPrice ? Number(model.sellingPrice) - totalCost : null,
-          marginPercent: model.sellingPrice 
-            ? Math.round(((Number(model.sellingPrice) - totalCost) / Number(model.sellingPrice) * 100) * 10) / 10 
+          margin: model.sellingPrice
+            ? Number(model.sellingPrice) - totalCost
+            : null,
+          marginPercent: model.sellingPrice
+            ? Math.round(
+                ((Number(model.sellingPrice) - totalCost) /
+                  Number(model.sellingPrice)) *
+                  100 *
+                  10,
+              ) / 10
             : null,
           suggestedPrices: {
-            margin30: Math.ceil((totalCost / 0.7) / 100) * 100,
-            margin40: Math.ceil((totalCost / 0.6) / 100) * 100,
-            margin50: Math.ceil((totalCost / 0.5) / 100) * 100,
+            margin30: Math.ceil(totalCost / 0.7 / 100) * 100,
+            margin40: Math.ceil(totalCost / 0.6 / 100) * 100,
+            margin50: Math.ceil(totalCost / 0.5 / 100) * 100,
           },
-        }
+        },
       };
     });
 
@@ -112,7 +147,7 @@ export async function GET(req: NextRequest) {
     console.error("Error fetching models:", error);
     return NextResponse.json(
       { error: "Failed to fetch models" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -125,19 +160,19 @@ export async function POST(req: NextRequest) {
     if (!data.sku || !data.name) {
       return NextResponse.json(
         { error: "SKU and name are required" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
     // Check if SKU exists
     const existing = await prisma.model.findUnique({
-      where: { sku: data.sku }
+      where: { sku: data.sku },
     });
 
     if (existing) {
       return NextResponse.json(
         { error: "SKU already exists" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -149,18 +184,25 @@ export async function POST(req: NextRequest) {
         image: data.image,
         collectionId: data.collectionId || null,
         productId: data.productId || null,
-        estimatedUnits: data.estimatedUnits ? parseInt(data.estimatedUnits) : 100,
+        estimatedUnits: data.estimatedUnits
+          ? parseInt(data.estimatedUnits)
+          : 100,
         targetPrice: data.targetPrice ? parseFloat(data.targetPrice) : null,
         sellingPrice: data.sellingPrice ? parseFloat(data.sellingPrice) : null,
         laborCost: data.laborCost ? parseFloat(data.laborCost) : 0,
         otherCost: data.otherCost ? parseFloat(data.otherCost) : 0,
-        returnMargin: data.returnMargin !== undefined ? parseFloat(data.returnMargin) : 150,
+        returnMargin:
+          data.returnMargin !== undefined ? parseFloat(data.returnMargin) : 150,
         packagingBox: data.packagingBox ? parseFloat(data.packagingBox) : 0,
         packagingBag: data.packagingBag ? parseFloat(data.packagingBag) : 0,
-        packagingLabel: data.packagingLabel ? parseFloat(data.packagingLabel) : 0,
+        packagingLabel: data.packagingLabel
+          ? parseFloat(data.packagingLabel)
+          : 0,
         packagingTag: data.packagingTag ? parseFloat(data.packagingTag) : 0,
         packagingCard: data.packagingCard ? parseFloat(data.packagingCard) : 0,
-        packagingOther: data.packagingOther ? parseFloat(data.packagingOther) : 0,
+        packagingOther: data.packagingOther
+          ? parseFloat(data.packagingOther)
+          : 0,
       },
     });
 
@@ -169,7 +211,7 @@ export async function POST(req: NextRequest) {
     console.error("Error creating model:", error);
     return NextResponse.json(
       { error: "Failed to create model" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/purchases/[id]/preview/route.ts b/src/app/api/accounting/purchases/[id]/preview/route.ts
index cb5a5f2..ea85550 100644
--- a/src/app/api/accounting/purchases/[id]/preview/route.ts
+++ b/src/app/api/accounting/purchases/[id]/preview/route.ts
@@ -9,7 +9,7 @@ import { previewReceive } from "@/lib/accounting/services";
 // GET - Prévisualiser la réception
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -21,7 +21,7 @@ export async function GET(
     console.error("Error generating receive preview:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de la prévisualisation" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
diff --git a/src/app/api/accounting/purchases/[id]/receive/route.ts b/src/app/api/accounting/purchases/[id]/receive/route.ts
index 7770036..8925175 100644
--- a/src/app/api/accounting/purchases/[id]/receive/route.ts
+++ b/src/app/api/accounting/purchases/[id]/receive/route.ts
@@ -9,17 +9,21 @@ import { z } from "zod";
 
 // Schema de validation
 const ReceiveSchema = z.object({
-  items: z.array(z.object({
-    id: z.string().min(1, "ID article requis"),
-    quantityReceived: z.number().min(0, "Quantité >= 0"),
-  })).min(1, "Au moins un article requis"),
+  items: z
+    .array(
+      z.object({
+        id: z.string().min(1, "ID article requis"),
+        quantityReceived: z.number().min(0, "Quantité >= 0"),
+      }),
+    )
+    .min(1, "Au moins un article requis"),
   receivedBy: z.string().optional(),
 });
 
 // POST - Réceptionner l'achat
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -29,11 +33,11 @@ export async function POST(
     const validation = ReceiveSchema.safeParse(body);
     if (!validation.success) {
       return NextResponse.json(
-        { 
+        {
           error: "Données invalides",
           details: validation.error.flatten().fieldErrors,
         },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -51,7 +55,7 @@ export async function POST(
     console.error("Error receiving purchase:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de la réception" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
diff --git a/src/app/api/accounting/purchases/[id]/route.ts b/src/app/api/accounting/purchases/[id]/route.ts
index a690c7b..9648775 100644
--- a/src/app/api/accounting/purchases/[id]/route.ts
+++ b/src/app/api/accounting/purchases/[id]/route.ts
@@ -5,23 +5,24 @@
 
 import { NextRequest, NextResponse } from "next/server";
 import { prisma } from "@/lib/prisma";
-import { getPurchaseById, orderPurchase, cancelPurchase } from "@/lib/accounting/services";
+import {
+  getPurchaseById,
+  orderPurchase,
+  cancelPurchase,
+} from "@/lib/accounting/services";
 
 // GET - Récupérer un achat par ID
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
-    
+
     const purchase = await getPurchaseById(id);
-    
+
     if (!purchase) {
-      return NextResponse.json(
-        { error: "Achat non trouvé" },
-        { status: 404 }
-      );
+      return NextResponse.json({ error: "Achat non trouvé" }, { status: 404 });
     }
 
     return NextResponse.json(purchase);
@@ -29,7 +30,7 @@ export async function GET(
     console.error("Error fetching purchase:", error);
     return NextResponse.json(
       { error: "Erreur lors de la récupération de l'achat" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -37,7 +38,7 @@ export async function GET(
 // PUT - Mettre à jour un achat (brouillon uniquement)
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -49,16 +50,13 @@ export async function PUT(
     });
 
     if (!existing) {
-      return NextResponse.json(
-        { error: "Achat non trouvé" },
-        { status: 404 }
-      );
+      return NextResponse.json({ error: "Achat non trouvé" }, { status: 404 });
     }
 
     if (existing.status !== "DRAFT") {
       return NextResponse.json(
         { error: "Seuls les achats en brouillon peuvent être modifiés" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -68,7 +66,9 @@ export async function PUT(
       data: {
         invoiceNumber: data.invoiceNumber,
         invoiceDate: data.invoiceDate ? new Date(data.invoiceDate) : undefined,
-        expectedDate: data.expectedDate ? new Date(data.expectedDate) : undefined,
+        expectedDate: data.expectedDate
+          ? new Date(data.expectedDate)
+          : undefined,
         taxAmount: data.taxAmount,
         shippingCost: data.shippingCost,
         notes: data.notes,
@@ -86,7 +86,7 @@ export async function PUT(
     console.error("Error updating purchase:", error);
     return NextResponse.json(
       { error: "Erreur lors de la mise à jour" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -94,7 +94,7 @@ export async function PUT(
 // PATCH - Actions sur l'achat (order, cancel)
 export async function PATCH(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -112,7 +112,7 @@ export async function PATCH(
       default:
         return NextResponse.json(
           { error: `Action inconnue: ${action}` },
-          { status: 400 }
+          { status: 400 },
         );
     }
 
@@ -121,7 +121,7 @@ export async function PATCH(
     console.error("Error patching purchase:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de l'action" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
@@ -129,7 +129,7 @@ export async function PATCH(
 // DELETE - Supprimer un achat (brouillon uniquement)
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -139,16 +139,13 @@ export async function DELETE(
     });
 
     if (!existing) {
-      return NextResponse.json(
-        { error: "Achat non trouvé" },
-        { status: 404 }
-      );
+      return NextResponse.json({ error: "Achat non trouvé" }, { status: 404 });
     }
 
     if (existing.status !== "DRAFT") {
       return NextResponse.json(
         { error: "Seuls les achats en brouillon peuvent être supprimés" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -159,7 +156,7 @@ export async function DELETE(
     console.error("Error deleting purchase:", error);
     return NextResponse.json(
       { error: "Erreur lors de la suppression" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/purchases/route.ts b/src/app/api/accounting/purchases/route.ts
index 41e3d06..7747358 100644
--- a/src/app/api/accounting/purchases/route.ts
+++ b/src/app/api/accounting/purchases/route.ts
@@ -17,8 +17,10 @@ export async function GET(req: NextRequest) {
     if (status) where.status = status;
     if (startDate || endDate) {
       where.orderDate = {};
-      if (startDate) (where.orderDate as Record<string, Date>).gte = new Date(startDate);
-      if (endDate) (where.orderDate as Record<string, Date>).lte = new Date(endDate);
+      if (startDate)
+        (where.orderDate as Record<string, Date>).gte = new Date(startDate);
+      if (endDate)
+        (where.orderDate as Record<string, Date>).lte = new Date(endDate);
     }
 
     const skip = (page - 1) * limit;
@@ -30,11 +32,11 @@ export async function GET(req: NextRequest) {
         take: limit,
         include: {
           supplier: true,
-          items: { include: { inventoryItem: true } }
+          items: { include: { inventoryItem: true } },
         },
-        orderBy: { orderDate: "desc" }
+        orderBy: { orderDate: "desc" },
       }),
-      prisma.purchase.count({ where })
+      prisma.purchase.count({ where }),
     ]);
 
     return NextResponse.json({
@@ -43,14 +45,14 @@ export async function GET(req: NextRequest) {
         page,
         limit,
         total,
-        totalPages: Math.ceil(total / limit)
-      }
+        totalPages: Math.ceil(total / limit),
+      },
     });
   } catch (error) {
     console.error("Error fetching purchases:", error);
     return NextResponse.json(
       { error: "Failed to fetch purchases" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -59,7 +61,7 @@ export async function GET(req: NextRequest) {
 async function generatePurchaseNumber(): Promise<string> {
   const year = new Date().getFullYear();
   const prefix = `ACH-${year}-`;
-  
+
   const last = await prisma.purchase.findFirst({
     where: { purchaseNumber: { startsWith: prefix } },
     orderBy: { purchaseNumber: "desc" },
@@ -83,15 +85,15 @@ export async function POST(req: NextRequest) {
     if (!data.items || data.items.length === 0) {
       return NextResponse.json(
         { error: "At least one item is required" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
     // Calculate subtotal and total
     const subtotal = data.items.reduce(
-      (sum: number, item: { quantity: number; unitPrice: number }) => 
-        sum + item.quantity * item.unitPrice, 
-      0
+      (sum: number, item: { quantity: number; unitPrice: number }) =>
+        sum + item.quantity * item.unitPrice,
+      0,
     );
     const taxAmount = data.taxAmount || 0;
     const shippingCost = data.shippingCost || 0;
@@ -122,25 +124,27 @@ export async function POST(req: NextRequest) {
         status,
         notes: data.notes,
         items: {
-          create: data.items.map((item: { 
-            inventoryItemId: string; 
-            quantity: number; 
-            unitPrice: number;
-            unit?: string;
-          }) => ({
-            inventoryItemId: item.inventoryItemId,
-            quantityOrdered: item.quantity,
-            quantityReceived: autoReceive ? item.quantity : 0,
-            unit: item.unit || "PIECE",
-            unitPrice: item.unitPrice,
-            totalPrice: item.quantity * item.unitPrice,
-          }))
-        }
+          create: data.items.map(
+            (item: {
+              inventoryItemId: string;
+              quantity: number;
+              unitPrice: number;
+              unit?: string;
+            }) => ({
+              inventoryItemId: item.inventoryItemId,
+              quantityOrdered: item.quantity,
+              quantityReceived: autoReceive ? item.quantity : 0,
+              unit: item.unit || "PIECE",
+              unitPrice: item.unitPrice,
+              totalPrice: item.quantity * item.unitPrice,
+            }),
+          ),
+        },
       },
       include: {
         items: { include: { inventoryItem: true } },
-        supplier: true
-      }
+        supplier: true,
+      },
     });
 
     // If autoReceive, update inventory immediately
@@ -153,7 +157,7 @@ export async function POST(req: NextRequest) {
     console.error("Error creating purchase:", error);
     return NextResponse.json(
       { error: "Failed to create purchase" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -170,7 +174,7 @@ async function receiveInventory(purchase: {
 }) {
   for (const item of purchase.items) {
     const inv = await prisma.inventoryItem.findUnique({
-      where: { id: item.inventoryItemId }
+      where: { id: item.inventoryItemId },
     });
 
     if (inv) {
@@ -179,9 +183,8 @@ async function receiveInventory(purchase: {
       const qty = Number(item.quantityOrdered);
       const price = Number(item.unitPrice);
       const newQty = currentQty + qty;
-      const newAvg = newQty > 0 
-        ? ((currentQty * currentAvg) + (qty * price)) / newQty 
-        : price;
+      const newAvg =
+        newQty > 0 ? (currentQty * currentAvg + qty * price) / newQty : price;
       const newValue = newQty * newAvg;
 
       await prisma.inventoryItem.update({
@@ -193,7 +196,7 @@ async function receiveInventory(purchase: {
           lastCost: price,
           totalValue: newValue,
           lastReceivedAt: new Date(),
-        }
+        },
       });
 
       // Create inventory transaction
@@ -212,8 +215,8 @@ async function receiveInventory(purchase: {
           avgCostAfter: newAvg,
           referenceType: "PURCHASE",
           referenceId: purchase.id,
-          notes: `Réception ${purchase.purchaseNumber}`
-        }
+          notes: `Réception ${purchase.purchaseNumber}`,
+        },
       });
     }
   }
diff --git a/src/app/api/accounting/reports/route.ts b/src/app/api/accounting/reports/route.ts
index 10db24a..9149d37 100644
--- a/src/app/api/accounting/reports/route.ts
+++ b/src/app/api/accounting/reports/route.ts
@@ -14,7 +14,7 @@ export async function GET(req: NextRequest) {
     // Calculate date range
     const now = new Date();
     let startDate: Date;
-    
+
     switch (period) {
       case "week":
         startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
@@ -36,69 +36,81 @@ export async function GET(req: NextRequest) {
         charges,
         orders,
         models,
-        lowStockItems
+        lowStockItems,
       ] = await Promise.all([
         prisma.inventoryItem.findMany(),
         prisma.purchase.findMany({
           where: { orderDate: { gte: startDate } },
-          include: { items: true }
+          include: { items: true },
         }),
         prisma.charge.findMany({
-          where: { 
+          where: {
             date: { gte: startDate },
-            category: { in: MARKETING_CATEGORIES }
-          }
+            category: { in: MARKETING_CATEGORIES },
+          },
         }),
         prisma.order.findMany({
-          where: { 
+          where: {
             createdAt: { gte: startDate },
-            status: { in: ["CONFIRMED", "SHIPPED", "DELIVERED"] }
-          }
+            status: { in: ["CONFIRMED", "SHIPPED", "DELIVERED"] },
+          },
         }),
         prisma.model.findMany({
           where: { isActive: true },
           include: {
             bom: { include: { inventoryItem: true } },
-            charges: true
-          }
+            charges: true,
+          },
         }),
         prisma.inventoryItem.findMany({
-          where: { threshold: { not: null } }
-        })
+          where: { threshold: { not: null } },
+        }),
       ]);
 
       const inventoryValuation = inventoryItems.reduce(
-        (sum: number, item) => sum + (Number(item.quantity) * Number(item.averageCost)), 0
+        (sum: number, item) =>
+          sum + Number(item.quantity) * Number(item.averageCost),
+        0,
       );
 
       const purchasesTotal = purchases.reduce(
-        (sum: number, p) => sum + Number(p.totalAmount), 0
+        (sum: number, p) => sum + Number(p.totalAmount),
+        0,
       );
 
       const marketingTotal = charges.reduce(
-        (sum: number, c) => sum + Number(c.amount), 0
+        (sum: number, c) => sum + Number(c.amount),
+        0,
       );
 
       const revenue = orders.reduce(
-        (sum: number, o) => sum + Number(o.total), 0
+        (sum: number, o) => sum + Number(o.total),
+        0,
       );
 
-      const marketingByCategory = charges.reduce((acc: Record<string, number>, c) => {
-        acc[c.category] = (acc[c.category] || 0) + Number(c.amount);
-        return acc;
-      }, {});
+      const marketingByCategory = charges.reduce(
+        (acc: Record<string, number>, c) => {
+          acc[c.category] = (acc[c.category] || 0) + Number(c.amount);
+          return acc;
+        },
+        {},
+      );
 
-      const inventoryByType = inventoryItems.reduce((acc: Record<string, { count: number; value: number }>, item) => {
-        if (!acc[item.type]) {
-          acc[item.type] = { count: 0, value: 0 };
-        }
-        acc[item.type].count += 1;
-        acc[item.type].value += Number(item.quantity) * Number(item.averageCost);
-        return acc;
-      }, {});
+      const inventoryByType = inventoryItems.reduce(
+        (acc: Record<string, { count: number; value: number }>, item) => {
+          if (!acc[item.type]) {
+            acc[item.type] = { count: 0, value: 0 };
+          }
+          acc[item.type].count += 1;
+          acc[item.type].value +=
+            Number(item.quantity) * Number(item.averageCost);
+          return acc;
+        },
+        {},
+      );
 
       const lowStock = lowStockItems.filter(
-        item => item.threshold !== null && item.quantity <= item.threshold
+        (item) => item.threshold !== null && item.quantity <= item.threshold,
       );
 
       const grossProfit = revenue - purchasesTotal;
@@ -115,24 +127,24 @@ export async function GET(req: NextRequest) {
           netProfit: Math.round(netProfit),
           ordersCount: orders.length,
           modelsCount: models.length,
-          lowStockCount: lowStock.length
+          lowStockCount: lowStock.length,
         },
         breakdowns: {
           marketingByCategory,
           inventoryByType,
         },
         alerts: {
-          lowStock: lowStock.map(item => ({
+          lowStock: lowStock.map((item) => ({
             id: item.id,
             sku: item.sku,
             name: item.name,
             quantity: item.quantity,
             threshold: item.threshold,
-            deficit: Number(item.threshold || 0) - Number(item.quantity)
-          }))
+            deficit: Number(item.threshold || 0) - Number(item.quantity),
+          })),
         },
         recentPurchases: purchases.slice(0, 5),
-        recentCharges: charges.slice(0, 5)
+        recentCharges: charges.slice(0, 5),
       });
     }
 
@@ -141,33 +153,59 @@ export async function GET(req: NextRequest) {
         where: { isActive: true },
         include: {
           bom: { include: { inventoryItem: true } },
-          charges: true
-        }
+          charges: true,
+        },
       });
 
-      const modelsWithCosts = models.map(model => {
+      const modelsWithCosts = models.map((model) => {
         const estimatedUnits = model.estimatedUnits || 100;
 
         const fabricCost = model.bom
-          .filter(b => b.inventoryItem.type === "FABRIC")
-          .reduce((sum, b) => sum + (Number(b.quantity) * Number(b.wasteFactor) * Number(b.inventoryItem.averageCost)), 0);
+          .filter((b) => b.inventoryItem.type === "FABRIC")
+          .reduce(
+            (sum, b) =>
+              sum +
+              Number(b.quantity) *
+                Number(b.wasteFactor) *
+                Number(b.inventoryItem.averageCost),
+            0,
+          );
 
         const accessoryCost = model.bom
-          .filter(b => b.inventoryItem.type === "ACCESSORY")
-          .reduce((sum, b) => sum + (Number(b.quantity) * Number(b.inventoryItem.averageCost)), 0);
-
-        const packagingCost = model.bom
-          .filter(b => b.inventoryItem.type === "PACKAGING")
-          .reduce((sum, b) => sum + (Number(b.quantity) * Number(b.inventoryItem.averageCost)), 0) +
-          (Number(model.packagingBox) || 0) + (Number(model.packagingBag) || 0) +
-          (Number(model.packagingLabel) || 0) + (Number(model.packagingTag) || 0) +
-          (Number(model.packagingCard) || 0) + (Number(model.packagingOther) || 0);
-
-        const chargesPerUnit = model.charges.reduce((sum, c) => sum + Number(c.amount), 0) / estimatedUnits;
-
-        const totalCost = fabricCost + accessoryCost + packagingCost + 
-          (Number(model.laborCost) || 0) + (Number(model.otherCost) || 0) + 
-          (Number(model.returnMargin) || 150) + chargesPerUnit;
+          .filter((b) => b.inventoryItem.type === "ACCESSORY")
+          .reduce(
+            (sum, b) =>
+              sum + Number(b.quantity) * Number(b.inventoryItem.averageCost),
+            0,
+          );
+
+        const packagingCost =
+          model.bom
+            .filter((b) => b.inventoryItem.type === "PACKAGING")
+            .reduce(
+              (sum, b) =>
+                sum + Number(b.quantity) * Number(b.inventoryItem.averageCost),
+              0,
+            ) +
+          (Number(model.packagingBox) || 0) +
+          (Number(model.packagingBag) || 0) +
+          (Number(model.packagingLabel) || 0) +
+          (Number(model.packagingTag) || 0) +
+          (Number(model.packagingCard) || 0) +
+          (Number(model.packagingOther) || 0);
+
+        const chargesPerUnit =
+          model.charges.reduce((sum, c) => sum + Number(c.amount), 0) /
+          estimatedUnits;
+
+        const totalCost =
+          fabricCost +
+          accessoryCost +
+          packagingCost +
+          (Number(model.laborCost) || 0) +
+          (Number(model.otherCost) || 0) +
+          (Number(model.returnMargin) || 150) +
+          chargesPerUnit;
 
         return {
           id: model.id,
@@ -180,12 +218,19 @@ export async function GET(req: NextRequest) {
             packaging: Math.round(packagingCost * 100) / 100,
             labor: Number(model.laborCost) || 0,
             charges: Math.round(chargesPerUnit * 100) / 100,
-            total: Math.round(totalCost * 100) / 100
+            total: Math.round(totalCost * 100) / 100,
           },
-          margin: model.sellingPrice ? Math.round((Number(model.sellingPrice) - totalCost) * 100) / 100 : null,
-          marginPercent: model.sellingPrice 
-            ? Math.round(((Number(model.sellingPrice) - totalCost) / Number(model.sellingPrice) * 100) * 10) / 10
-            : null
+          margin: model.sellingPrice
+            ? Math.round((Number(model.sellingPrice) - totalCost) * 100) / 100
+            : null,
+          marginPercent: model.sellingPrice
+            ? Math.round(
+                ((Number(model.sellingPrice) - totalCost) /
+                  Number(model.sellingPrice)) *
+                  100 *
+                  10,
+              ) / 10
+            : null,
         };
       });
 
@@ -198,7 +243,7 @@ export async function GET(req: NextRequest) {
     const message = error instanceof Error ? error.message : "Unknown error";
     return NextResponse.json(
       { error: "Failed to generate report", details: message },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/suppliers/[id]/route.ts b/src/app/api/accounting/suppliers/[id]/route.ts
index 5807e8e..d8fcaca 100644
--- a/src/app/api/accounting/suppliers/[id]/route.ts
+++ b/src/app/api/accounting/suppliers/[id]/route.ts
@@ -4,7 +4,7 @@ import { prisma } from "@/lib/prisma";
 // PUT update supplier
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -26,7 +26,7 @@ export async function PUT(
     console.error("Error updating supplier:", error);
     return NextResponse.json(
       { error: "Failed to update supplier" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -34,25 +34,25 @@ export async function PUT(
 // DELETE supplier
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
 
     // Check if supplier has purchases
     const purchaseCount = await prisma.purchase.count({
-      where: { supplierId: id }
+      where: { supplierId: id },
     });
 
     if (purchaseCount > 0) {
       return NextResponse.json(
         { error: "Cannot delete supplier with existing purchases" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
     await prisma.supplier.delete({
-      where: { id }
+      where: { id },
     });
 
     return NextResponse.json({ success: true });
@@ -60,7 +60,7 @@ export async function DELETE(
     console.error("Error deleting supplier:", error);
     return NextResponse.json(
       { error: "Failed to delete supplier" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/accounting/suppliers/route.ts b/src/app/api/accounting/suppliers/route.ts
index 8a8fc88..7b05b0f 100644
--- a/src/app/api/accounting/suppliers/route.ts
+++ b/src/app/api/accounting/suppliers/route.ts
@@ -7,10 +7,10 @@ export async function GET() {
     const suppliers = await prisma.supplier.findMany({
       include: {
         _count: {
-          select: { purchases: true }
-        }
+          select: { purchases: true },
+        },
       },
-      orderBy: { name: "asc" }
+      orderBy: { name: "asc" },
     });
 
     return NextResponse.json(suppliers);
@@ -18,7 +18,7 @@ export async function GET() {
     console.error("Error fetching suppliers:", error);
     return NextResponse.json(
       { error: "Failed to fetch suppliers" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -29,10 +29,7 @@ export async function POST(req: NextRequest) {
     const data = await req.json();
 
     if (!data.name) {
-      return NextResponse.json(
-        { error: "Name is required" },
-        { status: 400 }
-      );
+      return NextResponse.json({ error: "Name is required" }, { status: 400 });
     }
 
     // Generate supplier code if not provided
@@ -67,7 +64,7 @@ export async function POST(req: NextRequest) {
     console.error("Error creating supplier:", error);
     return NextResponse.json(
       { error: "Failed to create supplier" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/collections/[id]/route.ts b/src/app/api/collections/[id]/route.ts
index 6c77adf..d4aa839 100644
--- a/src/app/api/collections/[id]/route.ts
+++ b/src/app/api/collections/[id]/route.ts
@@ -1,71 +1,86 @@
-import { NextResponse } from 'next/server';
-import { prisma } from '@/lib/prisma';
-import { validateCollection, sanitizeString } from '@/lib/validations';
+import { NextResponse } from "next/server";
+import { prisma } from "@/lib/prisma";
+import { validateCollection, sanitizeString } from "@/lib/validations";
 
 export async function GET(
-    request: Request,
-    { params }: { params: Promise<{ id: string }> }
+  request: Request,
+  { params }: { params: Promise<{ id: string }> },
 ) {
-    try {
-        const { id } = await params;
-        const collection = await prisma.collection.findUnique({
-            where: { id },
-            include: { products: true },
-        });
+  try {
+    const { id } = await params;
+    const collection = await prisma.collection.findUnique({
+      where: { id },
+      include: { products: true },
+    });
 
-        if (!collection) {
-            return NextResponse.json({ error: 'Collection not found' }, { status: 404 });
-        }
-
-        return NextResponse.json(collection);
-    } catch (error) {
-        return NextResponse.json({ error: 'Error fetching collection' }, { status: 500 });
+    if (!collection) {
+      return NextResponse.json(
+        { error: "Collection not found" },
+        { status: 404 },
+      );
     }
+
+    return NextResponse.json(collection);
+  } catch (error) {
+    return NextResponse.json(
+      { error: "Error fetching collection" },
+      { status: 500 },
+    );
+  }
 }
 
 export async function PUT(
-    request: Request,
-    { params }: { params: Promise<{ id: string }> }
+  request: Request,
+  { params }: { params: Promise<{ id: string }> },
 ) {
-    try {
-        const { id } = await params;
-        const body = await request.json();
-        
-        // Validate input
-        const validation = validateCollection(body);
-        if (!validation.valid) {
-            return NextResponse.json({ 
-                error: 'Validation failed', 
-                details: validation.errors 
-            }, { status: 400 });
-        }
-        
-        const collection = await prisma.collection.update({
-            where: { id },
-            data: {
-                nameFr: sanitizeString(body.nameFr),
-                nameAr: sanitizeString(body.nameAr),
-                image: body.image || null,
-            },
-        });
-        return NextResponse.json(collection);
-    } catch (error) {
-        console.error('Error updating collection:', error);
-        return NextResponse.json({ error: 'Error updating collection' }, { status: 500 });
+  try {
+    const { id } = await params;
+    const body = await request.json();
+
+    // Validate input
+    const validation = validateCollection(body);
+    if (!validation.valid) {
+      return NextResponse.json(
+        {
+          error: "Validation failed",
+          details: validation.errors,
+        },
+        { status: 400 },
+      );
     }
+
+    const collection = await prisma.collection.update({
+      where: { id },
+      data: {
+        nameFr: sanitizeString(body.nameFr),
+        nameAr: sanitizeString(body.nameAr),
+        image: body.image || null,
+      },
+    });
+    return NextResponse.json(collection);
+  } catch (error) {
+    console.error("Error updating collection:", error);
+    return NextResponse.json(
+      { error: "Error updating collection" },
+      { status: 500 },
+    );
+  }
 }
 
 export async function DELETE(
-    request: Request,
-    { params }: { params: Promise<{ id: string }> }
+  request: Request,
+  { params }: { params: Promise<{ id: string }> },
 ) {
-    try {
-        const { id } = await params;
-        await prisma.collection.delete({
-            where: { id },
-        });
-        return NextResponse.json({ message: 'Collection deleted' });
-    } catch (error) {
-        return NextResponse.json({ error: 'Error deleting collection' }, { status: 500 });
-    }
+  try {
+    const { id } = await params;
+    await prisma.collection.delete({
+      where: { id },
+    });
+    return NextResponse.json({ message: "Collection deleted" });
+  } catch (error) {
+    return NextResponse.json(
+      { error: "Error deleting collection" },
+      { status: 500 },
+    );
+  }
 }
diff --git a/src/app/api/collections/route.ts b/src/app/api/collections/route.ts
index 4949328..8d676ae 100644
--- a/src/app/api/collections/route.ts
+++ b/src/app/api/collections/route.ts
@@ -1,69 +1,86 @@
-import { NextResponse } from 'next/server';
-import { prisma } from '@/lib/prisma';
-import { validateCollection, sanitizeString } from '@/lib/validations';
+import { NextResponse } from "next/server";
+import { prisma } from "@/lib/prisma";
+import { validateCollection, sanitizeString } from "@/lib/validations";
 
 // Generate URL-friendly slug from name
 function generateSlug(name: string): string {
-    return name
-        .toLowerCase()
-        .normalize('NFD')
-        .replace(/[\u0300-\u036f]/g, '') // Remove accents
-        .replace(/[^a-z0-9\s-]/g, '') // Remove special chars
-        .replace(/\s+/g, '-') // Replace spaces with hyphens
-        .replace(/-+/g, '-') // Remove multiple hyphens
-        .trim();
+  return name
+    .toLowerCase()
+    .normalize("NFD")
+    .replace(/[\u0300-\u036f]/g, "") // Remove accents
+    .replace(/[^a-z0-9\s-]/g, "") // Remove special chars
+    .replace(/\s+/g, "-") // Replace spaces with hyphens
+    .replace(/-+/g, "-") // Remove multiple hyphens
+    .trim();
 }
 
 export async function GET() {
-    try {
-        const collections = await prisma.collection.findMany({
-            include: { products: true },
-            orderBy: { createdAt: 'desc' },
-        });
-        
-        // Add cache headers for public collection listing
-        const response = NextResponse.json(collections);
-        response.headers.set("Cache-Control", "public, s-maxage=60, stale-while-revalidate=300");
-        return response;
-    } catch (error) {
-        console.error('Error fetching collections:', error);
-        return NextResponse.json({ error: 'Error fetching collections' }, { status: 500 });
-    }
+  try {
+    const collections = await prisma.collection.findMany({
+      include: { products: true },
+      orderBy: { createdAt: "desc" },
+    });
+
+    // Add cache headers for public collection listing
+    const response = NextResponse.json(collections);
+    response.headers.set(
+      "Cache-Control",
+      "public, s-maxage=60, stale-while-revalidate=300",
+    );
+    return response;
+  } catch (error) {
+    console.error("Error fetching collections:", error);
+    return NextResponse.json(
+      { error: "Error fetching collections" },
+      { status: 500 },
+    );
+  }
 }
 
 export async function POST(request: Request) {
-    try {
-        const body = await request.json();
-        
-        // Validate input
-        const validation = validateCollection(body);
-        if (!validation.valid) {
-            return NextResponse.json({ 
-                error: 'Validation failed', 
-                details: validation.errors 
-            }, { status: 400 });
-        }
-        
-        const slug = body.slug || generateSlug(body.nameFr);
-        
-        // Check if slug already exists
-        const existingSlug = await prisma.collection.findUnique({ where: { slug } });
-        const finalSlug = existingSlug ? `${slug}-${Date.now()}` : slug;
-        
-        const collection = await prisma.collection.create({
-            data: {
-                slug: finalSlug,
-                nameFr: sanitizeString(body.nameFr),
-                nameAr: sanitizeString(body.nameAr),
-                description: body.description || null,
-                image: body.image || null,
-                budget: body.budget || body.initialBudget ? parseFloat(body.budget || body.initialBudget) : 0,
-                budgetUsed: 0,
-            },
-        });
-        return NextResponse.json(collection, { status: 201 });
-    } catch (error) {
-        console.error('Error creating collection:', error);
-        return NextResponse.json({ error: 'Error creating collection' }, { status: 500 });
+  try {
+    const body = await request.json();
+
+    // Validate input
+    const validation = validateCollection(body);
+    if (!validation.valid) {
+      return NextResponse.json(
+        {
+          error: "Validation failed",
+          details: validation.errors,
+        },
+        { status: 400 },
+      );
     }
+
+    const slug = body.slug || generateSlug(body.nameFr);
+
+    // Check if slug already exists
+    const existingSlug = await prisma.collection.findUnique({
+      where: { slug },
+    });
+    const finalSlug = existingSlug ? `${slug}-${Date.now()}` : slug;
+
+    const collection = await prisma.collection.create({
+      data: {
+        slug: finalSlug,
+        nameFr: sanitizeString(body.nameFr),
+        nameAr: sanitizeString(body.nameAr),
+        description: body.description || null,
+        image: body.image || null,
+        budget:
+          body.budget || body.initialBudget
+            ? parseFloat(body.budget || body.initialBudget)
+            : 0,
+        budgetUsed: 0,
+      },
+    });
+    return NextResponse.json(collection, { status: 201 });
+  } catch (error) {
+    console.error("Error creating collection:", error);
+    return NextResponse.json(
+      { error: "Error creating collection" },
+      { status: 500 },
+    );
+  }
 }
diff --git a/src/app/api/docs/route.ts b/src/app/api/docs/route.ts
index 429feb7..475fd38 100644
--- a/src/app/api/docs/route.ts
+++ b/src/app/api/docs/route.ts
@@ -8,15 +8,15 @@ export async function GET() {
     const filePath = path.join(process.cwd(), "docs/openapi.yaml");
     const file = fs.readFileSync(filePath, "utf8");
     return new NextResponse(file, {
-      headers: { 
-        "Content-Type": "text/yaml"
+      headers: {
+        "Content-Type": "text/yaml",
         // CORS is handled by middleware
-      }
+      },
     });
   } catch {
     return NextResponse.json(
       { error: "OpenAPI spec not found" },
-      { status: 404 }
+      { status: 404 },
     );
   }
 }
diff --git a/src/app/api/orders/[id]/reserve/route.ts b/src/app/api/orders/[id]/reserve/route.ts
index 4da37d1..0cda7a2 100644
--- a/src/app/api/orders/[id]/reserve/route.ts
+++ b/src/app/api/orders/[id]/reserve/route.ts
@@ -5,12 +5,15 @@
 
 import { NextRequest, NextResponse } from "next/server";
 import { prisma } from "@/lib/prisma";
-import { reserveStock, checkStockAvailability } from "@/lib/accounting/services";
+import {
+  reserveStock,
+  checkStockAvailability,
+} from "@/lib/accounting/services";
 
 // POST - Réserver le stock
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -26,20 +29,21 @@ export async function POST(
     if (!order) {
       return NextResponse.json(
         { error: "Commande non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (order.stockReserved) {
       return NextResponse.json(
         { error: "Le stock est déjà réservé pour cette commande" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
     // Préparer les items à réserver (ceux qui ont un lien vers un modèle/inventaire)
-    const itemsToReserve: Array<{ inventoryItemId: string; quantity: number }> = [];
-    
+    const itemsToReserve: Array<{ inventoryItemId: string; quantity: number }> =
+      [];
+
     for (const item of order.items) {
       if (item.modelId) {
         // Récupérer les BOM du modèle
@@ -49,9 +53,14 @@ export async function POST(
         });
 
         for (const bomItem of bom) {
-          const qty = Number(bomItem.quantity) * Number(bomItem.wasteFactor) * item.quantity;
-          
-          const existing = itemsToReserve.find(i => i.inventoryItemId === bomItem.inventoryItemId);
+          const qty =
+            Number(bomItem.quantity) *
+            Number(bomItem.wasteFactor) *
+            item.quantity;
+
+          const existing = itemsToReserve.find(
+            (i) => i.inventoryItemId === bomItem.inventoryItemId,
+          );
           if (existing) {
             existing.quantity += qty;
           } else {
@@ -66,30 +75,30 @@ export async function POST(
 
     if (itemsToReserve.length === 0) {
       return NextResponse.json(
-        { 
+        {
           warning: "Aucun article à réserver (pas de liens modèle/BOM)",
           stockReserved: false,
         },
-        { status: 200 }
+        { status: 200 },
       );
     }
 
     // Vérifier la disponibilité
     const availability = await checkStockAvailability(itemsToReserve);
-    
+
     if (!availability.available) {
       const shortages = availability.details
-        .filter(d => d.shortage > 0)
-        .map(d => `${d.name}: manque ${d.shortage.toFixed(2)}`)
+        .filter((d) => d.shortage > 0)
+        .map((d) => `${d.name}: manque ${d.shortage.toFixed(2)}`)
         .join(", ");
-      
+
       return NextResponse.json(
-        { 
+        {
           error: "Stock insuffisant",
           details: shortages,
           availability: availability.details,
         },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -115,7 +124,7 @@ export async function POST(
     console.error("Error reserving stock:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de la réservation" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
@@ -123,11 +132,12 @@ export async function POST(
 // DELETE - Annuler la réservation
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
-    const { releaseStock: releaseStockFn } = await import("@/lib/accounting/services");
+    const { releaseStock: releaseStockFn } =
+      await import("@/lib/accounting/services");
 
     const order = await prisma.order.findUnique({
       where: { id },
@@ -137,14 +147,14 @@ export async function DELETE(
     if (!order) {
       return NextResponse.json(
         { error: "Commande non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (!order.stockReserved) {
       return NextResponse.json(
         { error: "Aucun stock n'est réservé pour cette commande" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -163,7 +173,7 @@ export async function DELETE(
           reservation.inventoryItemId,
           Number(reservation.quantity),
           order.id,
-          tx
+          tx,
         );
       }
 
@@ -181,7 +191,7 @@ export async function DELETE(
     console.error("Error releasing stock:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de l'annulation" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
diff --git a/src/app/api/orders/[id]/route.ts b/src/app/api/orders/[id]/route.ts
index a58cddc..1365392 100644
--- a/src/app/api/orders/[id]/route.ts
+++ b/src/app/api/orders/[id]/route.ts
@@ -1,180 +1,211 @@
-import { NextResponse } from 'next/server';
-import { prisma } from '@/lib/prisma';
-import { getYalidineClient, orderToYalidineParcel } from '@/lib/yalidine';
-import { getZRClient } from '@/lib/zrexpress';
+import { NextResponse } from "next/server";
+import { prisma } from "@/lib/prisma";
+import { getYalidineClient, orderToYalidineParcel } from "@/lib/yalidine";
+import { getZRClient } from "@/lib/zrexpress";
 
 // Helper: Create shipment on Yalidine
 async function createYalidineShipment(order: any) {
-    try {
-        const client = getYalidineClient();
-        
-        // Build product list from items
-        const productsList = order.items
-            ?.map((item: any) => `${item.quantity}x ${item.productName}`)
-            .join(', ') || 'Commande Harp';
-
-        const parcel = orderToYalidineParcel({
-            id: order.id,
-            customerName: order.customerName,
-            customerPhone: order.customerPhone,
-            address: order.customerAddress,
-            wilaya: order.customerWilaya,
-            commune: order.customerCity,
-            total: order.total - (order.shippingPrice || 0), // Prix produits sans livraison
-            items: order.items || [],
-            deliveryType: order.deliveryType === 'DESK' ? 'STOP_DESK' : 'DOMICILE',
-            stopDeskId: order.stopDeskId || undefined,
-        }, 'Alger'); // Wilaya d'expédition
-
-        const result = await client.createParcel(parcel);
-        
-        if (result.success && result.tracking) {
-            return { 
-                success: true, 
-                tracking: result.tracking,
-                label: result.label || undefined
-            };
-        }
-        return { success: false, error: result.message || 'Erreur inconnue' };
-    } catch (error) {
-        console.error('Yalidine shipment creation error:', error);
-        return { success: false, error: 'Erreur création Yalidine' };
+  try {
+    const client = getYalidineClient();
+
+    // Build product list from items
+    const productsList =
+      order.items
+        ?.map((item: any) => `${item.quantity}x ${item.productName}`)
+        .join(", ") || "Commande Harp";
+
+    const parcel = orderToYalidineParcel(
+      {
+        id: order.id,
+        customerName: order.customerName,
+        customerPhone: order.customerPhone,
+        address: order.customerAddress,
+        wilaya: order.customerWilaya,
+        commune: order.customerCity,
+        total: order.total - (order.shippingPrice || 0), // Prix produits sans livraison
+        items: order.items || [],
+        deliveryType: order.deliveryType === "DESK" ? "STOP_DESK" : "DOMICILE",
+        stopDeskId: order.stopDeskId || undefined,
+      },
+      "Alger",
+    ); // Wilaya d'expédition
+
+    const result = await client.createParcel(parcel);
+
+    if (result.success && result.tracking) {
+      return {
+        success: true,
+        tracking: result.tracking,
+        label: result.label || undefined,
+      };
     }
+    return { success: false, error: result.message || "Erreur inconnue" };
+  } catch (error) {
+    console.error("Yalidine shipment creation error:", error);
+    return { success: false, error: "Erreur création Yalidine" };
+  }
 }
 
 // Helper: Create shipment on ZR Express
 async function createZRExpressShipment(order: any) {
-    try {
-        const client = getZRClient();
-        
-        const productsList = order.items
-            ?.map((item: any) => `${item.quantity}x ${item.productName}`)
-            .join(', ') || 'Commande Harp';
-
-        // Map wilaya name to ID
-        const wilayaMap: Record<string, string> = {
-            'alger': '16', 'oran': '31', 'constantine': '25', 'blida': '9',
-            'sétif': '19', 'annaba': '23', 'batna': '5', 'tizi ouzou': '15',
-            'bejaia': '6', 'tlemcen': '13', 'djelfa': '17', 'biskra': '7',
-            'msila': '28', 'chlef': '2', 'medea': '26', 'mostaganem': '27',
-        };
-        const wilayaId = wilayaMap[order.customerWilaya?.toLowerCase()] || order.customerWilaya || '16';
-
-        const result = await client.createShipment({
-            id_Externe: order.id,
-            Client: order.customerName,
-            MobileA: order.customerPhone,
-            Adresse: order.customerAddress,
-            Commune: order.customerCity,
-            IDWilaya: wilayaId,
-            Total: String(order.total - (order.shippingPrice || 0)),
-            TypeLivraison: order.deliveryType === 'DESK' ? '1' : '0',
-            TypeColis: '0', // Normal (pas d'échange)
-            TProduit: productsList,
-            Note: `Commande Harp #${order.id.slice(-8).toUpperCase()}`,
-        });
-
-        if (result.success && result.tracking) {
-            return { success: true, tracking: result.tracking, label: undefined };
-        }
-        return { success: false, error: result.message || 'Erreur inconnue' };
-    } catch (error) {
-        console.error('ZR Express shipment creation error:', error);
-        return { success: false, error: 'Erreur création ZR Express' };
+  try {
+    const client = getZRClient();
+
+    const productsList =
+      order.items
+        ?.map((item: any) => `${item.quantity}x ${item.productName}`)
+        .join(", ") || "Commande Harp";
+
+    // Map wilaya name to ID
+    const wilayaMap: Record<string, string> = {
+      alger: "16",
+      oran: "31",
+      constantine: "25",
+      blida: "9",
+      sétif: "19",
+      annaba: "23",
+      batna: "5",
+      "tizi ouzou": "15",
+      bejaia: "6",
+      tlemcen: "13",
+      djelfa: "17",
+      biskra: "7",
+      msila: "28",
+      chlef: "2",
+      medea: "26",
+      mostaganem: "27",
+    };
+    const wilayaId =
+      wilayaMap[order.customerWilaya?.toLowerCase()] ||
+      order.customerWilaya ||
+      "16";
+
+    const result = await client.createShipment({
+      id_Externe: order.id,
+      Client: order.customerName,
+      MobileA: order.customerPhone,
+      Adresse: order.customerAddress,
+      Commune: order.customerCity,
+      IDWilaya: wilayaId,
+      Total: String(order.total - (order.shippingPrice || 0)),
+      TypeLivraison: order.deliveryType === "DESK" ? "1" : "0",
+      TypeColis: "0", // Normal (pas d'échange)
+      TProduit: productsList,
+      Note: `Commande Harp #${order.id.slice(-8).toUpperCase()}`,
+    });
+
+    if (result.success && result.tracking) {
+      return { success: true, tracking: result.tracking, label: undefined };
     }
+    return { success: false, error: result.message || "Erreur inconnue" };
+  } catch (error) {
+    console.error("ZR Express shipment creation error:", error);
+    return { success: false, error: "Erreur création ZR Express" };
+  }
 }
 
 export async function GET(
-    request: Request,
-    { params }: { params: Promise<{ id: string }> }
+  request: Request,
+  { params }: { params: Promise<{ id: string }> },
 ) {
-    try {
-        const { id } = await params;
-        const order = await prisma.order.findUnique({
-            where: { id },
-            include: { items: true },
-        });
-
-        if (!order) {
-            return NextResponse.json({ error: 'Order not found' }, { status: 404 });
-        }
-
-        return NextResponse.json(order);
-    } catch (error) {
-        return NextResponse.json({ error: 'Error fetching order' }, { status: 500 });
+  try {
+    const { id } = await params;
+    const order = await prisma.order.findUnique({
+      where: { id },
+      include: { items: true },
+    });
+
+    if (!order) {
+      return NextResponse.json({ error: "Order not found" }, { status: 404 });
     }
+
+    return NextResponse.json(order);
+  } catch (error) {
+    return NextResponse.json(
+      { error: "Error fetching order" },
+      { status: 500 },
+    );
+  }
 }
 
 export async function PATCH(
-    request: Request,
-    { params }: { params: Promise<{ id: string }> }
+  request: Request,
+  { params }: { params: Promise<{ id: string }> },
 ) {
-    try {
-        const { id } = await params;
-        const body = await request.json();
-        const { status, ...otherUpdates } = body;
-
-        // Get current order to check status transition
-        const currentOrder = await prisma.order.findUnique({
-            where: { id },
-            include: { items: true },
-        });
-
-        if (!currentOrder) {
-            return NextResponse.json({ error: 'Order not found' }, { status: 404 });
-        }
+  try {
+    const { id } = await params;
+    const body = await request.json();
+    const { status, ...otherUpdates } = body;
+
+    // Get current order to check status transition
+    const currentOrder = await prisma.order.findUnique({
+      where: { id },
+      include: { items: true },
+    });
+
+    if (!currentOrder) {
+      return NextResponse.json({ error: "Order not found" }, { status: 404 });
+    }
 
-        let updateData: any = { ...otherUpdates };
-        let shipmentResult: { success: boolean; tracking?: string; error?: string; label?: string } | null = null;
-
-        // If status is being updated
-        if (status) {
-            updateData.status = status;
-
-            // Auto-create shipment when status changes from PENDING to CONFIRMED
-            if (currentOrder.status === 'PENDING' && status === 'CONFIRMED') {
-                const provider = currentOrder.deliveryProvider;
-                
-                if (provider === 'Yalidine') {
-                    shipmentResult = await createYalidineShipment(currentOrder);
-                } else if (provider === 'ZR Express') {
-                    shipmentResult = await createZRExpressShipment(currentOrder);
-                }
-
-                // If shipment was created successfully, update tracking info
-                if (shipmentResult?.success) {
-                    updateData.trackingNumber = shipmentResult.tracking;
-                    updateData.trackingStatus = 'En préparation';
-                }
-            }
+    const updateData: any = { ...otherUpdates };
+    let shipmentResult: {
+      success: boolean;
+      tracking?: string;
+      error?: string;
+      label?: string;
+    } | null = null;
+
+    // If status is being updated
+    if (status) {
+      updateData.status = status;
+
+      // Auto-create shipment when status changes from PENDING to CONFIRMED
+      if (currentOrder.status === "PENDING" && status === "CONFIRMED") {
+        const provider = currentOrder.deliveryProvider;
+
+        if (provider === "Yalidine") {
+          shipmentResult = await createYalidineShipment(currentOrder);
+        } else if (provider === "ZR Express") {
+          shipmentResult = await createZRExpressShipment(currentOrder);
         }
 
-        // Update the order
-        const updatedOrder = await prisma.order.update({
-            where: { id },
-            data: updateData,
-            include: { items: true },
-        });
-
-        return NextResponse.json({
-            ...updatedOrder,
-            shipmentCreated: shipmentResult?.success || false,
-            shipmentError: shipmentResult?.error || null,
-            label: shipmentResult?.label || null,
-        });
-    } catch (error: any) {
-        console.error('Error updating order:', error);
-        return NextResponse.json({ 
-            error: 'Error updating order',
-            details: error?.message || String(error)
-        }, { status: 500 });
+        // If shipment was created successfully, update tracking info
+        if (shipmentResult?.success) {
+          updateData.trackingNumber = shipmentResult.tracking;
+          updateData.trackingStatus = "En préparation";
+        }
+      }
     }
+
+    // Update the order
+    const updatedOrder = await prisma.order.update({
+      where: { id },
+      data: updateData,
+      include: { items: true },
+    });
+
+    return NextResponse.json({
+      ...updatedOrder,
+      shipmentCreated: shipmentResult?.success || false,
+      shipmentError: shipmentResult?.error || null,
+      label: shipmentResult?.label || null,
+    });
+  } catch (error: any) {
+    console.error("Error updating order:", error);
+    return NextResponse.json(
+      {
+        error: "Error updating order",
+        details: error?.message || String(error),
+      },
+      { status: 500 },
+    );
+  }
 }
 
 export async function PUT(
-    request: Request,
-    { params }: { params: Promise<{ id: string }> }
+  request: Request,
+  { params }: { params: Promise<{ id: string }> },
 ) {
-    // Alias for PATCH
-    return PATCH(request, { params });
+  // Alias for PATCH
+  return PATCH(request, { params });
 }
diff --git a/src/app/api/orders/[id]/ship/route.ts b/src/app/api/orders/[id]/ship/route.ts
index eb328fe..77b3ba1 100644
--- a/src/app/api/orders/[id]/ship/route.ts
+++ b/src/app/api/orders/[id]/ship/route.ts
@@ -10,7 +10,7 @@ import { shipOrderStock, cancelShipment } from "@/lib/accounting/services";
 // POST - Expédier la commande
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -23,20 +23,21 @@ export async function POST(
     if (!order) {
       return NextResponse.json(
         { error: "Commande non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (order.status === "SHIPPED" || order.status === "DELIVERED") {
       return NextResponse.json(
         { error: "Cette commande a déjà été expédiée" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
     // Préparer les items à expédier
-    const itemsToShip: Array<{ inventoryItemId: string; quantity: number }> = [];
-    
+    const itemsToShip: Array<{ inventoryItemId: string; quantity: number }> =
+      [];
+
     for (const item of order.items) {
       if (item.modelId) {
         const bom = await prisma.bomItem.findMany({
@@ -44,9 +45,14 @@ export async function POST(
         });
 
         for (const bomItem of bom) {
-          const qty = Number(bomItem.quantity) * Number(bomItem.wasteFactor) * item.quantity;
-          
-          const existing = itemsToShip.find(i => i.inventoryItemId === bomItem.inventoryItemId);
+          const qty =
+            Number(bomItem.quantity) *
+            Number(bomItem.wasteFactor) *
+            item.quantity;
+
+          const existing = itemsToShip.find(
+            (i) => i.inventoryItemId === bomItem.inventoryItemId,
+          );
           if (existing) {
             existing.quantity += qty;
           } else {
@@ -83,7 +89,7 @@ export async function POST(
     console.error("Error shipping order:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de l'expédition" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
@@ -91,7 +97,7 @@ export async function POST(
 // DELETE - Annuler l'expédition (remettre le stock)
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -104,14 +110,14 @@ export async function DELETE(
     if (!order) {
       return NextResponse.json(
         { error: "Commande non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (order.status !== "SHIPPED") {
       return NextResponse.json(
         { error: "Cette commande n'a pas été expédiée" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -124,7 +130,7 @@ export async function DELETE(
       },
     });
 
-    const itemsToReturn = shipments.map(s => ({
+    const itemsToReturn = shipments.map((s) => ({
       inventoryItemId: s.inventoryItemId,
       quantity: Number(s.quantity),
     }));
@@ -150,7 +156,7 @@ export async function DELETE(
     console.error("Error cancelling shipment:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de l'annulation" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
diff --git a/src/app/api/orders/route.ts b/src/app/api/orders/route.ts
index 0da849c..664b6f6 100644
--- a/src/app/api/orders/route.ts
+++ b/src/app/api/orders/route.ts
@@ -1,160 +1,181 @@
-import { NextRequest, NextResponse } from 'next/server';
-import { prisma } from '@/lib/prisma';
-import { validateOrder, sanitizeString } from '@/lib/validations';
-import { parsePagination, paginatedResponse } from '@/lib/pagination';
+import { NextRequest, NextResponse } from "next/server";
+import { prisma } from "@/lib/prisma";
+import { validateOrder, sanitizeString } from "@/lib/validations";
+import { parsePagination, paginatedResponse } from "@/lib/pagination";
 import { getServerSession } from "next-auth/next";
 import { authOptions } from "@/lib/auth";
-import { earnPoints, LOYALTY_RULES } from "@/lib/loyalty/services/loyalty.service";
+import {
+  earnPoints,
+  LOYALTY_RULES,
+} from "@/lib/loyalty/services/loyalty.service";
 import { withRateLimit, RATE_LIMITS } from "@/lib/rate-limit";
 
 export async function GET(request: NextRequest) {
-    try {
-        const { searchParams } = new URL(request.url);
-        const { page, pageSize, skip } = parsePagination(searchParams);
-        
-        // Optional filters
-        const status = searchParams.get('status');
-        const customerPhone = searchParams.get('customerPhone');
-        const search = searchParams.get('search');
-        
-        const where: any = {};
-        
-        if (status) {
-            where.status = status;
-        }
-        
-        if (customerPhone) {
-            where.customerPhone = { contains: customerPhone };
-        }
-        
-        if (search) {
-            where.OR = [
-                { customerName: { contains: search } },
-                { customerPhone: { contains: search } },
-                { trackingNumber: { contains: search } },
-                { id: { contains: search } },
-            ];
-        }
-        
-        const [orders, total] = await Promise.all([
-            prisma.order.findMany({
-                where,
-                include: { items: true },
-                orderBy: { createdAt: 'desc' },
-                skip,
-                take: pageSize,
-            }),
-            prisma.order.count({ where }),
-        ]);
-        
-        return NextResponse.json(paginatedResponse(orders, page, pageSize, total));
-    } catch (error) {
-        console.error('Error fetching orders:', error);
-        return NextResponse.json({ error: 'Error fetching orders' }, { status: 500 });
+  try {
+    const { searchParams } = new URL(request.url);
+    const { page, pageSize, skip } = parsePagination(searchParams);
+
+    // Optional filters
+    const status = searchParams.get("status");
+    const customerPhone = searchParams.get("customerPhone");
+    const search = searchParams.get("search");
+
+    const where: any = {};
+
+    if (status) {
+      where.status = status;
     }
+
+    if (customerPhone) {
+      where.customerPhone = { contains: customerPhone };
+    }
+
+    if (search) {
+      where.OR = [
+        { customerName: { contains: search } },
+        { customerPhone: { contains: search } },
+        { trackingNumber: { contains: search } },
+        { id: { contains: search } },
+      ];
+    }
+
+    const [orders, total] = await Promise.all([
+      prisma.order.findMany({
+        where,
+        include: { items: true },
+        orderBy: { createdAt: "desc" },
+        skip,
+        take: pageSize,
+      }),
+      prisma.order.count({ where }),
+    ]);
+
+    return NextResponse.json(paginatedResponse(orders, page, pageSize, total));
+  } catch (error) {
+    console.error("Error fetching orders:", error);
+    return NextResponse.json(
+      { error: "Error fetching orders" },
+      { status: 500 },
+    );
+  }
 }
 
 export async function POST(request: NextRequest) {
-    // Rate limiting for order creation
-    const rateLimited = withRateLimit(request, RATE_LIMITS.SUBMIT, "orders");
-    if (rateLimited) return rateLimited;
-
-    try {
-        const body = await request.json();
-        const session = await getServerSession(authOptions);
-        
-        // Validate userId exists in database if provided
-        let userId = null;
-        if (session?.user && (session.user as any).id) {
-            const user = await prisma.user.findUnique({
-                where: { id: (session.user as any).id },
-                select: { id: true }
-            });
-            userId = user?.id || null;
-        }
+  // Rate limiting for order creation
+  const rateLimited = withRateLimit(request, RATE_LIMITS.SUBMIT, "orders");
+  if (rateLimited) return rateLimited;
 
-        // Validate input
-        const validation = validateOrder(body);
-        if (!validation.valid) {
-            return NextResponse.json({ 
-                error: 'Validation failed', 
-                details: validation.errors 
-            }, { status: 400 });
-        }
+  try {
+    const body = await request.json();
+    const session = await getServerSession(authOptions);
 
-        // Calculate subtotal from items
-        const subtotal = body.items.reduce((sum: number, item: { quantity: number; price: number }) => 
-            sum + (parseInt(String(item.quantity)) * parseFloat(String(item.price))), 0);
-
-        const totalAmount = parseFloat(body.total);
-
-        // Prepare items - skip productId validation to avoid FK issues
-        const itemsData = body.items.map((item: { 
-            productId?: string; 
-            productName: string; 
-            size: string; 
-            color: string; 
-            quantity: number; 
-            price: number 
-        }) => ({
-            // Skip productId entirely to avoid foreign key issues
-            productName: sanitizeString(item.productName),
-            size: item.size,
-            color: item.color,
-            quantity: parseInt(String(item.quantity)),
-            unitPrice: parseFloat(String(item.price)),
-            totalPrice: parseInt(String(item.quantity)) * parseFloat(String(item.price)),
-        }));
-
-        // Create the order and its items in a transaction
-        const order = await prisma.order.create({
-            data: {
-                customerName: sanitizeString(body.customerName),
-                customerPhone: sanitizeString(body.customerPhone),
-                customerAddress: sanitizeString(body.customerAddress),
-                customerCity: sanitizeString(body.customerCity),
-                customerWilaya: body.customerWilaya,
-                deliveryProvider: body.deliveryProvider || null,
-                deliveryType: body.deliveryType || null,
-                shippingPrice: parseFloat(body.shippingPrice) || 0,
-                subtotal,
-                total: totalAmount,
-                userId: userId || null, // Link order to user if logged in
-                items: {
-                    create: itemsData,
-                },
-            },
-            include: {
-                items: true,
-            },
-        });
-
-        // Loyalty: Award points if user is logged in
-        if (userId) {
-            try {
-                const points = Math.floor(totalAmount * LOYALTY_RULES.POINTS_PER_DZD);
-                if (points > 0) {
-                    await earnPoints(userId, points, "PURCHASE", order.id);
-                }
-            } catch (loyaltyError) {
-                console.error("Failed to award loyalty points:", loyaltyError);
-                // Do not fail the order if points fail
-            }
-        }
+    // Validate userId exists in database if provided
+    let userId = null;
+    if (session?.user && (session.user as any).id) {
+      const user = await prisma.user.findUnique({
+        where: { id: (session.user as any).id },
+        select: { id: true },
+      });
+      userId = user?.id || null;
+    }
+
+    // Validate input
+    const validation = validateOrder(body);
+    if (!validation.valid) {
+      return NextResponse.json(
+        {
+          error: "Validation failed",
+          details: validation.errors,
+        },
+        { status: 400 },
+      );
+    }
+
+    // Calculate subtotal from items
+    const subtotal = body.items.reduce(
+      (sum: number, item: { quantity: number; price: number }) =>
+        sum + parseInt(String(item.quantity)) * parseFloat(String(item.price)),
+      0,
+    );
+
+    const totalAmount = parseFloat(body.total);
 
-        return NextResponse.json(order, { status: 201 });
-    } catch (error: any) {
-        console.error('Order creation error:', error);
-        
-        // Handle specific Prisma errors
-        if (error?.code === 'P2003') {
-            console.error('Foreign key constraint failed:', error?.meta);
-            return NextResponse.json({ 
-                error: 'Référence invalide dans la commande',
-                details: error?.meta?.field_name || 'foreign key'
-            }, { status: 400 });
+    // Prepare items - skip productId validation to avoid FK issues
+    const itemsData = body.items.map(
+      (item: {
+        productId?: string;
+        productName: string;
+        size: string;
+        color: string;
+        quantity: number;
+        price: number;
+      }) => ({
+        // Skip productId entirely to avoid foreign key issues
+        productName: sanitizeString(item.productName),
+        size: item.size,
+        color: item.color,
+        quantity: parseInt(String(item.quantity)),
+        unitPrice: parseFloat(String(item.price)),
+        totalPrice:
+          parseInt(String(item.quantity)) * parseFloat(String(item.price)),
+      }),
+    );
+
+    // Create the order and its items in a transaction
+    const order = await prisma.order.create({
+      data: {
+        customerName: sanitizeString(body.customerName),
+        customerPhone: sanitizeString(body.customerPhone),
+        customerAddress: sanitizeString(body.customerAddress),
+        customerCity: sanitizeString(body.customerCity),
+        customerWilaya: body.customerWilaya,
+        deliveryProvider: body.deliveryProvider || null,
+        deliveryType: body.deliveryType || null,
+        shippingPrice: parseFloat(body.shippingPrice) || 0,
+        subtotal,
+        total: totalAmount,
+        userId: userId || null, // Link order to user if logged in
+        items: {
+          create: itemsData,
+        },
+      },
+      include: {
+        items: true,
+      },
+    });
+
+    // Loyalty: Award points if user is logged in
+    if (userId) {
+      try {
+        const points = Math.floor(totalAmount * LOYALTY_RULES.POINTS_PER_DZD);
+        if (points > 0) {
+          await earnPoints(userId, points, "PURCHASE", order.id);
         }
-        
-        return NextResponse.json({ error: 'Error creating order' }, { status: 500 });
+      } catch (loyaltyError) {
+        console.error("Failed to award loyalty points:", loyaltyError);
+        // Do not fail the order if points fail
+      }
+    }
+
+    return NextResponse.json(order, { status: 201 });
+  } catch (error: any) {
+    console.error("Order creation error:", error);
+
+    // Handle specific Prisma errors
+    if (error?.code === "P2003") {
+      console.error("Foreign key constraint failed:", error?.meta);
+      return NextResponse.json(
+        {
+          error: "Référence invalide dans la commande",
+          details: error?.meta?.field_name || "foreign key",
+        },
+        { status: 400 },
+      );
     }
+
+    return NextResponse.json(
+      { error: "Error creating order" },
+      { status: 500 },
+    );
+  }
 }
diff --git a/src/app/api/production/[id]/consume/route.ts b/src/app/api/production/[id]/consume/route.ts
index ed4ebff..dbcc3d6 100644
--- a/src/app/api/production/[id]/consume/route.ts
+++ b/src/app/api/production/[id]/consume/route.ts
@@ -4,22 +4,29 @@
 // =============================================================================
 
 import { NextRequest, NextResponse } from "next/server";
-import { consumeProductionBatch, previewConsumption } from "@/lib/accounting/services";
+import {
+  consumeProductionBatch,
+  previewConsumption,
+} from "@/lib/accounting/services";
 import { z } from "zod";
 
 // Schema de validation
 const ConsumeSchema = z.object({
-  consumptions: z.array(z.object({
-    inventoryItemId: z.string().min(1),
-    quantity: z.number().positive(),
-  })).optional(),
+  consumptions: z
+    .array(
+      z.object({
+        inventoryItemId: z.string().min(1),
+        quantity: z.number().positive(),
+      }),
+    )
+    .optional(),
   createdBy: z.string().optional(),
 });
 
 // GET - Prévisualiser la consommation
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -31,7 +38,7 @@ export async function GET(
     console.error("Error generating consumption preview:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de la prévisualisation" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
@@ -39,7 +46,7 @@ export async function GET(
 // POST - Consommer les matières
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -49,11 +56,11 @@ export async function POST(
     const validation = ConsumeSchema.safeParse(body);
     if (!validation.success) {
       return NextResponse.json(
-        { 
+        {
           error: "Données invalides",
           details: validation.error.flatten().fieldErrors,
         },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -71,7 +78,7 @@ export async function POST(
     console.error("Error consuming materials:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de la consommation" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
diff --git a/src/app/api/production/[id]/route.ts b/src/app/api/production/[id]/route.ts
index ec282f1..4afed87 100644
--- a/src/app/api/production/[id]/route.ts
+++ b/src/app/api/production/[id]/route.ts
@@ -5,23 +5,25 @@
 
 import { NextRequest, NextResponse } from "next/server";
 import { prisma } from "@/lib/prisma";
-import { getBatchById, startBatch, completeBatch, cancelBatch } from "@/lib/accounting/services";
+import {
+  getBatchById,
+  startBatch,
+  completeBatch,
+  cancelBatch,
+} from "@/lib/accounting/services";
 
 // GET - Récupérer un lot par ID
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
-    
+
     const batch = await getBatchById(id);
-    
+
     if (!batch) {
-      return NextResponse.json(
-        { error: "Lot non trouvé" },
-        { status: 404 }
-      );
+      return NextResponse.json({ error: "Lot non trouvé" }, { status: 404 });
     }
 
     return NextResponse.json(batch);
@@ -29,7 +31,7 @@ export async function GET(
     console.error("Error fetching batch:", error);
     return NextResponse.json(
       { error: "Erreur lors de la récupération du lot" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -37,7 +39,7 @@ export async function GET(
 // PUT - Mettre à jour un lot (planifié uniquement)
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -48,16 +50,13 @@ export async function PUT(
     });
 
     if (!existing) {
-      return NextResponse.json(
-        { error: "Lot non trouvé" },
-        { status: 404 }
-      );
+      return NextResponse.json({ error: "Lot non trouvé" }, { status: 404 });
     }
 
     if (existing.status !== "PLANNED") {
       return NextResponse.json(
         { error: "Seuls les lots planifiés peuvent être modifiés" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -81,7 +80,7 @@ export async function PUT(
     console.error("Error updating batch:", error);
     return NextResponse.json(
       { error: "Erreur lors de la mise à jour" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -89,7 +88,7 @@ export async function PUT(
 // PATCH - Actions sur le lot (start, complete, cancel)
 export async function PATCH(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -105,7 +104,7 @@ export async function PATCH(
         if (producedQty === undefined) {
           return NextResponse.json(
             { error: "producedQty requis pour terminer le lot" },
-            { status: 400 }
+            { status: 400 },
           );
         }
         result = await completeBatch(id, producedQty, wasteQty);
@@ -116,7 +115,7 @@ export async function PATCH(
       default:
         return NextResponse.json(
           { error: `Action inconnue: ${action}` },
-          { status: 400 }
+          { status: 400 },
         );
     }
 
@@ -125,7 +124,7 @@ export async function PATCH(
     console.error("Error patching batch:", error);
     return NextResponse.json(
       { error: error.message || "Erreur lors de l'action" },
-      { status: 400 }
+      { status: 400 },
     );
   }
 }
@@ -133,7 +132,7 @@ export async function PATCH(
 // DELETE - Supprimer un lot (planifié uniquement)
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const { id } = await params;
@@ -143,16 +142,13 @@ export async function DELETE(
     });
 
     if (!existing) {
-      return NextResponse.json(
-        { error: "Lot non trouvé" },
-        { status: 404 }
-      );
+      return NextResponse.json({ error: "Lot non trouvé" }, { status: 404 });
     }
 
     if (existing.status !== "PLANNED") {
       return NextResponse.json(
         { error: "Seuls les lots planifiés peuvent être supprimés" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -163,7 +159,7 @@ export async function DELETE(
     console.error("Error deleting batch:", error);
     return NextResponse.json(
       { error: "Erreur lors de la suppression" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/production/route.ts b/src/app/api/production/route.ts
index f2fd547..92716b8 100644
--- a/src/app/api/production/route.ts
+++ b/src/app/api/production/route.ts
@@ -5,7 +5,7 @@ import { prisma } from "@/lib/prisma";
 async function generateBatchNumber(): Promise<string> {
   const year = new Date().getFullYear();
   const prefix = `LOT-${year}-`;
-  
+
   const last = await prisma.productionBatch.findFirst({
     where: { batchNumber: { startsWith: prefix } },
     orderBy: { batchNumber: "desc" },
@@ -38,12 +38,12 @@ export async function GET(req: NextRequest) {
         model: {
           include: {
             bom: {
-              include: { inventoryItem: true }
-            }
-          }
-        }
+              include: { inventoryItem: true },
+            },
+          },
+        },
       },
-      orderBy: { createdAt: "desc" }
+      orderBy: { createdAt: "desc" },
     });
 
     // Add material requirements check for each batch
@@ -51,10 +51,10 @@ export async function GET(req: NextRequest) {
       batches.map(async (batch) => {
         const availability = await checkMaterialAvailability(
           batch.modelId,
-          batch.plannedQty
+          batch.plannedQty,
         );
         return { ...batch, availability };
-      })
+      }),
     );
 
     return NextResponse.json(batchesWithAvailability);
@@ -62,7 +62,7 @@ export async function GET(req: NextRequest) {
     console.error("Error fetching production batches:", error);
     return NextResponse.json(
       { error: "Failed to fetch production batches" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -76,7 +76,7 @@ export async function POST(req: NextRequest) {
     if (!data.modelId || !plannedQty || plannedQty < 1) {
       return NextResponse.json(
         { error: "modelId and plannedQty are required" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -84,30 +84,27 @@ export async function POST(req: NextRequest) {
     const model = await prisma.model.findUnique({
       where: { id: data.modelId },
       include: {
-        bom: { include: { inventoryItem: true } }
-      }
+        bom: { include: { inventoryItem: true } },
+      },
     });
 
     if (!model) {
-      return NextResponse.json(
-        { error: "Model not found" },
-        { status: 404 }
-      );
+      return NextResponse.json({ error: "Model not found" }, { status: 404 });
     }
 
     // Check material availability
     const availability = await checkMaterialAvailability(
       data.modelId,
-      plannedQty
+      plannedQty,
     );
 
     if (!availability.canProduce && !data.allowInsufficient) {
       return NextResponse.json(
-        { 
+        {
           error: "Insufficient materials",
-          details: availability.shortages
+          details: availability.shortages,
         },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -123,13 +120,13 @@ export async function POST(req: NextRequest) {
         status: data.status || "PLANNED",
         laborCost: data.laborCost || 0,
         plannedDate: data.plannedDate ? new Date(data.plannedDate) : null,
-        notes: data.notes
+        notes: data.notes,
       },
       include: {
         model: {
-          include: { bom: { include: { inventoryItem: true } } }
-        }
-      }
+          include: { bom: { include: { inventoryItem: true } } },
+        },
+      },
     });
 
     return NextResponse.json(batch, { status: 201 });
@@ -137,7 +134,7 @@ export async function POST(req: NextRequest) {
     console.error("Error creating production batch:", error);
     return NextResponse.json(
       { error: "Failed to create production batch" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
@@ -147,8 +144,8 @@ async function checkMaterialAvailability(modelId: string, plannedQty: number) {
   const model = await prisma.model.findUnique({
     where: { id: modelId },
     include: {
-      bom: { include: { inventoryItem: true } }
-    }
+      bom: { include: { inventoryItem: true } },
+    },
   });
 
   if (!model || !model.bom) {
@@ -173,7 +170,8 @@ async function checkMaterialAvailability(modelId: string, plannedQty: number) {
   }> = [];
 
   for (const bomItem of model.bom) {
-    const required = Number(bomItem.quantity) * Number(bomItem.wasteFactor) * plannedQty;
+    const required =
+      Number(bomItem.quantity) * Number(bomItem.wasteFactor) * plannedQty;
     const available = Number(bomItem.inventoryItem.available);
     const sufficient = available >= required;
 
@@ -183,7 +181,7 @@ async function checkMaterialAvailability(modelId: string, plannedQty: number) {
       sku: bomItem.inventoryItem.sku,
       required: Math.round(required * 100) / 100,
       available: Number(available),
-      sufficient
+      sufficient,
     });
 
     if (!sufficient) {
@@ -192,7 +190,7 @@ async function checkMaterialAvailability(modelId: string, plannedQty: number) {
         name: bomItem.inventoryItem.name,
         required: Math.round(required * 100) / 100,
         available: Number(available),
-        shortage: Math.round((required - available) * 100) / 100
+        shortage: Math.round((required - available) * 100) / 100,
       });
     }
   }
@@ -200,6 +198,6 @@ async function checkMaterialAvailability(modelId: string, plannedQty: number) {
   return {
     canProduce: shortages.length === 0,
     shortages,
-    materials
+    materials,
   };
 }
diff --git a/src/app/api/products/[id]/route.ts b/src/app/api/products/[id]/route.ts
index f33acb8..4ebeafa 100644
--- a/src/app/api/products/[id]/route.ts
+++ b/src/app/api/products/[id]/route.ts
@@ -1,82 +1,94 @@
-import { NextResponse } from 'next/server';
-import { prisma } from '@/lib/prisma';
-import { validateProduct, sanitizeString } from '@/lib/validations';
+import { NextResponse } from "next/server";
+import { prisma } from "@/lib/prisma";
+import { validateProduct, sanitizeString } from "@/lib/validations";
 
 export async function GET(
-    request: Request,
-    { params }: { params: Promise<{ id: string }> }
+  request: Request,
+  { params }: { params: Promise<{ id: string }> },
 ) {
-    try {
-        const { id } = await params;
-        const product = await prisma.product.findUnique({
-            where: { id },
-            include: { collection: true },
-        });
+  try {
+    const { id } = await params;
+    const product = await prisma.product.findUnique({
+      where: { id },
+      include: { collection: true },
+    });
 
-        if (!product) {
-            return NextResponse.json({ error: 'Product not found' }, { status: 404 });
-        }
-
-        return NextResponse.json(product);
-    } catch (error) {
-        return NextResponse.json({ error: 'Error fetching product' }, { status: 500 });
+    if (!product) {
+      return NextResponse.json({ error: "Product not found" }, { status: 404 });
     }
+
+    return NextResponse.json(product);
+  } catch (error) {
+    return NextResponse.json(
+      { error: "Error fetching product" },
+      { status: 500 },
+    );
+  }
 }
 
 export async function PUT(
-    request: Request,
-    { params }: { params: Promise<{ id: string }> }
+  request: Request,
+  { params }: { params: Promise<{ id: string }> },
 ) {
-    try {
-        const { id } = await params;
-        const body = await request.json();
-        
-        // Validate input
-        const validation = validateProduct(body);
-        if (!validation.valid) {
-            return NextResponse.json({ 
-                error: 'Validation failed', 
-                details: validation.errors 
-            }, { status: 400 });
-        }
-        
-        const product = await prisma.product.update({
-            where: { id },
-            data: {
-                nameFr: sanitizeString(body.nameFr),
-                nameAr: sanitizeString(body.nameAr),
-                descriptionFr: sanitizeString(body.descriptionFr),
-                descriptionAr: sanitizeString(body.descriptionAr),
-                price: parseFloat(body.price),
-                images: JSON.stringify(body.images),
-                sizes: JSON.stringify(body.sizes),
-                colors: JSON.stringify(body.colors),
-                stock: parseInt(body.stock) || 0,
-                isActive: body.isActive !== false,
-                showSizeGuide: body.showSizeGuide !== false,
-                freeShipping: body.freeShipping === true,
-                freeShippingThreshold: parseFloat(body.freeShippingThreshold) || 0,
-                collectionId: body.collectionId || null,
-            },
-        });
-        return NextResponse.json(product);
-    } catch (error) {
-        console.error('Error updating product:', error);
-        return NextResponse.json({ error: 'Error updating product' }, { status: 500 });
+  try {
+    const { id } = await params;
+    const body = await request.json();
+
+    // Validate input
+    const validation = validateProduct(body);
+    if (!validation.valid) {
+      return NextResponse.json(
+        {
+          error: "Validation failed",
+          details: validation.errors,
+        },
+        { status: 400 },
+      );
     }
+
+    const product = await prisma.product.update({
+      where: { id },
+      data: {
+        nameFr: sanitizeString(body.nameFr),
+        nameAr: sanitizeString(body.nameAr),
+        descriptionFr: sanitizeString(body.descriptionFr),
+        descriptionAr: sanitizeString(body.descriptionAr),
+        price: parseFloat(body.price),
+        images: JSON.stringify(body.images),
+        sizes: JSON.stringify(body.sizes),
+        colors: JSON.stringify(body.colors),
+        stock: parseInt(body.stock) || 0,
+        isActive: body.isActive !== false,
+        showSizeGuide: body.showSizeGuide !== false,
+        freeShipping: body.freeShipping === true,
+        freeShippingThreshold: parseFloat(body.freeShippingThreshold) || 0,
+        collectionId: body.collectionId || null,
+      },
+    });
+    return NextResponse.json(product);
+  } catch (error) {
+    console.error("Error updating product:", error);
+    return NextResponse.json(
+      { error: "Error updating product" },
+      { status: 500 },
+    );
+  }
 }
 
 export async function DELETE(
-    request: Request,
-    { params }: { params: Promise<{ id: string }> }
+  request: Request,
+  { params }: { params: Promise<{ id: string }> },
 ) {
-    try {
-        const { id } = await params;
-        await prisma.product.delete({
-            where: { id },
-        });
-        return NextResponse.json({ message: 'Product deleted' });
-    } catch (error) {
-        return NextResponse.json({ error: 'Error deleting product' }, { status: 500 });
-    }
+  try {
+    const { id } = await params;
+    await prisma.product.delete({
+      where: { id },
+    });
+    return NextResponse.json({ message: "Product deleted" });
+  } catch (error) {
+    return NextResponse.json(
+      { error: "Error deleting product" },
+      { status: 500 },
+    );
+  }
 }
diff --git a/src/app/api/products/route.ts b/src/app/api/products/route.ts
index d592946..f45dd5e 100644
--- a/src/app/api/products/route.ts
+++ b/src/app/api/products/route.ts
@@ -1,110 +1,124 @@
-import { NextRequest, NextResponse } from 'next/server';
-import { prisma } from '@/lib/prisma';
-import { validateProduct, sanitizeString } from '@/lib/validations';
-import { parsePagination, paginatedResponse } from '@/lib/pagination';
+import { NextRequest, NextResponse } from "next/server";
+import { prisma } from "@/lib/prisma";
+import { validateProduct, sanitizeString } from "@/lib/validations";
+import { parsePagination, paginatedResponse } from "@/lib/pagination";
 
 // Generate URL-friendly slug from name
 function generateSlug(name: string): string {
-    return name
-        .toLowerCase()
-        .normalize('NFD')
-        .replace(/[\u0300-\u036f]/g, '') // Remove accents
-        .replace(/[^a-z0-9\s-]/g, '') // Remove special chars
-        .replace(/\s+/g, '-') // Replace spaces with hyphens
-        .replace(/-+/g, '-') // Remove multiple hyphens
-        .trim();
+  return name
+    .toLowerCase()
+    .normalize("NFD")
+    .replace(/[\u0300-\u036f]/g, "") // Remove accents
+    .replace(/[^a-z0-9\s-]/g, "") // Remove special chars
+    .replace(/\s+/g, "-") // Replace spaces with hyphens
+    .replace(/-+/g, "-") // Remove multiple hyphens
+    .trim();
 }
 
 export async function GET(request: NextRequest) {
-    try {
-        const { searchParams } = new URL(request.url);
-        const { page, pageSize, skip } = parsePagination(searchParams);
-        
-        // Optional filters
-        const collectionId = searchParams.get('collectionId');
-        const isActive = searchParams.get('isActive');
-        const search = searchParams.get('search');
-        
-        const where: any = {};
-        
-        if (collectionId) {
-            where.collectionId = collectionId;
-        }
-        
-        if (isActive !== null && isActive !== undefined) {
-            where.isActive = isActive === 'true';
-        }
-        
-        if (search) {
-            where.OR = [
-                { nameFr: { contains: search } },
-                { nameAr: { contains: search } },
-                { slug: { contains: search } },
-            ];
-        }
-        
-        const [products, total] = await Promise.all([
-            prisma.product.findMany({
-                where,
-                include: { collection: true },
-                orderBy: { createdAt: 'desc' },
-                skip,
-                take: pageSize,
-            }),
-            prisma.product.count({ where }),
-        ]);
-        
-        // Add cache headers for public product listing
-        const response = NextResponse.json(paginatedResponse(products, page, pageSize, total));
-        response.headers.set("Cache-Control", "public, s-maxage=60, stale-while-revalidate=300");
-        return response;
-    } catch (error) {
-        console.error('Error fetching products:', error);
-        return NextResponse.json({ error: 'Error fetching products' }, { status: 500 });
+  try {
+    const { searchParams } = new URL(request.url);
+    const { page, pageSize, skip } = parsePagination(searchParams);
+
+    // Optional filters
+    const collectionId = searchParams.get("collectionId");
+    const isActive = searchParams.get("isActive");
+    const search = searchParams.get("search");
+
+    const where: any = {};
+
+    if (collectionId) {
+      where.collectionId = collectionId;
+    }
+
+    if (isActive !== null && isActive !== undefined) {
+      where.isActive = isActive === "true";
+    }
+
+    if (search) {
+      where.OR = [
+        { nameFr: { contains: search } },
+        { nameAr: { contains: search } },
+        { slug: { contains: search } },
+      ];
     }
+
+    const [products, total] = await Promise.all([
+      prisma.product.findMany({
+        where,
+        include: { collection: true },
+        orderBy: { createdAt: "desc" },
+        skip,
+        take: pageSize,
+      }),
+      prisma.product.count({ where }),
+    ]);
+
+    // Add cache headers for public product listing
+    const response = NextResponse.json(
+      paginatedResponse(products, page, pageSize, total),
+    );
+    response.headers.set(
+      "Cache-Control",
+      "public, s-maxage=60, stale-while-revalidate=300",
+    );
+    return response;
+  } catch (error) {
+    console.error("Error fetching products:", error);
+    return NextResponse.json(
+      { error: "Error fetching products" },
+      { status: 500 },
+    );
+  }
 }
 
 export async function POST(request: Request) {
-    try {
-        const body = await request.json();
-        
-        // Validate input
-        const validation = validateProduct(body);
-        if (!validation.valid) {
-            return NextResponse.json({ 
-                error: 'Validation failed', 
-                details: validation.errors 
-            }, { status: 400 });
-        }
-        
-        const slug = body.slug || generateSlug(body.nameFr);
-        
-        // Check if slug already exists
-        const existingSlug = await prisma.product.findUnique({ where: { slug } });
-        const finalSlug = existingSlug ? `${slug}-${Date.now()}` : slug;
-        
-        const product = await prisma.product.create({
-            data: {
-                slug: finalSlug,
-                nameFr: sanitizeString(body.nameFr),
-                nameAr: sanitizeString(body.nameAr),
-                descriptionFr: sanitizeString(body.descriptionFr),
-                descriptionAr: sanitizeString(body.descriptionAr),
-                price: parseFloat(body.price),
-                images: JSON.stringify(body.images),
-                sizes: JSON.stringify(body.sizes),
-                colors: JSON.stringify(body.colors),
-                stock: parseInt(body.stock) || 0,
-                isActive: body.isActive !== false,
-                showSizeGuide: body.showSizeGuide !== false,
-                freeShipping: body.freeShipping === true,
-                freeShippingThreshold: parseFloat(body.freeShippingThreshold) || 0,
-                collectionId: body.collectionId || null,
-            },
-        });
-        return NextResponse.json(product, { status: 201 });
-    } catch (error) {
-        console.error('Error creating product:', error);
-        return NextResponse.json({ error: 'Error creating product' }, { status: 500 });
+  try {
+    const body = await request.json();
+
+    // Validate input
+    const validation = validateProduct(body);
+    if (!validation.valid) {
+      return NextResponse.json(
+        {
+          error: "Validation failed",
+          details: validation.errors,
+        },
+        { status: 400 },
+      );
     }
+
+    const slug = body.slug || generateSlug(body.nameFr);
+
+    // Check if slug already exists
+    const existingSlug = await prisma.product.findUnique({ where: { slug } });
+    const finalSlug = existingSlug ? `${slug}-${Date.now()}` : slug;
+
+    const product = await prisma.product.create({
+      data: {
+        slug: finalSlug,
+        nameFr: sanitizeString(body.nameFr),
+        nameAr: sanitizeString(body.nameAr),
+        descriptionFr: sanitizeString(body.descriptionFr),
+        descriptionAr: sanitizeString(body.descriptionAr),
+        price: parseFloat(body.price),
+        images: JSON.stringify(body.images),
+        sizes: JSON.stringify(body.sizes),
+        colors: JSON.stringify(body.colors),
+        stock: parseInt(body.stock) || 0,
+        isActive: body.isActive !== false,
+        showSizeGuide: body.showSizeGuide !== false,
+        freeShipping: body.freeShipping === true,
+        freeShippingThreshold: parseFloat(body.freeShippingThreshold) || 0,
+        collectionId: body.collectionId || null,
+      },
+    });
+    return NextResponse.json(product, { status: 201 });
+  } catch (error) {
+    console.error("Error creating product:", error);
+    return NextResponse.json(
+      { error: "Error creating product" },
+      { status: 500 },
+    );
+  }
 }
diff --git a/src/app/api/seed/route.ts b/src/app/api/seed/route.ts
index f516e23..bcab1b5 100644
--- a/src/app/api/seed/route.ts
+++ b/src/app/api/seed/route.ts
@@ -1,150 +1,175 @@
-import { NextResponse } from 'next/server';
-import { prisma } from '@/lib/prisma';
+import { NextResponse } from "next/server";
+import { prisma } from "@/lib/prisma";
 
 // Generate URL-friendly slug from name
 function generateSlug(name: string): string {
-    return name
-        .toLowerCase()
-        .normalize('NFD')
-        .replace(/[\u0300-\u036f]/g, '') // Remove accents
-        .replace(/[^a-z0-9\s-]/g, '') // Remove special chars
-        .replace(/\s+/g, '-') // Replace spaces with hyphens
-        .replace(/-+/g, '-') // Remove multiple hyphens
-        .trim();
+  return name
+    .toLowerCase()
+    .normalize("NFD")
+    .replace(/[\u0300-\u036f]/g, "") // Remove accents
+    .replace(/[^a-z0-9\s-]/g, "") // Remove special chars
+    .replace(/\s+/g, "-") // Replace spaces with hyphens
+    .replace(/-+/g, "-") // Remove multiple hyphens
+    .trim();
 }
 
 export async function GET() {
-    try {
-        // Clear existing products to ensure clean state for the new catalog
-        await prisma.orderItem.deleteMany({}); // Delete order items first due to foreign key constraints
-        await prisma.product.deleteMany({});
+  try {
+    // Clear existing products to ensure clean state for the new catalog
+    await prisma.orderItem.deleteMany({}); // Delete order items first due to foreign key constraints
+    await prisma.product.deleteMany({});
 
-        const products = [
-            {
-                slug: "abaya-soie-medine-noire",
-                nameFr: "Abaya Soie de Médine Noire",
-                nameAr: "عباية حرير المدينة سوداء",
-                descriptionFr: "Abaya fluide en soie de Médine, coupe papillon pour une élégance modeste. Tissu opaque et léger, idéal pour toutes les saisons.",
-                descriptionAr: "عباية انسيابية من حرير المدينة، قصة فراشة لأناقة محتشمة. قماش غير شفاف وخفيف، مثالي لجميع الفصول.",
-                price: 5500,
-                images: JSON.stringify([
-                    "https://placehold.co/600x800/1a1a1a/ffffff?text=Abaya+Noire+Face",
-                    "https://placehold.co/600x800/1a1a1a/ffffff?text=Abaya+Noire+Dos"
-                ]),
-                sizes: JSON.stringify(["Taille 1 (1m55-1m62)", "Taille 2 (1m63-1m70)", "Taille 3 (1m70+)"]),
-                colors: JSON.stringify(["Noir"]),
-                collectionId: null
-            },
-            {
-                slug: "ensemble-kimono-lin-beige",
-                nameFr: "Ensemble Kimono Lin Beige",
-                nameAr: "طقم كيمونو كتان بيج",
-                descriptionFr: "Ensemble 3 pièces : Kimono, sous-abaya et ceinture. Confectionné en lin premium respirant.",
-                descriptionAr: "طقم 3 قطع: كيمونو، عباية داخلية وحزام. مصنوع من الكتان الفاخر جيد التهوية.",
-                price: 8900,
-                images: JSON.stringify([
-                    "https://placehold.co/600x800/e6dcc8/5c4b35?text=Kimono+Beige",
-                    "https://placehold.co/600x800/e6dcc8/5c4b35?text=Detail+Lin"
-                ]),
-                sizes: JSON.stringify(["Standard"]),
-                colors: JSON.stringify(["Beige", "Blanc Cassé", "Taupe"]),
-                collectionId: null
-            },
-            {
-                slug: "robe-satinee-emeraude",
-                nameFr: "Robe Satinée Émeraude",
-                nameAr: "فستان ساتان زمردي",
-                descriptionFr: "Robe longue satinée pour occasions spéciales. Manches ballons et ceinture assortie.",
-                descriptionAr: "فستان طويل من الساتان للمناسبات الخاصة. أكمام منفوخة وحزام متناسق.",
-                price: 7500,
-                images: JSON.stringify([
-                    "https://placehold.co/600x800/0f5c38/ffffff?text=Robe+Emeraude"
-                ]),
-                sizes: JSON.stringify(["S", "M", "L", "XL"]),
-                colors: JSON.stringify(["Émeraude", "Bordeaux", "Champagne"]),
-                collectionId: null
-            },
-            {
-                slug: "abaya-khimar-set",
-                nameFr: "Abaya Khimar Set",
-                nameAr: "طقم عباية وخمار",
-                descriptionFr: "Ensemble pratique composé d'une abaya ample et d'un khimar assorti. Tissu jazz infroissable.",
-                descriptionAr: "طقم عملي مكون من عباية واسعة وخمار متناسق. قماش جاز لا يتجعد.",
-                price: 4500,
-                images: JSON.stringify([
-                    "https://placehold.co/600x800/4a4a4a/ffffff?text=Set+Abaya+Khimar"
-                ]),
-                sizes: JSON.stringify(["Unique"]),
-                colors: JSON.stringify(["Gris Souris", "Bleu Nuit", "Prune"]),
-                collectionId: null
-            },
-            {
-                slug: "robe-coton-boheme",
-                nameFr: "Robe Coton Bohème",
-                nameAr: "معطف ترنش محتشم",
-                descriptionFr: "Trench long oversize, parfait pour la mi-saison. Double boutonnage et ceinture.",
-                descriptionAr: "معطف ترنش طويل واسع، مثالي لفصل الربيع والخريف. أزرار مزدوجة وحزام.",
-                price: 12500,
-                images: JSON.stringify([
-                    "https://placehold.co/600x800/c2b280/333333?text=Trench+Coat"
-                ]),
-                sizes: JSON.stringify(["S/M", "L/XL"]),
-                colors: JSON.stringify(["Camel", "Kaki"]),
-                collectionId: null
-            },
-            {
-                slug: "ensemble-tailleur-modest",
-                nameFr: "Ensemble Tailleur Modest",
-                nameAr: "طقم رسمي محتشم",
-                descriptionFr: "Veste blazer longue et pantalon large à pinces. Look professionnel et élégant.",
-                descriptionAr: "جاكيت بليزر طويل وبنطلون واسع بكسرات. مظهر احترافي وأنيق.",
-                price: 10500,
-                images: JSON.stringify([
-                    "https://placehold.co/600x800/303030/ffffff?text=Tailleur+Modest"
-                ]),
-                sizes: JSON.stringify(["38", "40", "42", "44"]),
-                colors: JSON.stringify(["Noir", "Bleu Marine", "Marron Glacé"]),
-                collectionId: null
-            },
-            {
-                slug: "jilbab-deux-pieces-classique",
-                nameFr: "Jilbab Deux-Pièces Classique",
-                nameAr: "عباية تطريز إنجليزي",
-                descriptionFr: "Abaya d'été en coton avec détails en broderie anglaise sur les manches et le bas.",
-                descriptionAr: "عباية صيفية قطنية مع تفاصيل تطريز إنجليزي على الأكمام والحافة.",
-                price: 6800,
-                images: JSON.stringify([
-                    "https://placehold.co/600x800/ffffff/333333?text=Abaya+Broderie"
-                ]),
-                sizes: JSON.stringify(["Standard"]),
-                colors: JSON.stringify(["Blanc", "Rose Poudré"]),
-                collectionId: null
-            },
-            {
-                slug: "cape-hivernale-laine",
-                nameFr: "Cape Hivernale Laine",
-                nameAr: "كيب شتوي صوف",
-                descriptionFr: "Cape chaude en laine mélangée, ouverture fente pour les bras. Chic et couvrant.",
-                descriptionAr: "كيب دافئ من مزيج الصوف، فتحة للذراعين. شيك ومحتشم.",
-                price: 9200,
-                images: JSON.stringify([
-                    "https://placehold.co/600x800/5c4b35/ffffff?text=Cape+Laine"
-                ]),
-                sizes: JSON.stringify(["Unique"]),
-                colors: JSON.stringify(["Gris Chiné", "Noir", "Beige"]),
-                collectionId: null
-            }
-        ];
+    const products = [
+      {
+        slug: "abaya-soie-medine-noire",
+        nameFr: "Abaya Soie de Médine Noire",
+        nameAr: "عباية حرير المدينة سوداء",
+        descriptionFr:
+          "Abaya fluide en soie de Médine, coupe papillon pour une élégance modeste. Tissu opaque et léger, idéal pour toutes les saisons.",
+        descriptionAr:
+          "عباية انسيابية من حرير المدينة، قصة فراشة لأناقة محتشمة. قماش غير شفاف وخفيف، مثالي لجميع الفصول.",
+        price: 5500,
+        images: JSON.stringify([
+          "https://placehold.co/600x800/1a1a1a/ffffff?text=Abaya+Noire+Face",
+          "https://placehold.co/600x800/1a1a1a/ffffff?text=Abaya+Noire+Dos",
+        ]),
+        sizes: JSON.stringify([
+          "Taille 1 (1m55-1m62)",
+          "Taille 2 (1m63-1m70)",
+          "Taille 3 (1m70+)",
+        ]),
+        colors: JSON.stringify(["Noir"]),
+        collectionId: null,
+      },
+      {
+        slug: "ensemble-kimono-lin-beige",
+        nameFr: "Ensemble Kimono Lin Beige",
+        nameAr: "طقم كيمونو كتان بيج",
+        descriptionFr:
+          "Ensemble 3 pièces : Kimono, sous-abaya et ceinture. Confectionné en lin premium respirant.",
+        descriptionAr:
+          "طقم 3 قطع: كيمونو، عباية داخلية وحزام. مصنوع من الكتان الفاخر جيد التهوية.",
+        price: 8900,
+        images: JSON.stringify([
+          "https://placehold.co/600x800/e6dcc8/5c4b35?text=Kimono+Beige",
+          "https://placehold.co/600x800/e6dcc8/5c4b35?text=Detail+Lin",
+        ]),
+        sizes: JSON.stringify(["Standard"]),
+        colors: JSON.stringify(["Beige", "Blanc Cassé", "Taupe"]),
+        collectionId: null,
+      },
+      {
+        slug: "robe-satinee-emeraude",
+        nameFr: "Robe Satinée Émeraude",
+        nameAr: "فستان ساتان زمردي",
+        descriptionFr:
+          "Robe longue satinée pour occasions spéciales. Manches ballons et ceinture assortie.",
+        descriptionAr:
+          "فستان طويل من الساتان للمناسبات الخاصة. أكمام منفوخة وحزام متناسق.",
+        price: 7500,
+        images: JSON.stringify([
+          "https://placehold.co/600x800/0f5c38/ffffff?text=Robe+Emeraude",
+        ]),
+        sizes: JSON.stringify(["S", "M", "L", "XL"]),
+        colors: JSON.stringify(["Émeraude", "Bordeaux", "Champagne"]),
+        collectionId: null,
+      },
+      {
+        slug: "abaya-khimar-set",
+        nameFr: "Abaya Khimar Set",
+        nameAr: "طقم عباية وخمار",
+        descriptionFr:
+          "Ensemble pratique composé d'une abaya ample et d'un khimar assorti. Tissu jazz infroissable.",
+        descriptionAr:
+          "طقم عملي مكون من عباية واسعة وخمار متناسق. قماش جاز لا يتجعد.",
+        price: 4500,
+        images: JSON.stringify([
+          "https://placehold.co/600x800/4a4a4a/ffffff?text=Set+Abaya+Khimar",
+        ]),
+        sizes: JSON.stringify(["Unique"]),
+        colors: JSON.stringify(["Gris Souris", "Bleu Nuit", "Prune"]),
+        collectionId: null,
+      },
+      {
+        slug: "robe-coton-boheme",
+        nameFr: "Robe Coton Bohème",
+        nameAr: "معطف ترنش محتشم",
+        descriptionFr:
+          "Trench long oversize, parfait pour la mi-saison. Double boutonnage et ceinture.",
+        descriptionAr:
+          "معطف ترنش طويل واسع، مثالي لفصل الربيع والخريف. أزرار مزدوجة وحزام.",
+        price: 12500,
+        images: JSON.stringify([
+          "https://placehold.co/600x800/c2b280/333333?text=Trench+Coat",
+        ]),
+        sizes: JSON.stringify(["S/M", "L/XL"]),
+        colors: JSON.stringify(["Camel", "Kaki"]),
+        collectionId: null,
+      },
+      {
+        slug: "ensemble-tailleur-modest",
+        nameFr: "Ensemble Tailleur Modest",
+        nameAr: "طقم رسمي محتشم",
+        descriptionFr:
+          "Veste blazer longue et pantalon large à pinces. Look professionnel et élégant.",
+        descriptionAr:
+          "جاكيت بليزر طويل وبنطلون واسع بكسرات. مظهر احترافي وأنيق.",
+        price: 10500,
+        images: JSON.stringify([
+          "https://placehold.co/600x800/303030/ffffff?text=Tailleur+Modest",
+        ]),
+        sizes: JSON.stringify(["38", "40", "42", "44"]),
+        colors: JSON.stringify(["Noir", "Bleu Marine", "Marron Glacé"]),
+        collectionId: null,
+      },
+      {
+        slug: "jilbab-deux-pieces-classique",
+        nameFr: "Jilbab Deux-Pièces Classique",
+        nameAr: "عباية تطريز إنجليزي",
+        descriptionFr:
+          "Abaya d'été en coton avec détails en broderie anglaise sur les manches et le bas.",
+        descriptionAr:
+          "عباية صيفية قطنية مع تفاصيل تطريز إنجليزي على الأكمام والحافة.",
+        price: 6800,
+        images: JSON.stringify([
+          "https://placehold.co/600x800/ffffff/333333?text=Abaya+Broderie",
+        ]),
+        sizes: JSON.stringify(["Standard"]),
+        colors: JSON.stringify(["Blanc", "Rose Poudré"]),
+        collectionId: null,
+      },
+      {
+        slug: "cape-hivernale-laine",
+        nameFr: "Cape Hivernale Laine",
+        nameAr: "كيب شتوي صوف",
+        descriptionFr:
+          "Cape chaude en laine mélangée, ouverture fente pour les bras. Chic et couvrant.",
+        descriptionAr: "كيب دافئ من مزيج الصوف، فتحة للذراعين. شيك ومحتشم.",
+        price: 9200,
+        images: JSON.stringify([
+          "https://placehold.co/600x800/5c4b35/ffffff?text=Cape+Laine",
+        ]),
+        sizes: JSON.stringify(["Unique"]),
+        colors: JSON.stringify(["Gris Chiné", "Noir", "Beige"]),
+        collectionId: null,
+      },
+    ];
 
-        for (const product of products) {
-            await prisma.product.create({
-                data: product,
-            });
-        }
-
-        return NextResponse.json({ message: 'Seeding successful', count: products.length });
-    } catch (error) {
-        console.error('Seeding error:', error);
-        return NextResponse.json({ error: 'Error seeding database' }, { status: 500 });
+    for (const product of products) {
+      await prisma.product.create({
+        data: product,
+      });
     }
+
+    return NextResponse.json({
+      message: "Seeding successful",
+      count: products.length,
+    });
+  } catch (error) {
+    console.error("Seeding error:", error);
+    return NextResponse.json(
+      { error: "Error seeding database" },
+      { status: 500 },
+    );
+  }
 }
diff --git a/src/app/api/shipping/route.ts b/src/app/api/shipping/route.ts
index a99f180..a26138b 100644
--- a/src/app/api/shipping/route.ts
+++ b/src/app/api/shipping/route.ts
@@ -1,93 +1,99 @@
 import { NextRequest, NextResponse } from "next/server";
 import { getZRClient } from "@/lib/zrexpress";
-import { getZRStopDesks, ZR_EXPRESS_STOPDESKS } from "@/lib/zrexpress-stopdesks";
+import {
+  getZRStopDesks,
+  ZR_EXPRESS_STOPDESKS,
+} from "@/lib/zrexpress-stopdesks";
 import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
 
 // GET /api/shipping - Tester la connexion, récupérer les tarifs, ou les stop desks
 export async function GET(request: NextRequest) {
-    try {
-        await requireAdmin(request);
-        
-        const { searchParams } = new URL(request.url);
-        const action = searchParams.get('action');
-        
-        // Get stop desks for a wilaya
-        if (action === 'stopdesks') {
-            const wilayaId = searchParams.get('wilaya_id');
-            if (wilayaId) {
-                const stopDesks = getZRStopDesks(parseInt(wilayaId));
-                return NextResponse.json({ data: stopDesks });
-            }
-            // Return all stop desks if no wilaya specified
-            return NextResponse.json({ data: ZR_EXPRESS_STOPDESKS });
-        }
-        
-        const client = getZRClient();
-        
-        // Tester la connexion
-        const connectionTest = await client.testConnection();
-        
-        if (!connectionTest.success) {
-            return NextResponse.json(
-                { error: "Impossible de se connecter à ZR Express" },
-                { status: 503 }
-            );
-        }
+  try {
+    await requireAdmin(request);
 
-        // Récupérer les tarifs
-        const tarifs = await client.getTarification();
+    const { searchParams } = new URL(request.url);
+    const action = searchParams.get("action");
 
-        return NextResponse.json({
-            connected: true,
-            tarifs
-        });
-    } catch (error) {
-        return handleApiError(error);
+    // Get stop desks for a wilaya
+    if (action === "stopdesks") {
+      const wilayaId = searchParams.get("wilaya_id");
+      if (wilayaId) {
+        const stopDesks = getZRStopDesks(parseInt(wilayaId));
+        return NextResponse.json({ data: stopDesks });
+      }
+      // Return all stop desks if no wilaya specified
+      return NextResponse.json({ data: ZR_EXPRESS_STOPDESKS });
     }
+
+    const client = getZRClient();
+
+    // Tester la connexion
+    const connectionTest = await client.testConnection();
+
+    if (!connectionTest.success) {
+      return NextResponse.json(
+        { error: "Impossible de se connecter à ZR Express" },
+        { status: 503 },
+      );
+    }
+
+    // Récupérer les tarifs
+    const tarifs = await client.getTarification();
+
+    return NextResponse.json({
+      connected: true,
+      tarifs,
+    });
+  } catch (error) {
+    return handleApiError(error);
+  }
 }
 
 // POST /api/shipping - Créer une expédition
 export async function POST(request: NextRequest) {
-    try {
-        await requireAdmin(request);
-        
-        const body = await request.json();
-        const { orderId, orderData } = body;
+  try {
+    await requireAdmin(request);
+
+    const body = await request.json();
+    const { orderId, orderData } = body;
 
-        if (!orderId || !orderData) {
-            return NextResponse.json(
-                { error: "orderId et orderData sont requis" },
-                { status: 400 }
-            );
-        }
+    if (!orderId || !orderData) {
+      return NextResponse.json(
+        { error: "orderId et orderData sont requis" },
+        { status: 400 },
+      );
+    }
 
-        const client = getZRClient();
+    const client = getZRClient();
 
-        // Créer le colis ZR Express
-        const colis = {
-            TypeLivraison: orderData.deliveryType === 'STOP_DESK' ? '1' as const : '0' as const,
-            TypeColis: '0' as const,
-            Confrimee: '1' as const,
-            Client: orderData.customerName,
-            MobileA: orderData.customerPhone.replace(/\s/g, ''),
-            MobileB: orderData.customerPhoneB || '',
-            Adresse: orderData.address,
-            IDWilaya: orderData.wilayaId || '16',
-            Commune: orderData.commune,
-            Total: orderData.total.toString(),
-            Note: orderData.notes || '',
-            TProduit: orderData.products || 'Articles Harp',
-            id_Externe: orderId,
-        };
+    // Créer le colis ZR Express
+    const colis = {
+      TypeLivraison:
+        orderData.deliveryType === "STOP_DESK"
+          ? ("1" as const)
+          : ("0" as const),
+      TypeColis: "0" as const,
+      Confrimee: "1" as const,
+      Client: orderData.customerName,
+      MobileA: orderData.customerPhone.replace(/\s/g, ""),
+      MobileB: orderData.customerPhoneB || "",
+      Adresse: orderData.address,
+      IDWilaya: orderData.wilayaId || "16",
+      Commune: orderData.commune,
+      Total: orderData.total.toString(),
+      Note: orderData.notes || "",
+      TProduit: orderData.products || "Articles Harp",
+      id_Externe: orderId,
+    };
 
-        const result = await client.createShipment(colis);
+    const result = await client.createShipment(colis);
 
-        return NextResponse.json({
-            success: true,
-            tracking: result.tracking,
-            data: result
-        });
-    } catch (error) {
-        return handleApiError(error);
-    }
+    return NextResponse.json({
+      success: true,
+      tracking: result.tracking,
+      data: result,
+    });
+  } catch (error) {
+    return handleApiError(error);
+  }
 }
diff --git a/src/app/api/shipping/track/route.ts b/src/app/api/shipping/track/route.ts
index 9a3e7f9..d6c4e14 100644
--- a/src/app/api/shipping/track/route.ts
+++ b/src/app/api/shipping/track/route.ts
@@ -4,27 +4,31 @@ import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
 
 // POST /api/shipping/track - Suivre un ou plusieurs colis
 export async function POST(request: NextRequest) {
-    try {
-        await requireAdmin(request);
-        
-        const body = await request.json();
-        const { trackingNumbers } = body;
+  try {
+    await requireAdmin(request);
 
-        if (!trackingNumbers || !Array.isArray(trackingNumbers) || trackingNumbers.length === 0) {
-            return NextResponse.json(
-                { error: "trackingNumbers est requis (tableau)" },
-                { status: 400 }
-            );
-        }
+    const body = await request.json();
+    const { trackingNumbers } = body;
 
-        const client = getZRClient();
-        const trackingInfo = await client.getTrackingInfo(trackingNumbers);
-
-        return NextResponse.json({
-            success: true,
-            data: trackingInfo
-        });
-    } catch (error) {
-        return handleApiError(error);
+    if (
+      !trackingNumbers ||
+      !Array.isArray(trackingNumbers) ||
+      trackingNumbers.length === 0
+    ) {
+      return NextResponse.json(
+        { error: "trackingNumbers est requis (tableau)" },
+        { status: 400 },
+      );
     }
+
+    const client = getZRClient();
+    const trackingInfo = await client.getTrackingInfo(trackingNumbers);
+
+    return NextResponse.json({
+      success: true,
+      data: trackingInfo,
+    });
+  } catch (error) {
+    return handleApiError(error);
+  }
 }
diff --git a/src/app/api/shipping/yalidine/route.ts b/src/app/api/shipping/yalidine/route.ts
index e93e117..dfe0034 100644
--- a/src/app/api/shipping/yalidine/route.ts
+++ b/src/app/api/shipping/yalidine/route.ts
@@ -4,120 +4,134 @@ import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
 
 // GET /api/shipping/yalidine - Tester la connexion et récupérer infos
 export async function GET(request: NextRequest) {
-    try {
-        await requireAdmin(request);
-        
-        const client = getYalidineClient();
-        const { searchParams } = new URL(request.url);
-        const action = searchParams.get('action');
+  try {
+    await requireAdmin(request);
 
-        // Test de connexion (default action)
-        if (!action || action === 'test') {
-            try {
-                const connectionTest = await client.testConnection();
-                return NextResponse.json({
-                    connected: connectionTest.success,
-                    provider: 'Yalidine',
-                    message: connectionTest.message
-                });
-            } catch (testError) {
-                console.error('Yalidine test connection error:', testError);
-                return NextResponse.json({
-                    connected: false,
-                    provider: 'Yalidine',
-                    message: 'Erreur de test de connexion'
-                });
-            }
-        }
+    const client = getYalidineClient();
+    const { searchParams } = new URL(request.url);
+    const action = searchParams.get("action");
 
-        // Récupérer les wilayas
-        if (action === 'wilayas') {
-            const result = await client.getWilayas();
-            return NextResponse.json({ data: result.data });
-        }
-
-        // Récupérer les communes
-        if (action === 'communes') {
-            const wilayaId = searchParams.get('wilaya_id');
-            const result = await client.getCommunes(wilayaId ? parseInt(wilayaId) : undefined);
-            return NextResponse.json({ data: result.data });
-        }
+    // Test de connexion (default action)
+    if (!action || action === "test") {
+      try {
+        const connectionTest = await client.testConnection();
+        return NextResponse.json({
+          connected: connectionTest.success,
+          provider: "Yalidine",
+          message: connectionTest.message,
+        });
+      } catch (testError) {
+        console.error("Yalidine test connection error:", testError);
+        return NextResponse.json({
+          connected: false,
+          provider: "Yalidine",
+          message: "Erreur de test de connexion",
+        });
+      }
+    }
 
-        // Récupérer les centres (stop desk)
-        if (action === 'centers') {
-            const wilayaId = searchParams.get('wilaya_id');
-            const result = await client.getCenters(wilayaId ? parseInt(wilayaId) : undefined);
-            return NextResponse.json({ data: result.data });
-        }
+    // Récupérer les wilayas
+    if (action === "wilayas") {
+      const result = await client.getWilayas();
+      return NextResponse.json({ data: result.data });
+    }
 
-        // Récupérer les tarifs
-        if (action === 'fees') {
-            const fromWilaya = searchParams.get('from_wilaya_id') || '16'; // Alger par défaut
-            const toWilaya = searchParams.get('to_wilaya_id');
-            if (!toWilaya) {
-                return NextResponse.json({ error: "to_wilaya_id requis" }, { status: 400 });
-            }
-            const result = await client.getFees(parseInt(fromWilaya), parseInt(toWilaya));
-            return NextResponse.json({ data: result });
-        }
+    // Récupérer les communes
+    if (action === "communes") {
+      const wilayaId = searchParams.get("wilaya_id");
+      const result = await client.getCommunes(
+        wilayaId ? parseInt(wilayaId) : undefined,
+      );
+      return NextResponse.json({ data: result.data });
+    }
 
-        return NextResponse.json({ error: "Action non reconnue" }, { status: 400 });
+    // Récupérer les centres (stop desk)
+    if (action === "centers") {
+      const wilayaId = searchParams.get("wilaya_id");
+      const result = await client.getCenters(
+        wilayaId ? parseInt(wilayaId) : undefined,
+      );
+      return NextResponse.json({ data: result.data });
+    }
 
-    } catch (error) {
-        return handleApiError(error);
+    // Récupérer les tarifs
+    if (action === "fees") {
+      const fromWilaya = searchParams.get("from_wilaya_id") || "16"; // Alger par défaut
+      const toWilaya = searchParams.get("to_wilaya_id");
+      if (!toWilaya) {
+        return NextResponse.json(
+          { error: "to_wilaya_id requis" },
+          { status: 400 },
+        );
+      }
+      const result = await client.getFees(
+        parseInt(fromWilaya),
+        parseInt(toWilaya),
+      );
+      return NextResponse.json({ data: result });
     }
+
+    return NextResponse.json({ error: "Action non reconnue" }, { status: 400 });
+  } catch (error) {
+    return handleApiError(error);
+  }
 }
 
 // POST /api/shipping/yalidine - Créer une expédition
 export async function POST(request: NextRequest) {
-    try {
-        await requireAdmin(request);
-        
-        const body = await request.json();
-        const { orderId, orderData } = body;
+  try {
+    await requireAdmin(request);
 
-        if (!orderId || !orderData) {
-            return NextResponse.json(
-                { error: "orderId et orderData sont requis" },
-                { status: 400 }
-            );
-        }
+    const body = await request.json();
+    const { orderId, orderData } = body;
 
-        const client = getYalidineClient();
+    if (!orderId || !orderData) {
+      return NextResponse.json(
+        { error: "orderId et orderData sont requis" },
+        { status: 400 },
+      );
+    }
 
-        // Convertir en format Yalidine
-        const parcel = orderToYalidineParcel({
-            id: orderId,
-            customerName: orderData.customerName,
-            customerPhone: orderData.customerPhone,
-            address: orderData.address,
-            wilaya: orderData.wilaya,
-            commune: orderData.commune,
-            total: orderData.total,
-            items: orderData.items || [],
-            deliveryType: orderData.deliveryType,
-            stopDeskId: orderData.stopDeskId,
-        }, orderData.fromWilaya || 'Alger');
+    const client = getYalidineClient();
 
-        // Créer le colis
-        const result = await client.createParcel(parcel);
+    // Convertir en format Yalidine
+    const parcel = orderToYalidineParcel(
+      {
+        id: orderId,
+        customerName: orderData.customerName,
+        customerPhone: orderData.customerPhone,
+        address: orderData.address,
+        wilaya: orderData.wilaya,
+        commune: orderData.commune,
+        total: orderData.total,
+        items: orderData.items || [],
+        deliveryType: orderData.deliveryType,
+        stopDeskId: orderData.stopDeskId,
+      },
+      orderData.fromWilaya || "Alger",
+    );
 
-        if (result.success) {
-            return NextResponse.json({
-                success: true,
-                tracking: result.tracking,
-                label: result.label,
-                labels: result.labels,
-                import_id: result.import_id
-            });
-        } else {
-            return NextResponse.json({
-                success: false,
-                error: result.message || 'Erreur de création'
-            }, { status: 400 });
-        }
+    // Créer le colis
+    const result = await client.createParcel(parcel);
 
-    } catch (error) {
-        return handleApiError(error);
+    if (result.success) {
+      return NextResponse.json({
+        success: true,
+        tracking: result.tracking,
+        label: result.label,
+        labels: result.labels,
+        import_id: result.import_id,
+      });
+    } else {
+      return NextResponse.json(
+        {
+          success: false,
+          error: result.message || "Erreur de création",
+        },
+        { status: 400 },
+      );
     }
+  } catch (error) {
+    return handleApiError(error);
+  }
 }
diff --git a/src/app/api/shipping/yalidine/track/route.ts b/src/app/api/shipping/yalidine/track/route.ts
index 1624ed3..799e988 100644
--- a/src/app/api/shipping/yalidine/track/route.ts
+++ b/src/app/api/shipping/yalidine/track/route.ts
@@ -4,60 +4,59 @@ import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
 
 // POST /api/shipping/yalidine/track - Suivre un ou plusieurs colis
 export async function POST(request: NextRequest) {
-    try {
-        await requireAdmin(request);
-        
-        const body = await request.json();
-        const { trackingNumbers } = body;
-
-        if (!trackingNumbers || !Array.isArray(trackingNumbers) || trackingNumbers.length === 0) {
-            return NextResponse.json(
-                { error: "trackingNumbers est requis (tableau)" },
-                { status: 400 }
-            );
-        }
-
-        const client = getYalidineClient();
-        
-        // Récupérer les infos de tracking
-        const result = await client.getParcels(trackingNumbers);
-
-        return NextResponse.json({
-            success: true,
-            data: result.data,
-            total: result.total_data
-        });
-
-    } catch (error) {
-        return handleApiError(error);
+  try {
+    await requireAdmin(request);
+
+    const body = await request.json();
+    const { trackingNumbers } = body;
+
+    if (
+      !trackingNumbers ||
+      !Array.isArray(trackingNumbers) ||
+      trackingNumbers.length === 0
+    ) {
+      return NextResponse.json(
+        { error: "trackingNumbers est requis (tableau)" },
+        { status: 400 },
+      );
     }
+
+    const client = getYalidineClient();
+
+    // Récupérer les infos de tracking
+    const result = await client.getParcels(trackingNumbers);
+
+    return NextResponse.json({
+      success: true,
+      data: result.data,
+      total: result.total_data,
+    });
+  } catch (error) {
+    return handleApiError(error);
+  }
 }
 
 // GET /api/shipping/yalidine/track?tracking=xxx - Historique d'un colis
 export async function GET(request: NextRequest) {
-    try {
-        await requireAdmin(request);
-        
-        const { searchParams } = new URL(request.url);
-        const tracking = searchParams.get('tracking');
-
-        if (!tracking) {
-            return NextResponse.json(
-                { error: "tracking requis" },
-                { status: 400 }
-            );
-        }
-
-        const client = getYalidineClient();
-        const history = await client.getHistory(tracking);
-
-        return NextResponse.json({
-            success: true,
-            tracking,
-            history: history.data
-        });
-
-    } catch (error) {
-        return handleApiError(error);
+  try {
+    await requireAdmin(request);
+
+    const { searchParams } = new URL(request.url);
+    const tracking = searchParams.get("tracking");
+
+    if (!tracking) {
+      return NextResponse.json({ error: "tracking requis" }, { status: 400 });
     }
+
+    const client = getYalidineClient();
+    const history = await client.getHistory(tracking);
+
+    return NextResponse.json({
+      success: true,
+      tracking,
+      history: history.data,
+    });
+  } catch (error) {
+    return handleApiError(error);
+  }
 }
diff --git a/src/app/api/tracking/route.ts b/src/app/api/tracking/route.ts
index 9f7b4fc..cfdb9b1 100644
--- a/src/app/api/tracking/route.ts
+++ b/src/app/api/tracking/route.ts
@@ -5,243 +5,279 @@ import { prisma } from "@/lib/prisma";
 
 // GET /api/tracking - Get tracking info for a package
 export async function GET(request: NextRequest) {
-    try {
-        const { searchParams } = new URL(request.url);
-        const tracking = searchParams.get('tracking');
-        const provider = searchParams.get('provider') || 'auto';
+  try {
+    const { searchParams } = new URL(request.url);
+    const tracking = searchParams.get("tracking");
+    const provider = searchParams.get("provider") || "auto";
 
-        if (!tracking) {
-            return NextResponse.json({ error: "Numéro de suivi requis" }, { status: 400 });
-        }
+    if (!tracking) {
+      return NextResponse.json(
+        { error: "Numéro de suivi requis" },
+        { status: 400 },
+      );
+    }
 
-        // Auto-detect provider from tracking format
-        let detectedProvider = provider;
-        if (provider === 'auto') {
-            if (tracking.toLowerCase().startsWith('yal-')) {
-                detectedProvider = 'yalidine';
-            } else if (tracking.toLowerCase().startsWith('zr')) {
-                detectedProvider = 'zrexpress';
-            } else {
-                // Try both
-                detectedProvider = 'both';
-            }
-        }
+    // Auto-detect provider from tracking format
+    let detectedProvider = provider;
+    if (provider === "auto") {
+      if (tracking.toLowerCase().startsWith("yal-")) {
+        detectedProvider = "yalidine";
+      } else if (tracking.toLowerCase().startsWith("zr")) {
+        detectedProvider = "zrexpress";
+      } else {
+        // Try both
+        detectedProvider = "both";
+      }
+    }
 
-        let result = null;
-
-        // Try Yalidine
-        if (detectedProvider === 'yalidine' || detectedProvider === 'both') {
-            try {
-                const yalidineClient = getYalidineClient();
-                const yalidineResult = await yalidineClient.getParcel(tracking);
-                
-                if (yalidineResult.data && yalidineResult.data.length > 0) {
-                    const parcel = yalidineResult.data[0];
-                    
-                    // Get tracking history
-                    let history: { status: string; date: string; location?: string; completed: boolean; current: boolean }[] = [];
-                    try {
-                        const historyResult = await yalidineClient.getTrackingHistory(tracking);
-                        if (historyResult.data) {
-                            history = historyResult.data.map((h: any, index: number, arr: any[]) => ({
-                                status: h.status,
-                                date: new Date(h.date).toLocaleString('fr-FR'),
-                                location: h.center_name || h.wilaya_name,
-                                completed: true,
-                                current: index === 0
-                            }));
-                        }
-                    } catch (e) {
-                        console.error('Error fetching Yalidine history:', e);
-                    }
-
-                    result = {
-                        found: true,
-                        provider: 'Yalidine',
-                        tracking: parcel.tracking,
-                        status: parcel.last_status || 'En cours',
-                        customerName: `${parcel.firstname} ${parcel.familyname}`,
-                        destination: `${parcel.to_commune_name}, ${parcel.to_wilaya_name}`,
-                        history: history.length > 0 ? history : [
-                            { status: parcel.last_status || 'En cours', date: 'Maintenant', completed: true, current: true }
-                        ]
-                    };
-                }
-            } catch (e) {
-                console.error('Yalidine tracking error:', e);
-            }
-        }
+    let result = null;
 
-        // Try ZR Express if not found
-        if (!result && (detectedProvider === 'zrexpress' || detectedProvider === 'both')) {
-            try {
-                const zrClient = getZRClient();
-                const zrResult = await zrClient.getTrackingInfo([tracking]);
-                
-                if (zrResult && zrResult.length > 0) {
-                    const parcel = zrResult[0];
-                    
-                    result = {
-                        found: true,
-                        provider: 'ZR Express',
-                        tracking: parcel.Tracking,
-                        status: parcel.Situation || 'En cours',
-                        customerName: parcel.Client,
-                        destination: `${parcel.Commune}, ${parcel.Wilaya}`,
-                        history: [
-                            { 
-                                status: parcel.Situation || 'En cours', 
-                                date: parcel.DateMAJ ? new Date(parcel.DateMAJ).toLocaleString('fr-FR') : 'Maintenant',
-                                completed: true, 
-                                current: true 
-                            },
-                            {
-                                status: 'Colis créé',
-                                date: parcel.DateCreation ? new Date(parcel.DateCreation).toLocaleString('fr-FR') : '',
-                                completed: true,
-                                current: false
-                            }
-                        ]
-                    };
-                }
-            } catch (e) {
-                console.error('ZR Express tracking error:', e);
-            }
-        }
+    // Try Yalidine
+    if (detectedProvider === "yalidine" || detectedProvider === "both") {
+      try {
+        const yalidineClient = getYalidineClient();
+        const yalidineResult = await yalidineClient.getParcel(tracking);
+
+        if (yalidineResult.data && yalidineResult.data.length > 0) {
+          const parcel = yalidineResult.data[0];
 
-        // If still not found, check local database
-        if (!result) {
-            const order = await prisma.order.findFirst({
-                where: { trackingNumber: tracking },
-                include: { items: true }
-            });
-
-            if (order) {
-                result = {
-                    found: true,
-                    provider: order.deliveryProvider || 'Inconnu',
-                    tracking: order.trackingNumber || tracking,
-                    status: order.trackingStatus || order.status,
-                    customerName: order.customerName,
-                    destination: `${order.customerCity}, Wilaya ${order.customerWilaya}`,
-                    history: [
-                        { 
-                            status: order.trackingStatus || order.status, 
-                            date: order.updatedAt.toLocaleString('fr-FR'),
-                            completed: true, 
-                            current: true 
-                        }
-                    ]
-                };
+          // Get tracking history
+          let history: {
+            status: string;
+            date: string;
+            location?: string;
+            completed: boolean;
+            current: boolean;
+          }[] = [];
+          try {
+            const historyResult =
+              await yalidineClient.getTrackingHistory(tracking);
+            if (historyResult.data) {
+              history = historyResult.data.map(
+                (h: any, index: number, arr: any[]) => ({
+                  status: h.status,
+                  date: new Date(h.date).toLocaleString("fr-FR"),
+                  location: h.center_name || h.wilaya_name,
+                  completed: true,
+                  current: index === 0,
+                }),
+              );
             }
+          } catch (e) {
+            console.error("Error fetching Yalidine history:", e);
+          }
+
+          result = {
+            found: true,
+            provider: "Yalidine",
+            tracking: parcel.tracking,
+            status: parcel.last_status || "En cours",
+            customerName: `${parcel.firstname} ${parcel.familyname}`,
+            destination: `${parcel.to_commune_name}, ${parcel.to_wilaya_name}`,
+            history:
+              history.length > 0
+                ? history
+                : [
+                    {
+                      status: parcel.last_status || "En cours",
+                      date: "Maintenant",
+                      completed: true,
+                      current: true,
+                    },
+                  ],
+          };
         }
+      } catch (e) {
+        console.error("Yalidine tracking error:", e);
+      }
+    }
 
-        if (result) {
-            return NextResponse.json(result);
+    // Try ZR Express if not found
+    if (
+      !result &&
+      (detectedProvider === "zrexpress" || detectedProvider === "both")
+    ) {
+      try {
+        const zrClient = getZRClient();
+        const zrResult = await zrClient.getTrackingInfo([tracking]);
+
+        if (zrResult && zrResult.length > 0) {
+          const parcel = zrResult[0];
+
+          result = {
+            found: true,
+            provider: "ZR Express",
+            tracking: parcel.Tracking,
+            status: parcel.Situation || "En cours",
+            customerName: parcel.Client,
+            destination: `${parcel.Commune}, ${parcel.Wilaya}`,
+            history: [
+              {
+                status: parcel.Situation || "En cours",
+                date: parcel.DateMAJ
+                  ? new Date(parcel.DateMAJ).toLocaleString("fr-FR")
+                  : "Maintenant",
+                completed: true,
+                current: true,
+              },
+              {
+                status: "Colis créé",
+                date: parcel.DateCreation
+                  ? new Date(parcel.DateCreation).toLocaleString("fr-FR")
+                  : "",
+                completed: true,
+                current: false,
+              },
+            ],
+          };
         }
+      } catch (e) {
+        console.error("ZR Express tracking error:", e);
+      }
+    }
+
+    // If still not found, check local database
+    if (!result) {
+      const order = await prisma.order.findFirst({
+        where: { trackingNumber: tracking },
+        include: { items: true },
+      });
 
-        return NextResponse.json({
-            found: false,
-            error: "Colis non trouvé. Vérifiez votre numéro de suivi."
-        });
-
-    } catch (error) {
-        console.error("Tracking API error:", error);
-        return NextResponse.json(
-            { error: "Erreur lors de la recherche du colis" },
-            { status: 500 }
-        );
+      if (order) {
+        result = {
+          found: true,
+          provider: order.deliveryProvider || "Inconnu",
+          tracking: order.trackingNumber || tracking,
+          status: order.trackingStatus || order.status,
+          customerName: order.customerName,
+          destination: `${order.customerCity}, Wilaya ${order.customerWilaya}`,
+          history: [
+            {
+              status: order.trackingStatus || order.status,
+              date: order.updatedAt.toLocaleString("fr-FR"),
+              completed: true,
+              current: true,
+            },
+          ],
+        };
+      }
     }
+
+    if (result) {
+      return NextResponse.json(result);
+    }
+
+    return NextResponse.json({
+      found: false,
+      error: "Colis non trouvé. Vérifiez votre numéro de suivi.",
+    });
+  } catch (error) {
+    console.error("Tracking API error:", error);
+    return NextResponse.json(
+      { error: "Erreur lors de la recherche du colis" },
+      { status: 500 },
+    );
+  }
 }
 
 // POST /api/tracking/sync - Sync tracking status for an order
 export async function POST(request: NextRequest) {
-    try {
-        const body = await request.json();
-        const { orderId } = body;
+  try {
+    const body = await request.json();
+    const { orderId } = body;
 
-        if (!orderId) {
-            return NextResponse.json({ error: "orderId requis" }, { status: 400 });
-        }
+    if (!orderId) {
+      return NextResponse.json({ error: "orderId requis" }, { status: 400 });
+    }
+
+    const order = await prisma.order.findUnique({
+      where: { id: orderId },
+    });
+
+    if (!order || !order.trackingNumber) {
+      return NextResponse.json(
+        { error: "Commande ou tracking non trouvé" },
+        { status: 404 },
+      );
+    }
 
-        const order = await prisma.order.findUnique({
-            where: { id: orderId }
-        });
+    let newStatus = order.trackingStatus;
+    let updated = false;
 
-        if (!order || !order.trackingNumber) {
-            return NextResponse.json({ error: "Commande ou tracking non trouvé" }, { status: 404 });
+    // Fetch from appropriate provider
+    if (order.deliveryProvider === "Yalidine") {
+      try {
+        const yalidineClient = getYalidineClient();
+        const result = await yalidineClient.getParcel(order.trackingNumber);
+
+        if (result.data && result.data.length > 0) {
+          newStatus = result.data[0].last_status;
+          updated = true;
         }
+      } catch (e) {
+        console.error("Yalidine sync error:", e);
+      }
+    } else if (order.deliveryProvider === "ZR Express") {
+      try {
+        const zrClient = getZRClient();
+        const result = await zrClient.getTrackingInfo([order.trackingNumber]);
 
-        let newStatus = order.trackingStatus;
-        let updated = false;
-
-        // Fetch from appropriate provider
-        if (order.deliveryProvider === 'Yalidine') {
-            try {
-                const yalidineClient = getYalidineClient();
-                const result = await yalidineClient.getParcel(order.trackingNumber);
-                
-                if (result.data && result.data.length > 0) {
-                    newStatus = result.data[0].last_status;
-                    updated = true;
-                }
-            } catch (e) {
-                console.error('Yalidine sync error:', e);
-            }
-        } else if (order.deliveryProvider === 'ZR Express') {
-            try {
-                const zrClient = getZRClient();
-                const result = await zrClient.getTrackingInfo([order.trackingNumber]);
-                
-                if (result && result.length > 0) {
-                    newStatus = result[0].Situation;
-                    updated = true;
-                }
-            } catch (e) {
-                console.error('ZR Express sync error:', e);
-            }
+        if (result && result.length > 0) {
+          newStatus = result[0].Situation;
+          updated = true;
         }
+      } catch (e) {
+        console.error("ZR Express sync error:", e);
+      }
+    }
 
-        if (updated && newStatus !== order.trackingStatus) {
-            // Map delivery status to order status
-            let orderStatus = order.status;
-            const statusLower = newStatus?.toLowerCase() || '';
-            
-            if (statusLower.includes('livré') || statusLower.includes('delivered')) {
-                orderStatus = 'DELIVERED';
-            } else if (statusLower.includes('retour') || statusLower.includes('échec') || statusLower.includes('annul')) {
-                orderStatus = 'CANCELLED';
-            } else if (statusLower.includes('expédié') || statusLower.includes('transit') || statusLower.includes('sorti')) {
-                orderStatus = 'SHIPPED';
-            }
+    if (updated && newStatus !== order.trackingStatus) {
+      // Map delivery status to order status
+      let orderStatus = order.status;
+      const statusLower = newStatus?.toLowerCase() || "";
 
-            await prisma.order.update({
-                where: { id: orderId },
-                data: {
-                    trackingStatus: newStatus,
-                    status: orderStatus
-                }
-            });
-
-            return NextResponse.json({
-                success: true,
-                previousStatus: order.trackingStatus,
-                newStatus: newStatus,
-                orderStatus: orderStatus
-            });
-        }
+      if (statusLower.includes("livré") || statusLower.includes("delivered")) {
+        orderStatus = "DELIVERED";
+      } else if (
+        statusLower.includes("retour") ||
+        statusLower.includes("échec") ||
+        statusLower.includes("annul")
+      ) {
+        orderStatus = "CANCELLED";
+      } else if (
+        statusLower.includes("expédié") ||
+        statusLower.includes("transit") ||
+        statusLower.includes("sorti")
+      ) {
+        orderStatus = "SHIPPED";
+      }
 
-        return NextResponse.json({
-            success: true,
-            status: newStatus,
-            message: "Aucun changement de statut"
-        });
-
-    } catch (error) {
-        console.error("Tracking sync error:", error);
-        return NextResponse.json(
-            { error: "Erreur lors de la synchronisation" },
-            { status: 500 }
-        );
+      await prisma.order.update({
+        where: { id: orderId },
+        data: {
+          trackingStatus: newStatus,
+          status: orderStatus,
+        },
+      });
+
+      return NextResponse.json({
+        success: true,
+        previousStatus: order.trackingStatus,
+        newStatus: newStatus,
+        orderStatus: orderStatus,
+      });
     }
+
+    return NextResponse.json({
+      success: true,
+      status: newStatus,
+      message: "Aucun changement de statut",
+    });
+  } catch (error) {
+    console.error("Tracking sync error:", error);
+    return NextResponse.json(
+      { error: "Erreur lors de la synchronisation" },
+      { status: 500 },
+    );
+  }
 }
diff --git a/src/app/api/upload/route.ts b/src/app/api/upload/route.ts
index 01089ec..c3dbe70 100644
--- a/src/app/api/upload/route.ts
+++ b/src/app/api/upload/route.ts
@@ -1,55 +1,54 @@
-import { NextResponse } from 'next/server';
-import { writeFile, mkdir } from 'fs/promises';
-import { existsSync } from 'fs';
-import path from 'path';
+import { NextResponse } from "next/server";
+import { writeFile, mkdir } from "fs/promises";
+import { existsSync } from "fs";
+import path from "path";
 
 export async function POST(request: Request) {
-    try {
-        const formData = await request.formData();
-        const file = formData.get('file') as File;
-
-        if (!file) {
-            return NextResponse.json({ error: 'No file provided' }, { status: 400 });
-        }
-
-        // Validate file type
-        const isVideo = file.type.startsWith('video/');
-        const isImage = file.type.startsWith('image/');
-        
-        if (!isVideo && !isImage) {
-            return NextResponse.json({ error: 'Invalid file type' }, { status: 400 });
-        }
-
-        // Create uploads directory if it doesn't exist
-        const uploadsDir = path.join(process.cwd(), 'public', 'uploads');
-        if (!existsSync(uploadsDir)) {
-            await mkdir(uploadsDir, { recursive: true });
-        }
-
-        // Generate unique filename
-        const timestamp = Date.now();
-        const randomString = Math.random().toString(36).substring(2, 8);
-        const extension = file.name.split('.').pop() || (isVideo ? 'mp4' : 'jpg');
-        const filename = `${timestamp}-${randomString}.${extension}`;
-        const filepath = path.join(uploadsDir, filename);
-
-        // Convert file to buffer and save
-        const bytes = await file.arrayBuffer();
-        const buffer = Buffer.from(bytes);
-        await writeFile(filepath, buffer);
-
-        // Return the public URL
-        const url = `/uploads/${filename}`;
-
-        return NextResponse.json({
-            url,
-            filename,
-            type: isVideo ? 'video' : 'image',
-            size: file.size
-        });
-
-    } catch (error) {
-        console.error('Upload error:', error);
-        return NextResponse.json({ error: 'Upload failed' }, { status: 500 });
+  try {
+    const formData = await request.formData();
+    const file = formData.get("file") as File;
+
+    if (!file) {
+      return NextResponse.json({ error: "No file provided" }, { status: 400 });
+    }
+
+    // Validate file type
+    const isVideo = file.type.startsWith("video/");
+    const isImage = file.type.startsWith("image/");
+
+    if (!isVideo && !isImage) {
+      return NextResponse.json({ error: "Invalid file type" }, { status: 400 });
     }
+
+    // Create uploads directory if it doesn't exist
+    const uploadsDir = path.join(process.cwd(), "public", "uploads");
+    if (!existsSync(uploadsDir)) {
+      await mkdir(uploadsDir, { recursive: true });
+    }
+
+    // Generate unique filename
+    const timestamp = Date.now();
+    const randomString = Math.random().toString(36).substring(2, 8);
+    const extension = file.name.split(".").pop() || (isVideo ? "mp4" : "jpg");
+    const filename = `${timestamp}-${randomString}.${extension}`;
+    const filepath = path.join(uploadsDir, filename);
+
+    // Convert file to buffer and save
+    const bytes = await file.arrayBuffer();
+    const buffer = Buffer.from(bytes);
+    await writeFile(filepath, buffer);
+
+    // Return the public URL
+    const url = `/uploads/${filename}`;
+
+    return NextResponse.json({
+      url,
+      filename,
+      type: isVideo ? "video" : "image",
+      size: file.size,
+    });
+  } catch (error) {
+    console.error("Upload error:", error);
+    return NextResponse.json({ error: "Upload failed" }, { status: 500 });
+  }
 }
diff --git a/src/app/api/v3/account/profile/route.ts b/src/app/api/v3/account/profile/route.ts
index 79ad97b..8c330a6 100644
--- a/src/app/api/v3/account/profile/route.ts
+++ b/src/app/api/v3/account/profile/route.ts
@@ -18,7 +18,7 @@ export async function GET(req: NextRequest) {
       where: { email: session.user.email },
       create: {
         email: session.user.email,
-        name: session.user.name || null
+        name: session.user.name || null,
       },
       update: {}, // No updates on GET
       select: {
@@ -29,14 +29,17 @@ export async function GET(req: NextRequest) {
         birthDate: true,
         loyaltyPoints: true,
         vipLevel: true,
-        createdAt: true
-      }
+        createdAt: true,
+      },
     });
 
     return NextResponse.json(user);
   } catch (error: any) {
     console.error("Profile GET error:", error);
-    return NextResponse.json({ error: "Internal Server Error" }, { status: 500 });
+    return NextResponse.json(
+      { error: "Internal Server Error" },
+      { status: 500 },
+    );
   }
 }
 
@@ -51,16 +54,16 @@ export async function PATCH(req: NextRequest) {
   try {
     const rawBody = await req.json();
     const parsed = UpdateProfileSchema.safeParse(rawBody);
-    
+
     if (!parsed.success) {
       return NextResponse.json(
         { error: parsed.error.issues[0]?.message || "Validation échouée" },
-        { status: 400 }
+        { status: 400 },
       );
     }
-    
+
     const body = parsed.data;
-    
+
     // Build update data
     const data: any = {};
     if (body.name !== undefined) data.name = body.name;
@@ -75,7 +78,7 @@ export async function PATCH(req: NextRequest) {
       create: {
         email: session.user.email,
         name: session.user.name || body.name || null,
-        ...data
+        ...data,
       },
       update: data,
       select: {
@@ -85,14 +88,17 @@ export async function PATCH(req: NextRequest) {
         phone: true,
         birthDate: true,
         loyaltyPoints: true,
-        vipLevel: true
-      }
+        vipLevel: true,
+      },
     });
 
     return NextResponse.json({ success: true, user: updated });
   } catch (error: any) {
     console.error("Profile PATCH error:", error);
-    
-    return NextResponse.json({ error: "Internal Server Error" }, { status: 500 });
+
+    return NextResponse.json(
+      { error: "Internal Server Error" },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/admin/birthday/route.ts b/src/app/api/v3/admin/birthday/route.ts
index 1074e3a..8a1aac3 100644
--- a/src/app/api/v3/admin/birthday/route.ts
+++ b/src/app/api/v3/admin/birthday/route.ts
@@ -1,20 +1,23 @@
 import { NextRequest, NextResponse } from "next/server";
 import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
-import { runDailyBirthdayGrant, LOYALTY_RULES } from "@/lib/loyalty/services/loyalty.service";
+import {
+  runDailyBirthdayGrant,
+  LOYALTY_RULES,
+} from "@/lib/loyalty/services/loyalty.service";
 
 // POST - Run birthday grant job manually (admin only)
 export async function POST(req: NextRequest) {
   try {
     await requireAdmin(req);
-    
+
     console.log("[Admin] Running birthday grant job...");
     const result = await runDailyBirthdayGrant();
-    
+
     return NextResponse.json({
       success: true,
       message: `Job terminé. ${result.processed} utilisateur(s) traité(s).`,
       pointsPerUser: LOYALTY_RULES.BIRTHDAY_BONUS,
-      ...result
+      ...result,
     });
   } catch (err: unknown) {
     return handleApiError(err);
@@ -25,12 +28,13 @@ export async function POST(req: NextRequest) {
 export async function GET(req: NextRequest) {
   try {
     await requireAdmin(req);
-    
+
     return NextResponse.json({
       birthdayBonus: LOYALTY_RULES.BIRTHDAY_BONUS,
-      description: "Points attribués automatiquement le jour de l'anniversaire de chaque utilisateur",
+      description:
+        "Points attribués automatiquement le jour de l'anniversaire de chaque utilisateur",
       endpoint: "/api/v3/admin/birthday",
-      method: "POST to run manually"
+      method: "POST to run manually",
     });
   } catch (err: unknown) {
     return handleApiError(err);
diff --git a/src/app/api/v3/auth/auto-create/route.ts b/src/app/api/v3/auth/auto-create/route.ts
index 99c76f9..e8638c7 100644
--- a/src/app/api/v3/auth/auto-create/route.ts
+++ b/src/app/api/v3/auth/auto-create/route.ts
@@ -1,6 +1,9 @@
 import { NextRequest, NextResponse } from "next/server";
 import { z } from "zod";
-import { createOrGetUserByEmail, issueMagicLink } from "@/lib/auth/auto-email.service";
+import {
+  createOrGetUserByEmail,
+  issueMagicLink,
+} from "@/lib/auth/auto-email.service";
 import { checkRateLimit } from "@/lib/rate-limit";
 import { handleApiError } from "@/lib/auth-helpers";
 
@@ -15,21 +18,27 @@ export async function POST(req: NextRequest) {
     const ip = req.headers.get("x-forwarded-for") || "unknown";
     // Rate limit: 5 requests per hour per IP
     if (!checkRateLimit(`magic-link-${ip}`, 5, 60 * 60 * 1000)) {
-        return NextResponse.json({ 
-            success: false,
-            error: "Trop de demandes. Veuillez réessayer plus tard." 
-        }, { status: 429 });
+      return NextResponse.json(
+        {
+          success: false,
+          error: "Trop de demandes. Veuillez réessayer plus tard.",
+        },
+        { status: 429 },
+      );
     }
 
     const body = await req.json();
     const validation = schema.safeParse(body);
-    
+
     if (!validation.success) {
-        return NextResponse.json({ 
-            success: false, 
-            error: "Données invalides",
-            details: validation.error.errors 
-        }, { status: 400 });
+      return NextResponse.json(
+        {
+          success: false,
+          error: "Données invalides",
+          details: validation.error.errors,
+        },
+        { status: 400 },
+      );
     }
 
     const { email, name, guestKey } = validation.data;
@@ -40,10 +49,10 @@ export async function POST(req: NextRequest) {
     // 2. Issue link
     const result = await issueMagicLink(email, "login", guestKey);
 
-    return NextResponse.json({ 
-        success: true, 
-        message: "Lien de connexion envoyé par email.", 
-        expiresAt: result.expiresAt 
+    return NextResponse.json({
+      success: true,
+      message: "Lien de connexion envoyé par email.",
+      expiresAt: result.expiresAt,
     });
   } catch (err) {
     console.error("Auto-Auth Error:", err);
diff --git a/src/app/api/v3/auth/magic-link/verify/route.ts b/src/app/api/v3/auth/magic-link/verify/route.ts
index cae0788..4eedf6e 100644
--- a/src/app/api/v3/auth/magic-link/verify/route.ts
+++ b/src/app/api/v3/auth/magic-link/verify/route.ts
@@ -8,24 +8,27 @@ export async function POST(req: NextRequest) {
     const { token } = body;
 
     if (!token) {
-      return NextResponse.json({ 
-          success: false, 
-          error: "Token manquant" 
-      }, { status: 400 });
+      return NextResponse.json(
+        {
+          success: false,
+          error: "Token manquant",
+        },
+        { status: 400 },
+      );
     }
 
     const result = await verifyMagicLink(token);
-    
+
     // In a full NextAuth setup, we might normally use the NextAuth `signIn` flow.
     // Here we verify manually. We return the user.
     // The frontend can use this response to set a context or redirect.
-    
-    return NextResponse.json({ 
-        success: true, 
-        user: result.user,
-        isNewUser: result.isNewUser,
-        guestKey: result.guestKey,
-        message: "Connexion réussie"
+
+    return NextResponse.json({
+      success: true,
+      user: result.user,
+      isNewUser: result.isNewUser,
+      guestKey: result.guestKey,
+      message: "Connexion réussie",
     });
   } catch (err) {
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/advances/[id]/apply/route.ts b/src/app/api/v3/compta/advances/[id]/apply/route.ts
index 0bbbcc8..d1fa142 100644
--- a/src/app/api/v3/compta/advances/[id]/apply/route.ts
+++ b/src/app/api/v3/compta/advances/[id]/apply/route.ts
@@ -10,7 +10,7 @@ const ApplySchema = z.object({
 
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -22,7 +22,7 @@ export async function POST(
     if (!advance) {
       return NextResponse.json(
         { success: false, error: "Avance non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
@@ -32,7 +32,7 @@ export async function POST(
           success: false,
           error: `Solde insuffisant: ${advance.amountRemaining} disponible, ${data.amount} demandé`,
         },
-        { status: 422 }
+        { status: 422 },
       );
     }
 
@@ -42,14 +42,17 @@ export async function POST(
     if (!purchase) {
       return NextResponse.json(
         { success: false, error: "Achat non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (purchase.supplierId !== advance.supplierId) {
       return NextResponse.json(
-        { success: false, error: "L'avance et l'achat doivent appartenir au même fournisseur" },
-        { status: 422 }
+        {
+          success: false,
+          error: "L'avance et l'achat doivent appartenir au même fournisseur",
+        },
+        { status: 422 },
       );
     }
 
@@ -59,7 +62,7 @@ export async function POST(
           success: false,
           error: `Montant dû insuffisant: ${purchase.amountDue} restant à payer`,
         },
-        { status: 422 }
+        { status: 422 },
       );
     }
 
@@ -115,10 +118,13 @@ export async function POST(
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/compta/advances/[id]/route.ts b/src/app/api/v3/compta/advances/[id]/route.ts
index 11ef5ea..d1335a9 100644
--- a/src/app/api/v3/compta/advances/[id]/route.ts
+++ b/src/app/api/v3/compta/advances/[id]/route.ts
@@ -4,7 +4,7 @@ import { requireAdmin } from "@/lib/auth-helpers";
 
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -16,7 +16,9 @@ export async function GET(
         supplier: true,
         applications: {
           include: {
-            purchase: { select: { id: true, purchaseNumber: true, totalAmount: true } },
+            purchase: {
+              select: { id: true, purchaseNumber: true, totalAmount: true },
+            },
           },
         },
       },
@@ -25,20 +27,23 @@ export async function GET(
     if (!advance) {
       return NextResponse.json(
         { success: false, error: "Avance non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     return NextResponse.json({ success: true, advance });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -48,14 +53,17 @@ export async function DELETE(
     if (!advance) {
       return NextResponse.json(
         { success: false, error: "Avance non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (Number(advance.amountUsed) > 0) {
       return NextResponse.json(
-        { success: false, error: "Impossible de supprimer une avance déjà utilisée" },
-        { status: 422 }
+        {
+          success: false,
+          error: "Impossible de supprimer une avance déjà utilisée",
+        },
+        { status: 422 },
       );
     }
 
@@ -64,6 +72,9 @@ export async function DELETE(
     return NextResponse.json({ success: true });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/compta/advances/route.ts b/src/app/api/v3/compta/advances/route.ts
index c9340c7..6754e95 100644
--- a/src/app/api/v3/compta/advances/route.ts
+++ b/src/app/api/v3/compta/advances/route.ts
@@ -66,7 +66,8 @@ export async function GET(req: NextRequest) {
       stats: {
         totalAdvances: stats._sum.amount || 0,
         totalUsed: stats._sum.amountUsed || 0,
-        totalRemaining: Number(stats._sum.amount || 0) - Number(stats._sum.amountUsed || 0),
+        totalRemaining:
+          Number(stats._sum.amount || 0) - Number(stats._sum.amountUsed || 0),
       },
     });
   } catch (err) {
@@ -103,7 +104,7 @@ export async function POST(req: NextRequest) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/charges/[id]/route.ts b/src/app/api/v3/compta/charges/[id]/route.ts
index 3f5c6b5..e684bfe 100644
--- a/src/app/api/v3/compta/charges/[id]/route.ts
+++ b/src/app/api/v3/compta/charges/[id]/route.ts
@@ -27,7 +27,7 @@ const ChargeUpdateSchema = z.object({
 
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -41,20 +41,23 @@ export async function GET(
     if (!charge) {
       return NextResponse.json(
         { success: false, error: "Charge non trouvée" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     return NextResponse.json({ success: true, charge });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -73,17 +76,20 @@ export async function PUT(
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -94,6 +100,9 @@ export async function DELETE(
     return NextResponse.json({ success: true });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/compta/charges/route.ts b/src/app/api/v3/compta/charges/route.ts
index 7673928..e22a097 100644
--- a/src/app/api/v3/compta/charges/route.ts
+++ b/src/app/api/v3/compta/charges/route.ts
@@ -83,13 +83,13 @@ export async function POST(req: NextRequest) {
     if (data.scope === "MODEL" && !data.modelId) {
       return NextResponse.json(
         { success: false, error: "modelId requis pour scope MODEL" },
-        { status: 400 }
+        { status: 400 },
       );
     }
     if (data.scope === "COLLECTION" && !data.collectionId) {
       return NextResponse.json(
         { success: false, error: "collectionId requis pour scope COLLECTION" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -129,7 +129,7 @@ export async function POST(req: NextRequest) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/clients/export/route.ts b/src/app/api/v3/compta/clients/export/route.ts
index b7ccb0b..8755467 100644
--- a/src/app/api/v3/compta/clients/export/route.ts
+++ b/src/app/api/v3/compta/clients/export/route.ts
@@ -17,10 +17,15 @@ export async function GET(req: NextRequest) {
     const lastExport = exportRateLimit.get(adminEmail);
     const now = Date.now();
     if (lastExport && now - lastExport < RATE_LIMIT_MS) {
-      const waitSeconds = Math.ceil((RATE_LIMIT_MS - (now - lastExport)) / 1000);
+      const waitSeconds = Math.ceil(
+        (RATE_LIMIT_MS - (now - lastExport)) / 1000,
+      );
       return NextResponse.json(
-        { success: false, error: `Veuillez attendre ${waitSeconds}s avant un nouvel export` },
-        { status: 429 }
+        {
+          success: false,
+          error: `Veuillez attendre ${waitSeconds}s avant un nouvel export`,
+        },
+        { status: 429 },
       );
     }
     exportRateLimit.set(adminEmail, now);
@@ -35,7 +40,7 @@ export async function GET(req: NextRequest) {
       where.OR = [
         { email: { contains: q.search } },
         { name: { contains: q.search } },
-        { phone: { contains: q.search } }
+        { phone: { contains: q.search } },
       ];
     }
     if (q.vipLevel && q.vipLevel !== "ALL") {
@@ -57,9 +62,9 @@ export async function GET(req: NextRequest) {
         vipLevel: true,
         isEmailVerified: true,
         _count: {
-          select: { orders: true }
-        }
-      }
+          select: { orders: true },
+        },
+      },
     });
 
     // Log export for audit
@@ -73,13 +78,13 @@ export async function GET(req: NextRequest) {
           format: q.format,
           filters: { vipLevel: q.vipLevel, search: q.search },
           count: users.length,
-          timestamp: new Date().toISOString()
-        })
-      }
+          timestamp: new Date().toISOString(),
+        }),
+      },
     });
 
     // Transform data
-    const exportData = users.map(u => ({
+    const exportData = users.map((u) => ({
       id: u.id,
       email: u.email,
       name: u.name || "",
@@ -88,7 +93,7 @@ export async function GET(req: NextRequest) {
       loyaltyPoints: u.loyaltyPoints,
       vipLevel: u.vipLevel,
       isVerified: u.isEmailVerified ? "Oui" : "Non",
-      orderCount: u._count.orders
+      orderCount: u._count.orders,
     }));
 
     if (q.format === "json") {
@@ -96,7 +101,7 @@ export async function GET(req: NextRequest) {
         success: true,
         exportedAt: new Date().toISOString(),
         count: exportData.length,
-        items: exportData
+        items: exportData,
       });
     }
 
@@ -110,7 +115,7 @@ export async function GET(req: NextRequest) {
       { label: "Points fidélité", value: "loyaltyPoints" },
       { label: "Niveau VIP", value: "vipLevel" },
       { label: "Email vérifié", value: "isVerified" },
-      { label: "Nb commandes", value: "orderCount" }
+      { label: "Nb commandes", value: "orderCount" },
     ]);
 
     const filename = `harp_clients_${new Date().toISOString().slice(0, 10)}.csv`;
@@ -119,8 +124,8 @@ export async function GET(req: NextRequest) {
       status: 200,
       headers: {
         "Content-Type": "text/csv; charset=utf-8",
-        "Content-Disposition": `attachment; filename="${filename}"`
-      }
+        "Content-Disposition": `attachment; filename="${filename}"`,
+      },
     });
   } catch (err: unknown) {
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/clients/route.ts b/src/app/api/v3/compta/clients/route.ts
index 95e21b7..0c28f51 100644
--- a/src/app/api/v3/compta/clients/route.ts
+++ b/src/app/api/v3/compta/clients/route.ts
@@ -13,21 +13,21 @@ export async function GET(req: NextRequest) {
 
     // Build where clause
     const where: any = {};
-    
+
     if (q.search) {
       where.OR = [
         { email: { contains: q.search } },
         { name: { contains: q.search } },
-        { phone: { contains: q.search } }
+        { phone: { contains: q.search } },
       ];
     }
-    
+
     if (q.vipLevel && q.vipLevel !== "ALL") {
       where.vipLevel = q.vipLevel;
     }
 
     const skip = (q.page - 1) * q.pageSize;
-    
+
     const [items, total] = await prisma.$transaction([
       prisma.user.findMany({
         where,
@@ -57,10 +57,10 @@ export async function GET(req: NextRequest) {
               createdAt: true,
               customerWilaya: true,
               customerCity: true,
-              customerAddress: true
+              customerAddress: true,
             },
             orderBy: { createdAt: "desc" },
-            take: 10
+            take: 10,
           },
           wishlist: {
             select: {
@@ -69,35 +69,35 @@ export async function GET(req: NextRequest) {
               product: {
                 select: {
                   nameFr: true,
-                  price: true
-                }
-              }
-            }
+                  price: true,
+                },
+              },
+            },
           },
           pointHistory: {
             select: {
               id: true,
               amount: true,
               reason: true,
-              createdAt: true
+              createdAt: true,
             },
             orderBy: { createdAt: "desc" },
-            take: 10
+            take: 10,
           },
           _count: {
             select: {
               orders: true,
               wishlist: true,
-              pointHistory: true
-            }
-          }
-        }
+              pointHistory: true,
+            },
+          },
+        },
       }),
-      prisma.user.count({ where })
+      prisma.user.count({ where }),
     ]);
 
     // Transform items with complete data
-    const transformedItems = items.map(item => {
+    const transformedItems = items.map((item) => {
       // Calculate total spent
       const totalSpent = item.orders.reduce((sum, order) => {
         return sum + Number(order.total);
@@ -107,11 +107,13 @@ export async function GET(req: NextRequest) {
       const lastOrder = item.orders[0] || null;
 
       // Get address from last order
-      const lastAddress = lastOrder ? {
-        wilaya: lastOrder.customerWilaya,
-        city: lastOrder.customerCity,
-        address: lastOrder.customerAddress
-      } : null;
+      const lastAddress = lastOrder
+        ? {
+            wilaya: lastOrder.customerWilaya,
+            city: lastOrder.customerCity,
+            address: lastOrder.customerAddress,
+          }
+        : null;
 
       return {
         id: item.id,
@@ -137,7 +139,7 @@ export async function GET(req: NextRequest) {
         // Related data
         recentOrders: item.orders,
         wishlist: item.wishlist,
-        pointHistory: item.pointHistory
+        pointHistory: item.pointHistory,
       };
     });
 
@@ -148,8 +150,8 @@ export async function GET(req: NextRequest) {
         page: q.page,
         pageSize: q.pageSize,
         total,
-        totalPages: Math.ceil(total / q.pageSize)
-      }
+        totalPages: Math.ceil(total / q.pageSize),
+      },
     });
   } catch (err: unknown) {
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/inventory/[id]/route.ts b/src/app/api/v3/compta/inventory/[id]/route.ts
index 206145a..43f08cb 100644
--- a/src/app/api/v3/compta/inventory/[id]/route.ts
+++ b/src/app/api/v3/compta/inventory/[id]/route.ts
@@ -5,15 +5,17 @@
  * DELETE /api/v3/compta/inventory/[id] - Soft delete item
  */
 
-import { NextRequest, NextResponse } from 'next/server';
-import { prisma } from '@/lib/prisma';
-import { requireAdmin, handleApiError } from '@/lib/auth-helpers';
-import { z } from 'zod';
-import { getInventoryDetail } from '@/lib/compta/services/inventory-service';
+import { NextRequest, NextResponse } from "next/server";
+import { prisma } from "@/lib/prisma";
+import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
+import { z } from "zod";
+import { getInventoryDetail } from "@/lib/compta/services/inventory-service";
 
 const InventoryUpdateSchema = z.object({
   name: z.string().min(1).optional(),
-  type: z.enum(["FABRIC", "ACCESSORY", "PACKAGING", "FINISHED", "TRIM", "LABEL"]).optional(),
+  type: z
+    .enum(["FABRIC", "ACCESSORY", "PACKAGING", "FINISHED", "TRIM", "LABEL"])
+    .optional(),
   unit: z.enum(["METER", "ROLL", "PIECE", "KG", "LITER", "SET"]).optional(),
   minStock: z.number().min(0).optional(),
   location: z.string().optional(),
@@ -22,7 +24,7 @@ const InventoryUpdateSchema = z.object({
 
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -32,8 +34,8 @@ export async function GET(
 
     if (!item) {
       return NextResponse.json(
-        { success: false, error: 'Article non trouvé' },
-        { status: 404 }
+        { success: false, error: "Article non trouvé" },
+        { status: 404 },
       );
     }
 
@@ -45,7 +47,7 @@ export async function GET(
 
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -56,8 +58,8 @@ export async function PUT(
     const existing = await prisma.inventoryItem.findUnique({ where: { id } });
     if (!existing) {
       return NextResponse.json(
-        { success: false, error: 'Article non trouvé' },
-        { status: 404 }
+        { success: false, error: "Article non trouvé" },
+        { status: 404 },
       );
     }
 
@@ -70,8 +72,12 @@ export async function PUT(
   } catch (err) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
-        { success: false, error: 'Validation échouée', details: err.flatten().fieldErrors },
-        { status: 400 }
+        {
+          success: false,
+          error: "Validation échouée",
+          details: err.flatten().fieldErrors,
+        },
+        { status: 400 },
       );
     }
     return handleApiError(err);
@@ -80,7 +86,7 @@ export async function PUT(
 
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -89,15 +95,18 @@ export async function DELETE(
     const item = await prisma.inventoryItem.findUnique({ where: { id } });
     if (!item) {
       return NextResponse.json(
-        { success: false, error: 'Article non trouvé' },
-        { status: 404 }
+        { success: false, error: "Article non trouvé" },
+        { status: 404 },
       );
     }
 
     if (Number(item.quantity) > 0) {
       return NextResponse.json(
-        { success: false, error: 'Impossible de supprimer un article avec du stock' },
-        { status: 422 }
+        {
+          success: false,
+          error: "Impossible de supprimer un article avec du stock",
+        },
+        { status: 422 },
       );
     }
 
@@ -107,7 +116,7 @@ export async function DELETE(
       data: { isActive: false },
     });
 
-    return NextResponse.json({ success: true, message: 'Article désactivé' });
+    return NextResponse.json({ success: true, message: "Article désactivé" });
   } catch (err) {
     return handleApiError(err);
   }
diff --git a/src/app/api/v3/compta/inventory/adjustment/route.ts b/src/app/api/v3/compta/inventory/adjustment/route.ts
index af5a1e7..0292424 100644
--- a/src/app/api/v3/compta/inventory/adjustment/route.ts
+++ b/src/app/api/v3/compta/inventory/adjustment/route.ts
@@ -3,11 +3,11 @@
  * POST /api/v3/compta/inventory/adjustment - Apply inventory adjustment
  */
 
-import { NextRequest, NextResponse } from 'next/server';
-import { requireAdmin, handleApiError } from '@/lib/auth-helpers';
-import { z } from 'zod';
-import { InventoryAdjustmentSchema } from '@/lib/compta/schemas/purchase.schemas';
-import { applyAdjustment } from '@/lib/compta/services/inventory-service';
+import { NextRequest, NextResponse } from "next/server";
+import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
+import { z } from "zod";
+import { InventoryAdjustmentSchema } from "@/lib/compta/schemas/purchase.schemas";
+import { applyAdjustment } from "@/lib/compta/services/inventory-service";
 
 /**
  * POST /api/v3/compta/inventory/adjustment
@@ -34,18 +34,23 @@ export async function POST(req: NextRequest) {
   } catch (err) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
-        { success: false, error: 'Validation échouée', details: err.flatten().fieldErrors },
-        { status: 400 }
+        {
+          success: false,
+          error: "Validation échouée",
+          details: err.flatten().fieldErrors,
+        },
+        { status: 400 },
       );
     }
     // Handle business logic errors
-    if (err instanceof Error && (
-      err.message.includes('non trouvé') ||
-      err.message.includes('insuffisant')
-    )) {
+    if (
+      err instanceof Error &&
+      (err.message.includes("non trouvé") ||
+        err.message.includes("insuffisant"))
+    ) {
       return NextResponse.json(
         { success: false, error: err.message },
-        { status: 422 }
+        { status: 422 },
       );
     }
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/inventory/reconcile/route.ts b/src/app/api/v3/compta/inventory/reconcile/route.ts
index a8bd1f6..8cff2d0 100644
--- a/src/app/api/v3/compta/inventory/reconcile/route.ts
+++ b/src/app/api/v3/compta/inventory/reconcile/route.ts
@@ -3,10 +3,10 @@
  * GET /api/v3/compta/inventory/reconcile - Run reconciliation or list results
  */
 
-import { NextRequest, NextResponse } from 'next/server';
-import { prisma } from '@/lib/prisma';
-import { requireAdmin, handleApiError } from '@/lib/auth-helpers';
-import { reconcileInventory } from '@/lib/compta/services/inventory-service';
+import { NextRequest, NextResponse } from "next/server";
+import { prisma } from "@/lib/prisma";
+import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
+import { reconcileInventory } from "@/lib/compta/services/inventory-service";
 
 /**
  * GET /api/v3/compta/inventory/reconcile
@@ -20,21 +20,26 @@ export async function GET(req: NextRequest) {
     const mismatches = await reconcileInventory();
 
     // Calculate stats
-    const totalItems = await prisma.inventoryItem.count({ where: { isActive: true } });
+    const totalItems = await prisma.inventoryItem.count({
+      where: { isActive: true },
+    });
     const stats = {
       totalItems,
       matched: totalItems - mismatches.length,
       mismatched: mismatches.length,
-      criticalMismatches: mismatches.filter((m) => Math.abs(m.variancePercent) > 10).length,
+      criticalMismatches: mismatches.filter(
+        (m) => Math.abs(m.variancePercent) > 10,
+      ).length,
     };
 
     return NextResponse.json({
       success: true,
       mismatches,
       stats,
-      message: mismatches.length === 0
-        ? 'Tous les articles sont réconciliés'
-        : `${mismatches.length} écart(s) détecté(s)`,
+      message:
+        mismatches.length === 0
+          ? "Tous les articles sont réconciliés"
+          : `${mismatches.length} écart(s) détecté(s)`,
     });
   } catch (err) {
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/inventory/route.ts b/src/app/api/v3/compta/inventory/route.ts
index bdf2ed9..25e33ec 100644
--- a/src/app/api/v3/compta/inventory/route.ts
+++ b/src/app/api/v3/compta/inventory/route.ts
@@ -4,19 +4,19 @@
  * POST /api/v3/compta/inventory - Create new inventory item
  */
 
-import { NextRequest, NextResponse } from 'next/server';
-import { requireAdmin, handleApiError } from '@/lib/auth-helpers';
-import { z } from 'zod';
-import { prisma } from '@/lib/prisma';
+import { NextRequest, NextResponse } from "next/server";
+import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
+import { z } from "zod";
+import { prisma } from "@/lib/prisma";
 import {
   InventoryItemCreateSchema,
   PaginationSchema,
   InventoryFilterSchema,
-} from '@/lib/compta/schemas/purchase.schemas';
+} from "@/lib/compta/schemas/purchase.schemas";
 import {
   getInventoryList,
   createInventoryItem,
-} from '@/lib/compta/services/inventory-service';
+} from "@/lib/compta/services/inventory-service";
 
 /**
  * GET /api/v3/compta/inventory
@@ -30,16 +30,16 @@ export async function GET(req: NextRequest) {
 
     // Parse pagination
     const pagination = PaginationSchema.parse({
-      page: searchParams.get('page') ?? 1,
-      pageSize: searchParams.get('pageSize') ?? searchParams.get('limit') ?? 20,
+      page: searchParams.get("page") ?? 1,
+      pageSize: searchParams.get("pageSize") ?? searchParams.get("limit") ?? 20,
     });
 
     // Parse filters
     const filters = InventoryFilterSchema.parse({
-      type: searchParams.get('type') ?? undefined,
-      lowStock: searchParams.get('lowStock') ?? undefined,
-      search: searchParams.get('search') ?? undefined,
-      isActive: searchParams.get('isActive') ?? undefined,
+      type: searchParams.get("type") ?? undefined,
+      lowStock: searchParams.get("lowStock") ?? undefined,
+      search: searchParams.get("search") ?? undefined,
+      isActive: searchParams.get("isActive") ?? undefined,
     });
 
     const result = await getInventoryList(pagination, filters);
@@ -63,8 +63,12 @@ export async function GET(req: NextRequest) {
   } catch (err) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
-        { success: false, error: 'Paramètres invalides', details: err.flatten().fieldErrors },
-        { status: 400 }
+        {
+          success: false,
+          error: "Paramètres invalides",
+          details: err.flatten().fieldErrors,
+        },
+        { status: 400 },
       );
     }
     return handleApiError(err);
@@ -84,22 +88,23 @@ export async function POST(req: NextRequest) {
 
     const item = await createInventoryItem(data);
 
-    return NextResponse.json(
-      { success: true, item },
-      { status: 201 }
-    );
+    return NextResponse.json({ success: true, item }, { status: 201 });
   } catch (err) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
-        { success: false, error: 'Validation échouée', details: err.flatten().fieldErrors },
-        { status: 400 }
+        {
+          success: false,
+          error: "Validation échouée",
+          details: err.flatten().fieldErrors,
+        },
+        { status: 400 },
       );
     }
     // Handle duplicate SKU error
-    if (err instanceof Error && err.message.includes('existe déjà')) {
+    if (err instanceof Error && err.message.includes("existe déjà")) {
       return NextResponse.json(
         { success: false, error: err.message },
-        { status: 409 }
+        { status: 409 },
       );
     }
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/models/[id]/bom/route.ts b/src/app/api/v3/compta/models/[id]/bom/route.ts
index 9396d9d..3c302af 100644
--- a/src/app/api/v3/compta/models/[id]/bom/route.ts
+++ b/src/app/api/v3/compta/models/[id]/bom/route.ts
@@ -13,7 +13,7 @@ const BomItemSchema = z.object({
 // GET: List BOM items for model
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -32,14 +32,17 @@ export async function GET(
     if (!model) {
       return NextResponse.json(
         { success: false, error: "Modèle non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     // Calculate total BOM cost
     let totalCost = 0;
     const bomWithCosts = model.bom.map((item) => {
-      const cost = Number(item.quantity) * Number(item.wasteFactor) * Number(item.inventoryItem.averageCost);
+      const cost =
+        Number(item.quantity) *
+        Number(item.wasteFactor) *
+        Number(item.inventoryItem.averageCost);
       totalCost += cost;
       return {
         ...item,
@@ -57,14 +60,17 @@ export async function GET(
     });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 // POST: Add item to BOM
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -77,7 +83,7 @@ export async function POST(
     if (!model) {
       return NextResponse.json(
         { success: false, error: "Modèle non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
@@ -88,7 +94,7 @@ export async function POST(
     if (!invItem) {
       return NextResponse.json(
         { success: false, error: "Article inventaire non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
@@ -99,7 +105,7 @@ export async function POST(
     if (existing) {
       return NextResponse.json(
         { success: false, error: "Cet article est déjà dans la nomenclature" },
-        { status: 409 }
+        { status: 409 },
       );
     }
 
@@ -119,11 +125,14 @@ export async function POST(
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
@@ -137,7 +146,7 @@ export async function DELETE(req: NextRequest) {
     if (!bomItemId) {
       return NextResponse.json(
         { success: false, error: "bomItemId requis" },
-        { status: 400 }
+        { status: 400 },
       );
     }
 
@@ -146,6 +155,9 @@ export async function DELETE(req: NextRequest) {
     return NextResponse.json({ success: true });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/compta/models/[id]/costs/route.ts b/src/app/api/v3/compta/models/[id]/costs/route.ts
index 8d4e7ca..35db319 100644
--- a/src/app/api/v3/compta/models/[id]/costs/route.ts
+++ b/src/app/api/v3/compta/models/[id]/costs/route.ts
@@ -5,7 +5,7 @@ import { requireAdmin } from "@/lib/auth-helpers";
 // GET: Calculate cost breakdown
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -23,7 +23,7 @@ export async function GET(
     if (!model) {
       return NextResponse.json(
         { success: false, error: "Modèle non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
@@ -33,7 +33,10 @@ export async function GET(
     let packagingCost = 0;
 
     for (const bom of model.bom) {
-      const cost = Number(bom.quantity) * Number(bom.wasteFactor) * Number(bom.inventoryItem.averageCost);
+      const cost =
+        Number(bom.quantity) *
+        Number(bom.wasteFactor) *
+        Number(bom.inventoryItem.averageCost);
       switch (bom.inventoryItem.type) {
         case "FABRIC":
           fabricCost += cost;
@@ -55,7 +58,8 @@ export async function GET(
     const atelierCharges = model.charges
       .filter((c) => c.category === "ATELIER")
       .reduce((sum, c) => sum + Number(c.amount), 0);
-    const atelierCost = model.estimatedUnits > 0 ? atelierCharges / model.estimatedUnits : 0;
+    const atelierCost =
+      model.estimatedUnits > 0 ? atelierCharges / model.estimatedUnits : 0;
     const productionCost = laborCost + atelierCost;
 
     // 3. Marketing costs
@@ -77,7 +81,13 @@ export async function GET(
     const returnMargin = Number(model.returnMargin) || 0;
 
     // 5. Total
-    const totalCost = materialsCost + productionCost + marketingCost + transportCost + otherCost + returnMargin;
+    const totalCost =
+      materialsCost +
+      productionCost +
+      marketingCost +
+      transportCost +
+      otherCost +
+      returnMargin;
 
     // 6. Suggested prices
     const round = (n: number) => Math.round(n * 100) / 100;
@@ -90,9 +100,10 @@ export async function GET(
     // 7. Current margin
     const currentPrice = model.sellingPrice ? Number(model.sellingPrice) : null;
     const currentMargin = currentPrice ? currentPrice - totalCost : null;
-    const currentMarginPercent = currentPrice && currentPrice > 0
-      ? round((currentMargin! / currentPrice) * 100)
-      : null;
+    const currentMarginPercent =
+      currentPrice && currentPrice > 0
+        ? round((currentMargin! / currentPrice) * 100)
+        : null;
 
     const breakdown = {
       fabricCost: round(fabricCost),
@@ -123,14 +134,17 @@ export async function GET(
     });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 // POST: Create cost snapshot
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -167,7 +181,8 @@ export async function POST(
         laborCost: costData.breakdown.laborCost,
         atelierCost: costData.breakdown.atelierCost,
         marketingCost: costData.breakdown.marketingCost,
-        otherCost: costData.breakdown.otherCost + costData.breakdown.transportCost,
+        otherCost:
+          costData.breakdown.otherCost + costData.breakdown.transportCost,
         totalCost: costData.breakdown.totalCost,
         sellingPrice: costData.currentPrice,
         margin: costData.currentMargin,
@@ -178,6 +193,9 @@ export async function POST(
     return NextResponse.json({ success: true, snapshot }, { status: 201 });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/compta/models/[id]/route.ts b/src/app/api/v3/compta/models/[id]/route.ts
index 5ca9a31..bec943a 100644
--- a/src/app/api/v3/compta/models/[id]/route.ts
+++ b/src/app/api/v3/compta/models/[id]/route.ts
@@ -15,7 +15,7 @@ const ModelUpdateSchema = z.object({
 
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -38,20 +38,23 @@ export async function GET(
     if (!model) {
       return NextResponse.json(
         { success: false, error: "Modèle non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     return NextResponse.json({ success: true, model });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -70,17 +73,20 @@ export async function PUT(
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -97,14 +103,18 @@ export async function DELETE(
     if (!model) {
       return NextResponse.json(
         { success: false, error: "Modèle non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (model._count.batches > 0) {
       return NextResponse.json(
-        { success: false, error: "Impossible de supprimer un modèle avec des lots de production" },
-        { status: 422 }
+        {
+          success: false,
+          error:
+            "Impossible de supprimer un modèle avec des lots de production",
+        },
+        { status: 422 },
       );
     }
 
@@ -118,6 +128,9 @@ export async function DELETE(
     return NextResponse.json({ success: true });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/compta/models/route.ts b/src/app/api/v3/compta/models/route.ts
index 1bd0e63..0567032 100644
--- a/src/app/api/v3/compta/models/route.ts
+++ b/src/app/api/v3/compta/models/route.ts
@@ -69,7 +69,7 @@ export async function POST(req: NextRequest) {
     if (existing) {
       return NextResponse.json(
         { success: false, error: "Ce SKU existe déjà" },
-        { status: 409 }
+        { status: 409 },
       );
     }
 
@@ -92,7 +92,7 @@ export async function POST(req: NextRequest) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/production/[id]/complete/route.ts b/src/app/api/v3/compta/production/[id]/complete/route.ts
index 77f8d7d..565d84a 100644
--- a/src/app/api/v3/compta/production/[id]/complete/route.ts
+++ b/src/app/api/v3/compta/production/[id]/complete/route.ts
@@ -3,11 +3,11 @@
  * POST /api/v3/compta/production/[id]/complete - Complete a batch
  */
 
-import { NextRequest, NextResponse } from 'next/server';
-import { requireAdmin, handleApiError } from '@/lib/auth-helpers';
-import { z } from 'zod';
-import { CompleteBatchSchema } from '@/lib/compta/schemas/production.schemas';
-import { completeProductionBatch } from '@/lib/compta/services/production-service';
+import { NextRequest, NextResponse } from "next/server";
+import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
+import { z } from "zod";
+import { CompleteBatchSchema } from "@/lib/compta/schemas/production.schemas";
+import { completeProductionBatch } from "@/lib/compta/services/production-service";
 
 /**
  * POST /api/v3/compta/production/[id]/complete
@@ -15,7 +15,7 @@ import { completeProductionBatch } from '@/lib/compta/services/production-servic
  */
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const session = await requireAdmin(req);
@@ -35,21 +35,25 @@ export async function POST(
   } catch (err) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
-        { success: false, error: 'Validation échouée', details: err.flatten().fieldErrors },
-        { status: 400 }
+        {
+          success: false,
+          error: "Validation échouée",
+          details: err.flatten().fieldErrors,
+        },
+        { status: 400 },
       );
     }
     if (err instanceof Error) {
-      if (err.message.includes('non trouvé')) {
+      if (err.message.includes("non trouvé")) {
         return NextResponse.json(
           { success: false, error: err.message },
-          { status: 404 }
+          { status: 404 },
         );
       }
-      if (err.message.includes('statut') || err.message.includes('dépasse')) {
+      if (err.message.includes("statut") || err.message.includes("dépasse")) {
         return NextResponse.json(
           { success: false, error: err.message },
-          { status: 422 }
+          { status: 422 },
         );
       }
     }
diff --git a/src/app/api/v3/compta/production/[id]/consume/route.ts b/src/app/api/v3/compta/production/[id]/consume/route.ts
index 202f8fe..c7425be 100644
--- a/src/app/api/v3/compta/production/[id]/consume/route.ts
+++ b/src/app/api/v3/compta/production/[id]/consume/route.ts
@@ -8,7 +8,7 @@ import {
 // GET: Preview consumption
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -39,13 +39,13 @@ export async function GET(
       if (err.message.includes("non trouvé")) {
         return NextResponse.json(
           { success: false, error: err.message },
-          { status: 404 }
+          { status: 404 },
         );
       }
       if (err.message.includes("statut")) {
         return NextResponse.json(
           { success: false, error: err.message },
-          { status: 422 }
+          { status: 422 },
         );
       }
     }
@@ -56,7 +56,7 @@ export async function GET(
 // POST: Execute consumption and start production
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const session = await requireAdmin(req);
@@ -77,13 +77,16 @@ export async function POST(
       if (err.message.includes("non trouvé")) {
         return NextResponse.json(
           { success: false, error: err.message },
-          { status: 404 }
+          { status: 404 },
         );
       }
-      if (err.message.includes("statut") || err.message.includes("insuffisant")) {
+      if (
+        err.message.includes("statut") ||
+        err.message.includes("insuffisant")
+      ) {
         return NextResponse.json(
           { success: false, error: err.message },
-          { status: 422 }
+          { status: 422 },
         );
       }
     }
diff --git a/src/app/api/v3/compta/production/[id]/preview/route.ts b/src/app/api/v3/compta/production/[id]/preview/route.ts
index 1377cc6..1dcefaa 100644
--- a/src/app/api/v3/compta/production/[id]/preview/route.ts
+++ b/src/app/api/v3/compta/production/[id]/preview/route.ts
@@ -3,9 +3,9 @@
  * GET /api/v3/compta/production/[id]/preview - Preview BOM requirements
  */
 
-import { NextRequest, NextResponse } from 'next/server';
-import { requireAdmin, handleApiError } from '@/lib/auth-helpers';
-import { previewProductionConsumption } from '@/lib/compta/services/production-service';
+import { NextRequest, NextResponse } from "next/server";
+import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
+import { previewProductionConsumption } from "@/lib/compta/services/production-service";
 
 /**
  * GET /api/v3/compta/production/[id]/preview
@@ -14,7 +14,7 @@ import { previewProductionConsumption } from '@/lib/compta/services/production-s
  */
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -28,16 +28,16 @@ export async function GET(
     });
   } catch (err) {
     if (err instanceof Error) {
-      if (err.message.includes('non trouvé')) {
+      if (err.message.includes("non trouvé")) {
         return NextResponse.json(
           { success: false, error: err.message },
-          { status: 404 }
+          { status: 404 },
         );
       }
-      if (err.message.includes('statut')) {
+      if (err.message.includes("statut")) {
         return NextResponse.json(
           { success: false, error: err.message },
-          { status: 422 }
+          { status: 422 },
         );
       }
     }
diff --git a/src/app/api/v3/compta/production/[id]/route.ts b/src/app/api/v3/compta/production/[id]/route.ts
index 07bbbcc..f34e6f6 100644
--- a/src/app/api/v3/compta/production/[id]/route.ts
+++ b/src/app/api/v3/compta/production/[id]/route.ts
@@ -9,12 +9,14 @@ const BatchUpdateSchema = z.object({
   laborCost: z.number().min(0).optional(),
   overheadCost: z.number().min(0).optional(),
   notes: z.string().optional(),
-  status: z.enum(["PLANNED", "IN_PROGRESS", "COMPLETED", "CANCELLED", "ON_HOLD"]).optional(),
+  status: z
+    .enum(["PLANNED", "IN_PROGRESS", "COMPLETED", "CANCELLED", "ON_HOLD"])
+    .optional(),
 });
 
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -35,20 +37,23 @@ export async function GET(
     if (!batch) {
       return NextResponse.json(
         { success: false, error: "Lot non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     return NextResponse.json({ success: true, batch });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -60,14 +65,17 @@ export async function PUT(
     if (!existing) {
       return NextResponse.json(
         { success: false, error: "Lot non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (existing.status === "COMPLETED" || existing.status === "CANCELLED") {
       return NextResponse.json(
-        { success: false, error: "Impossible de modifier un lot terminé ou annulé" },
-        { status: 422 }
+        {
+          success: false,
+          error: "Impossible de modifier un lot terminé ou annulé",
+        },
+        { status: 422 },
       );
     }
 
@@ -81,8 +89,11 @@ export async function PUT(
       const allowed = validTransitions[existing.status] || [];
       if (!allowed.includes(data.status) && data.status !== existing.status) {
         return NextResponse.json(
-          { success: false, error: `Transition ${existing.status} → ${data.status} non autorisée` },
-          { status: 422 }
+          {
+            success: false,
+            error: `Transition ${existing.status} → ${data.status} non autorisée`,
+          },
+          { status: 422 },
         );
       }
     }
@@ -105,17 +116,20 @@ export async function PUT(
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -125,14 +139,17 @@ export async function DELETE(
     if (!batch) {
       return NextResponse.json(
         { success: false, error: "Lot non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (batch.status !== "PLANNED") {
       return NextResponse.json(
-        { success: false, error: "Seuls les lots planifiés peuvent être supprimés" },
-        { status: 422 }
+        {
+          success: false,
+          error: "Seuls les lots planifiés peuvent être supprimés",
+        },
+        { status: 422 },
       );
     }
 
@@ -141,6 +158,9 @@ export async function DELETE(
     return NextResponse.json({ success: true });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/compta/production/route.ts b/src/app/api/v3/compta/production/route.ts
index b8d65fc..4ddbe75 100644
--- a/src/app/api/v3/compta/production/route.ts
+++ b/src/app/api/v3/compta/production/route.ts
@@ -72,11 +72,13 @@ export async function POST(req: NextRequest) {
     const data = BatchCreateSchema.parse(body);
 
     // Check model exists
-    const model = await prisma.model.findUnique({ where: { id: data.modelId } });
+    const model = await prisma.model.findUnique({
+      where: { id: data.modelId },
+    });
     if (!model) {
       return NextResponse.json(
         { success: false, error: "Modèle non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
@@ -104,7 +106,7 @@ export async function POST(req: NextRequest) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/purchases/[id]/preview/route.ts b/src/app/api/v3/compta/purchases/[id]/preview/route.ts
index b355252..fb34c40 100644
--- a/src/app/api/v3/compta/purchases/[id]/preview/route.ts
+++ b/src/app/api/v3/compta/purchases/[id]/preview/route.ts
@@ -3,11 +3,11 @@
  * POST /api/v3/compta/purchases/[id]/preview - Preview CUMP impact (non-destructive)
  */
 
-import { NextRequest, NextResponse } from 'next/server';
-import { requireAdmin, handleApiError } from '@/lib/auth-helpers';
-import { z } from 'zod';
-import { PreviewReceiveSchema } from '@/lib/compta/schemas/purchase.schemas';
-import { previewReceivePurchase } from '@/lib/compta/services/purchases-service';
+import { NextRequest, NextResponse } from "next/server";
+import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
+import { z } from "zod";
+import { PreviewReceiveSchema } from "@/lib/compta/schemas/purchase.schemas";
+import { previewReceivePurchase } from "@/lib/compta/services/purchases-service";
 
 /**
  * POST /api/v3/compta/purchases/[id]/preview
@@ -16,7 +16,7 @@ import { previewReceivePurchase } from '@/lib/compta/services/purchases-service'
  */
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -34,8 +34,12 @@ export async function POST(
   } catch (err) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
-        { success: false, error: 'Validation échouée', details: err.flatten().fieldErrors },
-        { status: 400 }
+        {
+          success: false,
+          error: "Validation échouée",
+          details: err.flatten().fieldErrors,
+        },
+        { status: 400 },
       );
     }
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/purchases/[id]/receive/route.ts b/src/app/api/v3/compta/purchases/[id]/receive/route.ts
index c9fa86e..6b678b7 100644
--- a/src/app/api/v3/compta/purchases/[id]/receive/route.ts
+++ b/src/app/api/v3/compta/purchases/[id]/receive/route.ts
@@ -4,15 +4,15 @@
  * POST /api/v3/compta/purchases/[id]/receive - Execute transactional receive
  */
 
-import { NextRequest, NextResponse } from 'next/server';
-import { requireAdmin, handleApiError } from '@/lib/auth-helpers';
-import { z } from 'zod';
-import { ReceivePurchaseSchema } from '@/lib/compta/schemas/purchase.schemas';
+import { NextRequest, NextResponse } from "next/server";
+import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
+import { z } from "zod";
+import { ReceivePurchaseSchema } from "@/lib/compta/schemas/purchase.schemas";
 import {
   receivePurchase,
   getPurchaseDetail,
-} from '@/lib/compta/services/purchases-service';
-import { calculateCUMP } from '@/lib/compta/accounting';
+} from "@/lib/compta/services/purchases-service";
+import { calculateCUMP } from "@/lib/compta/accounting";
 
 /**
  * GET /api/v3/compta/purchases/[id]/receive
@@ -20,7 +20,7 @@ import { calculateCUMP } from '@/lib/compta/accounting';
  */
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const session = await requireAdmin(req);
@@ -30,28 +30,29 @@ export async function GET(
 
     if (!purchase) {
       return NextResponse.json(
-        { success: false, error: 'Achat non trouvé' },
-        { status: 404 }
+        { success: false, error: "Achat non trouvé" },
+        { status: 404 },
       );
     }
 
-    if (purchase.status === 'CANCELLED') {
+    if (purchase.status === "CANCELLED") {
       return NextResponse.json(
-        { success: false, error: 'Cet achat est annulé' },
-        { status: 422 }
+        { success: false, error: "Cet achat est annulé" },
+        { status: 422 },
       );
     }
 
-    if (purchase.status === 'RECEIVED') {
+    if (purchase.status === "RECEIVED") {
       return NextResponse.json(
-        { success: false, error: 'Cet achat a déjà été entièrement reçu' },
-        { status: 422 }
+        { success: false, error: "Cet achat a déjà été entièrement reçu" },
+        { status: 422 },
       );
     }
 
     // Generate preview for all remaining items
     const preview = purchase.items.map((item) => {
-      const remaining = Number(item.quantityOrdered) - Number(item.quantityReceived);
+      const remaining =
+        Number(item.quantityOrdered) - Number(item.quantityReceived);
 
       if (remaining <= 0) {
         return {
@@ -76,7 +77,7 @@ export async function GET(
         Number(item.inventoryItem.quantity),
         Number(item.inventoryItem.averageCost),
         remaining,
-        Number(item.unitPrice)
+        Number(item.unitPrice),
       );
       const newQty = Number(item.inventoryItem.quantity) + remaining;
       const newValue = newQty * newCUMP;
@@ -129,7 +130,7 @@ export async function GET(
  */
 export async function POST(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     const session = await requireAdmin(req);
@@ -140,10 +141,16 @@ export async function POST(
     // Transform old format to new format if needed
     const transformedBody = {
       ...body,
-      items: body.items?.map((item: { id?: string; purchaseItemId?: string; quantityReceived: number }) => ({
-        purchaseItemId: item.purchaseItemId ?? item.id,
-        quantityReceived: item.quantityReceived,
-      })),
+      items: body.items?.map(
+        (item: {
+          id?: string;
+          purchaseItemId?: string;
+          quantityReceived: number;
+        }) => ({
+          purchaseItemId: item.purchaseItemId ?? item.id,
+          quantityReceived: item.quantityReceived,
+        }),
+      ),
     };
 
     const data = ReceivePurchaseSchema.parse(transformedBody);
@@ -157,13 +164,17 @@ export async function POST(
       success: true,
       purchase: result.purchase,
       stockUpdates: result.stockUpdates,
-      message: 'Réception enregistrée, stock mis à jour',
+      message: "Réception enregistrée, stock mis à jour",
     });
   } catch (err) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
-        { success: false, error: 'Validation échouée', details: err.flatten().fieldErrors },
-        { status: 400 }
+        {
+          success: false,
+          error: "Validation échouée",
+          details: err.flatten().fieldErrors,
+        },
+        { status: 400 },
       );
     }
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/purchases/[id]/route.ts b/src/app/api/v3/compta/purchases/[id]/route.ts
index 98b4c2f..8be3eb7 100644
--- a/src/app/api/v3/compta/purchases/[id]/route.ts
+++ b/src/app/api/v3/compta/purchases/[id]/route.ts
@@ -14,7 +14,7 @@ const PurchaseUpdateSchema = z.object({
 
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -32,20 +32,23 @@ export async function GET(
     if (!purchase) {
       return NextResponse.json(
         { success: false, error: "Achat non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     return NextResponse.json({ success: true, purchase });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -57,14 +60,14 @@ export async function PUT(
     if (!existing) {
       return NextResponse.json(
         { success: false, error: "Achat non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (existing.status !== "DRAFT") {
       return NextResponse.json(
         { success: false, error: "Seuls les brouillons peuvent être modifiés" },
-        { status: 422 }
+        { status: 422 },
       );
     }
 
@@ -73,7 +76,9 @@ export async function PUT(
       data: {
         invoiceNumber: data.invoiceNumber,
         invoiceDate: data.invoiceDate ? new Date(data.invoiceDate) : undefined,
-        expectedDate: data.expectedDate ? new Date(data.expectedDate) : undefined,
+        expectedDate: data.expectedDate
+          ? new Date(data.expectedDate)
+          : undefined,
         taxAmount: data.taxAmount,
         shippingCost: data.shippingCost,
         notes: data.notes,
@@ -86,17 +91,20 @@ export async function PUT(
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -106,14 +114,17 @@ export async function DELETE(
     if (!existing) {
       return NextResponse.json(
         { success: false, error: "Achat non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     if (existing.status !== "DRAFT") {
       return NextResponse.json(
-        { success: false, error: "Seuls les brouillons peuvent être supprimés" },
-        { status: 422 }
+        {
+          success: false,
+          error: "Seuls les brouillons peuvent être supprimés",
+        },
+        { status: 422 },
       );
     }
 
@@ -125,6 +136,9 @@ export async function DELETE(
     return NextResponse.json({ success: true });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/compta/purchases/route.ts b/src/app/api/v3/compta/purchases/route.ts
index 899ff69..84e62e2 100644
--- a/src/app/api/v3/compta/purchases/route.ts
+++ b/src/app/api/v3/compta/purchases/route.ts
@@ -4,18 +4,18 @@
  * POST /api/v3/compta/purchases - Create new purchase (DRAFT)
  */
 
-import { NextRequest, NextResponse } from 'next/server';
-import { requireAdmin, handleApiError } from '@/lib/auth-helpers';
-import { z } from 'zod';
+import { NextRequest, NextResponse } from "next/server";
+import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
+import { z } from "zod";
 import {
   PurchaseCreateSchema,
   PaginationSchema,
   PurchaseFilterSchema,
-} from '@/lib/compta/schemas/purchase.schemas';
+} from "@/lib/compta/schemas/purchase.schemas";
 import {
   getPurchaseList,
   createPurchase,
-} from '@/lib/compta/services/purchases-service';
+} from "@/lib/compta/services/purchases-service";
 
 /**
  * GET /api/v3/compta/purchases
@@ -29,15 +29,15 @@ export async function GET(req: NextRequest) {
 
     // Parse pagination
     const pagination = PaginationSchema.parse({
-      page: searchParams.get('page') ?? 1,
-      pageSize: searchParams.get('pageSize') ?? searchParams.get('limit') ?? 20,
+      page: searchParams.get("page") ?? 1,
+      pageSize: searchParams.get("pageSize") ?? searchParams.get("limit") ?? 20,
     });
 
     // Parse filters
     const filters = PurchaseFilterSchema.parse({
-      status: searchParams.get('status') ?? undefined,
-      supplierId: searchParams.get('supplierId') ?? undefined,
-      search: searchParams.get('search') ?? undefined,
+      status: searchParams.get("status") ?? undefined,
+      supplierId: searchParams.get("supplierId") ?? undefined,
+      search: searchParams.get("search") ?? undefined,
     });
 
     const result = await getPurchaseList(pagination, filters);
@@ -49,8 +49,12 @@ export async function GET(req: NextRequest) {
   } catch (err) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
-        { success: false, error: 'Paramètres invalides', details: err.flatten().fieldErrors },
-        { status: 400 }
+        {
+          success: false,
+          error: "Paramètres invalides",
+          details: err.flatten().fieldErrors,
+        },
+        { status: 400 },
       );
     }
     return handleApiError(err);
@@ -70,15 +74,16 @@ export async function POST(req: NextRequest) {
 
     const purchase = await createPurchase(data);
 
-    return NextResponse.json(
-      { success: true, purchase },
-      { status: 201 }
-    );
+    return NextResponse.json({ success: true, purchase }, { status: 201 });
   } catch (err) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
-        { success: false, error: 'Validation échouée', details: err.flatten().fieldErrors },
-        { status: 400 }
+        {
+          success: false,
+          error: "Validation échouée",
+          details: err.flatten().fieldErrors,
+        },
+        { status: 400 },
       );
     }
     return handleApiError(err);
diff --git a/src/app/api/v3/compta/reports/route.ts b/src/app/api/v3/compta/reports/route.ts
index ad5bc48..f0b317c 100644
--- a/src/app/api/v3/compta/reports/route.ts
+++ b/src/app/api/v3/compta/reports/route.ts
@@ -23,7 +23,7 @@ export async function GET(req: NextRequest) {
       select: { quantity: true, reserved: true },
     });
     const lowStockItems = allItems.filter(
-      (item) => (Number(item.quantity) - Number(item.reserved)) <= 10
+      (item) => Number(item.quantity) - Number(item.reserved) <= 10,
     ).length;
 
     // Purchase stats
diff --git a/src/app/api/v3/compta/route.ts b/src/app/api/v3/compta/route.ts
index bfa7909..a643e25 100644
--- a/src/app/api/v3/compta/route.ts
+++ b/src/app/api/v3/compta/route.ts
@@ -3,9 +3,9 @@
  * GET /api/v3/compta - Health check + list available routes
  */
 
-import { NextRequest, NextResponse } from 'next/server';
-import { requireAdmin, handleApiError } from '@/lib/auth-helpers';
-import { prisma } from '@/lib/prisma';
+import { NextRequest, NextResponse } from "next/server";
+import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
+import { prisma } from "@/lib/prisma";
 
 export async function GET(req: NextRequest) {
   try {
@@ -13,21 +13,25 @@ export async function GET(req: NextRequest) {
 
     // Get quick stats
     const [purchaseCount, inventoryCount, lowStockCount] = await Promise.all([
-      prisma.purchase.count({ where: { status: { in: ['DRAFT', 'ORDERED', 'PARTIAL'] } } }),
+      prisma.purchase.count({
+        where: { status: { in: ["DRAFT", "ORDERED", "PARTIAL"] } },
+      }),
       prisma.inventoryItem.count({ where: { isActive: true } }),
-      prisma.inventoryItem.count({
-        where: {
-          isActive: true,
-          quantity: { lte: prisma.inventoryItem.fields.threshold },
-        },
-      }).catch(() => 0), // Fallback if threshold comparison fails
+      prisma.inventoryItem
+        .count({
+          where: {
+            isActive: true,
+            quantity: { lte: prisma.inventoryItem.fields.threshold },
+          },
+        })
+        .catch(() => 0), // Fallback if threshold comparison fails
     ]);
 
     return NextResponse.json({
       success: true,
-      version: '3.0.0',
+      version: "3.0.0",
       phase: 1,
-      status: 'healthy',
+      status: "healthy",
       timestamp: new Date().toISOString(),
       stats: {
         pendingPurchases: purchaseCount,
@@ -36,18 +40,18 @@ export async function GET(req: NextRequest) {
       },
       routes: {
         purchases: {
-          list: 'GET /api/v3/compta/purchases',
-          create: 'POST /api/v3/compta/purchases',
-          detail: 'GET /api/v3/compta/purchases/[id]',
-          preview: 'POST /api/v3/compta/purchases/[id]/preview',
-          receive: 'POST /api/v3/compta/purchases/[id]/receive',
+          list: "GET /api/v3/compta/purchases",
+          create: "POST /api/v3/compta/purchases",
+          detail: "GET /api/v3/compta/purchases/[id]",
+          preview: "POST /api/v3/compta/purchases/[id]/preview",
+          receive: "POST /api/v3/compta/purchases/[id]/receive",
         },
         inventory: {
-          list: 'GET /api/v3/compta/inventory',
-          create: 'POST /api/v3/compta/inventory',
-          detail: 'GET /api/v3/compta/inventory/[id]',
-          adjustment: 'POST /api/v3/compta/inventory/adjustment',
-          reconcile: 'GET /api/v3/compta/inventory/reconcile',
+          list: "GET /api/v3/compta/inventory",
+          create: "POST /api/v3/compta/inventory",
+          detail: "GET /api/v3/compta/inventory/[id]",
+          adjustment: "POST /api/v3/compta/inventory/adjustment",
+          reconcile: "GET /api/v3/compta/inventory/reconcile",
         },
       },
     });
diff --git a/src/app/api/v3/compta/suppliers/[id]/route.ts b/src/app/api/v3/compta/suppliers/[id]/route.ts
index 50bfe23..ffc6985 100644
--- a/src/app/api/v3/compta/suppliers/[id]/route.ts
+++ b/src/app/api/v3/compta/suppliers/[id]/route.ts
@@ -16,7 +16,7 @@ const SupplierUpdateSchema = z.object({
 
 export async function GET(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -33,14 +33,23 @@ export async function GET(
     if (!supplier) {
       return NextResponse.json(
         { success: false, error: "Fournisseur non trouvé" },
-        { status: 404 }
+        { status: 404 },
       );
     }
 
     // Calculer le solde
-    const totalAdvances = supplier.advances.reduce((sum, a) => sum + Number(a.amount), 0);
-    const usedAdvances = supplier.advances.reduce((sum, a) => sum + Number(a.amountUsed), 0);
-    const totalDue = supplier.purchases.reduce((sum, p) => sum + Number(p.amountDue), 0);
+    const totalAdvances = supplier.advances.reduce(
+      (sum, a) => sum + Number(a.amount),
+      0,
+    );
+    const usedAdvances = supplier.advances.reduce(
+      (sum, a) => sum + Number(a.amountUsed),
+      0,
+    );
+    const totalDue = supplier.purchases.reduce(
+      (sum, p) => sum + Number(p.amountDue),
+      0,
+    );
     const balance = totalAdvances - usedAdvances - totalDue;
 
     return NextResponse.json({
@@ -50,13 +59,16 @@ export async function GET(
     });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function PUT(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -74,17 +86,20 @@ export async function PUT(
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
 export async function DELETE(
   req: NextRequest,
-  { params }: { params: Promise<{ id: string }> }
+  { params }: { params: Promise<{ id: string }> },
 ) {
   try {
     await requireAdmin(req);
@@ -99,6 +114,9 @@ export async function DELETE(
     return NextResponse.json({ success: true }, { status: 200 });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/compta/suppliers/route.ts b/src/app/api/v3/compta/suppliers/route.ts
index 087c3e3..5e65e38 100644
--- a/src/app/api/v3/compta/suppliers/route.ts
+++ b/src/app/api/v3/compta/suppliers/route.ts
@@ -51,7 +51,10 @@ export async function GET(req: NextRequest) {
     });
   } catch (err) {
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
 
@@ -68,10 +71,13 @@ export async function POST(req: NextRequest) {
     if (err instanceof z.ZodError) {
       return NextResponse.json(
         { success: false, error: "Validation échouée", details: err.issues },
-        { status: 400 }
+        { status: 400 },
       );
     }
     const message = err instanceof Error ? err.message : "Erreur serveur";
-    return NextResponse.json({ success: false, error: message }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: message },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/loyalty/balance/route.ts b/src/app/api/v3/loyalty/balance/route.ts
index fb845e3..239f518 100644
--- a/src/app/api/v3/loyalty/balance/route.ts
+++ b/src/app/api/v3/loyalty/balance/route.ts
@@ -10,14 +10,14 @@ export async function GET(req: Request) {
   if (!session?.user?.email) {
     return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
   }
-  
+
   try {
     // Upsert user: create if not exists
-    const user = await prisma.user.upsert({ 
+    const user = await prisma.user.upsert({
       where: { email: session.user.email },
       create: {
         email: session.user.email,
-        name: session.user.name || null
+        name: session.user.name || null,
       },
       update: {},
       select: {
@@ -25,43 +25,51 @@ export async function GET(req: Request) {
         loyaltyPoints: true,
         vipLevel: true,
         pointHistory: {
-          orderBy: { createdAt: 'desc' },
-          take: 20
-        }
-      }
+          orderBy: { createdAt: "desc" },
+          take: 20,
+        },
+      },
     });
 
     // Calculate progress to next level
     let nextLevel = null;
     let progress = 0;
-    
+
     const history = await prisma.loyaltyPoint.aggregate({
       where: { userId: user.id, amount: { gt: 0 } },
-      _sum: { amount: true }
+      _sum: { amount: true },
     });
     const totalLifetimePoints = history._sum.amount || 0;
 
     if (user.vipLevel === "SILVER") {
       nextLevel = { name: "GOLD", threshold: VIP_LEVELS.GOLD.threshold };
-      progress = Math.min(100, (totalLifetimePoints / VIP_LEVELS.GOLD.threshold) * 100);
+      progress = Math.min(
+        100,
+        (totalLifetimePoints / VIP_LEVELS.GOLD.threshold) * 100,
+      );
     } else if (user.vipLevel === "GOLD") {
       nextLevel = { name: "BLACK", threshold: VIP_LEVELS.BLACK.threshold };
-      progress = Math.min(100, (totalLifetimePoints / VIP_LEVELS.BLACK.threshold) * 100);
+      progress = Math.min(
+        100,
+        (totalLifetimePoints / VIP_LEVELS.BLACK.threshold) * 100,
+      );
     }
 
     return NextResponse.json({
       balance: user.loyaltyPoints,
       vipLevel: user.vipLevel,
-      benefits: VIP_LEVELS[user.vipLevel as keyof typeof VIP_LEVELS]?.benefits || VIP_LEVELS.SILVER.benefits,
+      benefits:
+        VIP_LEVELS[user.vipLevel as keyof typeof VIP_LEVELS]?.benefits ||
+        VIP_LEVELS.SILVER.benefits,
       nextLevel,
       progress,
-      history: user.pointHistory
+      history: user.pointHistory,
     });
   } catch (error: any) {
     console.error("Loyalty balance error:", error);
     return NextResponse.json(
       { error: error.message || "Internal Server Error" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/v3/loyalty/earn/route.ts b/src/app/api/v3/loyalty/earn/route.ts
index ab6bb57..7cc11a4 100644
--- a/src/app/api/v3/loyalty/earn/route.ts
+++ b/src/app/api/v3/loyalty/earn/route.ts
@@ -1,22 +1,25 @@
 import { NextResponse } from "next/server";
 import { getServerSession } from "next-auth/next";
 import { authOptions } from "@/lib/auth";
-import { earnPoints, LoyaltyAction } from "@/lib/loyalty/services/loyalty.service";
+import {
+  earnPoints,
+  LoyaltyAction,
+} from "@/lib/loyalty/services/loyalty.service";
 import { z } from "zod";
 
 const earnSchema = z.object({
   amount: z.number().positive(),
   reason: z.enum([
-    "PURCHASE", 
-    "SIGNUP", 
-    "BIRTHDAY", 
-    "REFERRAL", 
-    "REVIEW", 
+    "PURCHASE",
+    "SIGNUP",
+    "BIRTHDAY",
+    "REFERRAL",
+    "REVIEW",
     "ABANDONED_CART_RECOVERY",
     "NEWSLETTER",
     "WHATSAPP_SHARE",
     "WISHLIST_ADD",
-    "WISHLIST_PURCHASE"
+    "WISHLIST_PURCHASE",
   ]),
   referenceId: z.string().optional(),
   userId: z.string().optional(), // Admin can specify user, otherwise current user
@@ -31,25 +34,27 @@ export async function POST(req: Request) {
   try {
     const body = await req.json();
     const validated = earnSchema.parse(body);
-    
+
     const currentUserId = (session.user as any).id || "1";
     const targetUserId = validated.userId || currentUserId;
 
     // Basic security: only ADMIN can award points arbitrarily to others.
     // Users can trigger specific actions if allowed (like share), but usually this is backend controlled.
     // For now, let's allow if it's self-triggerable actions or if admin.
-    
-    const isAdmin = (session.user as any).role === 'ADMIN' || (session.user as any).role === 'admin';
-    
+
+    const isAdmin =
+      (session.user as any).role === "ADMIN" ||
+      (session.user as any).role === "admin";
+
     if (targetUserId !== currentUserId && !isAdmin) {
-       return NextResponse.json({ error: "Forbidden" }, { status: 403 });
+      return NextResponse.json({ error: "Forbidden" }, { status: 403 });
     }
 
     const result = await earnPoints(
       targetUserId,
       validated.amount,
       validated.reason as LoyaltyAction,
-      validated.referenceId
+      validated.referenceId,
     );
 
     return NextResponse.json(result);
@@ -58,8 +63,8 @@ export async function POST(req: Request) {
       return NextResponse.json({ error: error.errors }, { status: 400 });
     }
     return NextResponse.json(
-        { error: error.message || "Internal Server Error" },
-        { status: 500 }
+      { error: error.message || "Internal Server Error" },
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/v3/loyalty/redeem/route.ts b/src/app/api/v3/loyalty/redeem/route.ts
index 604b331..3778f5e 100644
--- a/src/app/api/v3/loyalty/redeem/route.ts
+++ b/src/app/api/v3/loyalty/redeem/route.ts
@@ -27,8 +27,8 @@ export async function POST(req: Request) {
       return NextResponse.json({ error: error.errors }, { status: 400 });
     }
     return NextResponse.json(
-        { error: error.message || "Internal Server Error" },
-        { status: 500 }
+      { error: error.message || "Internal Server Error" },
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/v3/loyalty/rewards/route.ts b/src/app/api/v3/loyalty/rewards/route.ts
index e9cdcc6..d7cba7e 100644
--- a/src/app/api/v3/loyalty/rewards/route.ts
+++ b/src/app/api/v3/loyalty/rewards/route.ts
@@ -5,13 +5,13 @@ export async function GET() {
   try {
     const rewards = await prisma.loyaltyReward.findMany({
       where: { isActive: true },
-      orderBy: { cost: 'asc' }
+      orderBy: { cost: "asc" },
     });
     return NextResponse.json(rewards);
   } catch (error: any) {
     return NextResponse.json(
-        { error: error.message || "Internal Server Error" },
-        { status: 500 }
+      { error: error.message || "Internal Server Error" },
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/v3/site/hero/history/route.ts b/src/app/api/v3/site/hero/history/route.ts
index 6bf5e1c..41b67ac 100644
--- a/src/app/api/v3/site/hero/history/route.ts
+++ b/src/app/api/v3/site/hero/history/route.ts
@@ -6,7 +6,7 @@ import { getSettingsHistory } from "@/lib/site/settings.service";
 export async function GET(req: NextRequest) {
   try {
     await requireAdmin(req);
-    
+
     const { searchParams } = new URL(req.url);
     const limit = parseInt(searchParams.get("limit") || "10");
 
@@ -14,11 +14,11 @@ export async function GET(req: NextRequest) {
 
     return NextResponse.json({
       success: true,
-      history: history.map(h => ({
+      history: history.map((h) => ({
         id: h.id,
         createdAt: h.createdAt,
-        snapshot: JSON.parse(h.snapshot)
-      }))
+        snapshot: JSON.parse(h.snapshot),
+      })),
     });
   } catch (err: unknown) {
     return handleApiError(err);
diff --git a/src/app/api/v3/site/hero/rollback/route.ts b/src/app/api/v3/site/hero/rollback/route.ts
index 73be472..072ed69 100644
--- a/src/app/api/v3/site/hero/rollback/route.ts
+++ b/src/app/api/v3/site/hero/rollback/route.ts
@@ -5,7 +5,7 @@ import { revalidatePath } from "next/cache";
 import { z } from "zod";
 
 const rollbackSchema = z.object({
-  historyId: z.string()
+  historyId: z.string(),
 });
 
 // POST - Rollback to a previous version (admin only)
@@ -13,7 +13,7 @@ export async function POST(req: NextRequest) {
   try {
     const admin = await requireAdmin(req);
     const body = await req.json();
-    
+
     const { historyId } = rollbackSchema.parse(body);
 
     const { updated } = await rollbackSettings(historyId, admin.user.id);
diff --git a/src/app/api/v3/site/settings/hero/route.ts b/src/app/api/v3/site/settings/hero/route.ts
index 21a5242..e11d51e 100644
--- a/src/app/api/v3/site/settings/hero/route.ts
+++ b/src/app/api/v3/site/settings/hero/route.ts
@@ -1,6 +1,9 @@
 import { NextRequest, NextResponse } from "next/server";
 import { requireAdmin, handleApiError } from "@/lib/auth-helpers";
-import { updateHeroSettings, getSiteSettings } from "@/lib/site/settings.service";
+import {
+  updateHeroSettings,
+  getSiteSettings,
+} from "@/lib/site/settings.service";
 import { revalidatePath } from "next/cache";
 import { z } from "zod";
 
@@ -17,12 +20,15 @@ const heroSchema = z.object({
   heroCtaTextAr: z.string().optional().nullable(),
   heroCtaUrl: z.string().optional().nullable(),
   heroOverlayOpacity: z.number().min(0).max(1).optional().nullable(),
-  heroPreset: z.enum(["classic", "minimal", "glass", "centered"]).optional().nullable(),
+  heroPreset: z
+    .enum(["classic", "minimal", "glass", "centered"])
+    .optional()
+    .nullable(),
   heroActive: z.boolean().optional(),
   heroScheduleStart: z.string().datetime().optional().nullable(),
   heroScheduleEnd: z.string().datetime().optional().nullable(),
   heroVariant: z.enum(["image", "video", "carousel"]).optional().nullable(),
-  heroCarouselItems: z.string().optional().nullable()
+  heroCarouselItems: z.string().optional().nullable(),
 });
 
 // GET - Get current hero settings (admin)
@@ -41,10 +47,10 @@ export async function PUT(req: NextRequest) {
   try {
     const admin = await requireAdmin(req);
     const body = await req.json();
-    
+
     // Validate input
     const validated = heroSchema.parse(body);
-    
+
     // Convert date strings to Date objects
     const data: any = { ...validated };
     if (validated.heroScheduleStart) {
diff --git a/src/app/api/v3/site/settings/route.ts b/src/app/api/v3/site/settings/route.ts
index 65b4019..d8d318d 100644
--- a/src/app/api/v3/site/settings/route.ts
+++ b/src/app/api/v3/site/settings/route.ts
@@ -5,17 +5,17 @@ import { getSiteSettings } from "@/lib/site/settings.service";
 export async function GET() {
   try {
     const settings = await getSiteSettings();
-    
+
     return NextResponse.json(settings, {
       headers: {
-        "Cache-Control": "public, s-maxage=60, stale-while-revalidate=300"
-      }
+        "Cache-Control": "public, s-maxage=60, stale-while-revalidate=300",
+      },
     });
   } catch (error: any) {
     console.error("Site settings error:", error);
     return NextResponse.json(
       { error: "Internal Server Error" },
-      { status: 500 }
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/v3/wishlist/route.ts b/src/app/api/v3/wishlist/route.ts
index 5402f30..3eeb8bb 100644
--- a/src/app/api/v3/wishlist/route.ts
+++ b/src/app/api/v3/wishlist/route.ts
@@ -15,8 +15,8 @@ export async function GET(req: Request) {
     return NextResponse.json(wishlist);
   } catch (error: any) {
     return NextResponse.json(
-        { error: error.message || "Internal Server Error" },
-        { status: 500 }
+      { error: error.message || "Internal Server Error" },
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/api/v3/wishlist/sync/route.ts b/src/app/api/v3/wishlist/sync/route.ts
index a334db2..f99fc84 100644
--- a/src/app/api/v3/wishlist/sync/route.ts
+++ b/src/app/api/v3/wishlist/sync/route.ts
@@ -5,24 +5,32 @@ import { getServerSession } from "next-auth";
 import { authOptions } from "@/lib/auth";
 
 const schema = z.object({
-  items: z.array(z.object({
-    productId: z.string()
-  })),
-  guestKey: z.string().optional()
+  items: z.array(
+    z.object({
+      productId: z.string(),
+    }),
+  ),
+  guestKey: z.string().optional(),
 });
 
 export async function POST(req: NextRequest) {
   try {
     const session = await getServerSession(authOptions);
     if (!session?.user) {
-        return NextResponse.json({ success: false, error: "Non authentifié" }, { status: 401 });
+      return NextResponse.json(
+        { success: false, error: "Non authentifié" },
+        { status: 401 },
+      );
     }
 
     const body = await req.json();
     const validation = schema.safeParse(body);
-    
+
     if (!validation.success) {
-        return NextResponse.json({ success: false, error: "Format invalide" }, { status: 400 });
+      return NextResponse.json(
+        { success: false, error: "Format invalide" },
+        { status: 400 },
+      );
     }
 
     const { items, guestKey } = validation.data;
@@ -30,9 +38,15 @@ export async function POST(req: NextRequest) {
 
     await syncGuestWishlistToUser(guestKey || "manual_sync", userId, items);
 
-    return NextResponse.json({ success: true, message: "Wishlist synchronisée" });
+    return NextResponse.json({
+      success: true,
+      message: "Wishlist synchronisée",
+    });
   } catch (err) {
     console.error("Wishlist sync error:", err);
-    return NextResponse.json({ success: false, error: "Erreur de synchronisation" }, { status: 500 });
+    return NextResponse.json(
+      { success: false, error: "Erreur de synchronisation" },
+      { status: 500 },
+    );
   }
 }
diff --git a/src/app/api/v3/wishlist/toggle/route.ts b/src/app/api/v3/wishlist/toggle/route.ts
index 120c690..2cfd6ce 100644
--- a/src/app/api/v3/wishlist/toggle/route.ts
+++ b/src/app/api/v3/wishlist/toggle/route.ts
@@ -33,17 +33,17 @@ export async function POST(req: Request) {
       // or check first.
       // For simplicity, let's just call it and assume we might allow multiple or rely on client behavior.
       // Better approach: check if LoyaltyPoint exists for this ref.
-      
+
       // Since `earnPoints` doesn't check for duplication of referenceId inherently unless we coded it,
       // we will proceed but note this caveat.
-      
+
       // Actually, let's just do it.
       try {
         await earnPoints(
           userId,
           LOYALTY_RULES.WISHLIST_ADD_BONUS,
           "WISHLIST_ADD",
-          `WISHLIST_${validated.productId}`
+          `WISHLIST_${validated.productId}`,
         );
       } catch (e) {
         // Ignore if duplicate or error, don't fail the toggle
@@ -57,8 +57,8 @@ export async function POST(req: Request) {
       return NextResponse.json({ error: error.errors }, { status: 400 });
     }
     return NextResponse.json(
-        { error: error.message || "Internal Server Error" },
-        { status: 500 }
+      { error: error.message || "Internal Server Error" },
+      { status: 500 },
     );
   }
 }
diff --git a/src/app/auth/magic-link-request/page.tsx b/src/app/auth/magic-link-request/page.tsx
index 5a20c44..591a318 100644
--- a/src/app/auth/magic-link-request/page.tsx
+++ b/src/app/auth/magic-link-request/page.tsx
@@ -4,23 +4,25 @@ import Link from "next/link";
 
 export default function MagicLinkRequest() {
   const [email, setEmail] = useState("");
-  const [status, setStatus] = useState<"idle" | "loading" | "success" | "error">("idle");
+  const [status, setStatus] = useState<
+    "idle" | "loading" | "success" | "error"
+  >("idle");
   const [message, setMessage] = useState("");
 
   const handleSubmit = async (e: React.FormEvent) => {
     e.preventDefault();
     setStatus("loading");
     setMessage("");
-    
+
     try {
       const guestKey = localStorage.getItem("guest_wishlist_key") || undefined;
-      
+
       const res = await fetch("/api/v3/auth/auto-create", {
         method: "POST",
         headers: { "Content-Type": "application/json" },
-        body: JSON.stringify({ email, guestKey })
+        body: JSON.stringify({ email, guestKey }),
       });
-      
+
       const data = await res.json();
       if (res.ok) {
         setStatus("success");
@@ -39,12 +41,19 @@ export default function MagicLinkRequest() {
     return (
       <div className="min-h-screen bg-[#F9F7F2] flex items-center justify-center p-4">
         <div className="bg-white p-8 max-w-md w-full shadow-sm text-center">
-          <h1 className="text-2xl font-serif text-[#5C4033] mb-4">Vérifiez votre email</h1>
+          <h1 className="text-2xl font-serif text-[#5C4033] mb-4">
+            Vérifiez votre email
+          </h1>
           <p className="text-gray-600 mb-6 leading-relaxed">
-            Nous avons envoyé un lien de connexion sécurisé à <strong>{email}</strong>.
-            <br/>Ce lien est valide pendant 15 minutes.
+            Nous avons envoyé un lien de connexion sécurisé à{" "}
+            <strong>{email}</strong>.
+            <br />
+            Ce lien est valide pendant 15 minutes.
           </p>
-          <Link href="/" className="text-[#5C4033] border-b border-[#5C4033] pb-0.5 text-sm uppercase tracking-widest hover:text-[#8B5E3C] hover:border-[#8B5E3C] transition-colors">
+          <Link
+            href="/"
+            className="text-[#5C4033] border-b border-[#5C4033] pb-0.5 text-sm uppercase tracking-widest hover:text-[#8B5E3C] hover:border-[#8B5E3C] transition-colors"
+          >
             Retour à l'accueil
           </Link>
         </div>
@@ -55,39 +64,52 @@ export default function MagicLinkRequest() {
   return (
     <div className="min-h-screen bg-[#F9F7F2] flex items-center justify-center p-4">
       <div className="bg-white p-8 max-w-md w-full shadow-sm">
-        <h1 className="text-2xl font-serif text-[#5C4033] mb-2 text-center">Connexion</h1>
-        <p className="text-center text-gray-500 text-sm mb-8">Accédez à votre espace personnel sans mot de passe</p>
-        
+        <h1 className="text-2xl font-serif text-[#5C4033] mb-2 text-center">
+          Connexion
+        </h1>
+        <p className="text-center text-gray-500 text-sm mb-8">
+          Accédez à votre espace personnel sans mot de passe
+        </p>
+
         <form onSubmit={handleSubmit} className="space-y-6">
           <div>
-            <label className="block text-xs uppercase tracking-widest text-gray-500 mb-2">Email</label>
-            <input 
-              type="email" 
+            <label className="block text-xs uppercase tracking-widest text-gray-500 mb-2">
+              Email
+            </label>
+            <input
+              type="email"
               value={email}
               onChange={(e) => setEmail(e.target.value)}
               className="w-full border border-gray-200 p-4 text-sm focus:outline-none focus:border-[#5C4033] transition-colors"
               placeholder="votre@email.com"
-              required 
+              required
             />
           </div>
-          
+
           {status === "error" && (
-            <div className="text-red-500 text-sm bg-red-50 p-4 border border-red-100">{message}</div>
+            <div className="text-red-500 text-sm bg-red-50 p-4 border border-red-100">
+              {message}
+            </div>
           )}
-          
-          <button 
+
+          <button
             type="submit"
             disabled={status === "loading"}
             className="w-full bg-[#5C4033] text-white py-4 uppercase tracking-widest text-xs hover:bg-[#4A332A] transition-colors disabled:opacity-70"
           >
-            {status === "loading" ? "Envoi en cours..." : "Recevoir mon lien magique"}
+            {status === "loading"
+              ? "Envoi en cours..."
+              : "Recevoir mon lien magique"}
           </button>
         </form>
-        
+
         <div className="mt-8 pt-6 border-t border-gray-100 text-center">
-            <Link href="/admin/login" className="text-xs text-gray-400 hover:text-gray-600 transition-colors">
-                Administration
-            </Link>
+          <Link
+            href="/admin/login"
+            className="text-xs text-gray-400 hover:text-gray-600 transition-colors"
+          >
+            Administration
+          </Link>
         </div>
       </div>
     </div>
diff --git a/src/app/auth/magic-link-verify/page.tsx b/src/app/auth/magic-link-verify/page.tsx
index 6091782..2269473 100644
--- a/src/app/auth/magic-link-verify/page.tsx
+++ b/src/app/auth/magic-link-verify/page.tsx
@@ -18,35 +18,36 @@ function VerifyContent() {
     const verify = async () => {
       try {
         // Sign in using the magic-link provider
-        const result = await signIn("magic-link", { 
-          token, 
-          redirect: false 
+        const result = await signIn("magic-link", {
+          token,
+          redirect: false,
         });
 
         if (result?.ok) {
           // Sync wishlist logic
           const guestKey = localStorage.getItem("guest_wishlist_key");
           try {
-              const stored = localStorage.getItem("guest_wishlist");
-              const localWishlist = stored ? JSON.parse(stored) : [];
-              
-              if (localWishlist.length > 0) {
-                 const items = localWishlist.map((item: any) => ({ 
-                    productId: typeof item === 'string' ? item : (item.id || item.productId) 
-                 }));
+            const stored = localStorage.getItem("guest_wishlist");
+            const localWishlist = stored ? JSON.parse(stored) : [];
 
-                 await fetch("/api/v3/wishlist/sync", {
-                    method: "POST",
-                    headers: { "Content-Type": "application/json" },
-                    body: JSON.stringify({ items, guestKey })
-                 });
-                 
-                 // Clear local guest data after sync
-                 localStorage.removeItem("guest_wishlist");
-              }
-              // We might keep the key or rotate it, but clearing items ensures no double sync
+            if (localWishlist.length > 0) {
+              const items = localWishlist.map((item: any) => ({
+                productId:
+                  typeof item === "string" ? item : item.id || item.productId,
+              }));
+
+              await fetch("/api/v3/wishlist/sync", {
+                method: "POST",
+                headers: { "Content-Type": "application/json" },
+                body: JSON.stringify({ items, guestKey }),
+              });
+
+              // Clear local guest data after sync
+              localStorage.removeItem("guest_wishlist");
+            }
+            // We might keep the key or rotate it, but clearing items ensures no double sync
           } catch (e) {
-              console.error("Sync failed", e);
+            console.error("Sync failed", e);
           }
 
           setStatus("success");
@@ -65,33 +66,50 @@ function VerifyContent() {
 
   return (
     <div className="bg-white p-8 max-w-md w-full shadow-sm text-center">
-        {status === "verifying" && (
-            <>
-                <h1 className="text-xl font-serif text-[#5C4033] mb-4">Vérification en cours...</h1>
-                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#5C4033] mx-auto"></div>
-            </>
-        )}
-        {status === "success" && (
-            <>
-                <h1 className="text-xl font-serif text-[#5C4033] mb-4">Connexion réussie !</h1>
-                <p className="text-gray-600">Redirection vers la boutique...</p>
-            </>
-        )}
-        {status === "error" && (
-            <>
-                <h1 className="text-xl font-serif text-red-800 mb-4">Lien invalide ou expiré</h1>
-                <p className="text-gray-600 mb-6">Ce lien de connexion n'est plus valide ou a déjà été utilisé.</p>
-                <a href="/auth/magic-link-request" className="text-[#5C4033] underline">Demander un nouveau lien</a>
-            </>
-        )}
-      </div>
+      {status === "verifying" && (
+        <>
+          <h1 className="text-xl font-serif text-[#5C4033] mb-4">
+            Vérification en cours...
+          </h1>
+          <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#5C4033] mx-auto"></div>
+        </>
+      )}
+      {status === "success" && (
+        <>
+          <h1 className="text-xl font-serif text-[#5C4033] mb-4">
+            Connexion réussie !
+          </h1>
+          <p className="text-gray-600">Redirection vers la boutique...</p>
+        </>
+      )}
+      {status === "error" && (
+        <>
+          <h1 className="text-xl font-serif text-red-800 mb-4">
+            Lien invalide ou expiré
+          </h1>
+          <p className="text-gray-600 mb-6">
+            Ce lien de connexion n'est plus valide ou a déjà été utilisé.
+          </p>
+          <a
+            href="/auth/magic-link-request"
+            className="text-[#5C4033] underline"
+          >
+            Demander un nouveau lien
+          </a>
+        </>
+      )}
+    </div>
   );
 }
 
 export default function VerifyPage() {
   return (
     <div className="min-h-screen bg-[#F9F7F2] flex items-center justify-center p-4">
-      <Suspense fallback={<div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#5C4033]"></div>}>
+      <Suspense
+        fallback={
+          <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#5C4033]"></div>
+        }
+      >
         <VerifyContent />
       </Suspense>
     </div>
diff --git a/src/app/checkout/page.tsx b/src/app/checkout/page.tsx
index 819ce2d..d1bfcf4 100644
--- a/src/app/checkout/page.tsx
+++ b/src/app/checkout/page.tsx
@@ -6,580 +6,688 @@ import { useLanguage } from "@/components/LanguageProvider";
 import { useRouter } from "next/navigation";
 import Image from "next/image";
 import Link from "next/link";
-import { deliveryRates, getDeliveryPrice, DeliveryProvider, DeliveryType } from "@/lib/delivery-data";
+import {
+  deliveryRates,
+  getDeliveryPrice,
+  DeliveryProvider,
+  DeliveryType,
+} from "@/lib/delivery-data";
 import { cn } from "@/lib/utils";
-import { 
-    ShoppingBag, 
-    User, 
-    MapPin, 
-    Truck, 
-    CreditCard, 
-    ChevronRight,
-    Phone,
-    Home,
-    Building2,
-    Package,
-    Shield,
-    Clock,
-    CheckCircle2,
-    ArrowLeft,
-    Loader2,
-    Lock
+import {
+  ShoppingBag,
+  User,
+  MapPin,
+  Truck,
+  CreditCard,
+  ChevronRight,
+  Phone,
+  Home,
+  Building2,
+  Package,
+  Shield,
+  Clock,
+  CheckCircle2,
+  ArrowLeft,
+  Loader2,
+  Lock,
 } from "lucide-react";
 
 export default function CheckoutPage() {
-    const { items, total, clearCart } = useCart();
-    const { t } = useLanguage();
-    const router = useRouter();
-    const [isSubmitting, setIsSubmitting] = useState(false);
-    const [currentStep, setCurrentStep] = useState(1);
+  const { items, total, clearCart } = useCart();
+  const { t } = useLanguage();
+  const router = useRouter();
+  const [isSubmitting, setIsSubmitting] = useState(false);
+  const [currentStep, setCurrentStep] = useState(1);
 
-    const [formData, setFormData] = useState({
-        firstName: "",
-        lastName: "",
-        phone: "",
-        address: "",
-        city: "",
-        wilaya: "",
-    });
+  const [formData, setFormData] = useState({
+    firstName: "",
+    lastName: "",
+    phone: "",
+    address: "",
+    city: "",
+    wilaya: "",
+  });
 
-    const [deliveryProvider, setDeliveryProvider] = useState<DeliveryProvider>("Yalidine");
-    const [deliveryType, setDeliveryType] = useState<DeliveryType>("HOME");
-    const [shippingPrice, setShippingPrice] = useState(0);
-    const [communes, setCommunes] = useState<{ id: number; name: string }[]>([]);
-    const [loadingCommunes, setLoadingCommunes] = useState(false);
-    const [stopDeskCenters, setStopDeskCenters] = useState<{ id: number; name: string; address: string; commune: string }[]>([]);
-    const [selectedStopDesk, setSelectedStopDesk] = useState<string>("");
-    const [loadingStopDesks, setLoadingStopDesks] = useState(false);
+  const [deliveryProvider, setDeliveryProvider] =
+    useState<DeliveryProvider>("Yalidine");
+  const [deliveryType, setDeliveryType] = useState<DeliveryType>("HOME");
+  const [shippingPrice, setShippingPrice] = useState(0);
+  const [communes, setCommunes] = useState<{ id: number; name: string }[]>([]);
+  const [loadingCommunes, setLoadingCommunes] = useState(false);
+  const [stopDeskCenters, setStopDeskCenters] = useState<
+    { id: number; name: string; address: string; commune: string }[]
+  >([]);
+  const [selectedStopDesk, setSelectedStopDesk] = useState<string>("");
+  const [loadingStopDesks, setLoadingStopDesks] = useState(false);
 
-    // Fetch communes when wilaya changes
-    useEffect(() => {
-        if (formData.wilaya) {
-            const price = getDeliveryPrice(parseInt(formData.wilaya), deliveryProvider, deliveryType);
-            setShippingPrice(price);
-            
-            // Fetch communes from Yalidine
-            setLoadingCommunes(true);
-            fetch(`/api/shipping/yalidine?action=communes&wilaya_id=${formData.wilaya}`)
-                .then(res => res.json())
-                .then(data => {
-                    if (data.data && Array.isArray(data.data)) {
-                        setCommunes(data.data.map((c: any) => ({ 
-                            id: c.id, 
-                            name: c.name 
-                        })));
-                    }
-                })
-                .catch(err => console.error('Error fetching communes:', err))
-                .finally(() => setLoadingCommunes(false));
-                
-            // Reset city when wilaya changes
-            setFormData(prev => ({ ...prev, city: '' }));
-        } else {
-            setCommunes([]);
-        }
-    }, [formData.wilaya, deliveryProvider, deliveryType]);
+  // Fetch communes when wilaya changes
+  useEffect(() => {
+    if (formData.wilaya) {
+      const price = getDeliveryPrice(
+        parseInt(formData.wilaya),
+        deliveryProvider,
+        deliveryType,
+      );
+      setShippingPrice(price);
 
-    // Fetch stop desk centers when DESK delivery type selected
-    useEffect(() => {
-        if (formData.wilaya && deliveryType === 'DESK') {
-            setLoadingStopDesks(true);
-            setSelectedStopDesk('');
-            
-            if (deliveryProvider === 'Yalidine') {
-                // Fetch from Yalidine API
-                fetch(`/api/shipping/yalidine?action=centers&wilaya_id=${formData.wilaya}`)
-                    .then(res => res.json())
-                    .then(data => {
-                        if (data.data && Array.isArray(data.data)) {
-                            setStopDeskCenters(data.data.map((c: any) => ({
-                                id: c.center_id,
-                                name: c.name,
-                                address: c.address,
-                                commune: c.commune_name
-                            })));
-                        } else {
-                            setStopDeskCenters([]);
-                        }
-                    })
-                    .catch(err => {
-                        console.error('Error fetching Yalidine stop desks:', err);
-                        setStopDeskCenters([]);
-                    })
-                    .finally(() => setLoadingStopDesks(false));
-            } else if (deliveryProvider === 'ZR Express') {
-                // Fetch from local ZR Express data
-                fetch(`/api/shipping?action=stopdesks&wilaya_id=${formData.wilaya}`)
-                    .then(res => res.json())
-                    .then(data => {
-                        if (data.data && Array.isArray(data.data)) {
-                            setStopDeskCenters(data.data.map((c: any) => ({
-                                id: c.wilayaId * 100 + data.data.indexOf(c),
-                                name: c.centerName,
-                                address: c.address,
-                                commune: c.wilayaName
-                            })));
-                        } else {
-                            setStopDeskCenters([]);
-                        }
-                    })
-                    .catch(err => {
-                        console.error('Error fetching ZR Express stop desks:', err);
-                        setStopDeskCenters([]);
-                    })
-                    .finally(() => setLoadingStopDesks(false));
+      // Fetch communes from Yalidine
+      setLoadingCommunes(true);
+      fetch(
+        `/api/shipping/yalidine?action=communes&wilaya_id=${formData.wilaya}`,
+      )
+        .then((res) => res.json())
+        .then((data) => {
+          if (data.data && Array.isArray(data.data)) {
+            setCommunes(
+              data.data.map((c: any) => ({
+                id: c.id,
+                name: c.name,
+              })),
+            );
+          }
+        })
+        .catch((err) => console.error("Error fetching communes:", err))
+        .finally(() => setLoadingCommunes(false));
+
+      // Reset city when wilaya changes
+      setFormData((prev) => ({ ...prev, city: "" }));
+    } else {
+      setCommunes([]);
+    }
+  }, [formData.wilaya, deliveryProvider, deliveryType]);
+
+  // Fetch stop desk centers when DESK delivery type selected
+  useEffect(() => {
+    if (formData.wilaya && deliveryType === "DESK") {
+      setLoadingStopDesks(true);
+      setSelectedStopDesk("");
+
+      if (deliveryProvider === "Yalidine") {
+        // Fetch from Yalidine API
+        fetch(
+          `/api/shipping/yalidine?action=centers&wilaya_id=${formData.wilaya}`,
+        )
+          .then((res) => res.json())
+          .then((data) => {
+            if (data.data && Array.isArray(data.data)) {
+              setStopDeskCenters(
+                data.data.map((c: any) => ({
+                  id: c.center_id,
+                  name: c.name,
+                  address: c.address,
+                  commune: c.commune_name,
+                })),
+              );
+            } else {
+              setStopDeskCenters([]);
             }
-        } else {
+          })
+          .catch((err) => {
+            console.error("Error fetching Yalidine stop desks:", err);
             setStopDeskCenters([]);
-            setSelectedStopDesk('');
-        }
-    }, [formData.wilaya, deliveryProvider, deliveryType]);
-
-    // Update step based on form completion
-    useEffect(() => {
-        if (formData.firstName && formData.lastName && formData.phone) {
-            if (formData.address && formData.city && formData.wilaya) {
-                setCurrentStep(3);
+          })
+          .finally(() => setLoadingStopDesks(false));
+      } else if (deliveryProvider === "ZR Express") {
+        // Fetch from local ZR Express data
+        fetch(`/api/shipping?action=stopdesks&wilaya_id=${formData.wilaya}`)
+          .then((res) => res.json())
+          .then((data) => {
+            if (data.data && Array.isArray(data.data)) {
+              setStopDeskCenters(
+                data.data.map((c: any) => ({
+                  id: c.wilayaId * 100 + data.data.indexOf(c),
+                  name: c.centerName,
+                  address: c.address,
+                  commune: c.wilayaName,
+                })),
+              );
             } else {
-                setCurrentStep(2);
+              setStopDeskCenters([]);
             }
-        } else {
-            setCurrentStep(1);
-        }
-    }, [formData]);
+          })
+          .catch((err) => {
+            console.error("Error fetching ZR Express stop desks:", err);
+            setStopDeskCenters([]);
+          })
+          .finally(() => setLoadingStopDesks(false));
+      }
+    } else {
+      setStopDeskCenters([]);
+      setSelectedStopDesk("");
+    }
+  }, [formData.wilaya, deliveryProvider, deliveryType]);
 
-    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {
-        setFormData({ ...formData, [e.target.name]: e.target.value });
-    };
+  // Update step based on form completion
+  useEffect(() => {
+    if (formData.firstName && formData.lastName && formData.phone) {
+      if (formData.address && formData.city && formData.wilaya) {
+        setCurrentStep(3);
+      } else {
+        setCurrentStep(2);
+      }
+    } else {
+      setCurrentStep(1);
+    }
+  }, [formData]);
 
-    const handleSubmit = async (e: React.FormEvent) => {
-        e.preventDefault();
-        setIsSubmitting(true);
+  const handleChange = (
+    e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>,
+  ) => {
+    setFormData({ ...formData, [e.target.name]: e.target.value });
+  };
 
-        try {
-            // Get stop desk info if selected
-            const stopDeskInfo = selectedStopDesk 
-                ? stopDeskCenters.find(c => c.id.toString() === selectedStopDesk)
-                : null;
-            
-            const orderData = {
-                customerName: formData.firstName + " " + formData.lastName,
-                customerPhone: formData.phone,
-                customerAddress: stopDeskInfo 
-                    ? `Stop Desk: ${stopDeskInfo.name} - ${stopDeskInfo.address}`
-                    : formData.address,
-                customerCity: stopDeskInfo?.commune || formData.city,
-                customerWilaya: formData.wilaya,
-                deliveryProvider,
-                deliveryType,
-                shippingPrice,
-                stopDeskId: selectedStopDesk ? parseInt(selectedStopDesk) : null,
-                total: total + shippingPrice,
-                items: items.map((item) => ({
-                    productId: item.productId,
-                    productName: item.name,
-                    size: item.size,
-                    color: item.color,
-                    quantity: item.quantity,
-                    price: item.price,
-                })),
-            };
+  const handleSubmit = async (e: React.FormEvent) => {
+    e.preventDefault();
+    setIsSubmitting(true);
 
-            const response = await fetch("/api/orders", {
-                method: "POST",
-                headers: { "Content-Type": "application/json" },
-                body: JSON.stringify(orderData),
-            });
+    try {
+      // Get stop desk info if selected
+      const stopDeskInfo = selectedStopDesk
+        ? stopDeskCenters.find((c) => c.id.toString() === selectedStopDesk)
+        : null;
 
-            if (response.ok) {
-                clearCart();
-                router.push("/order-confirmation");
-            } else {
-                alert("Une erreur est survenue. Veuillez réessayer.");
-            }
-        } catch (error) {
-            console.error("Error submitting order:", error);
-            alert("Une erreur est survenue.");
-        } finally {
-            setIsSubmitting(false);
-        }
-    };
+      const orderData = {
+        customerName: formData.firstName + " " + formData.lastName,
+        customerPhone: formData.phone,
+        customerAddress: stopDeskInfo
+          ? `Stop Desk: ${stopDeskInfo.name} - ${stopDeskInfo.address}`
+          : formData.address,
+        customerCity: stopDeskInfo?.commune || formData.city,
+        customerWilaya: formData.wilaya,
+        deliveryProvider,
+        deliveryType,
+        shippingPrice,
+        stopDeskId: selectedStopDesk ? parseInt(selectedStopDesk) : null,
+        total: total + shippingPrice,
+        items: items.map((item) => ({
+          productId: item.productId,
+          productName: item.name,
+          size: item.size,
+          color: item.color,
+          quantity: item.quantity,
+          price: item.price,
+        })),
+      };
 
-    if (items.length === 0) {
-        return (
-            <div className="min-h-[80vh] flex flex-col items-center justify-center px-4 bg-white">
-                <ShoppingBag size={40} className="text-gray-300 mb-6" />
-                <h1 className="text-2xl font-serif font-medium mb-2 text-gray-900">Votre panier est vide</h1>
-                <Link 
-                    href="/shop" 
-                    className="mt-6 text-sm uppercase tracking-widest border-b border-gray-900 pb-1 hover:text-gray-600 hover:border-gray-600 transition-all"
-                >
-                    Retourner à la boutique
-                </Link>
-            </div>
-        );
+      const response = await fetch("/api/orders", {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify(orderData),
+      });
+
+      if (response.ok) {
+        clearCart();
+        router.push("/order-confirmation");
+      } else {
+        alert("Une erreur est survenue. Veuillez réessayer.");
+      }
+    } catch (error) {
+      console.error("Error submitting order:", error);
+      alert("Une erreur est survenue.");
+    } finally {
+      setIsSubmitting(false);
     }
+  };
 
+  if (items.length === 0) {
     return (
-        <div className="min-h-screen bg-white pt-24 pb-20">
-            {/* Minimal Header */}
-            <div className="border-b border-gray-100 pb-6 mb-12">
-                <div className="container mx-auto px-4">
-                    <div className="flex items-center justify-between">
-                        <h1 className="text-2xl font-serif font-medium text-gray-900">Validation</h1>
-                        <div className="flex items-center gap-2 text-xs text-gray-500 uppercase tracking-wider">
-                            <Lock size={14} className="text-green-600" />
-                            Paiement sécurisé
-                        </div>
-                    </div>
-                </div>
+      <div className="min-h-[80vh] flex flex-col items-center justify-center px-4 bg-white">
+        <ShoppingBag size={40} className="text-gray-300 mb-6" />
+        <h1 className="text-2xl font-serif font-medium mb-2 text-gray-900">
+          Votre panier est vide
+        </h1>
+        <Link
+          href="/shop"
+          className="mt-6 text-sm uppercase tracking-widest border-b border-gray-900 pb-1 hover:text-gray-600 hover:border-gray-600 transition-all"
+        >
+          Retourner à la boutique
+        </Link>
+      </div>
+    );
+  }
+
+  return (
+    <div className="min-h-screen bg-white pt-24 pb-20">
+      {/* Minimal Header */}
+      <div className="border-b border-gray-100 pb-6 mb-12">
+        <div className="container mx-auto px-4">
+          <div className="flex items-center justify-between">
+            <h1 className="text-2xl font-serif font-medium text-gray-900">
+              Validation
+            </h1>
+            <div className="flex items-center gap-2 text-xs text-gray-500 uppercase tracking-wider">
+              <Lock size={14} className="text-green-600" />
+              Paiement sécurisé
             </div>
+          </div>
+        </div>
+      </div>
+
+      <div className="container mx-auto px-4">
+        <div className="grid grid-cols-1 lg:grid-cols-12 gap-12 max-w-7xl mx-auto">
+          {/* Form Section */}
+          <div className="lg:col-span-7 space-y-12">
+            <form
+              id="checkout-form"
+              onSubmit={handleSubmit}
+              className="space-y-12"
+            >
+              {/* Personal Info */}
+              <div>
+                <h2 className="text-lg font-serif font-medium text-gray-900 mb-6 flex items-center gap-3">
+                  <span className="w-6 h-6 rounded-full bg-gray-900 text-white text-xs flex items-center justify-center font-sans">
+                    1
+                  </span>
+                  Informations
+                </h2>
+                <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
+                  <div className="space-y-2">
+                    <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                      Prénom
+                    </label>
+                    <input
+                      required
+                      name="firstName"
+                      value={formData.firstName}
+                      onChange={handleChange}
+                      className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
+                      placeholder="Votre prénom"
+                    />
+                  </div>
+                  <div className="space-y-2">
+                    <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                      Nom
+                    </label>
+                    <input
+                      required
+                      name="lastName"
+                      value={formData.lastName}
+                      onChange={handleChange}
+                      className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
+                      placeholder="Votre nom"
+                    />
+                  </div>
+                  <div className="sm:col-span-2 space-y-2">
+                    <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                      Téléphone
+                    </label>
+                    <input
+                      required
+                      name="phone"
+                      type="tel"
+                      value={formData.phone}
+                      onChange={handleChange}
+                      className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
+                      placeholder="05 XX XX XX XX"
+                    />
+                  </div>
+                </div>
+              </div>
 
-            <div className="container mx-auto px-4">
-                <div className="grid grid-cols-1 lg:grid-cols-12 gap-12 max-w-7xl mx-auto">
-                    {/* Form Section */}
-                    <div className="lg:col-span-7 space-y-12">
-                        <form id="checkout-form" onSubmit={handleSubmit} className="space-y-12">
-                            {/* Personal Info */}
-                            <div>
-                                <h2 className="text-lg font-serif font-medium text-gray-900 mb-6 flex items-center gap-3">
-                                    <span className="w-6 h-6 rounded-full bg-gray-900 text-white text-xs flex items-center justify-center font-sans">1</span>
-                                    Informations
-                                </h2>
-                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
-                                    <div className="space-y-2">
-                                        <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Prénom</label>
-                                        <input
-                                            required
-                                            name="firstName"
-                                            value={formData.firstName}
-                                            onChange={handleChange}
-                                            className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
-                                            placeholder="Votre prénom"
-                                        />
-                                    </div>
-                                    <div className="space-y-2">
-                                        <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Nom</label>
-                                        <input
-                                            required
-                                            name="lastName"
-                                            value={formData.lastName}
-                                            onChange={handleChange}
-                                            className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
-                                            placeholder="Votre nom"
-                                        />
-                                    </div>
-                                    <div className="sm:col-span-2 space-y-2">
-                                        <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Téléphone</label>
-                                        <input
-                                            required
-                                            name="phone"
-                                            type="tel"
-                                            value={formData.phone}
-                                            onChange={handleChange}
-                                            className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
-                                            placeholder="05 XX XX XX XX"
-                                        />
-                                    </div>
-                                </div>
-                            </div>
+              {/* Address */}
+              <div>
+                <h2 className="text-lg font-serif font-medium text-gray-900 mb-6 flex items-center gap-3">
+                  <span className="w-6 h-6 rounded-full bg-gray-900 text-white text-xs flex items-center justify-center font-sans">
+                    2
+                  </span>
+                  Livraison
+                </h2>
+                <div className="space-y-6">
+                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
+                    <div className="space-y-2">
+                      <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                        Wilaya
+                      </label>
+                      <select
+                        required
+                        name="wilaya"
+                        value={formData.wilaya}
+                        onChange={handleChange}
+                        className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors cursor-pointer"
+                      >
+                        <option value="">Sélectionner</option>
+                        {deliveryRates.map((rate) => (
+                          <option key={rate.wilayaCode} value={rate.wilayaCode}>
+                            {rate.wilayaCode} - {rate.wilayaName}
+                          </option>
+                        ))}
+                      </select>
+                    </div>
+                    <div className="space-y-2">
+                      <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                        Commune
+                      </label>
+                      <select
+                        required
+                        name="city"
+                        value={formData.city}
+                        onChange={handleChange}
+                        disabled={!formData.wilaya || loadingCommunes}
+                        className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors cursor-pointer disabled:opacity-50"
+                      >
+                        <option value="">
+                          {loadingCommunes ? "Chargement..." : "Sélectionner"}
+                        </option>
+                        {communes.map((commune) => (
+                          <option key={commune.id} value={commune.name}>
+                            {commune.name}
+                          </option>
+                        ))}
+                      </select>
+                    </div>
+                  </div>
+                  <div className="space-y-2">
+                    <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                      Adresse
+                    </label>
+                    <input
+                      required
+                      name="address"
+                      value={formData.address}
+                      onChange={handleChange}
+                      className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
+                      placeholder="Cité, rue, n°..."
+                    />
+                  </div>
+                </div>
+              </div>
 
-                            {/* Address */}
-                            <div>
-                                <h2 className="text-lg font-serif font-medium text-gray-900 mb-6 flex items-center gap-3">
-                                    <span className="w-6 h-6 rounded-full bg-gray-900 text-white text-xs flex items-center justify-center font-sans">2</span>
-                                    Livraison
-                                </h2>
-                                <div className="space-y-6">
-                                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
-                                        <div className="space-y-2">
-                                            <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Wilaya</label>
-                                            <select
-                                                required
-                                                name="wilaya"
-                                                value={formData.wilaya}
-                                                onChange={handleChange}
-                                                className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors cursor-pointer"
-                                            >
-                                                <option value="">Sélectionner</option>
-                                                {deliveryRates.map((rate) => (
-                                                    <option key={rate.wilayaCode} value={rate.wilayaCode}>
-                                                        {rate.wilayaCode} - {rate.wilayaName}
-                                                    </option>
-                                                ))}
-                                            </select>
-                                        </div>
-                                        <div className="space-y-2">
-                                            <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Commune</label>
-                                            <select
-                                                required
-                                                name="city"
-                                                value={formData.city}
-                                                onChange={handleChange}
-                                                disabled={!formData.wilaya || loadingCommunes}
-                                                className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors cursor-pointer disabled:opacity-50"
-                                            >
-                                                <option value="">
-                                                    {loadingCommunes ? "Chargement..." : "Sélectionner"}
-                                                </option>
-                                                {communes.map((commune) => (
-                                                    <option key={commune.id} value={commune.name}>
-                                                        {commune.name}
-                                                    </option>
-                                                ))}
-                                            </select>
-                                        </div>
-                                    </div>
-                                    <div className="space-y-2">
-                                        <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Adresse</label>
-                                        <input
-                                            required
-                                            name="address"
-                                            value={formData.address}
-                                            onChange={handleChange}
-                                            className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
-                                            placeholder="Cité, rue, n°..."
-                                        />
-                                    </div>
-                                </div>
-                            </div>
+              {/* Delivery Options */}
+              <div>
+                <h2 className="text-lg font-serif font-medium text-gray-900 mb-6 flex items-center gap-3">
+                  <span className="w-6 h-6 rounded-full bg-gray-900 text-white text-xs flex items-center justify-center font-sans">
+                    3
+                  </span>
+                  Mode de livraison
+                </h2>
 
-                            {/* Delivery Options */}
-                            <div>
-                                <h2 className="text-lg font-serif font-medium text-gray-900 mb-6 flex items-center gap-3">
-                                    <span className="w-6 h-6 rounded-full bg-gray-900 text-white text-xs flex items-center justify-center font-sans">3</span>
-                                    Mode de livraison
-                                </h2>
-                                
-                                <div className="space-y-6">
-                                    {/* Delivery Provider Selection */}
-                                    <div>
-                                        <label className="text-xs font-bold uppercase tracking-wider text-gray-500 mb-3 block">Transporteur</label>
-                                        <div className="grid grid-cols-2 gap-4">
-                                            <button
-                                                type="button"
-                                                onClick={() => setDeliveryProvider("Yalidine")}
-                                                className={cn(
-                                                    "p-4 border transition-all rounded-xl flex items-center gap-3",
-                                                    deliveryProvider === "Yalidine"
-                                                        ? "border-harp-brown bg-harp-cream/50 ring-1 ring-harp-brown"
-                                                        : "border-gray-200 hover:border-harp-caramel hover:bg-gray-50"
-                                                )}
-                                            >
-                                                <div className="w-12 h-12 relative shrink-0">
-                                                    <Image
-                                                        src="/logo yalidine.webp"
-                                                        alt="Yalidine"
-                                                        fill
-                                                        className="object-contain"
-                                                    />
-                                                </div>
-                                                <div className="text-left flex-1">
-                                                    <span className="block text-sm font-semibold text-gray-900">Yalidine</span>
-                                                </div>
-                                                {deliveryProvider === "Yalidine" && (
-                                                    <CheckCircle2 size={18} className="text-harp-brown" />
-                                                )}
-                                            </button>
-                                            <button
-                                                type="button"
-                                                onClick={() => setDeliveryProvider("ZR Express")}
-                                                className={cn(
-                                                    "p-4 border transition-all rounded-xl flex items-center gap-3",
-                                                    deliveryProvider === "ZR Express"
-                                                        ? "border-harp-brown bg-harp-cream/50 ring-1 ring-harp-brown"
-                                                        : "border-gray-200 hover:border-harp-caramel hover:bg-gray-50"
-                                                )}
-                                            >
-                                                <div className="w-12 h-12 relative shrink-0">
-                                                    <Image
-                                                        src="/logo zrexpress.webp"
-                                                        alt="ZR Express"
-                                                        fill
-                                                        className="object-contain"
-                                                    />
-                                                </div>
-                                                <div className="text-left flex-1">
-                                                    <span className="block text-sm font-semibold text-gray-900">ZR Express</span>
-                                                </div>
-                                                {deliveryProvider === "ZR Express" && (
-                                                    <CheckCircle2 size={18} className="text-harp-brown" />
-                                                )}
-                                            </button>
-                                        </div>
-                                    </div>
+                <div className="space-y-6">
+                  {/* Delivery Provider Selection */}
+                  <div>
+                    <label className="text-xs font-bold uppercase tracking-wider text-gray-500 mb-3 block">
+                      Transporteur
+                    </label>
+                    <div className="grid grid-cols-2 gap-4">
+                      <button
+                        type="button"
+                        onClick={() => setDeliveryProvider("Yalidine")}
+                        className={cn(
+                          "p-4 border transition-all rounded-xl flex items-center gap-3",
+                          deliveryProvider === "Yalidine"
+                            ? "border-harp-brown bg-harp-cream/50 ring-1 ring-harp-brown"
+                            : "border-gray-200 hover:border-harp-caramel hover:bg-gray-50",
+                        )}
+                      >
+                        <div className="w-12 h-12 relative shrink-0">
+                          <Image
+                            src="/logo yalidine.webp"
+                            alt="Yalidine"
+                            fill
+                            className="object-contain"
+                          />
+                        </div>
+                        <div className="text-left flex-1">
+                          <span className="block text-sm font-semibold text-gray-900">
+                            Yalidine
+                          </span>
+                        </div>
+                        {deliveryProvider === "Yalidine" && (
+                          <CheckCircle2 size={18} className="text-harp-brown" />
+                        )}
+                      </button>
+                      <button
+                        type="button"
+                        onClick={() => setDeliveryProvider("ZR Express")}
+                        className={cn(
+                          "p-4 border transition-all rounded-xl flex items-center gap-3",
+                          deliveryProvider === "ZR Express"
+                            ? "border-harp-brown bg-harp-cream/50 ring-1 ring-harp-brown"
+                            : "border-gray-200 hover:border-harp-caramel hover:bg-gray-50",
+                        )}
+                      >
+                        <div className="w-12 h-12 relative shrink-0">
+                          <Image
+                            src="/logo zrexpress.webp"
+                            alt="ZR Express"
+                            fill
+                            className="object-contain"
+                          />
+                        </div>
+                        <div className="text-left flex-1">
+                          <span className="block text-sm font-semibold text-gray-900">
+                            ZR Express
+                          </span>
+                        </div>
+                        {deliveryProvider === "ZR Express" && (
+                          <CheckCircle2 size={18} className="text-harp-brown" />
+                        )}
+                      </button>
+                    </div>
+                  </div>
 
-                                    {/* Delivery Type Selection */}
-                                    <div>
-                                        <label className="text-xs font-bold uppercase tracking-wider text-gray-500 mb-3 block">Type de livraison</label>
-                                        <div className="grid grid-cols-2 gap-4">
-                                            <button
-                                                type="button"
-                                                onClick={() => setDeliveryType("HOME")}
-                                                className={cn(
-                                                    "p-5 text-left border transition-all rounded-xl",
-                                                    deliveryType === "HOME"
-                                                        ? "border-harp-brown bg-harp-cream/50 ring-1 ring-harp-brown"
-                                                        : "border-gray-200 hover:border-harp-caramel hover:bg-gray-50"
-                                                )}
-                                            >
-                                                <Home size={20} className={cn("mb-2", deliveryType === "HOME" ? "text-harp-brown" : "text-gray-400")} />
-                                                <span className="block text-sm font-medium text-gray-900 mb-1">À Domicile</span>
-                                                <span className="block text-xs text-gray-500">Livré chez vous</span>
-                                            </button>
-                                            <button
-                                                type="button"
-                                                onClick={() => setDeliveryType("DESK")}
-                                                className={cn(
-                                                    "p-5 text-left border transition-all rounded-xl",
-                                                    deliveryType === "DESK"
-                                                        ? "border-harp-brown bg-harp-cream/50 ring-1 ring-harp-brown"
-                                                        : "border-gray-200 hover:border-harp-caramel hover:bg-gray-50"
-                                                )}
-                                            >
-                                                <Building2 size={20} className={cn("mb-2", deliveryType === "DESK" ? "text-harp-brown" : "text-gray-400")} />
-                                                <span className="block text-sm font-medium text-gray-900 mb-1">Point Relais</span>
-                                                <span className="block text-xs text-gray-500">Stop Desk</span>
-                                            </button>
-                                        </div>
-                                    </div>
+                  {/* Delivery Type Selection */}
+                  <div>
+                    <label className="text-xs font-bold uppercase tracking-wider text-gray-500 mb-3 block">
+                      Type de livraison
+                    </label>
+                    <div className="grid grid-cols-2 gap-4">
+                      <button
+                        type="button"
+                        onClick={() => setDeliveryType("HOME")}
+                        className={cn(
+                          "p-5 text-left border transition-all rounded-xl",
+                          deliveryType === "HOME"
+                            ? "border-harp-brown bg-harp-cream/50 ring-1 ring-harp-brown"
+                            : "border-gray-200 hover:border-harp-caramel hover:bg-gray-50",
+                        )}
+                      >
+                        <Home
+                          size={20}
+                          className={cn(
+                            "mb-2",
+                            deliveryType === "HOME"
+                              ? "text-harp-brown"
+                              : "text-gray-400",
+                          )}
+                        />
+                        <span className="block text-sm font-medium text-gray-900 mb-1">
+                          À Domicile
+                        </span>
+                        <span className="block text-xs text-gray-500">
+                          Livré chez vous
+                        </span>
+                      </button>
+                      <button
+                        type="button"
+                        onClick={() => setDeliveryType("DESK")}
+                        className={cn(
+                          "p-5 text-left border transition-all rounded-xl",
+                          deliveryType === "DESK"
+                            ? "border-harp-brown bg-harp-cream/50 ring-1 ring-harp-brown"
+                            : "border-gray-200 hover:border-harp-caramel hover:bg-gray-50",
+                        )}
+                      >
+                        <Building2
+                          size={20}
+                          className={cn(
+                            "mb-2",
+                            deliveryType === "DESK"
+                              ? "text-harp-brown"
+                              : "text-gray-400",
+                          )}
+                        />
+                        <span className="block text-sm font-medium text-gray-900 mb-1">
+                          Point Relais
+                        </span>
+                        <span className="block text-xs text-gray-500">
+                          Stop Desk
+                        </span>
+                      </button>
+                    </div>
+                  </div>
 
-                                    {deliveryType === 'DESK' && formData.wilaya && (
-                                        <div className="space-y-2 animate-fade-in">
-                                            <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Point de retrait</label>
-                                            {loadingStopDesks ? (
-                                                <div className="flex items-center gap-2 text-sm text-gray-500 py-3">
-                                                    <Loader2 size={16} className="animate-spin" />
-                                                    Chargement...
-                                                </div>
-                                            ) : stopDeskCenters.length > 0 ? (
-                                                <select
-                                                    value={selectedStopDesk}
-                                                    onChange={(e) => setSelectedStopDesk(e.target.value)}
-                                                    className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors cursor-pointer"
-                                                    required
-                                                >
-                                                    <option value="">Choisir un bureau</option>
-                                                    {stopDeskCenters.map((center) => (
-                                                        <option key={center.id} value={center.id}>
-                                                            {center.name} - {center.commune}
-                                                        </option>
-                                                    ))}
-                                                </select>
-                                            ) : (
-                                                <p className="text-sm text-red-500 py-2">
-                                                    Aucun point de retrait disponible. Veuillez choisir la livraison à domicile.
-                                                </p>
-                                            )}
-                                        </div>
-                                    )}
-                                </div>
-                            </div>
-                        </form>
+                  {deliveryType === "DESK" && formData.wilaya && (
+                    <div className="space-y-2 animate-fade-in">
+                      <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                        Point de retrait
+                      </label>
+                      {loadingStopDesks ? (
+                        <div className="flex items-center gap-2 text-sm text-gray-500 py-3">
+                          <Loader2 size={16} className="animate-spin" />
+                          Chargement...
+                        </div>
+                      ) : stopDeskCenters.length > 0 ? (
+                        <select
+                          value={selectedStopDesk}
+                          onChange={(e) => setSelectedStopDesk(e.target.value)}
+                          className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors cursor-pointer"
+                          required
+                        >
+                          <option value="">Choisir un bureau</option>
+                          {stopDeskCenters.map((center) => (
+                            <option key={center.id} value={center.id}>
+                              {center.name} - {center.commune}
+                            </option>
+                          ))}
+                        </select>
+                      ) : (
+                        <p className="text-sm text-red-500 py-2">
+                          Aucun point de retrait disponible. Veuillez choisir la
+                          livraison à domicile.
+                        </p>
+                      )}
                     </div>
+                  )}
+                </div>
+              </div>
+            </form>
+          </div>
 
-                    {/* Order Summary - Sticky */}
-                    <div className="lg:col-span-5">
-                        <div className="lg:sticky lg:top-32 bg-[#F9F9F9] p-8 rounded-sm">
-                            <h2 className="font-serif font-medium text-gray-900 mb-6">Récapitulatif</h2>
-                            
-                            <div className="space-y-6 mb-8">
-                                {items.map((item) => (
-                                    <div key={`${item.productId}-${item.size}-${item.color}`} className="flex gap-4">
-                                        <div className="relative w-16 h-20 bg-white shrink-0 overflow-hidden">
-                                            <Image
-                                                src={item.image}
-                                                alt={item.name}
-                                                fill
-                                                className="object-cover"
-                                            />
-                                        </div>
-                                        <div className="flex-1">
-                                            <p className="text-sm font-medium text-gray-900">{item.name}</p>
-                                            <p className="text-xs text-gray-500 mt-1">
-                                                {item.size} / {item.color}
-                                            </p>
-                                            <div className="flex justify-between items-center mt-2">
-                                                <p className="text-xs text-gray-500">Qté: {item.quantity}</p>
-                                                <p className="text-sm font-medium text-gray-900">
-                                                    {item.price.toLocaleString()} DZD
-                                                </p>
-                                            </div>
-                                        </div>
-                                    </div>
-                                ))}
-                            </div>
+          {/* Order Summary - Sticky */}
+          <div className="lg:col-span-5">
+            <div className="lg:sticky lg:top-32 bg-[#F9F9F9] p-8 rounded-sm">
+              <h2 className="font-serif font-medium text-gray-900 mb-6">
+                Récapitulatif
+              </h2>
 
-                            {/* Price Breakdown */}
-                            <div className="border-t border-gray-200 pt-4 mb-6 space-y-3">
-                                <div className="flex justify-between text-sm">
-                                    <span className="text-gray-500">Sous-total</span>
-                                    <span className="text-gray-900">{total.toLocaleString()} DZD</span>
-                                </div>
-                                <div className="flex justify-between text-sm">
-                                    <span className="text-gray-500 flex items-center gap-2">
-                                        Livraison
-                                        {formData.wilaya && (
-                                            <span className="text-[10px] bg-harp-cream text-harp-brown px-2 py-0.5 rounded-full">
-                                                {deliveryProvider}
-                                            </span>
-                                        )}
-                                    </span>
-                                    <span className="text-gray-900">
-                                        {formData.wilaya ? `${shippingPrice.toLocaleString()} DZD` : "—"}
-                                    </span>
-                                </div>
-                                <div className="flex justify-between text-base font-semibold pt-2 border-t border-gray-200">
-                                    <span className="text-gray-900">Total</span>
-                                    <span className="text-harp-brown">{(total + shippingPrice).toLocaleString()} DZD</span>
-                                </div>
-                            </div>
+              <div className="space-y-6 mb-8">
+                {items.map((item) => (
+                  <div
+                    key={`${item.productId}-${item.size}-${item.color}`}
+                    className="flex gap-4"
+                  >
+                    <div className="relative w-16 h-20 bg-white shrink-0 overflow-hidden">
+                      <Image
+                        src={item.image}
+                        alt={item.name}
+                        fill
+                        className="object-cover"
+                      />
+                    </div>
+                    <div className="flex-1">
+                      <p className="text-sm font-medium text-gray-900">
+                        {item.name}
+                      </p>
+                      <p className="text-xs text-gray-500 mt-1">
+                        {item.size} / {item.color}
+                      </p>
+                      <div className="flex justify-between items-center mt-2">
+                        <p className="text-xs text-gray-500">
+                          Qté: {item.quantity}
+                        </p>
+                        <p className="text-sm font-medium text-gray-900">
+                          {item.price.toLocaleString()} DZD
+                        </p>
+                      </div>
+                    </div>
+                  </div>
+                ))}
+              </div>
 
-                            {/* Submit Button */}
-                            <button
-                                type="submit"
-                                form="checkout-form"
-                                disabled={isSubmitting || !formData.wilaya}
-                                className="w-full bg-harp-brown text-white py-4 rounded-xl font-medium hover:bg-harp-caramel transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-harp-brown/20"
-                            >
-                                {isSubmitting ? (
-                                    <>
-                                        <Loader2 size={20} className="animate-spin" />
-                                        Validation en cours...
-                                    </>
-                                ) : (
-                                    <>
-                                        Confirmer la commande
-                                        <ChevronRight size={20} />
-                                    </>
-                                )}
-                            </button>
+              {/* Price Breakdown */}
+              <div className="border-t border-gray-200 pt-4 mb-6 space-y-3">
+                <div className="flex justify-between text-sm">
+                  <span className="text-gray-500">Sous-total</span>
+                  <span className="text-gray-900">
+                    {total.toLocaleString()} DZD
+                  </span>
+                </div>
+                <div className="flex justify-between text-sm">
+                  <span className="text-gray-500 flex items-center gap-2">
+                    Livraison
+                    {formData.wilaya && (
+                      <span className="text-[10px] bg-harp-cream text-harp-brown px-2 py-0.5 rounded-full">
+                        {deliveryProvider}
+                      </span>
+                    )}
+                  </span>
+                  <span className="text-gray-900">
+                    {formData.wilaya
+                      ? `${shippingPrice.toLocaleString()} DZD`
+                      : "—"}
+                  </span>
+                </div>
+                <div className="flex justify-between text-base font-semibold pt-2 border-t border-gray-200">
+                  <span className="text-gray-900">Total</span>
+                  <span className="text-harp-brown">
+                    {(total + shippingPrice).toLocaleString()} DZD
+                  </span>
+                </div>
+              </div>
 
-                            {/* Trust Badges */}
-                            <div className="bg-gradient-to-r from-harp-cream to-harp-beige rounded-xl p-4 border border-harp-beige">
-                                <div className="flex items-center gap-3 text-harp-brown">
-                                    <CreditCard size={20} />
-                                    <div>
-                                        <p className="font-medium text-sm">Paiement à la livraison</p>
-                                        <p className="text-xs text-harp-brown">Cash on Delivery (COD)</p>
-                                    </div>
-                                </div>
-                            </div>
+              {/* Submit Button */}
+              <button
+                type="submit"
+                form="checkout-form"
+                disabled={isSubmitting || !formData.wilaya}
+                className="w-full bg-harp-brown text-white py-4 rounded-xl font-medium hover:bg-harp-caramel transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-harp-brown/20"
+              >
+                {isSubmitting ? (
+                  <>
+                    <Loader2 size={20} className="animate-spin" />
+                    Validation en cours...
+                  </>
+                ) : (
+                  <>
+                    Confirmer la commande
+                    <ChevronRight size={20} />
+                  </>
+                )}
+              </button>
 
-                            <div className="grid grid-cols-2 gap-3">
-                                <div className="bg-gray-50 rounded-xl p-3 text-center">
-                                    <Clock size={18} className="mx-auto text-gray-500 mb-1" />
-                                    <p className="text-xs font-medium text-gray-700">Livraison 24-72h</p>
-                                </div>
-                                <div className="bg-gray-50 rounded-xl p-3 text-center">
-                                    <Shield size={18} className="mx-auto text-gray-500 mb-1" />
-                                    <p className="text-xs font-medium text-gray-700">Achat sécurisé</p>
-                                </div>
-                            </div>
-                        </div>
-                    </div>
+              {/* Trust Badges */}
+              <div className="bg-gradient-to-r from-harp-cream to-harp-beige rounded-xl p-4 border border-harp-beige">
+                <div className="flex items-center gap-3 text-harp-brown">
+                  <CreditCard size={20} />
+                  <div>
+                    <p className="font-medium text-sm">
+                      Paiement à la livraison
+                    </p>
+                    <p className="text-xs text-harp-brown">
+                      Cash on Delivery (COD)
+                    </p>
+                  </div>
+                </div>
+              </div>
+
+              <div className="grid grid-cols-2 gap-3">
+                <div className="bg-gray-50 rounded-xl p-3 text-center">
+                  <Clock size={18} className="mx-auto text-gray-500 mb-1" />
+                  <p className="text-xs font-medium text-gray-700">
+                    Livraison 24-72h
+                  </p>
                 </div>
+                <div className="bg-gray-50 rounded-xl p-3 text-center">
+                  <Shield size={18} className="mx-auto text-gray-500 mb-1" />
+                  <p className="text-xs font-medium text-gray-700">
+                    Achat sécurisé
+                  </p>
+                </div>
+              </div>
             </div>
+          </div>
         </div>
-    );
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/contact/page.tsx b/src/app/contact/page.tsx
index 8a83a52..24e43e8 100644
--- a/src/app/contact/page.tsx
+++ b/src/app/contact/page.tsx
@@ -3,280 +3,328 @@
 import { useState } from "react";
 import { useLanguage } from "@/components/LanguageProvider";
 import Image from "next/image";
-import { Mail, MapPin, Instagram, Facebook, MessageCircle, Clock, CheckCircle, Send, ArrowRight } from "lucide-react";
+import {
+  Mail,
+  MapPin,
+  Instagram,
+  Facebook,
+  MessageCircle,
+  Clock,
+  CheckCircle,
+  Send,
+  ArrowRight,
+} from "lucide-react";
 import { siteConfig, getWhatsAppLink } from "@/lib/config";
 
-const TikTokIcon = ({ size = 24, className = "" }: { size?: number | string, className?: string }) => (
-    <svg
-        width={size}
-        height={size}
-        viewBox="0 0 24 24"
-        fill="none"
-        stroke="currentColor"
-        strokeWidth="2"
-        strokeLinecap="round"
-        strokeLinejoin="round"
-        className={className}
-    >
-        <path d="M9 12a4 4 0 1 0 4 4V4a5 5 0 0 0 5 5" />
-    </svg>
+const TikTokIcon = ({
+  size = 24,
+  className = "",
+}: {
+  size?: number | string;
+  className?: string;
+}) => (
+  <svg
+    width={size}
+    height={size}
+    viewBox="0 0 24 24"
+    fill="none"
+    stroke="currentColor"
+    strokeWidth="2"
+    strokeLinecap="round"
+    strokeLinejoin="round"
+    className={className}
+  >
+    <path d="M9 12a4 4 0 1 0 4 4V4a5 5 0 0 0 5 5" />
+  </svg>
 );
 
 export default function ContactPage() {
-    const { t } = useLanguage();
-    const [formState, setFormState] = useState({
-        name: "",
-        email: "",
-        phone: "",
-        subject: "",
-        message: ""
-    });
-    const [isSubmitting, setIsSubmitting] = useState(false);
-    const [isSubmitted, setIsSubmitted] = useState(false);
+  const { t } = useLanguage();
+  const [formState, setFormState] = useState({
+    name: "",
+    email: "",
+    phone: "",
+    subject: "",
+    message: "",
+  });
+  const [isSubmitting, setIsSubmitting] = useState(false);
+  const [isSubmitted, setIsSubmitted] = useState(false);
 
-    const handleSubmit = async (e: React.FormEvent) => {
-        e.preventDefault();
-        setIsSubmitting(true);
+  const handleSubmit = async (e: React.FormEvent) => {
+    e.preventDefault();
+    setIsSubmitting(true);
 
-        // Simulate form submission
-        await new Promise(resolve => setTimeout(resolve, 1500));
+    // Simulate form submission
+    await new Promise((resolve) => setTimeout(resolve, 1500));
 
-        setIsSubmitting(false);
-        setIsSubmitted(true);
-        setFormState({ name: "", email: "", phone: "", subject: "", message: "" });
+    setIsSubmitting(false);
+    setIsSubmitted(true);
+    setFormState({ name: "", email: "", phone: "", subject: "", message: "" });
 
-        setTimeout(() => setIsSubmitted(false), 5000);
-    };
+    setTimeout(() => setIsSubmitted(false), 5000);
+  };
 
-    const contactMethods = [
-        {
-            icon: MessageCircle,
-            title: "WhatsApp",
-            value: siteConfig.whatsapp.display,
-            link: getWhatsAppLink(),
-            description: "Réponse rapide"
-        },
-        {
-            icon: Mail,
-            title: "Email",
-            value: "contact@harpalgeria.com",
-            link: "mailto:contact@harpalgeria.com",
-            description: "Pour toute question"
-        },
-        {
-            icon: Instagram,
-            title: "Instagram",
-            value: "@harp_algeria",
-            link: "https://instagram.com/harp_algeria",
-            description: "Suivez nos nouveautés"
-        },
-        {
-            icon: MapPin,
-            title: "Atelier",
-            value: "Alger, Algérie",
-            link: null,
-            description: "Siège social"
-        },
-    ];
+  const contactMethods = [
+    {
+      icon: MessageCircle,
+      title: "WhatsApp",
+      value: siteConfig.whatsapp.display,
+      link: getWhatsAppLink(),
+      description: "Réponse rapide",
+    },
+    {
+      icon: Mail,
+      title: "Email",
+      value: "contact@harpalgeria.com",
+      link: "mailto:contact@harpalgeria.com",
+      description: "Pour toute question",
+    },
+    {
+      icon: Instagram,
+      title: "Instagram",
+      value: "@harp_algeria",
+      link: "https://instagram.com/harp_algeria",
+      description: "Suivez nos nouveautés",
+    },
+    {
+      icon: MapPin,
+      title: "Atelier",
+      value: "Alger, Algérie",
+      link: null,
+      description: "Siège social",
+    },
+  ];
 
-    return (
-        <div className="min-h-screen bg-gradient-to-b from-harp-cream/30 to-white">
-            {/* Hero Section - Minimalist */}
-            <section className="relative pt-32 pb-16 md:pt-40 md:pb-20 bg-harp-sand/30">
-                <div className="container mx-auto px-4">
-                    <div className="max-w-3xl mx-auto text-center">
-                        <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
-                            Contact
-                        </span>
-                        <h1 className="text-4xl md:text-6xl font-serif font-medium text-gray-900 mb-6">
-                            Nous sommes à votre écoute.
-                        </h1>
-                        <p className="text-lg text-gray-500 leading-relaxed font-light max-w-xl mx-auto">
-                            Une question, une suggestion ou simplement envie de dire bonjour ?
-                            Notre équipe est là pour vous accompagner.
-                        </p>
-                    </div>
-                </div>
-            </section>
+  return (
+    <div className="min-h-screen bg-gradient-to-b from-harp-cream/30 to-white">
+      {/* Hero Section - Minimalist */}
+      <section className="relative pt-32 pb-16 md:pt-40 md:pb-20 bg-harp-sand/30">
+        <div className="container mx-auto px-4">
+          <div className="max-w-3xl mx-auto text-center">
+            <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
+              Contact
+            </span>
+            <h1 className="text-4xl md:text-6xl font-serif font-medium text-gray-900 mb-6">
+              Nous sommes à votre écoute.
+            </h1>
+            <p className="text-lg text-gray-500 leading-relaxed font-light max-w-xl mx-auto">
+              Une question, une suggestion ou simplement envie de dire bonjour ?
+              Notre équipe est là pour vous accompagner.
+            </p>
+          </div>
+        </div>
+      </section>
 
-            {/* Contact Methods Grid */}
-            <section className="py-16 md:py-24 border-b border-gray-100">
-                <div className="container mx-auto px-4">
-                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
-                        {contactMethods.map((method, index) => (
-                            <div key={index} className="group">
-                                <div className="mb-4 inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-gray-900 group-hover:bg-gray-900 group-hover:text-white transition-colors">
-                                    <method.icon size={20} />
-                                </div>
-                                <h3 className="font-serif font-medium text-xl text-gray-900 mb-2">{method.title}</h3>
-                                <p className="text-sm text-gray-500 mb-1">{method.description}</p>
-                                {method.link ? (
-                                    <a
-                                        href={method.link}
-                                        target="_blank"
-                                        rel="noopener noreferrer"
-                                        className="text-sm font-medium text-gray-900 border-b border-gray-200 pb-0.5 hover:border-gray-900 transition-colors inline-block mt-2"
-                                    >
-                                        {method.value}
-                                    </a>
-                                ) : (
-                                    <p className="text-sm font-medium text-gray-900 mt-2">{method.value}</p>
-                                )}
-                            </div>
-                        ))}
-                    </div>
+      {/* Contact Methods Grid */}
+      <section className="py-16 md:py-24 border-b border-gray-100">
+        <div className="container mx-auto px-4">
+          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
+            {contactMethods.map((method, index) => (
+              <div key={index} className="group">
+                <div className="mb-4 inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-gray-900 group-hover:bg-gray-900 group-hover:text-white transition-colors">
+                  <method.icon size={20} />
                 </div>
-            </section>
+                <h3 className="font-serif font-medium text-xl text-gray-900 mb-2">
+                  {method.title}
+                </h3>
+                <p className="text-sm text-gray-500 mb-1">
+                  {method.description}
+                </p>
+                {method.link ? (
+                  <a
+                    href={method.link}
+                    target="_blank"
+                    rel="noopener noreferrer"
+                    className="text-sm font-medium text-gray-900 border-b border-gray-200 pb-0.5 hover:border-gray-900 transition-colors inline-block mt-2"
+                  >
+                    {method.value}
+                  </a>
+                ) : (
+                  <p className="text-sm font-medium text-gray-900 mt-2">
+                    {method.value}
+                  </p>
+                )}
+              </div>
+            ))}
+          </div>
+        </div>
+      </section>
 
-            {/* Main Form Section */}
-            <section className="py-24">
-                <div className="container mx-auto px-4">
-                    <div className="grid grid-cols-1 lg:grid-cols-12 gap-16">
-                        {/* Left - Info & Hours */}
-                        <div className="lg:col-span-4 lg:col-start-2 space-y-12">
-                            <div>
-                                <h2 className="text-3xl font-serif font-medium text-gray-900 mb-6">
-                                    Envoyez-nous un message
-                                </h2>
-                                <p className="text-gray-500 font-light leading-relaxed">
-                                    Remplissez le formulaire ci-contre et nous vous répondrons dans les plus brefs délais.
-                                    Vous pouvez également nous contacter directement sur WhatsApp pour une réponse immédiate.
-                                </p>
-                            </div>
+      {/* Main Form Section */}
+      <section className="py-24">
+        <div className="container mx-auto px-4">
+          <div className="grid grid-cols-1 lg:grid-cols-12 gap-16">
+            {/* Left - Info & Hours */}
+            <div className="lg:col-span-4 lg:col-start-2 space-y-12">
+              <div>
+                <h2 className="text-3xl font-serif font-medium text-gray-900 mb-6">
+                  Envoyez-nous un message
+                </h2>
+                <p className="text-gray-500 font-light leading-relaxed">
+                  Remplissez le formulaire ci-contre et nous vous répondrons
+                  dans les plus brefs délais. Vous pouvez également nous
+                  contacter directement sur WhatsApp pour une réponse immédiate.
+                </p>
+              </div>
 
-                            <div className="space-y-8">
-                                <div>
-                                    <h4 className="text-sm font-bold uppercase tracking-widest text-gray-900 mb-3">Horaires Service Client</h4>
-                                    <ul className="space-y-2 text-sm text-gray-500 font-light">
-                                        <li className="flex justify-between max-w-[200px]">
-                                            <span>Dimanche - Jeudi</span>
-                                            <span>9h - 18h</span>
-                                        </li>
-                                        <li className="flex justify-between max-w-[200px]">
-                                            <span>Samedi</span>
-                                            <span>10h - 16h</span>
-                                        </li>
-                                        <li className="flex justify-between max-w-[200px]">
-                                            <span>Vendredi</span>
-                                            <span>Fermé</span>
-                                        </li>
-                                    </ul>
-                                </div>
+              <div className="space-y-8">
+                <div>
+                  <h4 className="text-sm font-bold uppercase tracking-widest text-gray-900 mb-3">
+                    Horaires Service Client
+                  </h4>
+                  <ul className="space-y-2 text-sm text-gray-500 font-light">
+                    <li className="flex justify-between max-w-[200px]">
+                      <span>Dimanche - Jeudi</span>
+                      <span>9h - 18h</span>
+                    </li>
+                    <li className="flex justify-between max-w-[200px]">
+                      <span>Samedi</span>
+                      <span>10h - 16h</span>
+                    </li>
+                    <li className="flex justify-between max-w-[200px]">
+                      <span>Vendredi</span>
+                      <span>Fermé</span>
+                    </li>
+                  </ul>
+                </div>
 
-                                <a
-                                    href={getWhatsAppLink()}
-                                    target="_blank"
-                                    rel="noopener noreferrer"
-                                    className="inline-flex items-center gap-3 bg-[#25D366] text-white px-6 py-4 rounded-full hover:bg-[#20bd5a] transition-colors shadow-lg shadow-[#25D366]/20"
-                                >
-                                    <MessageCircle size={20} />
-                                    <span className="font-medium text-sm tracking-wide">Discuter sur WhatsApp</span>
-                                </a>
-                            </div>
-                        </div>
+                <a
+                  href={getWhatsAppLink()}
+                  target="_blank"
+                  rel="noopener noreferrer"
+                  className="inline-flex items-center gap-3 bg-[#25D366] text-white px-6 py-4 rounded-full hover:bg-[#20bd5a] transition-colors shadow-lg shadow-[#25D366]/20"
+                >
+                  <MessageCircle size={20} />
+                  <span className="font-medium text-sm tracking-wide">
+                    Discuter sur WhatsApp
+                  </span>
+                </a>
+              </div>
+            </div>
 
-                        {/* Right - Form */}
-                        <div className="lg:col-span-6">
-                            {isSubmitted ? (
-                                <div className="bg-gray-50 p-12 rounded-2xl text-center">
-                                    <div className="inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full text-green-600 mb-6">
-                                        <CheckCircle size={32} />
-                                    </div>
-                                    <h4 className="text-2xl font-serif font-medium text-gray-900 mb-2">
-                                        Message envoyé !
-                                    </h4>
-                                    <p className="text-gray-500 font-light">
-                                        Merci de nous avoir contactés. Nous reviendrons vers vous très vite.
-                                    </p>
-                                </div>
-                            ) : (
-                                <form onSubmit={handleSubmit} className="space-y-6">
-                                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
-                                        <div className="space-y-2">
-                                            <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Nom complet</label>
-                                            <input
-                                                type="text"
-                                                required
-                                                value={formState.name}
-                                                onChange={(e) => setFormState({ ...formState, name: e.target.value })}
-                                                className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
-                                                placeholder="Votre nom"
-                                            />
-                                        </div>
-                                        <div className="space-y-2">
-                                            <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Téléphone</label>
-                                            <input
-                                                type="tel"
-                                                value={formState.phone}
-                                                onChange={(e) => setFormState({ ...formState, phone: e.target.value })}
-                                                className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
-                                                placeholder="05 XX XX XX XX"
-                                            />
-                                        </div>
-                                    </div>
+            {/* Right - Form */}
+            <div className="lg:col-span-6">
+              {isSubmitted ? (
+                <div className="bg-gray-50 p-12 rounded-2xl text-center">
+                  <div className="inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full text-green-600 mb-6">
+                    <CheckCircle size={32} />
+                  </div>
+                  <h4 className="text-2xl font-serif font-medium text-gray-900 mb-2">
+                    Message envoyé !
+                  </h4>
+                  <p className="text-gray-500 font-light">
+                    Merci de nous avoir contactés. Nous reviendrons vers vous
+                    très vite.
+                  </p>
+                </div>
+              ) : (
+                <form onSubmit={handleSubmit} className="space-y-6">
+                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
+                    <div className="space-y-2">
+                      <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                        Nom complet
+                      </label>
+                      <input
+                        type="text"
+                        required
+                        value={formState.name}
+                        onChange={(e) =>
+                          setFormState({ ...formState, name: e.target.value })
+                        }
+                        className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
+                        placeholder="Votre nom"
+                      />
+                    </div>
+                    <div className="space-y-2">
+                      <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                        Téléphone
+                      </label>
+                      <input
+                        type="tel"
+                        value={formState.phone}
+                        onChange={(e) =>
+                          setFormState({ ...formState, phone: e.target.value })
+                        }
+                        className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
+                        placeholder="05 XX XX XX XX"
+                      />
+                    </div>
+                  </div>
 
-                                    <div className="space-y-2">
-                                        <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Email</label>
-                                        <input
-                                            type="email"
-                                            required
-                                            value={formState.email}
-                                            onChange={(e) => setFormState({ ...formState, email: e.target.value })}
-                                            className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
-                                            placeholder="votre@email.com"
-                                        />
-                                    </div>
+                  <div className="space-y-2">
+                    <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                      Email
+                    </label>
+                    <input
+                      type="email"
+                      required
+                      value={formState.email}
+                      onChange={(e) =>
+                        setFormState({ ...formState, email: e.target.value })
+                      }
+                      className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors placeholder:text-gray-300"
+                      placeholder="votre@email.com"
+                    />
+                  </div>
 
-                                    <div className="space-y-2">
-                                        <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Sujet</label>
-                                        <select
-                                            value={formState.subject}
-                                            onChange={(e) => setFormState({ ...formState, subject: e.target.value })}
-                                            className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors cursor-pointer"
-                                        >
-                                            <option value="">Sélectionnez un sujet</option>
-                                            <option value="question">Question produit</option>
-                                            <option value="order">Suivi de commande</option>
-                                            <option value="return">Retour & Échange</option>
-                                            <option value="collaboration">Partenariat</option>
-                                            <option value="other">Autre</option>
-                                        </select>
-                                    </div>
+                  <div className="space-y-2">
+                    <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                      Sujet
+                    </label>
+                    <select
+                      value={formState.subject}
+                      onChange={(e) =>
+                        setFormState({ ...formState, subject: e.target.value })
+                      }
+                      className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors cursor-pointer"
+                    >
+                      <option value="">Sélectionnez un sujet</option>
+                      <option value="question">Question produit</option>
+                      <option value="order">Suivi de commande</option>
+                      <option value="return">Retour & Échange</option>
+                      <option value="collaboration">Partenariat</option>
+                      <option value="other">Autre</option>
+                    </select>
+                  </div>
 
-                                    <div className="space-y-2">
-                                        <label className="text-xs font-bold uppercase tracking-wider text-gray-500">Message</label>
-                                        <textarea
-                                            required
-                                            rows={5}
-                                            value={formState.message}
-                                            onChange={(e) => setFormState({ ...formState, message: e.target.value })}
-                                            className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors resize-none placeholder:text-gray-300"
-                                            placeholder="Comment pouvons-nous vous aider ?"
-                                        />
-                                    </div>
+                  <div className="space-y-2">
+                    <label className="text-xs font-bold uppercase tracking-wider text-gray-500">
+                      Message
+                    </label>
+                    <textarea
+                      required
+                      rows={5}
+                      value={formState.message}
+                      onChange={(e) =>
+                        setFormState({ ...formState, message: e.target.value })
+                      }
+                      className="w-full bg-transparent border-b border-gray-200 py-3 text-gray-900 focus:border-gray-900 outline-none transition-colors resize-none placeholder:text-gray-300"
+                      placeholder="Comment pouvons-nous vous aider ?"
+                    />
+                  </div>
 
-                                    <div className="pt-4">
-                                        <button
-                                            type="submit"
-                                            disabled={isSubmitting}
-                                            className="w-full bg-gray-900 text-white py-4 rounded-full uppercase tracking-widest hover:bg-gray-800 transition-all duration-300 font-medium flex items-center justify-center gap-2 disabled:opacity-70"
-                                        >
-                                            {isSubmitting ? (
-                                                <div className="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin" />
-                                            ) : (
-                                                <>
-                                                    Envoyer
-                                                    <ArrowRight size={18} />
-                                                </>
-                                            )}
-                                        </button>
-                                    </div>
-                                </form>
-                            )}
-                        </div>
-                    </div>
-                </div>
-            </section>
+                  <div className="pt-4">
+                    <button
+                      type="submit"
+                      disabled={isSubmitting}
+                      className="w-full bg-gray-900 text-white py-4 rounded-full uppercase tracking-widest hover:bg-gray-800 transition-all duration-300 font-medium flex items-center justify-center gap-2 disabled:opacity-70"
+                    >
+                      {isSubmitting ? (
+                        <div className="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin" />
+                      ) : (
+                        <>
+                          Envoyer
+                          <ArrowRight size={18} />
+                        </>
+                      )}
+                    </button>
+                  </div>
+                </form>
+              )}
+            </div>
+          </div>
         </div>
-    );
+      </section>
+    </div>
+  );
 }
diff --git a/src/app/error.tsx b/src/app/error.tsx
index 403b5aa..a8c4654 100644
--- a/src/app/error.tsx
+++ b/src/app/error.tsx
@@ -5,47 +5,47 @@ import { AlertCircle, RefreshCcw, ArrowLeft } from "lucide-react";
 import Link from "next/link";
 
 export default function Error({
-    error,
-    reset,
+  error,
+  reset,
 }: {
-    error: Error & { digest?: string };
-    reset: () => void;
+  error: Error & { digest?: string };
+  reset: () => void;
 }) {
-    useEffect(() => {
-        console.error("Application error:", error);
-    }, [error]);
+  useEffect(() => {
+    console.error("Application error:", error);
+  }, [error]);
 
-    return (
-        <div className="min-h-[80vh] flex items-center justify-center px-4 bg-white">
-            <div className="text-center max-w-md">
-                <div className="inline-flex items-center justify-center w-16 h-16 bg-red-50 rounded-full text-red-500 mb-6">
-                    <AlertCircle size={32} />
-                </div>
-                
-                <h2 className="text-2xl font-serif font-medium text-gray-900 mb-4">
-                    Une erreur est survenue
-                </h2>
-                <p className="text-gray-500 mb-10 font-light">
-                    Désolé, quelque chose s'est mal passé. Veuillez réessayer.
-                </p>
-                
-                <div className="flex flex-col sm:flex-row gap-4 justify-center">
-                    <button
-                        onClick={reset}
-                        className="inline-flex items-center justify-center gap-2 bg-gray-900 text-white px-8 py-4 rounded-full text-sm uppercase tracking-widest hover:bg-harp-brown transition-colors"
-                    >
-                        <RefreshCcw size={16} />
-                        Réessayer
-                    </button>
-                    <Link
-                        href="/"
-                        className="inline-flex items-center justify-center gap-2 border border-gray-200 text-gray-900 px-8 py-4 rounded-full text-sm uppercase tracking-widest hover:border-gray-900 transition-colors"
-                    >
-                        <ArrowLeft size={16} />
-                        Retour à l'accueil
-                    </Link>
-                </div>
-            </div>
+  return (
+    <div className="min-h-[80vh] flex items-center justify-center px-4 bg-white">
+      <div className="text-center max-w-md">
+        <div className="inline-flex items-center justify-center w-16 h-16 bg-red-50 rounded-full text-red-500 mb-6">
+          <AlertCircle size={32} />
         </div>
-    );
+
+        <h2 className="text-2xl font-serif font-medium text-gray-900 mb-4">
+          Une erreur est survenue
+        </h2>
+        <p className="text-gray-500 mb-10 font-light">
+          Désolé, quelque chose s'est mal passé. Veuillez réessayer.
+        </p>
+
+        <div className="flex flex-col sm:flex-row gap-4 justify-center">
+          <button
+            onClick={reset}
+            className="inline-flex items-center justify-center gap-2 bg-gray-900 text-white px-8 py-4 rounded-full text-sm uppercase tracking-widest hover:bg-harp-brown transition-colors"
+          >
+            <RefreshCcw size={16} />
+            Réessayer
+          </button>
+          <Link
+            href="/"
+            className="inline-flex items-center justify-center gap-2 border border-gray-200 text-gray-900 px-8 py-4 rounded-full text-sm uppercase tracking-widest hover:border-gray-900 transition-colors"
+          >
+            <ArrowLeft size={16} />
+            Retour à l'accueil
+          </Link>
+        </div>
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/globals.css b/src/app/globals.css
index d6bab40..d2be1ca 100644
--- a/src/app/globals.css
+++ b/src/app/globals.css
@@ -5,12 +5,12 @@
   --font-serif: var(--font-playfair);
 
   /* Brand Colors - Premium Palette */
-  --color-harp-beige: #D4C4B0;
-  --color-harp-brown: #3D2314;
-  --color-harp-caramel: #9B7B5C;
-  --color-harp-gold: #C9B896;
-  --color-harp-cream: #FDFBF8;
-  --color-harp-sand: #E8E0D5;
+  --color-harp-beige: #d4c4b0;
+  --color-harp-brown: #3d2314;
+  --color-harp-caramel: #9b7b5c;
+  --color-harp-gold: #c9b896;
+  --color-harp-cream: #fdfbf8;
+  --color-harp-sand: #e8e0d5;
 
   /* Shadows - More refined */
   --shadow-soft: 0 4px 20px -2px rgba(61, 35, 20, 0.06);
@@ -102,7 +102,6 @@
 }
 
 @keyframes pulse-soft {
-
   0%,
   100% {
     opacity: 1;
@@ -124,7 +123,8 @@
 }
 
 @keyframes float {
-  0%, 100% {
+  0%,
+  100% {
     transform: translateY(0);
   }
   50% {
@@ -157,7 +157,7 @@
 
 /* Gradient Text */
 .gradient-text {
-  background: linear-gradient(135deg, #3D2314 0%, #9B7B5C 50%, #C9B896 100%);
+  background: linear-gradient(135deg, #3d2314 0%, #9b7b5c 50%, #c9b896 100%);
   -webkit-background-clip: text;
   -webkit-text-fill-color: transparent;
   background-clip: text;
@@ -171,13 +171,18 @@
 }
 
 .btn-premium::before {
-  content: '';
+  content: "";
   position: absolute;
   top: 0;
   left: -100%;
   width: 100%;
   height: 100%;
-  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
+  background: linear-gradient(
+    90deg,
+    transparent,
+    rgba(255, 255, 255, 0.2),
+    transparent
+  );
   transition: left 0.5s;
 }
 
@@ -187,7 +192,11 @@
 
 /* Beige accent styles */
 .beige-accent {
-  background: linear-gradient(135deg, var(--color-harp-cream) 0%, var(--color-harp-sand) 100%);
+  background: linear-gradient(
+    135deg,
+    var(--color-harp-cream) 0%,
+    var(--color-harp-sand) 100%
+  );
 }
 
 .beige-border {
@@ -224,7 +233,7 @@
 }
 
 .link-underline::after {
-  content: '';
+  content: "";
   position: absolute;
   bottom: -2px;
   left: 0;
@@ -247,7 +256,6 @@
   color utility to any element that depends on these defaults.
 */
 @layer base {
-
   *,
   ::after,
   ::before,
@@ -290,4 +298,4 @@
 
 .scrollbar-hide::-webkit-scrollbar {
   display: none;
-}
\ No newline at end of file
+}
diff --git a/src/app/layout.tsx b/src/app/layout.tsx
index 2992a12..54b8693 100644
--- a/src/app/layout.tsx
+++ b/src/app/layout.tsx
@@ -10,72 +10,81 @@ import { OrganizationJsonLd } from "@/components/JsonLd";
 import { ErrorBoundary } from "@/components/ErrorBoundary";
 
 const inter = Inter({
-    variable: "--font-inter",
-    subsets: ["latin"],
-    display: "swap", // Prevents FOIT (Flash of Invisible Text)
-    preload: true,
+  variable: "--font-inter",
+  subsets: ["latin"],
+  display: "swap", // Prevents FOIT (Flash of Invisible Text)
+  preload: true,
 });
 
 const playfair = Playfair_Display({
-    variable: "--font-playfair",
-    subsets: ["latin"],
-    display: "swap",
-    preload: true,
+  variable: "--font-playfair",
+  subsets: ["latin"],
+  display: "swap",
+  preload: true,
 });
 
 export const metadata: Metadata = {
-    title: {
-        default: "Harp - Une élégance qui résonne",
-        template: "%s | Harp",
-    },
-    description: "Prêt-à-porter féminin élégant et modeste. Découvrez nos collections uniques alliant confort, qualité et modernité.",
-    keywords: ["mode", "femme", "modest fashion", "élégance", "vêtements", "harp", "algérie"],
-    authors: [{ name: "Harp" }],
-    openGraph: {
-        title: "Harp - Une élégance qui résonne",
-        description: "Prêt-à-porter féminin élégant et modeste.",
-        url: "https://harp-web.com",
-        siteName: "Harp",
-        locale: "fr_FR",
-        type: "website",
-    },
-    twitter: {
-        card: "summary_large_image",
-        title: "Harp - Une élégance qui résonne",
-        description: "Prêt-à-porter féminin élégant et modeste.",
-    },
-    icons: {
-        icon: "/favicon.svg",
-        apple: "/icon-192.png",
-    },
-    manifest: "/manifest.json",
-    appleWebApp: {
-        capable: true,
-        statusBarStyle: "default",
-        title: "Harp",
-    },
+  title: {
+    default: "Harp - Une élégance qui résonne",
+    template: "%s | Harp",
+  },
+  description:
+    "Prêt-à-porter féminin élégant et modeste. Découvrez nos collections uniques alliant confort, qualité et modernité.",
+  keywords: [
+    "mode",
+    "femme",
+    "modest fashion",
+    "élégance",
+    "vêtements",
+    "harp",
+    "algérie",
+  ],
+  authors: [{ name: "Harp" }],
+  openGraph: {
+    title: "Harp - Une élégance qui résonne",
+    description: "Prêt-à-porter féminin élégant et modeste.",
+    url: "https://harp-web.com",
+    siteName: "Harp",
+    locale: "fr_FR",
+    type: "website",
+  },
+  twitter: {
+    card: "summary_large_image",
+    title: "Harp - Une élégance qui résonne",
+    description: "Prêt-à-porter féminin élégant et modeste.",
+  },
+  icons: {
+    icon: "/favicon.svg",
+    apple: "/icon-192.png",
+  },
+  manifest: "/manifest.json",
+  appleWebApp: {
+    capable: true,
+    statusBarStyle: "default",
+    title: "Harp",
+  },
 };
 
 export default function RootLayout({
-    children,
+  children,
 }: Readonly<{
-    children: React.ReactNode;
+  children: React.ReactNode;
 }>) {
-    return (
-        <html lang="fr" className={`${inter.variable} ${playfair.variable}`}>
-            <body className="antialiased font-sans">
-                <Analytics />
-                <OrganizationJsonLd />
-                <SessionProvider>
-                    <ErrorBoundary>
-                        <LanguageProvider>
-                            <CartProvider>
-                                <MainLayout>{children}</MainLayout>
-                            </CartProvider>
-                        </LanguageProvider>
-                    </ErrorBoundary>
-                </SessionProvider>
-            </body>
-        </html>
-    );
+  return (
+    <html lang="fr" className={`${inter.variable} ${playfair.variable}`}>
+      <body className="antialiased font-sans">
+        <Analytics />
+        <OrganizationJsonLd />
+        <SessionProvider>
+          <ErrorBoundary>
+            <LanguageProvider>
+              <CartProvider>
+                <MainLayout>{children}</MainLayout>
+              </CartProvider>
+            </LanguageProvider>
+          </ErrorBoundary>
+        </SessionProvider>
+      </body>
+    </html>
+  );
 }
diff --git a/src/app/loading.tsx b/src/app/loading.tsx
index 4da77bc..9697d4e 100644
--- a/src/app/loading.tsx
+++ b/src/app/loading.tsx
@@ -1,9 +1,9 @@
 import { Loader2 } from "lucide-react";
 
 export default function Loading() {
-    return (
-        <div className="min-h-[60vh] flex items-center justify-center bg-white">
-            <Loader2 size={32} className="text-gray-900 animate-spin" />
-        </div>
-    );
+  return (
+    <div className="min-h-[60vh] flex items-center justify-center bg-white">
+      <Loader2 size={32} className="text-gray-900 animate-spin" />
+    </div>
+  );
 }
diff --git a/src/app/lookbook/page.tsx b/src/app/lookbook/page.tsx
index 00f3d2f..9d44e03 100644
--- a/src/app/lookbook/page.tsx
+++ b/src/app/lookbook/page.tsx
@@ -8,211 +8,222 @@ import { ArrowRight, X, Instagram } from "lucide-react";
 import { cn } from "@/lib/utils";
 
 interface LookbookItem {
-    id: string;
-    image: string;
-    caption?: string;
-    productIds?: string[];
+  id: string;
+  image: string;
+  caption?: string;
+  productIds?: string[];
 }
 
 interface Lookbook {
-    id: string;
-    slug: string;
-    title: string;
-    description?: string;
-    season?: string;
-    coverImage?: string;
-    items: LookbookItem[];
+  id: string;
+  slug: string;
+  title: string;
+  description?: string;
+  season?: string;
+  coverImage?: string;
+  items: LookbookItem[];
 }
 
 export default function LookbookPage() {
-    const { t } = useLanguage();
-    const [lookbooks, setLookbooks] = useState<Lookbook[]>([]);
-    const [selectedLook, setSelectedLook] = useState<LookbookItem | null>(null);
-    const [loading, setLoading] = useState(true);
+  const { t } = useLanguage();
+  const [lookbooks, setLookbooks] = useState<Lookbook[]>([]);
+  const [selectedLook, setSelectedLook] = useState<LookbookItem | null>(null);
+  const [loading, setLoading] = useState(true);
 
-    // Placeholder lookbook data (will be replaced by API data)
-    const placeholderLookbook: Lookbook = {
-        id: "placeholder",
-        slug: "printemps-2025",
-        title: "Saison 01 — Printemps",
-        description: "Une ode à la fluidité et à la lumière. Découvrez notre nouvelle collection inspirée des jardins andalous.",
-        season: "Printemps 2025",
-        coverImage: "https://images.unsplash.com/photo-1585487000160-6ebcfceb0d03?w=1600&q=90",
-        items: [
-            {
-                id: "1",
-                image: "https://images.unsplash.com/photo-1594938298603-c8148c4dae35?w=1200&q=85",
-                caption: "Silhouette 01"
-            },
-            {
-                id: "2",
-                image: "https://images.unsplash.com/photo-1585487000160-6ebcfceb0d03?w=1200&q=85",
-                caption: "Silhouette 02"
-            },
-            {
-                id: "3",
-                image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=1200&q=85",
-                caption: "Silhouette 03"
-            },
-            {
-                id: "4",
-                image: "https://images.unsplash.com/photo-1551232864-3f0890e580d9?w=1200&q=85",
-                caption: "Silhouette 04"
-            },
-            {
-                id: "5",
-                image: "https://images.unsplash.com/photo-1558171813-4c088753af8f?w=1200&q=85",
-                caption: "Silhouette 05"
-            },
-            {
-                id: "6",
-                image: "https://images.unsplash.com/photo-1544725176-7c40e5a71c5e?w=1200&q=85",
-                caption: "Silhouette 06"
-            },
-        ]
-    };
+  // Placeholder lookbook data (will be replaced by API data)
+  const placeholderLookbook: Lookbook = {
+    id: "placeholder",
+    slug: "printemps-2025",
+    title: "Saison 01 — Printemps",
+    description:
+      "Une ode à la fluidité et à la lumière. Découvrez notre nouvelle collection inspirée des jardins andalous.",
+    season: "Printemps 2025",
+    coverImage:
+      "https://images.unsplash.com/photo-1585487000160-6ebcfceb0d03?w=1600&q=90",
+    items: [
+      {
+        id: "1",
+        image:
+          "https://images.unsplash.com/photo-1594938298603-c8148c4dae35?w=1200&q=85",
+        caption: "Silhouette 01",
+      },
+      {
+        id: "2",
+        image:
+          "https://images.unsplash.com/photo-1585487000160-6ebcfceb0d03?w=1200&q=85",
+        caption: "Silhouette 02",
+      },
+      {
+        id: "3",
+        image:
+          "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=1200&q=85",
+        caption: "Silhouette 03",
+      },
+      {
+        id: "4",
+        image:
+          "https://images.unsplash.com/photo-1551232864-3f0890e580d9?w=1200&q=85",
+        caption: "Silhouette 04",
+      },
+      {
+        id: "5",
+        image:
+          "https://images.unsplash.com/photo-1558171813-4c088753af8f?w=1200&q=85",
+        caption: "Silhouette 05",
+      },
+      {
+        id: "6",
+        image:
+          "https://images.unsplash.com/photo-1544725176-7c40e5a71c5e?w=1200&q=85",
+        caption: "Silhouette 06",
+      },
+    ],
+  };
 
-    useEffect(() => {
-        // For now, use placeholder data
-        // In production, fetch from API: /api/lookbooks
-        setLookbooks([placeholderLookbook]);
-        setLoading(false);
-    }, []);
+  useEffect(() => {
+    // For now, use placeholder data
+    // In production, fetch from API: /api/lookbooks
+    setLookbooks([placeholderLookbook]);
+    setLoading(false);
+  }, []);
 
-    const currentLookbook = lookbooks[0] || placeholderLookbook;
+  const currentLookbook = lookbooks[0] || placeholderLookbook;
 
-    return (
-        <div className="min-h-screen bg-white">
-            {/* Hero Section - Editorial */}
-            <section className="relative h-screen min-h-[700px] w-full overflow-hidden">
-                <div className="absolute inset-0">
-                    <Image
-                        src={currentLookbook.coverImage || "https://images.unsplash.com/photo-1585487000160-6ebcfceb0d03?w=1600&q=90"}
-                        alt={currentLookbook.title}
-                        fill
-                        className="object-cover object-center"
-                        priority
-                    />
-                    <div className="absolute inset-0 bg-black/10" />
-                </div>
+  return (
+    <div className="min-h-screen bg-white">
+      {/* Hero Section - Editorial */}
+      <section className="relative h-screen min-h-[700px] w-full overflow-hidden">
+        <div className="absolute inset-0">
+          <Image
+            src={
+              currentLookbook.coverImage ||
+              "https://images.unsplash.com/photo-1585487000160-6ebcfceb0d03?w=1600&q=90"
+            }
+            alt={currentLookbook.title}
+            fill
+            className="object-cover object-center"
+            priority
+          />
+          <div className="absolute inset-0 bg-black/10" />
+        </div>
 
-                <div className="relative z-10 h-full flex flex-col justify-center items-center text-center px-4">
-                    <div className="max-w-3xl">
-                        <span className="text-white text-xs font-bold uppercase tracking-[0.3em] mb-6 block">
-                            Lookbook
-                        </span>
-                        <h1 className="text-5xl md:text-7xl lg:text-8xl font-serif font-medium text-white mb-8 leading-tight">
-                            {currentLookbook.title}
-                        </h1>
-                        <p className="text-lg md:text-xl text-white/90 font-light max-w-xl mx-auto leading-relaxed">
-                            {currentLookbook.description}
-                        </p>
-                    </div>
-                </div>
-            </section>
+        <div className="relative z-10 h-full flex flex-col justify-center items-center text-center px-4">
+          <div className="max-w-3xl">
+            <span className="text-white text-xs font-bold uppercase tracking-[0.3em] mb-6 block">
+              Lookbook
+            </span>
+            <h1 className="text-5xl md:text-7xl lg:text-8xl font-serif font-medium text-white mb-8 leading-tight">
+              {currentLookbook.title}
+            </h1>
+            <p className="text-lg md:text-xl text-white/90 font-light max-w-xl mx-auto leading-relaxed">
+              {currentLookbook.description}
+            </p>
+          </div>
+        </div>
+      </section>
 
-            {/* Gallery Grid - Minimalist */}
-            <section className="py-32 bg-white">
-                <div className="container mx-auto px-4 max-w-6xl">
-                    <div className="columns-1 md:columns-2 lg:columns-3 gap-8 space-y-8">
-                        {currentLookbook.items.map((item, index) => (
-                            <div
-                                key={item.id}
-                                className="break-inside-avoid cursor-pointer group"
-                                onClick={() => setSelectedLook(item)}
-                            >
-                                <div className="relative overflow-hidden mb-4">
-                                    <Image
-                                        src={item.image}
-                                        alt={item.caption || `Look ${index + 1}`}
-                                        width={800}
-                                        height={1200}
-                                        className="w-full h-auto object-cover transition-transform duration-700 group-hover:scale-105"
-                                    />
-                                    <div className="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-500" />
-                                </div>
-                                <div className="flex justify-between items-center">
-                                    <p className="text-xs uppercase tracking-widest text-gray-900 font-medium">
-                                        {item.caption}
-                                    </p>
-                                    <span className="text-[10px] text-gray-400 font-mono">
-                                        {String(index + 1).padStart(2, '0')}
-                                    </span>
-                                </div>
-                            </div>
-                        ))}
-                    </div>
+      {/* Gallery Grid - Minimalist */}
+      <section className="py-32 bg-white">
+        <div className="container mx-auto px-4 max-w-6xl">
+          <div className="columns-1 md:columns-2 lg:columns-3 gap-8 space-y-8">
+            {currentLookbook.items.map((item, index) => (
+              <div
+                key={item.id}
+                className="break-inside-avoid cursor-pointer group"
+                onClick={() => setSelectedLook(item)}
+              >
+                <div className="relative overflow-hidden mb-4">
+                  <Image
+                    src={item.image}
+                    alt={item.caption || `Look ${index + 1}`}
+                    width={800}
+                    height={1200}
+                    className="w-full h-auto object-cover transition-transform duration-700 group-hover:scale-105"
+                  />
+                  <div className="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-500" />
                 </div>
-            </section>
-
-            {/* Shop CTA - Clean */}
-            <section className="py-32 bg-[#F9F9F9] text-center">
-                <div className="container mx-auto px-4">
-                    <h2 className="text-3xl md:text-5xl font-serif font-medium text-gray-900 mb-8">
-                        Inspirée ?
-                    </h2>
-                    <Link
-                        href="/shop"
-                        className="inline-block border-b border-gray-900 pb-1 text-sm uppercase tracking-widest hover:text-gray-600 hover:border-gray-600 transition-all"
-                    >
-                        Explorer la collection
-                    </Link>
+                <div className="flex justify-between items-center">
+                  <p className="text-xs uppercase tracking-widest text-gray-900 font-medium">
+                    {item.caption}
+                  </p>
+                  <span className="text-[10px] text-gray-400 font-mono">
+                    {String(index + 1).padStart(2, "0")}
+                  </span>
                 </div>
-            </section>
+              </div>
+            ))}
+          </div>
+        </div>
+      </section>
 
-            {/* Social - Footer Style */}
-            <section className="py-20 bg-white border-t border-gray-100">
-                <div className="container mx-auto px-4 text-center">
-                    <a
-                        href="https://www.instagram.com/harp_algeria"
-                        target="_blank"
-                        rel="noopener noreferrer"
-                        className="inline-flex flex-col items-center gap-4 group"
-                    >
-                        <Instagram size={32} className="text-gray-900" />
-                        <span className="text-sm uppercase tracking-widest text-gray-900 group-hover:text-gray-600 transition-colors">
-                            @harp_algeria
-                        </span>
-                    </a>
-                </div>
-            </section>
+      {/* Shop CTA - Clean */}
+      <section className="py-32 bg-[#F9F9F9] text-center">
+        <div className="container mx-auto px-4">
+          <h2 className="text-3xl md:text-5xl font-serif font-medium text-gray-900 mb-8">
+            Inspirée ?
+          </h2>
+          <Link
+            href="/shop"
+            className="inline-block border-b border-gray-900 pb-1 text-sm uppercase tracking-widest hover:text-gray-600 hover:border-gray-600 transition-all"
+          >
+            Explorer la collection
+          </Link>
+        </div>
+      </section>
 
-            {/* Lightbox Modal - Minimal */}
-            {selectedLook && (
-                <div 
-                    className="fixed inset-0 z-50 bg-white/95 backdrop-blur-sm flex items-center justify-center p-4 md:p-8"
-                    onClick={() => setSelectedLook(null)}
-                >
-                    <button 
-                        className="absolute top-8 right-8 text-gray-900 hover:text-gray-600 transition-colors"
-                        onClick={() => setSelectedLook(null)}
-                    >
-                        <X size={32} strokeWidth={1} />
-                    </button>
-                    
-                    <div className="relative max-w-5xl w-full flex flex-col items-center">
-                        <div className="relative w-full max-h-[80vh] aspect-[3/4] md:aspect-auto md:h-[80vh]">
-                            <Image
-                                src={selectedLook.image}
-                                alt={selectedLook.caption || "Look"}
-                                fill
-                                className="object-contain"
-                            />
-                        </div>
-                        {selectedLook.caption && (
-                            <p className="mt-8 text-sm uppercase tracking-widest text-gray-900 font-medium">
-                                {selectedLook.caption}
-                            </p>
-                        )}
-                        <Link
-                            href="/shop"
-                            className="mt-4 text-xs text-gray-500 hover:text-gray-900 border-b border-gray-300 hover:border-gray-900 transition-all pb-0.5"
-                        >
-                            Voir les produits
-                        </Link>
-                    </div>
-                </div>
+      {/* Social - Footer Style */}
+      <section className="py-20 bg-white border-t border-gray-100">
+        <div className="container mx-auto px-4 text-center">
+          <a
+            href="https://www.instagram.com/harp_algeria"
+            target="_blank"
+            rel="noopener noreferrer"
+            className="inline-flex flex-col items-center gap-4 group"
+          >
+            <Instagram size={32} className="text-gray-900" />
+            <span className="text-sm uppercase tracking-widest text-gray-900 group-hover:text-gray-600 transition-colors">
+              @harp_algeria
+            </span>
+          </a>
+        </div>
+      </section>
+
+      {/* Lightbox Modal - Minimal */}
+      {selectedLook && (
+        <div
+          className="fixed inset-0 z-50 bg-white/95 backdrop-blur-sm flex items-center justify-center p-4 md:p-8"
+          onClick={() => setSelectedLook(null)}
+        >
+          <button
+            className="absolute top-8 right-8 text-gray-900 hover:text-gray-600 transition-colors"
+            onClick={() => setSelectedLook(null)}
+          >
+            <X size={32} strokeWidth={1} />
+          </button>
+
+          <div className="relative max-w-5xl w-full flex flex-col items-center">
+            <div className="relative w-full max-h-[80vh] aspect-[3/4] md:aspect-auto md:h-[80vh]">
+              <Image
+                src={selectedLook.image}
+                alt={selectedLook.caption || "Look"}
+                fill
+                className="object-contain"
+              />
+            </div>
+            {selectedLook.caption && (
+              <p className="mt-8 text-sm uppercase tracking-widest text-gray-900 font-medium">
+                {selectedLook.caption}
+              </p>
             )}
+            <Link
+              href="/shop"
+              className="mt-4 text-xs text-gray-500 hover:text-gray-900 border-b border-gray-300 hover:border-gray-900 transition-all pb-0.5"
+            >
+              Voir les produits
+            </Link>
+          </div>
         </div>
-    );
+      )}
+    </div>
+  );
 }
diff --git a/src/app/loyalty/page.tsx b/src/app/loyalty/page.tsx
index 716e90d..037aaa8 100644
--- a/src/app/loyalty/page.tsx
+++ b/src/app/loyalty/page.tsx
@@ -6,7 +6,8 @@ import { authOptions } from "@/lib/auth";
 
 export const metadata: Metadata = {
   title: "Mes Récompenses | HARP",
-  description: "Gérez vos points de fidélité et débloquez des récompenses exclusives.",
+  description:
+    "Gérez vos points de fidélité et débloquez des récompenses exclusives.",
 };
 
 export default async function LoyaltyPage() {
@@ -20,9 +21,11 @@ export default async function LoyaltyPage() {
     <div className="min-h-screen bg-white pt-24 pb-12">
       <div className="container mx-auto px-4 max-w-5xl">
         <div className="text-center mb-12">
-          <h1 className="font-serif text-4xl md:text-5xl text-harp-brown mb-4">Harp Rewards</h1>
+          <h1 className="font-serif text-4xl md:text-5xl text-harp-brown mb-4">
+            Harp Rewards
+          </h1>
           <p className="text-gray-500 max-w-2xl mx-auto">
-            Plus qu'un programme de fidélité, une invitation à l'exclusivité. 
+            Plus qu'un programme de fidélité, une invitation à l'exclusivité.
             Cumulez des points à chaque achat et accédez au cercle privilégié.
           </p>
         </div>
diff --git a/src/app/not-found.tsx b/src/app/not-found.tsx
index caddbad..1e3018c 100644
--- a/src/app/not-found.tsx
+++ b/src/app/not-found.tsx
@@ -4,30 +4,31 @@ import Link from "next/link";
 import { ArrowRight } from "lucide-react";
 
 export default function NotFound() {
-    return (
-        <div className="min-h-[80vh] flex items-center justify-center px-4 bg-white">
-            <div className="text-center max-w-lg">
-                <h1 className="text-[120px] md:text-[180px] font-serif font-medium text-gray-900 leading-none tracking-tighter opacity-10 select-none">
-                    404
-                </h1>
-                
-                <div className="-mt-12 relative z-10">
-                    <h2 className="text-2xl font-serif font-medium text-gray-900 mb-4">
-                        Page introuvable
-                    </h2>
-                    <p className="text-gray-500 mb-10 font-light">
-                        La page que vous recherchez a peut-être été déplacée ou n'existe plus.
-                    </p>
-                    
-                    <Link
-                        href="/"
-                        className="inline-flex items-center gap-2 bg-gray-900 text-white px-8 py-4 rounded-full text-sm uppercase tracking-widest hover:bg-harp-brown transition-all"
-                    >
-                        Retour à l'accueil
-                        <ArrowRight size={16} />
-                    </Link>
-                </div>
-            </div>
+  return (
+    <div className="min-h-[80vh] flex items-center justify-center px-4 bg-white">
+      <div className="text-center max-w-lg">
+        <h1 className="text-[120px] md:text-[180px] font-serif font-medium text-gray-900 leading-none tracking-tighter opacity-10 select-none">
+          404
+        </h1>
+
+        <div className="-mt-12 relative z-10">
+          <h2 className="text-2xl font-serif font-medium text-gray-900 mb-4">
+            Page introuvable
+          </h2>
+          <p className="text-gray-500 mb-10 font-light">
+            La page que vous recherchez a peut-être été déplacée ou n'existe
+            plus.
+          </p>
+
+          <Link
+            href="/"
+            className="inline-flex items-center gap-2 bg-gray-900 text-white px-8 py-4 rounded-full text-sm uppercase tracking-widest hover:bg-harp-brown transition-all"
+          >
+            Retour à l'accueil
+            <ArrowRight size={16} />
+          </Link>
         </div>
-    );
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/order-confirmation/page.tsx b/src/app/order-confirmation/page.tsx
index 418c807..3f19fa8 100644
--- a/src/app/order-confirmation/page.tsx
+++ b/src/app/order-confirmation/page.tsx
@@ -1,107 +1,117 @@
 "use client";
 
 import Link from "next/link";
-import { CheckCircle2, Package, ArrowRight, Clock, MessageCircle } from "lucide-react";
+import {
+  CheckCircle2,
+  Package,
+  ArrowRight,
+  Clock,
+  MessageCircle,
+} from "lucide-react";
 import { useLanguage } from "@/components/LanguageProvider";
 import { siteConfig } from "@/lib/config";
 
 export default function OrderConfirmationPage() {
-    const { t } = useLanguage();
+  const { t } = useLanguage();
 
-    return (
-        <div className="min-h-screen bg-white pt-32 pb-20">
-            <div className="container mx-auto px-4">
-                <div className="max-w-2xl mx-auto text-center">
-                    {/* Success Animation */}
-                    <div className="mb-8 inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-50 text-green-600 animate-scale-in">
-                        <CheckCircle2 size={40} strokeWidth={1.5} />
-                    </div>
+  return (
+    <div className="min-h-screen bg-white pt-32 pb-20">
+      <div className="container mx-auto px-4">
+        <div className="max-w-2xl mx-auto text-center">
+          {/* Success Animation */}
+          <div className="mb-8 inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-50 text-green-600 animate-scale-in">
+            <CheckCircle2 size={40} strokeWidth={1.5} />
+          </div>
 
-                    <h1 className="text-3xl md:text-5xl font-serif font-medium text-gray-900 mb-6">
-                        Merci pour votre commande
-                    </h1>
+          <h1 className="text-3xl md:text-5xl font-serif font-medium text-gray-900 mb-6">
+            Merci pour votre commande
+          </h1>
 
-                    <p className="text-gray-500 text-lg font-light leading-relaxed mb-12">
-                        Nous avons bien reçu votre commande. Un membre de notre équipe vous contactera 
-                        très prochainement pour la confirmer.
-                    </p>
+          <p className="text-gray-500 text-lg font-light leading-relaxed mb-12">
+            Nous avons bien reçu votre commande. Un membre de notre équipe vous
+            contactera très prochainement pour la confirmer.
+          </p>
 
-                    {/* Next Steps Timeline */}
-                    <div className="bg-gray-50 rounded-3xl p-8 md:p-12 text-left mb-12">
-                        <h2 className="text-lg font-serif font-medium text-gray-900 mb-8 text-center">
-                            Prochaines étapes
-                        </h2>
-                        
-                        <div className="space-y-8 relative before:absolute before:left-[15px] before:top-2 before:bottom-2 before:w-0.5 before:bg-gray-200">
-                            <div className="relative flex gap-6">
-                                <div className="relative z-10 w-8 h-8 rounded-full bg-white border-2 border-gray-900 flex items-center justify-center text-xs font-bold text-gray-900">
-                                    1
-                                </div>
-                                <div>
-                                    <h3 className="font-medium text-gray-900 mb-1">Confirmation</h3>
-                                    <p className="text-sm text-gray-500 font-light">
-                                        Validation téléphonique sous 24h
-                                    </p>
-                                </div>
-                            </div>
+          {/* Next Steps Timeline */}
+          <div className="bg-gray-50 rounded-3xl p-8 md:p-12 text-left mb-12">
+            <h2 className="text-lg font-serif font-medium text-gray-900 mb-8 text-center">
+              Prochaines étapes
+            </h2>
 
-                            <div className="relative flex gap-6">
-                                <div className="relative z-10 w-8 h-8 rounded-full bg-white border-2 border-gray-200 flex items-center justify-center text-xs font-bold text-gray-400">
-                                    2
-                                </div>
-                                <div>
-                                    <h3 className="font-medium text-gray-900 mb-1">Expédition</h3>
-                                    <p className="text-sm text-gray-500 font-light">
-                                        Préparation et remise au transporteur
-                                    </p>
-                                </div>
-                            </div>
-
-                            <div className="relative flex gap-6">
-                                <div className="relative z-10 w-8 h-8 rounded-full bg-white border-2 border-gray-200 flex items-center justify-center text-xs font-bold text-gray-400">
-                                    3
-                                </div>
-                                <div>
-                                    <h3 className="font-medium text-gray-900 mb-1">Livraison</h3>
-                                    <p className="text-sm text-gray-500 font-light">
-                                        Réception à domicile ou en point relais
-                                    </p>
-                                </div>
-                            </div>
-                        </div>
-                    </div>
+            <div className="space-y-8 relative before:absolute before:left-[15px] before:top-2 before:bottom-2 before:w-0.5 before:bg-gray-200">
+              <div className="relative flex gap-6">
+                <div className="relative z-10 w-8 h-8 rounded-full bg-white border-2 border-gray-900 flex items-center justify-center text-xs font-bold text-gray-900">
+                  1
+                </div>
+                <div>
+                  <h3 className="font-medium text-gray-900 mb-1">
+                    Confirmation
+                  </h3>
+                  <p className="text-sm text-gray-500 font-light">
+                    Validation téléphonique sous 24h
+                  </p>
+                </div>
+              </div>
 
-                    {/* Actions */}
-                    <div className="flex flex-col sm:flex-row gap-4 justify-center">
-                        <Link
-                            href="/suivi"
-                            className="inline-flex items-center justify-center gap-2 bg-gray-900 text-white px-8 py-4 rounded-full text-sm uppercase tracking-widest hover:bg-gray-800 transition-all"
-                        >
-                            Suivre ma commande
-                        </Link>
-                        <Link
-                            href="/shop"
-                            className="inline-flex items-center justify-center gap-2 border border-gray-200 text-gray-900 px-8 py-4 rounded-full text-sm uppercase tracking-widest hover:border-gray-900 transition-all"
-                        >
-                            Continuer mes achats
-                        </Link>
-                    </div>
+              <div className="relative flex gap-6">
+                <div className="relative z-10 w-8 h-8 rounded-full bg-white border-2 border-gray-200 flex items-center justify-center text-xs font-bold text-gray-400">
+                  2
+                </div>
+                <div>
+                  <h3 className="font-medium text-gray-900 mb-1">Expédition</h3>
+                  <p className="text-sm text-gray-500 font-light">
+                    Préparation et remise au transporteur
+                  </p>
+                </div>
+              </div>
 
-                    {/* Support */}
-                    <div className="mt-16 pt-8 border-t border-gray-100">
-                        <p className="text-sm text-gray-400 mb-4">Une question ?</p>
-                        <a
-                            href={`https://wa.me/${siteConfig.whatsapp.number}`}
-                            target="_blank"
-                            rel="noopener noreferrer"
-                            className="inline-flex items-center gap-2 text-gray-900 hover:text-gray-600 transition-colors"
-                        >
-                            <MessageCircle size={18} />
-                            <span className="border-b border-gray-900 pb-0.5">Contacter le support</span>
-                        </a>
-                    </div>
+              <div className="relative flex gap-6">
+                <div className="relative z-10 w-8 h-8 rounded-full bg-white border-2 border-gray-200 flex items-center justify-center text-xs font-bold text-gray-400">
+                  3
+                </div>
+                <div>
+                  <h3 className="font-medium text-gray-900 mb-1">Livraison</h3>
+                  <p className="text-sm text-gray-500 font-light">
+                    Réception à domicile ou en point relais
+                  </p>
                 </div>
+              </div>
             </div>
+          </div>
+
+          {/* Actions */}
+          <div className="flex flex-col sm:flex-row gap-4 justify-center">
+            <Link
+              href="/suivi"
+              className="inline-flex items-center justify-center gap-2 bg-gray-900 text-white px-8 py-4 rounded-full text-sm uppercase tracking-widest hover:bg-gray-800 transition-all"
+            >
+              Suivre ma commande
+            </Link>
+            <Link
+              href="/shop"
+              className="inline-flex items-center justify-center gap-2 border border-gray-200 text-gray-900 px-8 py-4 rounded-full text-sm uppercase tracking-widest hover:border-gray-900 transition-all"
+            >
+              Continuer mes achats
+            </Link>
+          </div>
+
+          {/* Support */}
+          <div className="mt-16 pt-8 border-t border-gray-100">
+            <p className="text-sm text-gray-400 mb-4">Une question ?</p>
+            <a
+              href={`https://wa.me/${siteConfig.whatsapp.number}`}
+              target="_blank"
+              rel="noopener noreferrer"
+              className="inline-flex items-center gap-2 text-gray-900 hover:text-gray-600 transition-colors"
+            >
+              <MessageCircle size={18} />
+              <span className="border-b border-gray-900 pb-0.5">
+                Contacter le support
+              </span>
+            </a>
+          </div>
         </div>
-    );
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/page.tsx b/src/app/page.tsx
index f594c71..a12ec44 100644
--- a/src/app/page.tsx
+++ b/src/app/page.tsx
@@ -10,328 +10,349 @@ import { Star, ArrowRight, Quote, CheckCircle2 } from "lucide-react";
 
 // Intersection Observer hook for scroll animations
 function useInView(threshold = 0.1) {
-    const ref = useRef<HTMLDivElement>(null);
-    const [isInView, setIsInView] = useState(false);
+  const ref = useRef<HTMLDivElement>(null);
+  const [isInView, setIsInView] = useState(false);
 
-    useEffect(() => {
-        const observer = new IntersectionObserver(
-            ([entry]) => {
-                if (entry.isIntersecting) {
-                    setIsInView(true);
-                }
-            },
-            { threshold }
-        );
-
-        if (ref.current) {
-            observer.observe(ref.current);
+  useEffect(() => {
+    const observer = new IntersectionObserver(
+      ([entry]) => {
+        if (entry.isIntersecting) {
+          setIsInView(true);
         }
+      },
+      { threshold },
+    );
+
+    if (ref.current) {
+      observer.observe(ref.current);
+    }
 
-        return () => observer.disconnect();
-    }, [threshold]);
+    return () => observer.disconnect();
+  }, [threshold]);
 
-    return { ref, isInView };
+  return { ref, isInView };
 }
 
 export default function Home() {
-    const { t, language } = useLanguage();
-    const [newCollection, setNewCollection] = useState<any[]>([]);
-    const [collections, setCollections] = useState<any[]>([]);
-    const [loading, setLoading] = useState(true);
+  const { t, language } = useLanguage();
+  const [newCollection, setNewCollection] = useState<any[]>([]);
+  const [collections, setCollections] = useState<any[]>([]);
+  const [loading, setLoading] = useState(true);
 
-    // Animation hooks for each section
-    const collectionSection = useInView();
-    const collectionsSection = useInView();
-    const reviewsSection = useInView();
+  // Animation hooks for each section
+  const collectionSection = useInView();
+  const collectionsSection = useInView();
+  const reviewsSection = useInView();
 
-    useEffect(() => {
-        const fetchData = async () => {
-            try {
-                // Fetch products (handle paginated response)
-                const productsRes = await fetch("/api/products?pageSize=4&isActive=true");
-                const productsData = await productsRes.json();
-                const productsList = Array.isArray(productsData) ? productsData : (productsData.items || []);
-                setNewCollection(productsList.slice(0, 4));
+  useEffect(() => {
+    const fetchData = async () => {
+      try {
+        // Fetch products (handle paginated response)
+        const productsRes = await fetch(
+          "/api/products?pageSize=4&isActive=true",
+        );
+        const productsData = await productsRes.json();
+        const productsList = Array.isArray(productsData)
+          ? productsData
+          : productsData.items || [];
+        setNewCollection(productsList.slice(0, 4));
 
-                // Fetch collections
-                const collectionsRes = await fetch("/api/collections");
-                const collectionsData = await collectionsRes.json();
-                const collectionsList = Array.isArray(collectionsData) ? collectionsData : (collectionsData?.items || []);
-                setCollections(collectionsList.slice(0, 3));
-            } catch (error) {
-                console.error("Error fetching data:", error);
-            } finally {
-                setLoading(false);
-            }
-        };
+        // Fetch collections
+        const collectionsRes = await fetch("/api/collections");
+        const collectionsData = await collectionsRes.json();
+        const collectionsList = Array.isArray(collectionsData)
+          ? collectionsData
+          : collectionsData?.items || [];
+        setCollections(collectionsList.slice(0, 3));
+      } catch (error) {
+        console.error("Error fetching data:", error);
+      } finally {
+        setLoading(false);
+      }
+    };
 
-        fetchData();
-    }, []);
+    fetchData();
+  }, []);
 
-    const reviews = [
-        {
-            text: t("home.reviews.1.text"),
-            author: "Yasmin B.",
-            rating: 5
-        },
-        {
-            text: t("home.reviews.2.text"),
-            author: "Amina",
-            rating: 5
-        },
-        {
-            text: t("home.reviews.3.text"),
-            author: "Mima B.",
-            rating: 5
-        }
-    ];
+  const reviews = [
+    {
+      text: t("home.reviews.1.text"),
+      author: "Yasmin B.",
+      rating: 5,
+    },
+    {
+      text: t("home.reviews.2.text"),
+      author: "Amina",
+      rating: 5,
+    },
+    {
+      text: t("home.reviews.3.text"),
+      author: "Mima B.",
+      rating: 5,
+    },
+  ];
 
-    return (
-        <div className="flex flex-col bg-harp-cream">
-            {/* Hero Section - Editorial Style */}
-            <section className="relative h-screen min-h-[700px] w-full overflow-hidden">
-                <div className="absolute inset-0">
-                    <Image
-                        src="/Image%20Hero.avif"
-                        alt="Harp Collection - Femme élégante"
-                        fill
-                        sizes="100vw"
-                        className="object-cover object-top"
-                        priority
-                    />
-                    <div className="absolute inset-0 bg-black/20" />
-                </div>
+  return (
+    <div className="flex flex-col bg-harp-cream">
+      {/* Hero Section - Editorial Style */}
+      <section className="relative h-screen min-h-[700px] w-full overflow-hidden">
+        <div className="absolute inset-0">
+          <Image
+            src="/Image%20Hero.avif"
+            alt="Harp Collection - Femme élégante"
+            fill
+            sizes="100vw"
+            className="object-cover object-top"
+            priority
+          />
+          <div className="absolute inset-0 bg-black/20" />
+        </div>
 
-                <div className="relative z-10 container mx-auto px-6 h-full flex items-center justify-center text-center">
-                    <div className="max-w-4xl animate-fade-in-up">
-                        <span className="text-white text-xs font-bold uppercase tracking-[0.3em] mb-6 block">
-                            {t("home.newCollection")}
-                        </span>
-                        <h1 className="text-5xl md:text-7xl lg:text-8xl font-serif font-medium text-white mb-8 leading-tight">
-                            {t("hero.title")}
-                        </h1>
-                        
-                        <div className="flex flex-col sm:flex-row gap-6 justify-center items-center mt-12">
-                            <Link
-                                href="/shop"
-                                className="bg-white text-harp-brown px-10 py-4 text-sm uppercase tracking-[0.15em] hover:bg-harp-cream transition-colors min-w-[200px]"
-                            >
-                                {t("hero.cta")}
-                            </Link>
-                        </div>
-                    </div>
-                </div>
-            </section>
+        <div className="relative z-10 container mx-auto px-6 h-full flex items-center justify-center text-center">
+          <div className="max-w-4xl animate-fade-in-up">
+            <span className="text-white text-xs font-bold uppercase tracking-[0.3em] mb-6 block">
+              {t("home.newCollection")}
+            </span>
+            <h1 className="text-5xl md:text-7xl lg:text-8xl font-serif font-medium text-white mb-8 leading-tight">
+              {t("hero.title")}
+            </h1>
 
-            {/* New Collection Section - Minimalist Grid */}
-            <section
-                ref={collectionSection.ref}
-                className="py-24 md:py-32 bg-harp-cream"
+            <div className="flex flex-col sm:flex-row gap-6 justify-center items-center mt-12">
+              <Link
+                href="/shop"
+                className="bg-white text-harp-brown px-10 py-4 text-sm uppercase tracking-[0.15em] hover:bg-harp-cream transition-colors min-w-[200px]"
+              >
+                {t("hero.cta")}
+              </Link>
+            </div>
+          </div>
+        </div>
+      </section>
+
+      {/* New Collection Section - Minimalist Grid */}
+      <section
+        ref={collectionSection.ref}
+        className="py-24 md:py-32 bg-harp-cream"
+      >
+        <div className="container mx-auto px-4">
+          <div className="flex flex-col md:flex-row justify-between items-end mb-16 gap-6">
+            <div
+              className={`transition-all duration-700 ${collectionSection.isInView ? "opacity-100 translate-y-0" : "opacity-0 translate-y-8"}`}
+            >
+              <span className="text-xs font-bold uppercase tracking-[0.2em] text-harp-caramel mb-2 block">
+                {t("home.section.new")}
+              </span>
+              <h2 className="text-3xl md:text-4xl font-serif font-medium text-harp-brown">
+                {t("home.latestArrivals")}
+              </h2>
+            </div>
+            <Link
+              href="/shop"
+              className="hidden md:flex items-center gap-2 text-sm uppercase tracking-widest text-harp-brown border-b border-harp-brown pb-1 hover:text-harp-caramel hover:border-harp-caramel transition-all"
             >
-                <div className="container mx-auto px-4">
-                    <div className="flex flex-col md:flex-row justify-between items-end mb-16 gap-6">
-                        <div className={`transition-all duration-700 ${collectionSection.isInView ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8'}`}>
-                            <span className="text-xs font-bold uppercase tracking-[0.2em] text-harp-caramel mb-2 block">{t("home.section.new")}</span>
-                            <h2 className="text-3xl md:text-4xl font-serif font-medium text-harp-brown">
-                                {t("home.latestArrivals")}
-                            </h2>
-                        </div>
-                        <Link
-                            href="/shop"
-                            className="hidden md:flex items-center gap-2 text-sm uppercase tracking-widest text-harp-brown border-b border-harp-brown pb-1 hover:text-harp-caramel hover:border-harp-caramel transition-all"
-                        >
-                            {t("home.seeAll")} <ArrowRight size={16} />
-                        </Link>
-                    </div>
+              {t("home.seeAll")} <ArrowRight size={16} />
+            </Link>
+          </div>
 
-                    {loading ? (
-                        <ProductGridSkeleton count={4} />
-                    ) : newCollection.length > 0 ? (
-                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-x-8 gap-y-12">
-                            {newCollection.map((product, index) => {
-                                const images = JSON.parse(product.images);
-                                return (
-                                    <div
-                                        key={product.id}
-                                        className={`transition-all duration-700 ${collectionSection.isInView ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8'}`}
-                                        style={{ transitionDelay: `${index * 100}ms` }}
-                                    >
-                                        <ProductCard
-                                            id={product.id}
-                                            name={language === "fr" ? product.nameFr : product.nameAr}
-                                            price={product.price}
-                                            image={images[0]}
-                                            category={t("shop.badge.new")}
-                                            isNew={true}
-                                        />
-                                    </div>
-                                );
-                            })}
-                        </div>
-                    ) : (
-                        <div className="text-center py-12">
-                            <p className="text-gray-500 mb-4">{t("home.noProducts")}</p>
-                        </div>
-                    )}
-                    
-                    <div className="mt-12 text-center md:hidden">
-                        <Link
-                            href="/shop"
-                            className="inline-flex items-center gap-2 border-b border-harp-brown pb-1 text-sm uppercase tracking-widest text-harp-brown"
-                        >
-                            {t("home.seeAll")} <ArrowRight size={16} />
-                        </Link>
-                    </div>
-                </div>
-            </section>
+          {loading ? (
+            <ProductGridSkeleton count={4} />
+          ) : newCollection.length > 0 ? (
+            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-x-8 gap-y-12">
+              {newCollection.map((product, index) => {
+                const images = JSON.parse(product.images);
+                return (
+                  <div
+                    key={product.id}
+                    className={`transition-all duration-700 ${collectionSection.isInView ? "opacity-100 translate-y-0" : "opacity-0 translate-y-8"}`}
+                    style={{ transitionDelay: `${index * 100}ms` }}
+                  >
+                    <ProductCard
+                      id={product.id}
+                      name={language === "fr" ? product.nameFr : product.nameAr}
+                      price={product.price}
+                      image={images[0]}
+                      category={t("shop.badge.new")}
+                      isNew={true}
+                    />
+                  </div>
+                );
+              })}
+            </div>
+          ) : (
+            <div className="text-center py-12">
+              <p className="text-gray-500 mb-4">{t("home.noProducts")}</p>
+            </div>
+          )}
 
-            {/* Focus Product Section - Editorial Layout */}
-            <section className="py-0 bg-harp-sand/20">
-                <div className="grid grid-cols-1 lg:grid-cols-2 min-h-[600px]">
-                    <div className="relative h-[500px] lg:h-auto order-1">
-                        <Image
-                            src="https://images.unsplash.com/photo-1564584217132-2271feaeb3c5?w=1200&q=80" 
-                            alt="La pièce du moment"
-                            fill
-                            className="object-cover"
-                        />
-                    </div>
-                    <div className="flex items-center justify-center p-12 lg:p-24 order-2">
-                        <div className="max-w-md">
-                            <span className="text-xs font-bold uppercase tracking-[0.2em] text-harp-caramel mb-6 block">
-                                {t("home.featured.badge")}
-                            </span>
-                            <h2 className="text-4xl md:text-5xl font-serif font-medium text-harp-brown mb-6">
-                                {t("home.featured.title")}
-                            </h2>
-                            <p className="text-gray-600 text-lg leading-relaxed mb-8 font-light">
-                                {t("home.featured.desc")}
-                            </p>
-                            <Link
-                                href="/shop"
-                                className="inline-block bg-harp-brown text-white px-8 py-4 text-xs uppercase tracking-[0.2em] hover:bg-harp-caramel transition-colors"
-                            >
-                                {t("home.discover")}
-                            </Link>
-                        </div>
-                    </div>
-                </div>
-            </section>
+          <div className="mt-12 text-center md:hidden">
+            <Link
+              href="/shop"
+              className="inline-flex items-center gap-2 border-b border-harp-brown pb-1 text-sm uppercase tracking-widest text-harp-brown"
+            >
+              {t("home.seeAll")} <ArrowRight size={16} />
+            </Link>
+          </div>
+        </div>
+      </section>
 
-            {/* Values Section - Darker Contrast */}
-            <section className="py-24 bg-harp-brown text-harp-cream">
-                <div className="container mx-auto px-4">
-                    <div className="grid grid-cols-1 md:grid-cols-3 gap-12 text-center">
-                        <div>
-                            <h3 className="font-serif font-medium text-xl text-white mb-3">{t("home.values.quality.title")}</h3>
-                            <p className="text-harp-beige/80 font-light text-sm leading-relaxed">
-                                {t("home.values.quality.desc")}
-                            </p>
-                        </div>
-                        <div>
-                            <h3 className="font-serif font-medium text-xl text-white mb-3">{t("home.values.delivery.title")}</h3>
-                            <p className="text-harp-beige/80 font-light text-sm leading-relaxed">
-                                {t("home.values.delivery.desc")}
-                            </p>
-                        </div>
-                        <div>
-                            <h3 className="font-serif font-medium text-xl text-white mb-3">{t("home.values.service.title")}</h3>
-                            <p className="text-harp-beige/80 font-light text-sm leading-relaxed">
-                                {t("home.values.service.desc")}
-                            </p>
-                        </div>
-                    </div>
-                </div>
-            </section>
+      {/* Focus Product Section - Editorial Layout */}
+      <section className="py-0 bg-harp-sand/20">
+        <div className="grid grid-cols-1 lg:grid-cols-2 min-h-[600px]">
+          <div className="relative h-[500px] lg:h-auto order-1">
+            <Image
+              src="https://images.unsplash.com/photo-1564584217132-2271feaeb3c5?w=1200&q=80"
+              alt="La pièce du moment"
+              fill
+              className="object-cover"
+            />
+          </div>
+          <div className="flex items-center justify-center p-12 lg:p-24 order-2">
+            <div className="max-w-md">
+              <span className="text-xs font-bold uppercase tracking-[0.2em] text-harp-caramel mb-6 block">
+                {t("home.featured.badge")}
+              </span>
+              <h2 className="text-4xl md:text-5xl font-serif font-medium text-harp-brown mb-6">
+                {t("home.featured.title")}
+              </h2>
+              <p className="text-gray-600 text-lg leading-relaxed mb-8 font-light">
+                {t("home.featured.desc")}
+              </p>
+              <Link
+                href="/shop"
+                className="inline-block bg-harp-brown text-white px-8 py-4 text-xs uppercase tracking-[0.2em] hover:bg-harp-caramel transition-colors"
+              >
+                {t("home.discover")}
+              </Link>
+            </div>
+          </div>
+        </div>
+      </section>
 
-            {/* Collections Showcase - Visual */}
-            {collections.length > 0 && (
-                <section
-                    ref={collectionsSection.ref}
-                    className="py-24 bg-harp-cream"
-                >
-                    <div className="container mx-auto px-4">
-                        <div className="text-center mb-16">
-                            <h2 className="text-3xl md:text-4xl font-serif font-medium text-harp-brown">{t("home.collections.title")}</h2>
-                        </div>
+      {/* Values Section - Darker Contrast */}
+      <section className="py-24 bg-harp-brown text-harp-cream">
+        <div className="container mx-auto px-4">
+          <div className="grid grid-cols-1 md:grid-cols-3 gap-12 text-center">
+            <div>
+              <h3 className="font-serif font-medium text-xl text-white mb-3">
+                {t("home.values.quality.title")}
+              </h3>
+              <p className="text-harp-beige/80 font-light text-sm leading-relaxed">
+                {t("home.values.quality.desc")}
+              </p>
+            </div>
+            <div>
+              <h3 className="font-serif font-medium text-xl text-white mb-3">
+                {t("home.values.delivery.title")}
+              </h3>
+              <p className="text-harp-beige/80 font-light text-sm leading-relaxed">
+                {t("home.values.delivery.desc")}
+              </p>
+            </div>
+            <div>
+              <h3 className="font-serif font-medium text-xl text-white mb-3">
+                {t("home.values.service.title")}
+              </h3>
+              <p className="text-harp-beige/80 font-light text-sm leading-relaxed">
+                {t("home.values.service.desc")}
+              </p>
+            </div>
+          </div>
+        </div>
+      </section>
 
-                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
-                            {collections.map((collection, index) => (
-                                <Link
-                                    key={collection.id}
-                                    href={`/shop?collection=${collection.id}`}
-                                    className="group relative aspect-[3/4] overflow-hidden bg-gray-100"
-                                >
-                                    <Image
-                                        src={collection.image || "https://images.unsplash.com/photo-1585487000160-6ebcfceb0d03?w=800&q=80"}
-                                        alt={language === "fr" ? collection.nameFr : collection.nameAr}
-                                        fill
-                                        sizes="(max-width: 768px) 100vw, 33vw"
-                                        className="object-cover transition-transform duration-1000 group-hover:scale-105"
-                                    />
-                                    <div className="absolute inset-0 bg-black/10 group-hover:bg-black/20 transition-colors" />
-                                    <div className="absolute inset-0 flex items-center justify-center">
-                                        <h3 className="text-2xl font-serif text-white font-medium tracking-widest uppercase opacity-0 translate-y-4 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-500">
-                                            {language === "fr" ? collection.nameFr : collection.nameAr}
-                                        </h3>
-                                    </div>
-                                </Link>
-                            ))}
-                        </div>
-                    </div>
-                </section>
-            )}
+      {/* Collections Showcase - Visual */}
+      {collections.length > 0 && (
+        <section ref={collectionsSection.ref} className="py-24 bg-harp-cream">
+          <div className="container mx-auto px-4">
+            <div className="text-center mb-16">
+              <h2 className="text-3xl md:text-4xl font-serif font-medium text-harp-brown">
+                {t("home.collections.title")}
+              </h2>
+            </div>
 
-            {/* Reviews Section - Minimal Cards */}
-            <section
-                ref={reviewsSection.ref}
-                className="py-24 bg-harp-beige/10"
-            >
-                <div className="container mx-auto px-4">
-                    <div className="text-center mb-16">
-                        <span className="text-xs font-bold uppercase tracking-[0.2em] text-harp-caramel mb-3 block">{t("home.testimonials.badge")}</span>
-                        <h2 className="text-3xl md:text-4xl font-serif font-medium text-harp-brown">
-                            {t("home.testimonials.title")}
-                        </h2>
-                    </div>
+            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
+              {collections.map((collection, index) => (
+                <Link
+                  key={collection.id}
+                  href={`/shop?collection=${collection.id}`}
+                  className="group relative aspect-[3/4] overflow-hidden bg-gray-100"
+                >
+                  <Image
+                    src={
+                      collection.image ||
+                      "https://images.unsplash.com/photo-1585487000160-6ebcfceb0d03?w=800&q=80"
+                    }
+                    alt={
+                      language === "fr" ? collection.nameFr : collection.nameAr
+                    }
+                    fill
+                    sizes="(max-width: 768px) 100vw, 33vw"
+                    className="object-cover transition-transform duration-1000 group-hover:scale-105"
+                  />
+                  <div className="absolute inset-0 bg-black/10 group-hover:bg-black/20 transition-colors" />
+                  <div className="absolute inset-0 flex items-center justify-center">
+                    <h3 className="text-2xl font-serif text-white font-medium tracking-widest uppercase opacity-0 translate-y-4 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-500">
+                      {language === "fr"
+                        ? collection.nameFr
+                        : collection.nameAr}
+                    </h3>
+                  </div>
+                </Link>
+              ))}
+            </div>
+          </div>
+        </section>
+      )}
 
-                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto">
-                        {reviews.map((review, index) => (
-                            <div
-                                key={index}
-                                className="bg-white p-8 shadow-[0_2px_20px_-5px_rgba(61,35,20,0.05)] text-center"
-                            >
-                                <div className="flex justify-center gap-1 text-harp-caramel mb-6">
-                                    {[...Array(review.rating)].map((_, j) => (
-                                        <Star key={j} size={14} fill="currentColor" />
-                                    ))}
-                                </div>
-                                <p className="text-gray-600 italic mb-6 font-light leading-relaxed">
-                                    "{review.text}"
-                                </p>
-                                <p className="text-xs font-bold uppercase tracking-widest text-harp-brown">
-                                    {review.author}
-                                </p>
-                            </div>
-                        ))}
-                    </div>
-                </div>
-            </section>
+      {/* Reviews Section - Minimal Cards */}
+      <section ref={reviewsSection.ref} className="py-24 bg-harp-beige/10">
+        <div className="container mx-auto px-4">
+          <div className="text-center mb-16">
+            <span className="text-xs font-bold uppercase tracking-[0.2em] text-harp-caramel mb-3 block">
+              {t("home.testimonials.badge")}
+            </span>
+            <h2 className="text-3xl md:text-4xl font-serif font-medium text-harp-brown">
+              {t("home.testimonials.title")}
+            </h2>
+          </div>
 
-            {/* Simple CTA */}
-            <section className="py-32 bg-white text-center border-t border-harp-sand/30">
-                <div className="container mx-auto px-4">
-                    <h2 className="text-4xl md:text-5xl font-serif font-medium text-harp-brown mb-8">
-                        {t("home.join.title")}
-                    </h2>
-                    <Link
-                        href="/shop"
-                        className="inline-block border-b border-harp-brown pb-1 text-sm uppercase tracking-widest text-harp-brown hover:text-harp-caramel hover:border-harp-caramel transition-all"
-                    >
-                        {t("home.join.cta")}
-                    </Link>
+          <div className="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto">
+            {reviews.map((review, index) => (
+              <div
+                key={index}
+                className="bg-white p-8 shadow-[0_2px_20px_-5px_rgba(61,35,20,0.05)] text-center"
+              >
+                <div className="flex justify-center gap-1 text-harp-caramel mb-6">
+                  {[...Array(review.rating)].map((_, j) => (
+                    <Star key={j} size={14} fill="currentColor" />
+                  ))}
                 </div>
-            </section>
+                <p className="text-gray-600 italic mb-6 font-light leading-relaxed">
+                  "{review.text}"
+                </p>
+                <p className="text-xs font-bold uppercase tracking-widest text-harp-brown">
+                  {review.author}
+                </p>
+              </div>
+            ))}
+          </div>
         </div>
-    );
+      </section>
+
+      {/* Simple CTA */}
+      <section className="py-32 bg-white text-center border-t border-harp-sand/30">
+        <div className="container mx-auto px-4">
+          <h2 className="text-4xl md:text-5xl font-serif font-medium text-harp-brown mb-8">
+            {t("home.join.title")}
+          </h2>
+          <Link
+            href="/shop"
+            className="inline-block border-b border-harp-brown pb-1 text-sm uppercase tracking-widest text-harp-brown hover:text-harp-caramel hover:border-harp-caramel transition-all"
+          >
+            {t("home.join.cta")}
+          </Link>
+        </div>
+      </section>
+    </div>
+  );
 }
diff --git a/src/app/privacy/page.tsx b/src/app/privacy/page.tsx
index a6effda..f6e34c0 100644
--- a/src/app/privacy/page.tsx
+++ b/src/app/privacy/page.tsx
@@ -4,182 +4,193 @@ import { useLanguage } from "@/components/LanguageProvider";
 import { Shield, Lock, Eye, Mail, Trash2, UserCheck } from "lucide-react";
 
 export default function PrivacyPage() {
-    const { language } = useLanguage();
-    const isAr = language === "ar";
-
-    const content = {
-        fr: {
-            title: "Politique de Confidentialité",
-            lastUpdate: "Dernière mise à jour : Novembre 2025",
-            intro: "Chez Harp, nous accordons une importance primordiale à la protection de vos données personnelles. Cette politique explique en toute transparence comment nous collectons, utilisons et protégeons vos informations.",
-            sections: [
-                {
-                    icon: Eye,
-                    title: "1. Données collectées",
-                    content: `Nous collectons uniquement les informations nécessaires au traitement de vos commandes :
+  const { language } = useLanguage();
+  const isAr = language === "ar";
+
+  const content = {
+    fr: {
+      title: "Politique de Confidentialité",
+      lastUpdate: "Dernière mise à jour : Novembre 2025",
+      intro:
+        "Chez Harp, nous accordons une importance primordiale à la protection de vos données personnelles. Cette politique explique en toute transparence comment nous collectons, utilisons et protégeons vos informations.",
+      sections: [
+        {
+          icon: Eye,
+          title: "1. Données collectées",
+          content: `Nous collectons uniquement les informations nécessaires au traitement de vos commandes :
                     
 • **Identité** : Nom, prénom, numéro de téléphone
 • **Livraison** : Adresse postale, ville, wilaya
 • **Commande** : Détails des produits achetés
 
-Nous ne collectons **JAMAIS** vos informations bancaires (paiement à la livraison uniquement) ni de données sensibles.`
-                },
-                {
-                    icon: Lock,
-                    title: "2. Utilisation des données",
-                    content: `Vos données sont utilisées exclusivement pour :
+Nous ne collectons **JAMAIS** vos informations bancaires (paiement à la livraison uniquement) ni de données sensibles.`,
+        },
+        {
+          icon: Lock,
+          title: "2. Utilisation des données",
+          content: `Vos données sont utilisées exclusivement pour :
 
 • Expédier vos commandes
 • Vous notifier de l'avancement de la livraison
 • Assurer le service après-vente
 
-Nous ne vendons, ne louons et ne partageons vos données avec aucun tiers à des fins commerciales.`
-                },
-                {
-                    icon: Shield,
-                    title: "3. Protection des données",
-                    content: `La sécurité de vos données est notre priorité :
+Nous ne vendons, ne louons et ne partageons vos données avec aucun tiers à des fins commerciales.`,
+        },
+        {
+          icon: Shield,
+          title: "3. Protection des données",
+          content: `La sécurité de vos données est notre priorité :
 
 • Stockage sur des serveurs sécurisés
 • Accès strictement limité au personnel autorisé
-• Connexions chiffrées (HTTPS)`
-                },
-                {
-                    icon: UserCheck,
-                    title: "4. Vos droits",
-                    content: `Conformément à la réglementation, vous disposez d'un droit d'accès, de rectification et de suppression de vos données.
-
-Pour exercer ces droits, contactez simplement notre service client.`
-                },
-                {
-                    icon: Trash2,
-                    title: "5. Conservation",
-                    content: `Vos données de commande sont conservées durant la durée légale obligatoire (3 ans). Vos coordonnées sont conservées tant que vous souhaitez rester en contact avec nous.
-
-Vous pouvez demander leur suppression à tout moment.`
-                },
-                {
-                    icon: Mail,
-                    title: "6. Contact",
-                    content: `Pour toute question relative à vos données :
+• Connexions chiffrées (HTTPS)`,
+        },
+        {
+          icon: UserCheck,
+          title: "4. Vos droits",
+          content: `Conformément à la réglementation, vous disposez d'un droit d'accès, de rectification et de suppression de vos données.
+
+Pour exercer ces droits, contactez simplement notre service client.`,
+        },
+        {
+          icon: Trash2,
+          title: "5. Conservation",
+          content: `Vos données de commande sont conservées durant la durée légale obligatoire (3 ans). Vos coordonnées sont conservées tant que vous souhaitez rester en contact avec nous.
+
+Vous pouvez demander leur suppression à tout moment.`,
+        },
+        {
+          icon: Mail,
+          title: "6. Contact",
+          content: `Pour toute question relative à vos données :
 
 • **Email** : contact@harpalgeria.com
 • **WhatsApp** : Service Client
 
-Nous nous engageons à vous répondre sous 48h.`
-                }
-            ]
+Nous nous engageons à vous répondre sous 48h.`,
         },
-        ar: {
-            title: "سياسة الخصوصية",
-            lastUpdate: "آخر تحديث: نوفمبر 2025",
-            intro: "في هارب، نولي أهمية قصوى لحماية بياناتك الشخصية. تشرح هذه السياسة بشفافية كيفية جمع واستخدام وحماية معلوماتك.",
-            sections: [
-                {
-                    icon: Eye,
-                    title: "1. البيانات التي نجمعها",
-                    content: `نجمع فقط المعلومات الضرورية لمعالجة طلباتك:
+      ],
+    },
+    ar: {
+      title: "سياسة الخصوصية",
+      lastUpdate: "آخر تحديث: نوفمبر 2025",
+      intro:
+        "في هارب، نولي أهمية قصوى لحماية بياناتك الشخصية. تشرح هذه السياسة بشفافية كيفية جمع واستخدام وحماية معلوماتك.",
+      sections: [
+        {
+          icon: Eye,
+          title: "1. البيانات التي نجمعها",
+          content: `نجمع فقط المعلومات الضرورية لمعالجة طلباتك:
                     
 • **الهوية**: الاسم، اللقب، رقم الهاتف
 • **التوصيل**: العنوان، المدينة، الولاية
 • **الطلب**: تفاصيل المنتجات المشتراة
 
-لا نجمع **أبداً** معلوماتك البنكية (الدفع عند الاستلام فقط) أو أي بيانات حساسة.`
-                },
-                {
-                    icon: Lock,
-                    title: "2. استخدام البيانات",
-                    content: `تستخدم بياناتك حصرياً لـ:
+لا نجمع **أبداً** معلوماتك البنكية (الدفع عند الاستلام فقط) أو أي بيانات حساسة.`,
+        },
+        {
+          icon: Lock,
+          title: "2. استخدام البيانات",
+          content: `تستخدم بياناتك حصرياً لـ:
 
 • شحن طلباتك
 • إعلامك بتقدم التوصيل
 • ضمان خدمة ما بعد البيع
 
-لا نبيع ولا نؤجر ولا نشارك بياناتك مع أي طرف ثالث لأغراض تجارية.`
-                },
-                {
-                    icon: Shield,
-                    title: "3. حماية البيانات",
-                    content: `أمن بياناتك هو أولويتنا:
+لا نبيع ولا نؤجر ولا نشارك بياناتك مع أي طرف ثالث لأغراض تجارية.`,
+        },
+        {
+          icon: Shield,
+          title: "3. حماية البيانات",
+          content: `أمن بياناتك هو أولويتنا:
 
 • تخزين على خوادم آمنة
 • وصول مقيد بدقة للموظفين المصرح لهم
-• اتصالات مشفرة (HTTPS)`
-                },
-                {
-                    icon: UserCheck,
-                    title: "4. حقوقك",
-                    content: `وفقاً للقوانين، لديك الحق في الوصول إلى بياناتك وتصحيحها وحذفها.
-
-لممارسة هذه الحقوق، تواصل ببساطة مع خدمة العملاء.`
-                },
-                {
-                    icon: Trash2,
-                    title: "5. الاحتفاظ بالبيانات",
-                    content: `يتم الاحتفاظ ببيانات طلبك للمدة القانونية الإلزامية (3 سنوات). يتم الاحتفاظ بمعلومات الاتصال طالما رغبت في البقاء على تواصل معنا.
-
-يمكنك طلب حذفها في أي وقت.`
-                },
-                {
-                    icon: Mail,
-                    title: "6. الاتصال",
-                    content: `لأي سؤال يتعلق ببياناتك:
+• اتصالات مشفرة (HTTPS)`,
+        },
+        {
+          icon: UserCheck,
+          title: "4. حقوقك",
+          content: `وفقاً للقوانين، لديك الحق في الوصول إلى بياناتك وتصحيحها وحذفها.
+
+لممارسة هذه الحقوق، تواصل ببساطة مع خدمة العملاء.`,
+        },
+        {
+          icon: Trash2,
+          title: "5. الاحتفاظ بالبيانات",
+          content: `يتم الاحتفاظ ببيانات طلبك للمدة القانونية الإلزامية (3 سنوات). يتم الاحتفاظ بمعلومات الاتصال طالما رغبت في البقاء على تواصل معنا.
+
+يمكنك طلب حذفها في أي وقت.`,
+        },
+        {
+          icon: Mail,
+          title: "6. الاتصال",
+          content: `لأي سؤال يتعلق ببياناتك:
 
 • **البريد الإلكتروني**: contact@harpalgeria.com
 • **واتساب**: خدمة العملاء
 
-نلتزم بالرد عليك خلال 48 ساعة.`
-                }
-            ]
-        }
-    };
-
-    const t = isAr ? content.ar : content.fr;
-
-    return (
-        <div className={`min-h-screen bg-white pt-32 pb-20 ${isAr ? 'rtl' : ''}`}>
-            <div className="container mx-auto px-4 max-w-3xl">
-                {/* Header */}
-                <div className="text-center mb-16">
-                    <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
-                        Légal
-                    </span>
-                    <h1 className="text-3xl md:text-5xl font-serif font-medium text-gray-900 mb-6">
-                        {t.title}
-                    </h1>
-                    <p className="text-gray-500 font-light">
-                        {t.lastUpdate}
-                    </p>
-                </div>
+نلتزم بالرد عليك خلال 48 ساعة.`,
+        },
+      ],
+    },
+  };
+
+  const t = isAr ? content.ar : content.fr;
+
+  return (
+    <div className={`min-h-screen bg-white pt-32 pb-20 ${isAr ? "rtl" : ""}`}>
+      <div className="container mx-auto px-4 max-w-3xl">
+        {/* Header */}
+        <div className="text-center mb-16">
+          <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
+            Légal
+          </span>
+          <h1 className="text-3xl md:text-5xl font-serif font-medium text-gray-900 mb-6">
+            {t.title}
+          </h1>
+          <p className="text-gray-500 font-light">{t.lastUpdate}</p>
+        </div>
 
-                {/* Intro */}
-                <div className="mb-16 text-center">
-                    <p className="text-lg text-gray-600 font-light leading-relaxed max-w-2xl mx-auto">
-                        {t.intro}
-                    </p>
-                </div>
+        {/* Intro */}
+        <div className="mb-16 text-center">
+          <p className="text-lg text-gray-600 font-light leading-relaxed max-w-2xl mx-auto">
+            {t.intro}
+          </p>
+        </div>
 
-                {/* Sections */}
-                <div className="space-y-12">
-                    {t.sections.map((section, index) => (
-                        <div key={index} className="group border-t border-gray-100 pt-12">
-                            <div className="flex flex-col md:flex-row gap-6 md:gap-12">
-                                <div className="md:w-1/3 flex items-start gap-4">
-                                    <section.icon size={20} className="text-gray-400 mt-1 group-hover:text-gray-900 transition-colors" />
-                                    <h2 className="text-xl font-serif font-medium text-gray-900">{section.title}</h2>
-                                </div>
-                                <div className="md:w-2/3">
-                                    <div className="text-gray-500 font-light leading-relaxed whitespace-pre-line">
-                                        {section.content.split('**').map((part, i) => 
-                                            i % 2 === 1 ? <strong key={i} className="text-gray-900 font-medium">{part}</strong> : part
-                                        )}
-                                    </div>
-                                </div>
-                            </div>
-                        </div>
-                    ))}
+        {/* Sections */}
+        <div className="space-y-12">
+          {t.sections.map((section, index) => (
+            <div key={index} className="group border-t border-gray-100 pt-12">
+              <div className="flex flex-col md:flex-row gap-6 md:gap-12">
+                <div className="md:w-1/3 flex items-start gap-4">
+                  <section.icon
+                    size={20}
+                    className="text-gray-400 mt-1 group-hover:text-gray-900 transition-colors"
+                  />
+                  <h2 className="text-xl font-serif font-medium text-gray-900">
+                    {section.title}
+                  </h2>
+                </div>
+                <div className="md:w-2/3">
+                  <div className="text-gray-500 font-light leading-relaxed whitespace-pre-line">
+                    {section.content.split("**").map((part, i) =>
+                      i % 2 === 1 ? (
+                        <strong key={i} className="text-gray-900 font-medium">
+                          {part}
+                        </strong>
+                      ) : (
+                        part
+                      ),
+                    )}
+                  </div>
                 </div>
+              </div>
             </div>
+          ))}
         </div>
-    );
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/product/[id]/layout.tsx b/src/app/product/[id]/layout.tsx
index c6d191a..8380382 100644
--- a/src/app/product/[id]/layout.tsx
+++ b/src/app/product/[id]/layout.tsx
@@ -2,56 +2,62 @@ import { prisma } from "@/lib/prisma";
 import { Metadata } from "next";
 
 interface Props {
-    params: Promise<{ id: string }>;
-    children: React.ReactNode;
+  params: Promise<{ id: string }>;
+  children: React.ReactNode;
 }
 
 export async function generateMetadata({ params }: Props): Promise<Metadata> {
-    const { id } = await params;
-    
-    try {
-        const product = await prisma.product.findUnique({
-            where: { id },
-            include: { collection: true },
-        });
+  const { id } = await params;
 
-        if (!product) {
-            return {
-                title: "Produit non trouvé",
-            };
-        }
+  try {
+    const product = await prisma.product.findUnique({
+      where: { id },
+      include: { collection: true },
+    });
 
-        const images = JSON.parse(product.images);
-        const firstImage = images[0] || "";
-
-        return {
-            title: product.nameFr,
-            description: product.descriptionFr.slice(0, 160),
-            openGraph: {
-                title: `${product.nameFr} | Harp`,
-                description: product.descriptionFr.slice(0, 160),
-                images: firstImage ? [{ url: firstImage, width: 600, height: 800 }] : [],
-                type: "website",
-                locale: "fr_FR",
-            },
-            twitter: {
-                card: "summary_large_image",
-                title: `${product.nameFr} | Harp`,
-                description: product.descriptionFr.slice(0, 160),
-                images: firstImage ? [firstImage] : [],
-            },
-            other: {
-                "product:price:amount": product.price.toString(),
-                "product:price:currency": "DZD",
-            },
-        };
-    } catch (error) {
-        return {
-            title: "Harp - Produit",
-        };
+    if (!product) {
+      return {
+        title: "Produit non trouvé",
+      };
     }
+
+    const images = JSON.parse(product.images);
+    const firstImage = images[0] || "";
+
+    return {
+      title: product.nameFr,
+      description: product.descriptionFr.slice(0, 160),
+      openGraph: {
+        title: `${product.nameFr} | Harp`,
+        description: product.descriptionFr.slice(0, 160),
+        images: firstImage
+          ? [{ url: firstImage, width: 600, height: 800 }]
+          : [],
+        type: "website",
+        locale: "fr_FR",
+      },
+      twitter: {
+        card: "summary_large_image",
+        title: `${product.nameFr} | Harp`,
+        description: product.descriptionFr.slice(0, 160),
+        images: firstImage ? [firstImage] : [],
+      },
+      other: {
+        "product:price:amount": product.price.toString(),
+        "product:price:currency": "DZD",
+      },
+    };
+  } catch (error) {
+    return {
+      title: "Harp - Produit",
+    };
+  }
 }
 
-export default function ProductLayout({ children }: { children: React.ReactNode }) {
-    return <>{children}</>;
+export default function ProductLayout({
+  children,
+}: {
+  children: React.ReactNode;
+}) {
+  return <>{children}</>;
 }
diff --git a/src/app/product/[id]/page.tsx b/src/app/product/[id]/page.tsx
index b7c4ca3..9de4881 100644
--- a/src/app/product/[id]/page.tsx
+++ b/src/app/product/[id]/page.tsx
@@ -5,802 +5,1088 @@ import Image from "next/image";
 import Link from "next/link";
 import { useLanguage } from "@/components/LanguageProvider";
 import { useCart } from "@/components/CartProvider";
-import { 
-    Truck, 
-    ShieldCheck, 
-    ChevronRight, 
-    Minus, 
-    Plus, 
-    Heart,
-    Share2,
-    Check,
-    CreditCard,
-    RotateCcw,
-    Loader2,
-    ShoppingBag,
-    MessageCircle,
-    Sparkles,
-    ZoomIn,
-    X,
-    Ruler,
-    Star,
-    Quote
+import {
+  Truck,
+  ShieldCheck,
+  ChevronRight,
+  Minus,
+  Plus,
+  Heart,
+  Share2,
+  Check,
+  CreditCard,
+  RotateCcw,
+  Loader2,
+  ShoppingBag,
+  MessageCircle,
+  Sparkles,
+  ZoomIn,
+  X,
+  Ruler,
+  Star,
+  Quote,
 } from "lucide-react";
 import { getWhatsAppLink } from "@/lib/config";
 import { cn } from "@/lib/utils";
 
-export default function ProductPage({ params }: { params: Promise<{ id: string }> }) {
-    const { id } = use(params);
-    const { t, language } = useLanguage();
-    const { addItem } = useCart();
-
-    const [product, setProduct] = useState<any>(null);
-    const [loading, setLoading] = useState(true);
-    const [selectedSize, setSelectedSize] = useState("");
-    const [selectedColor, setSelectedColor] = useState("");
-    const [quantity, setQuantity] = useState(1);
-    const [activeImage, setActiveImage] = useState(0);
-    const [isWishlisted, setIsWishlisted] = useState(false);
-    const [addedToCart, setAddedToCart] = useState(false);
-    const [imageError, setImageError] = useState<Record<number, boolean>>({});
-    const [isZoomed, setIsZoomed] = useState(false);
-    const [showSizeGuide, setShowSizeGuide] = useState(false);
-    const [relatedProducts, setRelatedProducts] = useState<any[]>([]);
-
-    // Customer reviews (static for now, can be from DB later)
-    const reviews = [
-        { id: 1, author: "Sarah B.", location: "Alger", rating: 5, text: "La qualité est incroyable ! Le tissu est lourd et tombe parfaitement.", date: "Il y a 3 jours" },
-        { id: 2, author: "Amira K.", location: "Oran", rating: 5, text: "Exactement comme sur les photos. Livraison très rapide, j'ai reçu mon colis en 48h.", date: "Il y a 1 semaine" },
-        { id: 3, author: "Lina M.", location: "Constantine", rating: 5, text: "Je reçois des compliments à chaque sortie. La coupe est parfaite !", date: "Il y a 2 semaines" },
-    ];
-
-    useEffect(() => {
-        const fetchProduct = async () => {
-            try {
-                const res = await fetch(`/api/products/${id}`);
-                if (!res.ok) throw new Error("Product not found");
-                const data = await res.json();
-
-                // Parse JSON fields
-                data.images = JSON.parse(data.images);
-                data.sizes = JSON.parse(data.sizes);
-                data.colors = JSON.parse(data.colors);
-
-                setProduct(data);
-                // Set default selections
-                if (data.sizes.length > 0) setSelectedSize(data.sizes[0]);
-                if (data.colors.length > 0) setSelectedColor(data.colors[0]);
-            } catch (error) {
-                console.error("Error fetching product:", error);
-            } finally {
-                setLoading(false);
-            }
-        };
-
-        fetchProduct();
-    }, [id]);
-
-    // Fetch related products
-    useEffect(() => {
-        if (product?.collectionId) {
-            fetch(`/api/products?collection=${product.collectionId}&limit=4`)
-                .then(res => res.json())
-                .then(data => {
-                    const filtered = data
-                        .filter((p: any) => p.id !== id)
-                        .slice(0, 3)
-                        .map((p: any) => ({
-                            ...p,
-                            images: JSON.parse(p.images),
-                        }));
-                    setRelatedProducts(filtered);
-                })
-                .catch(() => setRelatedProducts([]));
-        } else if (product) {
-            // Fallback: get any products
-            fetch('/api/products?limit=4')
-                .then(res => res.json())
-                .then(data => {
-                    const filtered = data
-                        .filter((p: any) => p.id !== id)
-                        .slice(0, 3)
-                        .map((p: any) => ({
-                            ...p,
-                            images: JSON.parse(p.images),
-                        }));
-                    setRelatedProducts(filtered);
-                })
-                .catch(() => setRelatedProducts([]));
-        }
-    }, [product, id]);
-
-    const handleAddToCart = () => {
-        if (!product) return;
-        if (!selectedSize || !selectedColor) {
-            alert("Veuillez sélectionner une taille et une couleur");
-            return;
-        }
-        addItem({
-            productId: product.id,
-            name: language === "fr" ? product.nameFr : product.nameAr,
-            price: product.price,
-            image: product.images[0],
-            size: selectedSize,
-            color: selectedColor,
-            quantity: quantity,
-        });
-        setAddedToCart(true);
-        setTimeout(() => setAddedToCart(false), 2000);
-    };
+export default function ProductPage({
+  params,
+}: {
+  params: Promise<{ id: string }>;
+}) {
+  const { id } = use(params);
+  const { t, language } = useLanguage();
+  const { addItem } = useCart();
+
+  const [product, setProduct] = useState<any>(null);
+  const [loading, setLoading] = useState(true);
+  const [selectedSize, setSelectedSize] = useState("");
+  const [selectedColor, setSelectedColor] = useState("");
+  const [quantity, setQuantity] = useState(1);
+  const [activeImage, setActiveImage] = useState(0);
+  const [isWishlisted, setIsWishlisted] = useState(false);
+  const [addedToCart, setAddedToCart] = useState(false);
+  const [imageError, setImageError] = useState<Record<number, boolean>>({});
+  const [isZoomed, setIsZoomed] = useState(false);
+  const [showSizeGuide, setShowSizeGuide] = useState(false);
+  const [relatedProducts, setRelatedProducts] = useState<any[]>([]);
+
+  // Customer reviews (static for now, can be from DB later)
+  const reviews = [
+    {
+      id: 1,
+      author: "Sarah B.",
+      location: "Alger",
+      rating: 5,
+      text: "La qualité est incroyable ! Le tissu est lourd et tombe parfaitement.",
+      date: "Il y a 3 jours",
+    },
+    {
+      id: 2,
+      author: "Amira K.",
+      location: "Oran",
+      rating: 5,
+      text: "Exactement comme sur les photos. Livraison très rapide, j'ai reçu mon colis en 48h.",
+      date: "Il y a 1 semaine",
+    },
+    {
+      id: 3,
+      author: "Lina M.",
+      location: "Constantine",
+      rating: 5,
+      text: "Je reçois des compliments à chaque sortie. La coupe est parfaite !",
+      date: "Il y a 2 semaines",
+    },
+  ];
 
-    const handleWhatsApp = () => {
-        if (!product) return;
-        const productName = language === "fr" ? product.nameFr : product.nameAr;
-        const message = `Bonjour, je souhaite commander:\n\n🛍️ ${productName}\n📏 Taille: ${selectedSize}\n🎨 Couleur: ${selectedColor}\n🔢 Quantité: ${quantity}\n💰 Prix: ${product.price * quantity} DZD`;
-        window.open(getWhatsAppLink(message), "_blank");
+  useEffect(() => {
+    const fetchProduct = async () => {
+      try {
+        const res = await fetch(`/api/products/${id}`);
+        if (!res.ok) throw new Error("Product not found");
+        const data = await res.json();
+
+        // Parse JSON fields
+        data.images = JSON.parse(data.images);
+        data.sizes = JSON.parse(data.sizes);
+        data.colors = JSON.parse(data.colors);
+
+        setProduct(data);
+        // Set default selections
+        if (data.sizes.length > 0) setSelectedSize(data.sizes[0]);
+        if (data.colors.length > 0) setSelectedColor(data.colors[0]);
+      } catch (error) {
+        console.error("Error fetching product:", error);
+      } finally {
+        setLoading(false);
+      }
     };
 
-    const getFallbackImage = (name: string) => 
-        `https://placehold.co/600x800/F5F1EC/4A3A2A?text=${encodeURIComponent(name || 'Produit')}`;
-
-    // Loading Skeleton
-    if (loading) {
-        return (
-            <div className="min-h-screen bg-gradient-to-b from-harp-beige/30 to-white">
-                <div className="container mx-auto px-4 py-8">
-                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16">
-                        {/* Image skeleton */}
-                        <div className="space-y-4">
-                            <div className="relative aspect-[3/4] bg-gray-200 rounded-2xl animate-pulse" />
-                            <div className="grid grid-cols-4 gap-3">
-                                {[...Array(4)].map((_, i) => (
-                                    <div key={i} className="aspect-[3/4] bg-gray-200 rounded-xl animate-pulse" />
-                                ))}
-                            </div>
-                        </div>
-                        {/* Details skeleton */}
-                        <div className="space-y-6">
-                            <div className="h-8 bg-gray-200 rounded-lg w-3/4 animate-pulse" />
-                            <div className="h-6 bg-gray-200 rounded-lg w-1/3 animate-pulse" />
-                            <div className="space-y-2">
-                                <div className="h-4 bg-gray-200 rounded w-full animate-pulse" />
-                                <div className="h-4 bg-gray-200 rounded w-5/6 animate-pulse" />
-                            </div>
-                            <div className="flex gap-3">
-                                {[...Array(3)].map((_, i) => (
-                                    <div key={i} className="h-12 w-20 bg-gray-200 rounded-xl animate-pulse" />
-                                ))}
-                            </div>
-                        </div>
-                    </div>
-                </div>
-            </div>
-        );
+    fetchProduct();
+  }, [id]);
+
+  // Fetch related products
+  useEffect(() => {
+    if (product?.collectionId) {
+      fetch(`/api/products?collection=${product.collectionId}&limit=4`)
+        .then((res) => res.json())
+        .then((data) => {
+          const filtered = data
+            .filter((p: any) => p.id !== id)
+            .slice(0, 3)
+            .map((p: any) => ({
+              ...p,
+              images: JSON.parse(p.images),
+            }));
+          setRelatedProducts(filtered);
+        })
+        .catch(() => setRelatedProducts([]));
+    } else if (product) {
+      // Fallback: get any products
+      fetch("/api/products?limit=4")
+        .then((res) => res.json())
+        .then((data) => {
+          const filtered = data
+            .filter((p: any) => p.id !== id)
+            .slice(0, 3)
+            .map((p: any) => ({
+              ...p,
+              images: JSON.parse(p.images),
+            }));
+          setRelatedProducts(filtered);
+        })
+        .catch(() => setRelatedProducts([]));
     }
+  }, [product, id]);
 
-    // Not found
-    if (!product) {
-        return (
-            <div className="min-h-[60vh] flex flex-col items-center justify-center px-4">
-                <div className="w-20 h-20 rounded-full bg-gray-100 flex items-center justify-center mb-6">
-                    <ShoppingBag size={32} className="text-gray-400" />
-                </div>
-                <h1 className="text-2xl font-serif font-bold mb-2 text-gray-900">Produit non trouvé</h1>
-                <p className="text-gray-500 mb-6">Ce produit n'existe pas ou a été supprimé</p>
-                <Link 
-                    href="/shop" 
-                    className="inline-flex items-center gap-2 bg-harp-brown text-white px-6 py-3 rounded-full hover:bg-harp-caramel transition-colors"
-                >
-                    Retour à la boutique
-                </Link>
-            </div>
-        );
+  const handleAddToCart = () => {
+    if (!product) return;
+    if (!selectedSize || !selectedColor) {
+      alert("Veuillez sélectionner une taille et une couleur");
+      return;
     }
+    addItem({
+      productId: product.id,
+      name: language === "fr" ? product.nameFr : product.nameAr,
+      price: product.price,
+      image: product.images[0],
+      size: selectedSize,
+      color: selectedColor,
+      quantity: quantity,
+    });
+    setAddedToCart(true);
+    setTimeout(() => setAddedToCart(false), 2000);
+  };
+
+  const handleWhatsApp = () => {
+    if (!product) return;
+    const productName = language === "fr" ? product.nameFr : product.nameAr;
+    const message = `Bonjour, je souhaite commander:\n\n🛍️ ${productName}\n📏 Taille: ${selectedSize}\n🎨 Couleur: ${selectedColor}\n🔢 Quantité: ${quantity}\n💰 Prix: ${product.price * quantity} DZD`;
+    window.open(getWhatsAppLink(message), "_blank");
+  };
 
-    const name = language === "fr" ? product.nameFr : product.nameAr;
-    const description = language === "fr" ? product.descriptionFr : product.descriptionAr;
+  const getFallbackImage = (name: string) =>
+    `https://placehold.co/600x800/F5F1EC/4A3A2A?text=${encodeURIComponent(name || "Produit")}`;
 
+  // Loading Skeleton
+  if (loading) {
     return (
-        <div className="min-h-screen bg-gradient-to-b from-harp-beige/20 to-white">
-            {/* Breadcrumb */}
-            <div className="bg-white border-b border-gray-100">
-                <div className="container mx-auto px-4 py-3">
-                    <nav className="flex items-center gap-2 text-sm">
-                        <Link href="/" className="text-gray-500 hover:text-harp-brown transition-colors">
-                            Accueil
-                        </Link>
-                        <ChevronRight size={14} className="text-gray-300" />
-                        <Link href="/shop" className="text-gray-500 hover:text-harp-brown transition-colors">
-                            Boutique
-                        </Link>
-                        <ChevronRight size={14} className="text-gray-300" />
-                        <span className="text-harp-brown font-medium truncate max-w-[200px]">{name}</span>
-                    </nav>
-                </div>
+      <div className="min-h-screen bg-gradient-to-b from-harp-beige/30 to-white">
+        <div className="container mx-auto px-4 py-8">
+          <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16">
+            {/* Image skeleton */}
+            <div className="space-y-4">
+              <div className="relative aspect-[3/4] bg-gray-200 rounded-2xl animate-pulse" />
+              <div className="grid grid-cols-4 gap-3">
+                {[...Array(4)].map((_, i) => (
+                  <div
+                    key={i}
+                    className="aspect-[3/4] bg-gray-200 rounded-xl animate-pulse"
+                  />
+                ))}
+              </div>
+            </div>
+            {/* Details skeleton */}
+            <div className="space-y-6">
+              <div className="h-8 bg-gray-200 rounded-lg w-3/4 animate-pulse" />
+              <div className="h-6 bg-gray-200 rounded-lg w-1/3 animate-pulse" />
+              <div className="space-y-2">
+                <div className="h-4 bg-gray-200 rounded w-full animate-pulse" />
+                <div className="h-4 bg-gray-200 rounded w-5/6 animate-pulse" />
+              </div>
+              <div className="flex gap-3">
+                {[...Array(3)].map((_, i) => (
+                  <div
+                    key={i}
+                    className="h-12 w-20 bg-gray-200 rounded-xl animate-pulse"
+                  />
+                ))}
+              </div>
             </div>
+          </div>
+        </div>
+      </div>
+    );
+  }
 
-            <div className="container mx-auto px-4 py-8 lg:py-12">
-                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16">
-                    {/* Gallery */}
-                    <div className="space-y-4">
-                        {/* Main Image */}
-                        <div 
-                            className="relative aspect-[3/4] bg-gray-100 rounded-2xl overflow-hidden group cursor-zoom-in"
-                            onClick={() => setIsZoomed(!isZoomed)}
-                        >
-                            <Image
-                                src={imageError[activeImage] ? getFallbackImage(name) : product.images[activeImage]}
-                                alt={name}
-                                fill
-                                sizes="(max-width: 1024px) 100vw, 50vw"
-                                className={cn(
-                                    "object-cover transition-transform duration-500",
-                                    isZoomed ? "scale-150" : "group-hover:scale-105"
-                                )}
-                                priority
-                                onError={() => setImageError(prev => ({ ...prev, [activeImage]: true }))}
-                            />
-                            
-                            {/* Zoom indicator */}
-                            <div className="absolute bottom-4 right-4 bg-white/90 backdrop-blur-sm rounded-full p-2 opacity-0 group-hover:opacity-100 transition-opacity">
-                                <ZoomIn size={20} className="text-gray-600" />
-                            </div>
-
-                            {/* New badge */}
-                            <div className="absolute top-4 left-4">
-                                <span className="inline-flex items-center gap-1.5 bg-white/90 backdrop-blur-sm text-harp-brown text-xs uppercase tracking-widest px-3 py-1.5 rounded-full font-medium">
-                                    <Sparkles size={12} />
-                                    Nouveau
-                                </span>
-                            </div>
-                        </div>
-
-                        {/* Thumbnails */}
-                        <div className="grid grid-cols-4 gap-3">
-                            {product.images.map((img: string, idx: number) => (
-                                <button
-                                    key={idx}
-                                    onClick={() => { setActiveImage(idx); setIsZoomed(false); }}
-                                    className={cn(
-                                        "relative aspect-[3/4] bg-gray-100 rounded-xl overflow-hidden transition-all duration-300",
-                                        activeImage === idx 
-                                            ? "ring-2 ring-harp-brown ring-offset-2" 
-                                            : "hover:opacity-80"
-                                    )}
-                                >
-                                    <Image 
-                                        src={imageError[idx] ? getFallbackImage(name) : img} 
-                                        alt={`Vue ${idx + 1}`} 
-                                        fill 
-                                        sizes="(max-width: 768px) 25vw, 12vw" 
-                                        className="object-cover"
-                                        onError={() => setImageError(prev => ({ ...prev, [idx]: true }))}
-                                    />
-                                </button>
-                            ))}
-                        </div>
-                    </div>
+  // Not found
+  if (!product) {
+    return (
+      <div className="min-h-[60vh] flex flex-col items-center justify-center px-4">
+        <div className="w-20 h-20 rounded-full bg-gray-100 flex items-center justify-center mb-6">
+          <ShoppingBag size={32} className="text-gray-400" />
+        </div>
+        <h1 className="text-2xl font-serif font-bold mb-2 text-gray-900">
+          Produit non trouvé
+        </h1>
+        <p className="text-gray-500 mb-6">
+          Ce produit n'existe pas ou a été supprimé
+        </p>
+        <Link
+          href="/shop"
+          className="inline-flex items-center gap-2 bg-harp-brown text-white px-6 py-3 rounded-full hover:bg-harp-caramel transition-colors"
+        >
+          Retour à la boutique
+        </Link>
+      </div>
+    );
+  }
 
-                    {/* Details */}
-                    <div className="lg:sticky lg:top-24 lg:self-start space-y-6">
-                        {/* Header */}
-                        <div className="flex items-start justify-between gap-4">
-                            <div>
-                                <h1 className="text-2xl md:text-3xl font-serif font-bold text-gray-900 mb-2">{name}</h1>
-                                <p className="text-2xl md:text-3xl font-bold text-harp-brown">
-                                    {product.price.toLocaleString()} <span className="text-lg font-normal">DZD</span>
-                                </p>
-                            </div>
-                            <div className="flex gap-2">
-                                <button 
-                                    onClick={() => setIsWishlisted(!isWishlisted)}
-                                    className={cn(
-                                        "p-3 rounded-full transition-all",
-                                        isWishlisted 
-                                            ? "bg-red-50 text-red-500" 
-                                            : "bg-gray-100 text-gray-500 hover:bg-gray-200"
-                                    )}
-                                >
-                                    <Heart size={20} className={isWishlisted ? "fill-current" : ""} />
-                                </button>
-                                <button className="p-3 bg-gray-100 text-gray-500 rounded-full hover:bg-gray-200 transition-colors">
-                                    <Share2 size={20} />
-                                </button>
-                            </div>
-                        </div>
-
-                        {/* Delivery Estimate Badge */}
-                        <div className="flex items-center gap-3 p-3 bg-green-50 border border-green-200 rounded-xl">
-                            <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center shrink-0">
-                                <Truck size={18} className="text-green-600" />
-                            </div>
-                            <div className="flex-1">
-                                <p className="text-sm font-semibold text-green-800">
-                                    ⏱ Livraison estimée 24-72h
-                                </p>
-                                <p className="text-xs text-green-600">
-                                    Suivi en temps réel Yalidine ou ZR Express
-                                </p>
-                            </div>
-                            <Link href="/suivi" className="text-xs text-green-700 hover:underline shrink-0">
-                                Suivre un colis →
-                            </Link>
-                        </div>
-
-                        {/* Description */}
-                        <p className="text-gray-600 leading-relaxed">{description}</p>
-
-                        {/* Color Selection */}
-                        <div>
-                            <div className="flex items-center justify-between mb-3">
-                                <label className="text-sm font-medium text-gray-900 uppercase tracking-wide">
-                                    Couleur
-                                </label>
-                                <span className="text-sm text-harp-brown font-medium">{selectedColor}</span>
-                            </div>
-                            <div className="flex flex-wrap gap-2">
-                                {product.colors.map((color: string) => (
-                                    <button
-                                        key={color}
-                                        onClick={() => setSelectedColor(color)}
-                                        className={cn(
-                                            "relative px-5 py-2.5 rounded-full text-sm font-medium transition-all",
-                                            selectedColor === color
-                                                ? "bg-harp-brown text-white shadow-lg shadow-harp-brown/20"
-                                                : "bg-gray-100 text-gray-700 hover:bg-gray-200"
-                                        )}
-                                    >
-                                        {selectedColor === color && (
-                                            <Check size={14} className="inline mr-1.5" />
-                                        )}
-                                        {color}
-                                    </button>
-                                ))}
-                            </div>
-                        </div>
-
-                        {/* Size Selection */}
-                        <div>
-                            <div className="flex items-center justify-between mb-3">
-                                <label className="text-sm font-medium text-gray-900 uppercase tracking-wide">
-                                    Taille
-                                </label>
-                                {product.showSizeGuide !== false && (
-                                    <button 
-                                        onClick={() => setShowSizeGuide(true)}
-                                        className="text-xs text-harp-brown hover:underline flex items-center gap-1"
-                                    >
-                                        <Ruler size={12} />
-                                        Guide des tailles
-                                    </button>
-                                )}
-                            </div>
-                            <div className="flex flex-wrap gap-2">
-                                {product.sizes.map((size: string) => (
-                                    <button
-                                        key={size}
-                                        onClick={() => setSelectedSize(size)}
-                                        className={cn(
-                                            "px-4 py-2.5 rounded-xl text-sm font-medium transition-all border-2",
-                                            selectedSize === size
-                                                ? "border-harp-brown bg-harp-brown/5 text-harp-brown"
-                                                : "border-gray-200 text-gray-600 hover:border-gray-300"
-                                        )}
-                                    >
-                                        {size}
-                                    </button>
-                                ))}
-                            </div>
-                        </div>
-
-                        {/* Quantity */}
-                        <div>
-                            <label className="block text-sm font-medium text-gray-900 uppercase tracking-wide mb-3">
-                                Quantité
-                            </label>
-                            <div className="inline-flex items-center bg-gray-100 rounded-xl">
-                                <button
-                                    onClick={() => setQuantity(Math.max(1, quantity - 1))}
-                                    className="p-3 hover:bg-gray-200 rounded-l-xl transition-colors"
-                                >
-                                    <Minus size={18} />
-                                </button>
-                                <span className="px-6 py-3 font-medium text-lg min-w-[60px] text-center">
-                                    {quantity}
-                                </span>
-                                <button
-                                    onClick={() => setQuantity(quantity + 1)}
-                                    className="p-3 hover:bg-gray-200 rounded-r-xl transition-colors"
-                                >
-                                    <Plus size={18} />
-                                </button>
-                            </div>
-                        </div>
-
-                        {/* Actions */}
-                        <div className="space-y-3 pt-4">
-                            <button
-                                onClick={handleAddToCart}
-                                disabled={addedToCart}
-                                className={cn(
-                                    "w-full py-4 rounded-xl font-medium uppercase tracking-widest transition-all flex items-center justify-center gap-2",
-                                    addedToCart
-                                        ? "bg-green-600 text-white"
-                                        : "bg-harp-brown text-white hover:bg-harp-caramel shadow-lg shadow-harp-brown/20"
-                                )}
-                            >
-                                {addedToCart ? (
-                                    <>
-                                        <Check size={20} />
-                                        Ajouté au panier
-                                    </>
-                                ) : (
-                                    <>
-                                        <ShoppingBag size={20} />
-                                        {t("product.addToCart")}
-                                    </>
-                                )}
-                            </button>
-                            <button
-                                onClick={handleWhatsApp}
-                                className="w-full py-4 rounded-xl font-medium uppercase tracking-widest border-2 border-green-600 text-green-600 hover:bg-green-50 transition-all flex items-center justify-center gap-2"
-                            >
-                                <MessageCircle size={20} />
-                                Commander via WhatsApp
-                            </button>
-                        </div>
-
-                        {/* Trust Badges - Minimalist */}
-                        <div className="grid grid-cols-2 gap-x-4 gap-y-6 pt-8 border-t border-gray-100">
-                            <div className="flex items-start gap-3">
-                                <Truck size={20} className="text-harp-brown mt-0.5" />
-                                <div>
-                                    <p className="text-sm font-semibold text-gray-900">Livraison 58 wilayas</p>
-                                    <p className="text-xs text-gray-500">24-72h via Yalidine/ZR</p>
-                                </div>
-                            </div>
-                            <div className="flex items-start gap-3">
-                                <CreditCard size={20} className="text-harp-brown mt-0.5" />
-                                <div>
-                                    <p className="text-sm font-semibold text-gray-900">Paiement à la livraison</p>
-                                    <p className="text-xs text-gray-500">Payez à réception</p>
-                                </div>
-                            </div>
-                            <div className="flex items-start gap-3">
-                                <ShieldCheck size={20} className="text-harp-brown mt-0.5" />
-                                <div>
-                                    <p className="text-sm font-semibold text-gray-900">Qualité Garantie</p>
-                                    <p className="text-xs text-gray-500">Satisfait ou remboursé</p>
-                                </div>
-                            </div>
-                            <div className="flex items-start gap-3">
-                                <RotateCcw size={20} className="text-harp-brown mt-0.5" />
-                                <div>
-                                    <p className="text-sm font-semibold text-gray-900">Échange Facile</p>
-                                    <p className="text-xs text-gray-500">Sous 48h</p>
-                                </div>
-                            </div>
-                        </div>
-                    </div>
-                </div>
+  const name = language === "fr" ? product.nameFr : product.nameAr;
+  const description =
+    language === "fr" ? product.descriptionFr : product.descriptionAr;
+
+  return (
+    <div className="min-h-screen bg-gradient-to-b from-harp-beige/20 to-white">
+      {/* Breadcrumb */}
+      <div className="bg-white border-b border-gray-100">
+        <div className="container mx-auto px-4 py-3">
+          <nav className="flex items-center gap-2 text-sm">
+            <Link
+              href="/"
+              className="text-gray-500 hover:text-harp-brown transition-colors"
+            >
+              Accueil
+            </Link>
+            <ChevronRight size={14} className="text-gray-300" />
+            <Link
+              href="/shop"
+              className="text-gray-500 hover:text-harp-brown transition-colors"
+            >
+              Boutique
+            </Link>
+            <ChevronRight size={14} className="text-gray-300" />
+            <span className="text-harp-brown font-medium truncate max-w-[200px]">
+              {name}
+            </span>
+          </nav>
+        </div>
+      </div>
+
+      <div className="container mx-auto px-4 py-8 lg:py-12">
+        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16">
+          {/* Gallery */}
+          <div className="space-y-4">
+            {/* Main Image */}
+            <div
+              className="relative aspect-[3/4] bg-gray-100 rounded-2xl overflow-hidden group cursor-zoom-in"
+              onClick={() => setIsZoomed(!isZoomed)}
+            >
+              <Image
+                src={
+                  imageError[activeImage]
+                    ? getFallbackImage(name)
+                    : product.images[activeImage]
+                }
+                alt={name}
+                fill
+                sizes="(max-width: 1024px) 100vw, 50vw"
+                className={cn(
+                  "object-cover transition-transform duration-500",
+                  isZoomed ? "scale-150" : "group-hover:scale-105",
+                )}
+                priority
+                onError={() =>
+                  setImageError((prev) => ({ ...prev, [activeImage]: true }))
+                }
+              />
+
+              {/* Zoom indicator */}
+              <div className="absolute bottom-4 right-4 bg-white/90 backdrop-blur-sm rounded-full p-2 opacity-0 group-hover:opacity-100 transition-opacity">
+                <ZoomIn size={20} className="text-gray-600" />
+              </div>
+
+              {/* New badge */}
+              <div className="absolute top-4 left-4">
+                <span className="inline-flex items-center gap-1.5 bg-white/90 backdrop-blur-sm text-harp-brown text-xs uppercase tracking-widest px-3 py-1.5 rounded-full font-medium">
+                  <Sparkles size={12} />
+                  Nouveau
+                </span>
+              </div>
+            </div>
+
+            {/* Thumbnails */}
+            <div className="grid grid-cols-4 gap-3">
+              {product.images.map((img: string, idx: number) => (
+                <button
+                  key={idx}
+                  onClick={() => {
+                    setActiveImage(idx);
+                    setIsZoomed(false);
+                  }}
+                  className={cn(
+                    "relative aspect-[3/4] bg-gray-100 rounded-xl overflow-hidden transition-all duration-300",
+                    activeImage === idx
+                      ? "ring-2 ring-harp-brown ring-offset-2"
+                      : "hover:opacity-80",
+                  )}
+                >
+                  <Image
+                    src={imageError[idx] ? getFallbackImage(name) : img}
+                    alt={`Vue ${idx + 1}`}
+                    fill
+                    sizes="(max-width: 768px) 25vw, 12vw"
+                    className="object-cover"
+                    onError={() =>
+                      setImageError((prev) => ({ ...prev, [idx]: true }))
+                    }
+                  />
+                </button>
+              ))}
+            </div>
+          </div>
+
+          {/* Details */}
+          <div className="lg:sticky lg:top-24 lg:self-start space-y-6">
+            {/* Header */}
+            <div className="flex items-start justify-between gap-4">
+              <div>
+                <h1 className="text-2xl md:text-3xl font-serif font-bold text-gray-900 mb-2">
+                  {name}
+                </h1>
+                <p className="text-2xl md:text-3xl font-bold text-harp-brown">
+                  {product.price.toLocaleString()}{" "}
+                  <span className="text-lg font-normal">DZD</span>
+                </p>
+              </div>
+              <div className="flex gap-2">
+                <button
+                  onClick={() => setIsWishlisted(!isWishlisted)}
+                  className={cn(
+                    "p-3 rounded-full transition-all",
+                    isWishlisted
+                      ? "bg-red-50 text-red-500"
+                      : "bg-gray-100 text-gray-500 hover:bg-gray-200",
+                  )}
+                >
+                  <Heart
+                    size={20}
+                    className={isWishlisted ? "fill-current" : ""}
+                  />
+                </button>
+                <button className="p-3 bg-gray-100 text-gray-500 rounded-full hover:bg-gray-200 transition-colors">
+                  <Share2 size={20} />
+                </button>
+              </div>
+            </div>
+
+            {/* Delivery Estimate Badge */}
+            <div className="flex items-center gap-3 p-3 bg-green-50 border border-green-200 rounded-xl">
+              <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center shrink-0">
+                <Truck size={18} className="text-green-600" />
+              </div>
+              <div className="flex-1">
+                <p className="text-sm font-semibold text-green-800">
+                  ⏱ Livraison estimée 24-72h
+                </p>
+                <p className="text-xs text-green-600">
+                  Suivi en temps réel Yalidine ou ZR Express
+                </p>
+              </div>
+              <Link
+                href="/suivi"
+                className="text-xs text-green-700 hover:underline shrink-0"
+              >
+                Suivre un colis →
+              </Link>
+            </div>
+
+            {/* Description */}
+            <p className="text-gray-600 leading-relaxed">{description}</p>
+
+            {/* Color Selection */}
+            <div>
+              <div className="flex items-center justify-between mb-3">
+                <label className="text-sm font-medium text-gray-900 uppercase tracking-wide">
+                  Couleur
+                </label>
+                <span className="text-sm text-harp-brown font-medium">
+                  {selectedColor}
+                </span>
+              </div>
+              <div className="flex flex-wrap gap-2">
+                {product.colors.map((color: string) => (
+                  <button
+                    key={color}
+                    onClick={() => setSelectedColor(color)}
+                    className={cn(
+                      "relative px-5 py-2.5 rounded-full text-sm font-medium transition-all",
+                      selectedColor === color
+                        ? "bg-harp-brown text-white shadow-lg shadow-harp-brown/20"
+                        : "bg-gray-100 text-gray-700 hover:bg-gray-200",
+                    )}
+                  >
+                    {selectedColor === color && (
+                      <Check size={14} className="inline mr-1.5" />
+                    )}
+                    {color}
+                  </button>
+                ))}
+              </div>
+            </div>
+
+            {/* Size Selection */}
+            <div>
+              <div className="flex items-center justify-between mb-3">
+                <label className="text-sm font-medium text-gray-900 uppercase tracking-wide">
+                  Taille
+                </label>
+                {product.showSizeGuide !== false && (
+                  <button
+                    onClick={() => setShowSizeGuide(true)}
+                    className="text-xs text-harp-brown hover:underline flex items-center gap-1"
+                  >
+                    <Ruler size={12} />
+                    Guide des tailles
+                  </button>
+                )}
+              </div>
+              <div className="flex flex-wrap gap-2">
+                {product.sizes.map((size: string) => (
+                  <button
+                    key={size}
+                    onClick={() => setSelectedSize(size)}
+                    className={cn(
+                      "px-4 py-2.5 rounded-xl text-sm font-medium transition-all border-2",
+                      selectedSize === size
+                        ? "border-harp-brown bg-harp-brown/5 text-harp-brown"
+                        : "border-gray-200 text-gray-600 hover:border-gray-300",
+                    )}
+                  >
+                    {size}
+                  </button>
+                ))}
+              </div>
             </div>
 
-            {/* Sticky Mobile Add to Cart Bar */}
-            <div className="fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-gray-100 lg:hidden z-40 flex gap-3 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
+            {/* Quantity */}
+            <div>
+              <label className="block text-sm font-medium text-gray-900 uppercase tracking-wide mb-3">
+                Quantité
+              </label>
+              <div className="inline-flex items-center bg-gray-100 rounded-xl">
                 <button
-                    onClick={handleAddToCart}
-                    className="flex-1 bg-harp-brown text-white py-3 rounded-xl font-medium text-sm uppercase tracking-widest"
+                  onClick={() => setQuantity(Math.max(1, quantity - 1))}
+                  className="p-3 hover:bg-gray-200 rounded-l-xl transition-colors"
                 >
-                    {addedToCart ? "Ajouté !" : "Ajouter au panier"}
+                  <Minus size={18} />
                 </button>
+                <span className="px-6 py-3 font-medium text-lg min-w-[60px] text-center">
+                  {quantity}
+                </span>
                 <button
-                    onClick={handleWhatsApp}
-                    className="bg-green-50 text-green-600 p-3 rounded-xl"
+                  onClick={() => setQuantity(quantity + 1)}
+                  className="p-3 hover:bg-gray-200 rounded-r-xl transition-colors"
                 >
-                    <MessageCircle size={24} />
+                  <Plus size={18} />
                 </button>
+              </div>
+            </div>
+
+            {/* Actions */}
+            <div className="space-y-3 pt-4">
+              <button
+                onClick={handleAddToCart}
+                disabled={addedToCart}
+                className={cn(
+                  "w-full py-4 rounded-xl font-medium uppercase tracking-widest transition-all flex items-center justify-center gap-2",
+                  addedToCart
+                    ? "bg-green-600 text-white"
+                    : "bg-harp-brown text-white hover:bg-harp-caramel shadow-lg shadow-harp-brown/20",
+                )}
+              >
+                {addedToCart ? (
+                  <>
+                    <Check size={20} />
+                    Ajouté au panier
+                  </>
+                ) : (
+                  <>
+                    <ShoppingBag size={20} />
+                    {t("product.addToCart")}
+                  </>
+                )}
+              </button>
+              <button
+                onClick={handleWhatsApp}
+                className="w-full py-4 rounded-xl font-medium uppercase tracking-widest border-2 border-green-600 text-green-600 hover:bg-green-50 transition-all flex items-center justify-center gap-2"
+              >
+                <MessageCircle size={20} />
+                Commander via WhatsApp
+              </button>
+            </div>
+
+            {/* Trust Badges - Minimalist */}
+            <div className="grid grid-cols-2 gap-x-4 gap-y-6 pt-8 border-t border-gray-100">
+              <div className="flex items-start gap-3">
+                <Truck size={20} className="text-harp-brown mt-0.5" />
+                <div>
+                  <p className="text-sm font-semibold text-gray-900">
+                    Livraison 58 wilayas
+                  </p>
+                  <p className="text-xs text-gray-500">
+                    24-72h via Yalidine/ZR
+                  </p>
+                </div>
+              </div>
+              <div className="flex items-start gap-3">
+                <CreditCard size={20} className="text-harp-brown mt-0.5" />
+                <div>
+                  <p className="text-sm font-semibold text-gray-900">
+                    Paiement à la livraison
+                  </p>
+                  <p className="text-xs text-gray-500">Payez à réception</p>
+                </div>
+              </div>
+              <div className="flex items-start gap-3">
+                <ShieldCheck size={20} className="text-harp-brown mt-0.5" />
+                <div>
+                  <p className="text-sm font-semibold text-gray-900">
+                    Qualité Garantie
+                  </p>
+                  <p className="text-xs text-gray-500">
+                    Satisfait ou remboursé
+                  </p>
+                </div>
+              </div>
+              <div className="flex items-start gap-3">
+                <RotateCcw size={20} className="text-harp-brown mt-0.5" />
+                <div>
+                  <p className="text-sm font-semibold text-gray-900">
+                    Échange Facile
+                  </p>
+                  <p className="text-xs text-gray-500">Sous 48h</p>
+                </div>
+              </div>
+            </div>
+          </div>
+        </div>
+      </div>
+
+      {/* Sticky Mobile Add to Cart Bar */}
+      <div className="fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-gray-100 lg:hidden z-40 flex gap-3 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
+        <button
+          onClick={handleAddToCart}
+          className="flex-1 bg-harp-brown text-white py-3 rounded-xl font-medium text-sm uppercase tracking-widest"
+        >
+          {addedToCart ? "Ajouté !" : "Ajouter au panier"}
+        </button>
+        <button
+          onClick={handleWhatsApp}
+          className="bg-green-50 text-green-600 p-3 rounded-xl"
+        >
+          <MessageCircle size={24} />
+        </button>
+      </div>
+
+      {/* Cross-sell Section */}
+      {relatedProducts.length > 0 && (
+        <section className="mt-16 border-t border-gray-100 pt-12">
+          <div className="container mx-auto px-4">
+            <h2 className="text-2xl font-serif font-bold text-gray-900 mb-2 flex items-center gap-2">
+              <Sparkles size={20} className="text-amber-500" />
+              Complétez votre look
+            </h2>
+            <p className="text-gray-500 mb-8">
+              D&apos;autres pièces qui pourraient vous plaire
+            </p>
+            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
+              {relatedProducts.map((item) => (
+                <Link
+                  key={item.id}
+                  href={`/product/${item.id}`}
+                  className="group bg-white rounded-2xl overflow-hidden border border-gray-100 hover:shadow-lg transition-all"
+                >
+                  <div className="relative aspect-[3/4] bg-gray-100">
+                    <Image
+                      src={item.images[0]}
+                      alt={item.nameFr}
+                      fill
+                      className="object-cover group-hover:scale-105 transition-transform duration-500"
+                    />
+                  </div>
+                  <div className="p-4">
+                    <h3 className="font-medium text-gray-900 truncate">
+                      {item.nameFr}
+                    </h3>
+                    <p className="text-harp-brown font-bold mt-1">
+                      {item.price.toLocaleString()} DZD
+                    </p>
+                  </div>
+                </Link>
+              ))}
+            </div>
+          </div>
+        </section>
+      )}
+
+      {/* Customer Reviews Section */}
+      <section className="mt-16 bg-gray-50 py-12">
+        <div className="container mx-auto px-4">
+          <div className="flex items-center justify-between mb-8">
+            <div>
+              <h2 className="text-2xl font-serif font-bold text-gray-900 mb-1">
+                Avis Clients
+              </h2>
+              <div className="flex items-center gap-2">
+                <div className="flex">
+                  {[1, 2, 3, 4, 5].map((i) => (
+                    <Star
+                      key={i}
+                      size={16}
+                      className="text-amber-400 fill-amber-400"
+                    />
+                  ))}
+                </div>
+                <span className="text-sm text-gray-600">
+                  5.0 • {reviews.length} avis
+                </span>
+              </div>
+            </div>
+          </div>
+          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
+            {reviews.map((review) => (
+              <div
+                key={review.id}
+                className="bg-white p-6 rounded-2xl border border-gray-100"
+              >
+                <div className="flex items-center gap-1 mb-3">
+                  {[1, 2, 3, 4, 5].map((i) => (
+                    <Star
+                      key={i}
+                      size={14}
+                      className={
+                        i <= review.rating
+                          ? "text-amber-400 fill-amber-400"
+                          : "text-gray-300"
+                      }
+                    />
+                  ))}
+                </div>
+                <p className="text-gray-700 mb-4 leading-relaxed">
+                  <Quote size={14} className="inline text-gray-300 mr-1" />
+                  {review.text}
+                </p>
+                <div className="flex items-center justify-between text-sm">
+                  <div>
+                    <p className="font-medium text-gray-900">{review.author}</p>
+                    <p className="text-gray-500">{review.location}</p>
+                  </div>
+                  <span className="text-xs text-gray-400">{review.date}</span>
+                </div>
+              </div>
+            ))}
+          </div>
+        </div>
+      </section>
+
+      {/* Size Guide Modal */}
+      {showSizeGuide && (
+        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
+          <div className="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-auto">
+            <div className="p-6 border-b border-gray-100 flex items-center justify-between sticky top-0 bg-white z-10">
+              <div className="flex items-center gap-3">
+                <div className="w-10 h-10 bg-harp-brown/10 rounded-full flex items-center justify-center">
+                  <Ruler size={20} className="text-harp-brown" />
+                </div>
+                <h3 className="text-xl font-serif font-bold text-gray-900">
+                  Guide des Tailles
+                </h3>
+              </div>
+              <button
+                onClick={() => setShowSizeGuide(false)}
+                className="p-2 hover:bg-gray-100 rounded-full transition-colors"
+              >
+                <X size={20} />
+              </button>
             </div>
+            <div className="p-6 space-y-6">
+              {/* How to Measure - Visual Guide */}
+              <div className="bg-gradient-to-br from-harp-beige/30 to-harp-gold/10 p-5 rounded-2xl">
+                <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
+                  <svg
+                    className="w-5 h-5 text-harp-brown"
+                    fill="none"
+                    viewBox="0 0 24 24"
+                    stroke="currentColor"
+                  >
+                    <path
+                      strokeLinecap="round"
+                      strokeLinejoin="round"
+                      strokeWidth={2}
+                      d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
+                    />
+                  </svg>
+                  Comment prendre vos mesures
+                </h4>
+                <div className="grid grid-cols-3 gap-4">
+                  {/* Poitrine */}
+                  <div className="bg-white rounded-xl p-4 text-center shadow-sm">
+                    <div className="w-16 h-16 mx-auto mb-3 relative">
+                      {/* Silhouette buste femme */}
+                      <svg viewBox="0 0 64 64" className="w-full h-full">
+                        {/* Corps */}
+                        <path
+                          d="M32 8c-4 0-7 3-7 7s3 7 7 7 7-3 7-7-3-7-7-7z"
+                          fill="#fce7f3"
+                          stroke="#ec4899"
+                          strokeWidth="1.5"
+                        />
+                        <path
+                          d="M20 28c0-6 5-8 12-8s12 2 12 8v12c0 2-2 4-4 4h-16c-2 0-4-2-4-4V28z"
+                          fill="#fce7f3"
+                          stroke="#ec4899"
+                          strokeWidth="1.5"
+                        />
+                        {/* Ligne mesure poitrine */}
+                        <path
+                          d="M16 32h32"
+                          stroke="#ec4899"
+                          strokeWidth="2"
+                          strokeDasharray="3 2"
+                        />
+                        <circle cx="16" cy="32" r="2" fill="#ec4899" />
+                        <circle cx="48" cy="32" r="2" fill="#ec4899" />
+                        {/* Flèches */}
+                        <path
+                          d="M18 30l-2 2 2 2M46 30l2 2-2 2"
+                          stroke="#ec4899"
+                          strokeWidth="1.5"
+                          fill="none"
+                        />
+                      </svg>
+                    </div>
+                    <p className="font-semibold text-gray-900 text-sm">
+                      Poitrine
+                    </p>
+                    <p className="text-xs text-gray-500 mt-1">
+                      Mesurez au niveau le plus fort
+                    </p>
+                  </div>
+                  {/* Taille */}
+                  <div className="bg-white rounded-xl p-4 text-center shadow-sm">
+                    <div className="w-16 h-16 mx-auto mb-3 relative">
+                      {/* Silhouette taille femme */}
+                      <svg viewBox="0 0 64 64" className="w-full h-full">
+                        {/* Corps - forme sablier */}
+                        <path
+                          d="M22 8c-2 8 0 16 0 24 0 8-4 16-4 24h28c0-8-4-16-4-24 0-8 2-16 0-24H22z"
+                          fill="#fef3c7"
+                          stroke="#f59e0b"
+                          strokeWidth="1.5"
+                        />
+                        {/* Ligne mesure taille (partie étroite) */}
+                        <path
+                          d="M14 32h36"
+                          stroke="#f59e0b"
+                          strokeWidth="2"
+                          strokeDasharray="3 2"
+                        />
+                        <circle cx="14" cy="32" r="2" fill="#f59e0b" />
+                        <circle cx="50" cy="32" r="2" fill="#f59e0b" />
+                        {/* Flèches */}
+                        <path
+                          d="M16 30l-2 2 2 2M48 30l2 2-2 2"
+                          stroke="#f59e0b"
+                          strokeWidth="1.5"
+                          fill="none"
+                        />
+                        {/* Indication creux */}
+                        <path
+                          d="M26 32c2-2 4-2 6-2s4 0 6 2"
+                          stroke="#f59e0b"
+                          strokeWidth="1"
+                          fill="none"
+                          opacity="0.5"
+                        />
+                      </svg>
+                    </div>
+                    <p className="font-semibold text-gray-900 text-sm">
+                      Taille
+                    </p>
+                    <p className="text-xs text-gray-500 mt-1">
+                      Mesurez au creux naturel
+                    </p>
+                  </div>
+                  {/* Hanches */}
+                  <div className="bg-white rounded-xl p-4 text-center shadow-sm">
+                    <div className="w-16 h-16 mx-auto mb-3 relative">
+                      {/* Silhouette hanches femme */}
+                      <svg viewBox="0 0 64 64" className="w-full h-full">
+                        {/* Corps - hanches larges */}
+                        <path
+                          d="M26 4h12v8c4 4 10 12 10 20v8c0 4-2 8-6 12H22c-4-4-6-8-6-12v-8c0-8 6-16 10-20V4z"
+                          fill="#f3e8ff"
+                          stroke="#a855f7"
+                          strokeWidth="1.5"
+                        />
+                        {/* Ligne mesure hanches (partie large) */}
+                        <path
+                          d="M10 38h44"
+                          stroke="#a855f7"
+                          strokeWidth="2"
+                          strokeDasharray="3 2"
+                        />
+                        <circle cx="10" cy="38" r="2" fill="#a855f7" />
+                        <circle cx="54" cy="38" r="2" fill="#a855f7" />
+                        {/* Flèches */}
+                        <path
+                          d="M12 36l-2 2 2 2M52 36l2 2-2 2"
+                          stroke="#a855f7"
+                          strokeWidth="1.5"
+                          fill="none"
+                        />
+                      </svg>
+                    </div>
+                    <p className="font-semibold text-gray-900 text-sm">
+                      Hanches
+                    </p>
+                    <p className="text-xs text-gray-500 mt-1">
+                      Mesurez au niveau le plus large
+                    </p>
+                  </div>
+                </div>
+              </div>
 
-            {/* Cross-sell Section */}
-            {relatedProducts.length > 0 && (
-                <section className="mt-16 border-t border-gray-100 pt-12">
-                    <div className="container mx-auto px-4">
-                        <h2 className="text-2xl font-serif font-bold text-gray-900 mb-2 flex items-center gap-2">
-                            <Sparkles size={20} className="text-amber-500" />
-                            Complétez votre look
-                        </h2>
-                        <p className="text-gray-500 mb-8">D&apos;autres pièces qui pourraient vous plaire</p>
-                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
-                            {relatedProducts.map((item) => (
-                                <Link
-                                    key={item.id}
-                                    href={`/product/${item.id}`}
-                                    className="group bg-white rounded-2xl overflow-hidden border border-gray-100 hover:shadow-lg transition-all"
-                                >
-                                    <div className="relative aspect-[3/4] bg-gray-100">
-                                        <Image
-                                            src={item.images[0]}
-                                            alt={item.nameFr}
-                                            fill
-                                            className="object-cover group-hover:scale-105 transition-transform duration-500"
-                                        />
-                                    </div>
-                                    <div className="p-4">
-                                        <h3 className="font-medium text-gray-900 truncate">{item.nameFr}</h3>
-                                        <p className="text-harp-brown font-bold mt-1">{item.price.toLocaleString()} DZD</p>
-                                    </div>
-                                </Link>
-                            ))}
-                        </div>
+              {/* Height Reference */}
+              <div className="bg-gray-50 p-5 rounded-2xl">
+                <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
+                  <svg
+                    className="w-5 h-5 text-gray-700"
+                    viewBox="0 0 24 24"
+                    fill="none"
+                    stroke="currentColor"
+                    strokeWidth="2"
+                  >
+                    <path
+                      d="M12 22V2M12 2l4 4M12 2L8 6"
+                      strokeLinecap="round"
+                      strokeLinejoin="round"
+                    />
+                  </svg>
+                  Selon votre hauteur
+                </h4>
+                <div className="grid grid-cols-4 gap-3">
+                  {/* Taille S */}
+                  <div className="bg-white rounded-xl p-3 text-center border-2 border-transparent hover:border-harp-brown/30 transition-colors">
+                    <div className="h-16 flex items-end justify-center mb-2">
+                      <svg viewBox="0 0 40 64" className="h-10">
+                        <ellipse cx="20" cy="8" rx="6" ry="6" fill="#E8D5C4" />
+                        <path
+                          d="M12 18c0-2 4-4 8-4s8 2 8 4v14c0 1-1 2-2 2h-2l-2 24h-4l-2-24h-2c-1 0-2-1-2-2V18z"
+                          fill="#D4C4B0"
+                        />
+                        <path
+                          d="M14 58h12"
+                          stroke="#8B7355"
+                          strokeWidth="2"
+                          strokeLinecap="round"
+                        />
+                      </svg>
+                    </div>
+                    <div className="w-10 h-10 mx-auto bg-harp-brown text-white rounded-full flex items-center justify-center font-bold text-sm mb-1">
+                      S
+                    </div>
+                    <p className="text-xs text-gray-600 font-medium">
+                      1m55-1m60
+                    </p>
+                  </div>
+                  {/* Taille M */}
+                  <div className="bg-white rounded-xl p-3 text-center border-2 border-transparent hover:border-harp-brown/30 transition-colors">
+                    <div className="h-16 flex items-end justify-center mb-2">
+                      <svg viewBox="0 0 40 64" className="h-12">
+                        <ellipse cx="20" cy="6" rx="5" ry="5" fill="#E8D5C4" />
+                        <path
+                          d="M13 14c0-2 3-3 7-3s7 1 7 3v12c0 1-1 2-2 2h-2l-2 28h-2l-2-28h-2c-1 0-2-1-2-2V14z"
+                          fill="#D4C4B0"
+                        />
+                        <path
+                          d="M15 58h10"
+                          stroke="#8B7355"
+                          strokeWidth="2"
+                          strokeLinecap="round"
+                        />
+                      </svg>
+                    </div>
+                    <div className="w-10 h-10 mx-auto bg-harp-brown text-white rounded-full flex items-center justify-center font-bold text-sm mb-1">
+                      M
                     </div>
-                </section>
-            )}
-
-            {/* Customer Reviews Section */}
-            <section className="mt-16 bg-gray-50 py-12">
-                <div className="container mx-auto px-4">
-                    <div className="flex items-center justify-between mb-8">
-                        <div>
-                            <h2 className="text-2xl font-serif font-bold text-gray-900 mb-1">Avis Clients</h2>
-                            <div className="flex items-center gap-2">
-                                <div className="flex">
-                                    {[1,2,3,4,5].map(i => (
-                                        <Star key={i} size={16} className="text-amber-400 fill-amber-400" />
-                                    ))}
-                                </div>
-                                <span className="text-sm text-gray-600">5.0 • {reviews.length} avis</span>
-                            </div>
-                        </div>
+                    <p className="text-xs text-gray-600 font-medium">
+                      1m60-1m68
+                    </p>
+                  </div>
+                  {/* Taille L */}
+                  <div className="bg-white rounded-xl p-3 text-center border-2 border-transparent hover:border-harp-brown/30 transition-colors">
+                    <div className="h-16 flex items-end justify-center mb-2">
+                      <svg viewBox="0 0 40 64" className="h-14">
+                        <ellipse
+                          cx="20"
+                          cy="5"
+                          rx="4.5"
+                          ry="4.5"
+                          fill="#E8D5C4"
+                        />
+                        <path
+                          d="M14 12c0-1.5 3-2.5 6-2.5s6 1 6 2.5v11c0 1-1 1.5-1.5 1.5H23l-1.5 32h-3l-1.5-32h-1.5c-.5 0-1.5-.5-1.5-1.5V12z"
+                          fill="#D4C4B0"
+                        />
+                        <path
+                          d="M16 58h8"
+                          stroke="#8B7355"
+                          strokeWidth="2"
+                          strokeLinecap="round"
+                        />
+                      </svg>
                     </div>
-                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
-                        {reviews.map((review) => (
-                            <div key={review.id} className="bg-white p-6 rounded-2xl border border-gray-100">
-                                <div className="flex items-center gap-1 mb-3">
-                                    {[1,2,3,4,5].map(i => (
-                                        <Star key={i} size={14} className={i <= review.rating ? "text-amber-400 fill-amber-400" : "text-gray-300"} />
-                                    ))}
-                                </div>
-                                <p className="text-gray-700 mb-4 leading-relaxed">
-                                    <Quote size={14} className="inline text-gray-300 mr-1" />
-                                    {review.text}
-                                </p>
-                                <div className="flex items-center justify-between text-sm">
-                                    <div>
-                                        <p className="font-medium text-gray-900">{review.author}</p>
-                                        <p className="text-gray-500">{review.location}</p>
-                                    </div>
-                                    <span className="text-xs text-gray-400">{review.date}</span>
-                                </div>
-                            </div>
-                        ))}
+                    <div className="w-10 h-10 mx-auto bg-harp-brown text-white rounded-full flex items-center justify-center font-bold text-sm mb-1">
+                      L
                     </div>
+                    <p className="text-xs text-gray-600 font-medium">
+                      1m68-1m75
+                    </p>
+                  </div>
+                  {/* Taille XL */}
+                  <div className="bg-white rounded-xl p-3 text-center border-2 border-transparent hover:border-harp-brown/30 transition-colors">
+                    <div className="h-16 flex items-end justify-center mb-2">
+                      <svg viewBox="0 0 40 64" className="h-16">
+                        <ellipse cx="20" cy="4" rx="4" ry="4" fill="#E8D5C4" />
+                        <path
+                          d="M14 10c0-1 2.5-2 6-2s6 1 6 2v10c0 .8-.8 1.2-1.2 1.2H23l-1.5 36h-3l-1.5-36h-1.8c-.4 0-1.2-.4-1.2-1.2V10z"
+                          fill="#D4C4B0"
+                        />
+                        <path
+                          d="M17 58h6"
+                          stroke="#8B7355"
+                          strokeWidth="2"
+                          strokeLinecap="round"
+                        />
+                      </svg>
+                    </div>
+                    <div className="w-10 h-10 mx-auto bg-harp-brown text-white rounded-full flex items-center justify-center font-bold text-sm mb-1">
+                      XL
+                    </div>
+                    <p className="text-xs text-gray-600 font-medium">1m75+</p>
+                  </div>
+                </div>
+              </div>
+
+              {/* Size Table */}
+              <div>
+                <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
+                  <svg
+                    className="w-5 h-5 text-gray-700"
+                    viewBox="0 0 24 24"
+                    fill="none"
+                    stroke="currentColor"
+                    strokeWidth="2"
+                  >
+                    <rect x="3" y="3" width="18" height="18" rx="2" />
+                    <path d="M3 9h18M9 3v18" />
+                  </svg>
+                  Tableau des mesures (cm)
+                </h4>
+                <div className="overflow-hidden rounded-xl border border-gray-200">
+                  <table className="w-full text-sm">
+                    <thead>
+                      <tr className="bg-harp-brown text-white">
+                        <th className="p-3 text-left font-medium">Taille</th>
+                        <th className="p-3 text-center font-medium">
+                          <span className="inline-flex items-center gap-1">
+                            <span className="w-2 h-2 bg-pink-300 rounded-full"></span>
+                            Poitrine
+                          </span>
+                        </th>
+                        <th className="p-3 text-center font-medium">
+                          <span className="inline-flex items-center gap-1">
+                            <span className="w-2 h-2 bg-amber-300 rounded-full"></span>
+                            Taille
+                          </span>
+                        </th>
+                        <th className="p-3 text-center font-medium">
+                          <span className="inline-flex items-center gap-1">
+                            <span className="w-2 h-2 bg-purple-300 rounded-full"></span>
+                            Hanches
+                          </span>
+                        </th>
+                      </tr>
+                    </thead>
+                    <tbody className="divide-y divide-gray-100">
+                      <tr className="hover:bg-gray-50">
+                        <td className="p-3 font-bold text-harp-brown">S</td>
+                        <td className="p-3 text-center">86-90</td>
+                        <td className="p-3 text-center">66-70</td>
+                        <td className="p-3 text-center">92-96</td>
+                      </tr>
+                      <tr className="hover:bg-gray-50">
+                        <td className="p-3 font-bold text-harp-brown">M</td>
+                        <td className="p-3 text-center">90-94</td>
+                        <td className="p-3 text-center">70-74</td>
+                        <td className="p-3 text-center">96-100</td>
+                      </tr>
+                      <tr className="hover:bg-gray-50">
+                        <td className="p-3 font-bold text-harp-brown">L</td>
+                        <td className="p-3 text-center">94-98</td>
+                        <td className="p-3 text-center">74-78</td>
+                        <td className="p-3 text-center">100-104</td>
+                      </tr>
+                      <tr className="hover:bg-gray-50">
+                        <td className="p-3 font-bold text-harp-brown">XL</td>
+                        <td className="p-3 text-center">98-102</td>
+                        <td className="p-3 text-center">78-82</td>
+                        <td className="p-3 text-center">104-108</td>
+                      </tr>
+                    </tbody>
+                  </table>
                 </div>
-            </section>
-
-            {/* Size Guide Modal */}
-            {showSizeGuide && (
-                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
-                    <div className="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-auto">
-                        <div className="p-6 border-b border-gray-100 flex items-center justify-between sticky top-0 bg-white z-10">
-                            <div className="flex items-center gap-3">
-                                <div className="w-10 h-10 bg-harp-brown/10 rounded-full flex items-center justify-center">
-                                    <Ruler size={20} className="text-harp-brown" />
-                                </div>
-                                <h3 className="text-xl font-serif font-bold text-gray-900">Guide des Tailles</h3>
-                            </div>
-                            <button 
-                                onClick={() => setShowSizeGuide(false)}
-                                className="p-2 hover:bg-gray-100 rounded-full transition-colors"
-                            >
-                                <X size={20} />
-                            </button>
-                        </div>
-                        <div className="p-6 space-y-6">
-                            {/* How to Measure - Visual Guide */}
-                            <div className="bg-gradient-to-br from-harp-beige/30 to-harp-gold/10 p-5 rounded-2xl">
-                                <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
-                                    <svg className="w-5 h-5 text-harp-brown" fill="none" viewBox="0 0 24 24" stroke="currentColor">
-                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
-                                    </svg>
-                                    Comment prendre vos mesures
-                                </h4>
-                                <div className="grid grid-cols-3 gap-4">
-                                    {/* Poitrine */}
-                                    <div className="bg-white rounded-xl p-4 text-center shadow-sm">
-                                        <div className="w-16 h-16 mx-auto mb-3 relative">
-                                            {/* Silhouette buste femme */}
-                                            <svg viewBox="0 0 64 64" className="w-full h-full">
-                                                {/* Corps */}
-                                                <path d="M32 8c-4 0-7 3-7 7s3 7 7 7 7-3 7-7-3-7-7-7z" fill="#fce7f3" stroke="#ec4899" strokeWidth="1.5"/>
-                                                <path d="M20 28c0-6 5-8 12-8s12 2 12 8v12c0 2-2 4-4 4h-16c-2 0-4-2-4-4V28z" fill="#fce7f3" stroke="#ec4899" strokeWidth="1.5"/>
-                                                {/* Ligne mesure poitrine */}
-                                                <path d="M16 32h32" stroke="#ec4899" strokeWidth="2" strokeDasharray="3 2"/>
-                                                <circle cx="16" cy="32" r="2" fill="#ec4899"/>
-                                                <circle cx="48" cy="32" r="2" fill="#ec4899"/>
-                                                {/* Flèches */}
-                                                <path d="M18 30l-2 2 2 2M46 30l2 2-2 2" stroke="#ec4899" strokeWidth="1.5" fill="none"/>
-                                            </svg>
-                                        </div>
-                                        <p className="font-semibold text-gray-900 text-sm">Poitrine</p>
-                                        <p className="text-xs text-gray-500 mt-1">Mesurez au niveau le plus fort</p>
-                                    </div>
-                                    {/* Taille */}
-                                    <div className="bg-white rounded-xl p-4 text-center shadow-sm">
-                                        <div className="w-16 h-16 mx-auto mb-3 relative">
-                                            {/* Silhouette taille femme */}
-                                            <svg viewBox="0 0 64 64" className="w-full h-full">
-                                                {/* Corps - forme sablier */}
-                                                <path d="M22 8c-2 8 0 16 0 24 0 8-4 16-4 24h28c0-8-4-16-4-24 0-8 2-16 0-24H22z" fill="#fef3c7" stroke="#f59e0b" strokeWidth="1.5"/>
-                                                {/* Ligne mesure taille (partie étroite) */}
-                                                <path d="M14 32h36" stroke="#f59e0b" strokeWidth="2" strokeDasharray="3 2"/>
-                                                <circle cx="14" cy="32" r="2" fill="#f59e0b"/>
-                                                <circle cx="50" cy="32" r="2" fill="#f59e0b"/>
-                                                {/* Flèches */}
-                                                <path d="M16 30l-2 2 2 2M48 30l2 2-2 2" stroke="#f59e0b" strokeWidth="1.5" fill="none"/>
-                                                {/* Indication creux */}
-                                                <path d="M26 32c2-2 4-2 6-2s4 0 6 2" stroke="#f59e0b" strokeWidth="1" fill="none" opacity="0.5"/>
-                                            </svg>
-                                        </div>
-                                        <p className="font-semibold text-gray-900 text-sm">Taille</p>
-                                        <p className="text-xs text-gray-500 mt-1">Mesurez au creux naturel</p>
-                                    </div>
-                                    {/* Hanches */}
-                                    <div className="bg-white rounded-xl p-4 text-center shadow-sm">
-                                        <div className="w-16 h-16 mx-auto mb-3 relative">
-                                            {/* Silhouette hanches femme */}
-                                            <svg viewBox="0 0 64 64" className="w-full h-full">
-                                                {/* Corps - hanches larges */}
-                                                <path d="M26 4h12v8c4 4 10 12 10 20v8c0 4-2 8-6 12H22c-4-4-6-8-6-12v-8c0-8 6-16 10-20V4z" fill="#f3e8ff" stroke="#a855f7" strokeWidth="1.5"/>
-                                                {/* Ligne mesure hanches (partie large) */}
-                                                <path d="M10 38h44" stroke="#a855f7" strokeWidth="2" strokeDasharray="3 2"/>
-                                                <circle cx="10" cy="38" r="2" fill="#a855f7"/>
-                                                <circle cx="54" cy="38" r="2" fill="#a855f7"/>
-                                                {/* Flèches */}
-                                                <path d="M12 36l-2 2 2 2M52 36l2 2-2 2" stroke="#a855f7" strokeWidth="1.5" fill="none"/>
-                                            </svg>
-                                        </div>
-                                        <p className="font-semibold text-gray-900 text-sm">Hanches</p>
-                                        <p className="text-xs text-gray-500 mt-1">Mesurez au niveau le plus large</p>
-                                    </div>
-                                </div>
-                            </div>
-
-                            {/* Height Reference */}
-                            <div className="bg-gray-50 p-5 rounded-2xl">
-                                <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
-                                    <svg className="w-5 h-5 text-gray-700" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
-                                        <path d="M12 22V2M12 2l4 4M12 2L8 6" strokeLinecap="round" strokeLinejoin="round" />
-                                    </svg>
-                                    Selon votre hauteur
-                                </h4>
-                                <div className="grid grid-cols-4 gap-3">
-                                    {/* Taille S */}
-                                    <div className="bg-white rounded-xl p-3 text-center border-2 border-transparent hover:border-harp-brown/30 transition-colors">
-                                        <div className="h-16 flex items-end justify-center mb-2">
-                                            <svg viewBox="0 0 40 64" className="h-10">
-                                                <ellipse cx="20" cy="8" rx="6" ry="6" fill="#E8D5C4"/>
-                                                <path d="M12 18c0-2 4-4 8-4s8 2 8 4v14c0 1-1 2-2 2h-2l-2 24h-4l-2-24h-2c-1 0-2-1-2-2V18z" fill="#D4C4B0"/>
-                                                <path d="M14 58h12" stroke="#8B7355" strokeWidth="2" strokeLinecap="round"/>
-                                            </svg>
-                                        </div>
-                                        <div className="w-10 h-10 mx-auto bg-harp-brown text-white rounded-full flex items-center justify-center font-bold text-sm mb-1">S</div>
-                                        <p className="text-xs text-gray-600 font-medium">1m55-1m60</p>
-                                    </div>
-                                    {/* Taille M */}
-                                    <div className="bg-white rounded-xl p-3 text-center border-2 border-transparent hover:border-harp-brown/30 transition-colors">
-                                        <div className="h-16 flex items-end justify-center mb-2">
-                                            <svg viewBox="0 0 40 64" className="h-12">
-                                                <ellipse cx="20" cy="6" rx="5" ry="5" fill="#E8D5C4"/>
-                                                <path d="M13 14c0-2 3-3 7-3s7 1 7 3v12c0 1-1 2-2 2h-2l-2 28h-2l-2-28h-2c-1 0-2-1-2-2V14z" fill="#D4C4B0"/>
-                                                <path d="M15 58h10" stroke="#8B7355" strokeWidth="2" strokeLinecap="round"/>
-                                            </svg>
-                                        </div>
-                                        <div className="w-10 h-10 mx-auto bg-harp-brown text-white rounded-full flex items-center justify-center font-bold text-sm mb-1">M</div>
-                                        <p className="text-xs text-gray-600 font-medium">1m60-1m68</p>
-                                    </div>
-                                    {/* Taille L */}
-                                    <div className="bg-white rounded-xl p-3 text-center border-2 border-transparent hover:border-harp-brown/30 transition-colors">
-                                        <div className="h-16 flex items-end justify-center mb-2">
-                                            <svg viewBox="0 0 40 64" className="h-14">
-                                                <ellipse cx="20" cy="5" rx="4.5" ry="4.5" fill="#E8D5C4"/>
-                                                <path d="M14 12c0-1.5 3-2.5 6-2.5s6 1 6 2.5v11c0 1-1 1.5-1.5 1.5H23l-1.5 32h-3l-1.5-32h-1.5c-.5 0-1.5-.5-1.5-1.5V12z" fill="#D4C4B0"/>
-                                                <path d="M16 58h8" stroke="#8B7355" strokeWidth="2" strokeLinecap="round"/>
-                                            </svg>
-                                        </div>
-                                        <div className="w-10 h-10 mx-auto bg-harp-brown text-white rounded-full flex items-center justify-center font-bold text-sm mb-1">L</div>
-                                        <p className="text-xs text-gray-600 font-medium">1m68-1m75</p>
-                                    </div>
-                                    {/* Taille XL */}
-                                    <div className="bg-white rounded-xl p-3 text-center border-2 border-transparent hover:border-harp-brown/30 transition-colors">
-                                        <div className="h-16 flex items-end justify-center mb-2">
-                                            <svg viewBox="0 0 40 64" className="h-16">
-                                                <ellipse cx="20" cy="4" rx="4" ry="4" fill="#E8D5C4"/>
-                                                <path d="M14 10c0-1 2.5-2 6-2s6 1 6 2v10c0 .8-.8 1.2-1.2 1.2H23l-1.5 36h-3l-1.5-36h-1.8c-.4 0-1.2-.4-1.2-1.2V10z" fill="#D4C4B0"/>
-                                                <path d="M17 58h6" stroke="#8B7355" strokeWidth="2" strokeLinecap="round"/>
-                                            </svg>
-                                        </div>
-                                        <div className="w-10 h-10 mx-auto bg-harp-brown text-white rounded-full flex items-center justify-center font-bold text-sm mb-1">XL</div>
-                                        <p className="text-xs text-gray-600 font-medium">1m75+</p>
-                                    </div>
-                                </div>
-                            </div>
-
-                            {/* Size Table */}
-                            <div>
-                                <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
-                                    <svg className="w-5 h-5 text-gray-700" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
-                                        <rect x="3" y="3" width="18" height="18" rx="2" />
-                                        <path d="M3 9h18M9 3v18" />
-                                    </svg>
-                                    Tableau des mesures (cm)
-                                </h4>
-                                <div className="overflow-hidden rounded-xl border border-gray-200">
-                                    <table className="w-full text-sm">
-                                        <thead>
-                                            <tr className="bg-harp-brown text-white">
-                                                <th className="p-3 text-left font-medium">Taille</th>
-                                                <th className="p-3 text-center font-medium">
-                                                    <span className="inline-flex items-center gap-1">
-                                                        <span className="w-2 h-2 bg-pink-300 rounded-full"></span>
-                                                        Poitrine
-                                                    </span>
-                                                </th>
-                                                <th className="p-3 text-center font-medium">
-                                                    <span className="inline-flex items-center gap-1">
-                                                        <span className="w-2 h-2 bg-amber-300 rounded-full"></span>
-                                                        Taille
-                                                    </span>
-                                                </th>
-                                                <th className="p-3 text-center font-medium">
-                                                    <span className="inline-flex items-center gap-1">
-                                                        <span className="w-2 h-2 bg-purple-300 rounded-full"></span>
-                                                        Hanches
-                                                    </span>
-                                                </th>
-                                            </tr>
-                                        </thead>
-                                        <tbody className="divide-y divide-gray-100">
-                                            <tr className="hover:bg-gray-50"><td className="p-3 font-bold text-harp-brown">S</td><td className="p-3 text-center">86-90</td><td className="p-3 text-center">66-70</td><td className="p-3 text-center">92-96</td></tr>
-                                            <tr className="hover:bg-gray-50"><td className="p-3 font-bold text-harp-brown">M</td><td className="p-3 text-center">90-94</td><td className="p-3 text-center">70-74</td><td className="p-3 text-center">96-100</td></tr>
-                                            <tr className="hover:bg-gray-50"><td className="p-3 font-bold text-harp-brown">L</td><td className="p-3 text-center">94-98</td><td className="p-3 text-center">74-78</td><td className="p-3 text-center">100-104</td></tr>
-                                            <tr className="hover:bg-gray-50"><td className="p-3 font-bold text-harp-brown">XL</td><td className="p-3 text-center">98-102</td><td className="p-3 text-center">78-82</td><td className="p-3 text-center">104-108</td></tr>
-                                        </tbody>
-                                    </table>
-                                </div>
-                            </div>
-
-                            {/* Tips */}
-                            <div className="grid grid-cols-2 gap-3">
-                                <div className="bg-blue-50 border border-blue-200 rounded-xl p-4">
-                                    <div className="flex items-start gap-3">
-                                        <div className="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center shrink-0">
-                                            <svg className="w-4 h-4 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
-                                                <circle cx="12" cy="12" r="10" />
-                                                <path d="M12 16v-4M12 8h.01" />
-                                            </svg>
-                                        </div>
-                                        <div>
-                                            <p className="font-medium text-blue-900 text-sm">Conseil</p>
-                                            <p className="text-xs text-blue-700 mt-1">Entre deux tailles ? Prenez la plus grande pour un confort optimal.</p>
-                                        </div>
-                                    </div>
-                                </div>
-                                <div className="bg-green-50 border border-green-200 rounded-xl p-4">
-                                    <div className="flex items-start gap-3">
-                                        <div className="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center shrink-0">
-                                            <MessageCircle size={16} className="text-green-600" />
-                                        </div>
-                                        <div>
-                                            <p className="font-medium text-green-900 text-sm">Besoin d&apos;aide ?</p>
-                                            <p className="text-xs text-green-700 mt-1">WhatsApp pour conseils personnalisés</p>
-                                        </div>
-                                    </div>
-                                </div>
-                            </div>
-                        </div>
+              </div>
+
+              {/* Tips */}
+              <div className="grid grid-cols-2 gap-3">
+                <div className="bg-blue-50 border border-blue-200 rounded-xl p-4">
+                  <div className="flex items-start gap-3">
+                    <div className="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center shrink-0">
+                      <svg
+                        className="w-4 h-4 text-blue-600"
+                        viewBox="0 0 24 24"
+                        fill="none"
+                        stroke="currentColor"
+                        strokeWidth="2"
+                      >
+                        <circle cx="12" cy="12" r="10" />
+                        <path d="M12 16v-4M12 8h.01" />
+                      </svg>
+                    </div>
+                    <div>
+                      <p className="font-medium text-blue-900 text-sm">
+                        Conseil
+                      </p>
+                      <p className="text-xs text-blue-700 mt-1">
+                        Entre deux tailles ? Prenez la plus grande pour un
+                        confort optimal.
+                      </p>
                     </div>
+                  </div>
                 </div>
-            )}
+                <div className="bg-green-50 border border-green-200 rounded-xl p-4">
+                  <div className="flex items-start gap-3">
+                    <div className="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center shrink-0">
+                      <MessageCircle size={16} className="text-green-600" />
+                    </div>
+                    <div>
+                      <p className="font-medium text-green-900 text-sm">
+                        Besoin d&apos;aide ?
+                      </p>
+                      <p className="text-xs text-green-700 mt-1">
+                        WhatsApp pour conseils personnalisés
+                      </p>
+                    </div>
+                  </div>
+                </div>
+              </div>
+            </div>
+          </div>
         </div>
-    );
+      )}
+    </div>
+  );
 }
diff --git a/src/app/robots.ts b/src/app/robots.ts
index e6b4184..a17bb2f 100644
--- a/src/app/robots.ts
+++ b/src/app/robots.ts
@@ -1,12 +1,12 @@
 import { MetadataRoute } from "next";
 
 export default function robots(): MetadataRoute.Robots {
-    return {
-        rules: {
-            userAgent: "*",
-            allow: "/",
-            disallow: ["/admin", "/api"],
-        },
-        sitemap: "https://harp-web.com/sitemap.xml", // Remplacez par votre domaine réel
-    };
+  return {
+    rules: {
+      userAgent: "*",
+      allow: "/",
+      disallow: ["/admin", "/api"],
+    },
+    sitemap: "https://harp-web.com/sitemap.xml", // Remplacez par votre domaine réel
+  };
 }
diff --git a/src/app/shop/page.tsx b/src/app/shop/page.tsx
index ae92c6f..6c02747 100644
--- a/src/app/shop/page.tsx
+++ b/src/app/shop/page.tsx
@@ -5,249 +5,292 @@ import Link from "next/link";
 import { ProductCard } from "@/components/ProductCard";
 import { ProductGridSkeleton } from "@/components/Skeleton";
 import { useLanguage } from "@/components/LanguageProvider";
-import { 
-    ChevronDown, 
-    X, 
-    Filter,
-    Package,
-    ChevronRight,
-    Search
+import {
+  ChevronDown,
+  X,
+  Filter,
+  Package,
+  ChevronRight,
+  Search,
 } from "lucide-react";
 import { cn } from "@/lib/utils";
 
 type SortOption = "newest" | "price-asc" | "price-desc" | "name";
 
 export default function ShopPage() {
-    const { t, language } = useLanguage();
-    const [products, setProducts] = useState<any[]>([]);
-    const [collections, setCollections] = useState<any[]>([]);
-    const [loading, setLoading] = useState(true);
-    const [activeCollection, setActiveCollection] = useState<string | null>(null);
-    const [sortBy, setSortBy] = useState<SortOption>("newest");
-    const [searchQuery, setSearchQuery] = useState("");
-    const [showMobileFilters, setShowMobileFilters] = useState(false);
-
-    useEffect(() => {
-        const fetchData = async () => {
-            try {
-                const [productsRes, collectionsRes] = await Promise.all([
-                    fetch("/api/products?pageSize=100&isActive=true"),
-                    fetch("/api/collections")
-                ]);
-                const productsData = await productsRes.json();
-                const collectionsData = await collectionsRes.json();
-                // Handle paginated response format { items, meta }
-                const productsList = Array.isArray(productsData) ? productsData : (productsData.items || []);
-                const collectionsList = Array.isArray(collectionsData) ? collectionsData : (collectionsData.items || collectionsData);
-                setProducts(productsList);
-                setCollections(collectionsList);
-            } catch (error) {
-                console.error("Error fetching data:", error);
-            } finally {
-                setLoading(false);
-            }
-        };
-
-        fetchData();
-    }, []);
-
-    // Filter products by collection and search
-    const filteredProducts = products.filter(p => {
-        const matchesCollection = !activeCollection || p.collectionId === activeCollection;
-        const name = language === "fr" ? p.nameFr : p.nameAr;
-        const matchesSearch = !searchQuery || name.toLowerCase().includes(searchQuery.toLowerCase());
-        return matchesCollection && matchesSearch;
-    });
-
-    // Sort products
-    const sortedProducts = [...filteredProducts].sort((a, b) => {
-        switch (sortBy) {
-            case "price-asc":
-                return a.price - b.price;
-            case "price-desc":
-                return b.price - a.price;
-            case "name":
-                return (language === "fr" ? a.nameFr : a.nameAr).localeCompare(
-                    language === "fr" ? b.nameFr : b.nameAr
-                );
-            case "newest":
-            default:
-                return new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime();
-        }
-    });
-
-    const activeCollectionName = activeCollection
-        ? collections.find(c => c.id === activeCollection)?.[language === "fr" ? "nameFr" : "nameAr"]
-        : null;
-
-    return (
-        <div className="min-h-screen bg-gradient-to-b from-harp-cream/50 to-white pt-24 pb-20">
-            {/* Breadcrumb - Minimal */}
-            <div className="container mx-auto px-4 mb-8">
-                <nav className="flex items-center gap-2 text-xs text-gray-500 uppercase tracking-wider">
-                    <Link href="/" className="hover:text-gray-900 transition-colors">
-                        Accueil
-                    </Link>
-                    <ChevronRight size={10} />
-                    <span className="text-gray-900 font-medium">
-                        {activeCollectionName || t("nav.shop")}
-                    </span>
-                </nav>
+  const { t, language } = useLanguage();
+  const [products, setProducts] = useState<any[]>([]);
+  const [collections, setCollections] = useState<any[]>([]);
+  const [loading, setLoading] = useState(true);
+  const [activeCollection, setActiveCollection] = useState<string | null>(null);
+  const [sortBy, setSortBy] = useState<SortOption>("newest");
+  const [searchQuery, setSearchQuery] = useState("");
+  const [showMobileFilters, setShowMobileFilters] = useState(false);
+
+  useEffect(() => {
+    const fetchData = async () => {
+      try {
+        const [productsRes, collectionsRes] = await Promise.all([
+          fetch("/api/products?pageSize=100&isActive=true"),
+          fetch("/api/collections"),
+        ]);
+        const productsData = await productsRes.json();
+        const collectionsData = await collectionsRes.json();
+        // Handle paginated response format { items, meta }
+        const productsList = Array.isArray(productsData)
+          ? productsData
+          : productsData.items || [];
+        const collectionsList = Array.isArray(collectionsData)
+          ? collectionsData
+          : collectionsData.items || collectionsData;
+        setProducts(productsList);
+        setCollections(collectionsList);
+      } catch (error) {
+        console.error("Error fetching data:", error);
+      } finally {
+        setLoading(false);
+      }
+    };
+
+    fetchData();
+  }, []);
+
+  // Filter products by collection and search
+  const filteredProducts = products.filter((p) => {
+    const matchesCollection =
+      !activeCollection || p.collectionId === activeCollection;
+    const name = language === "fr" ? p.nameFr : p.nameAr;
+    const matchesSearch =
+      !searchQuery || name.toLowerCase().includes(searchQuery.toLowerCase());
+    return matchesCollection && matchesSearch;
+  });
+
+  // Sort products
+  const sortedProducts = [...filteredProducts].sort((a, b) => {
+    switch (sortBy) {
+      case "price-asc":
+        return a.price - b.price;
+      case "price-desc":
+        return b.price - a.price;
+      case "name":
+        return (language === "fr" ? a.nameFr : a.nameAr).localeCompare(
+          language === "fr" ? b.nameFr : b.nameAr,
+        );
+      case "newest":
+      default:
+        return (
+          new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()
+        );
+    }
+  });
+
+  const activeCollectionName = activeCollection
+    ? collections.find((c) => c.id === activeCollection)?.[
+        language === "fr" ? "nameFr" : "nameAr"
+      ]
+    : null;
+
+  return (
+    <div className="min-h-screen bg-gradient-to-b from-harp-cream/50 to-white pt-24 pb-20">
+      {/* Breadcrumb - Minimal */}
+      <div className="container mx-auto px-4 mb-8">
+        <nav className="flex items-center gap-2 text-xs text-gray-500 uppercase tracking-wider">
+          <Link href="/" className="hover:text-gray-900 transition-colors">
+            Accueil
+          </Link>
+          <ChevronRight size={10} />
+          <span className="text-gray-900 font-medium">
+            {activeCollectionName || t("nav.shop")}
+          </span>
+        </nav>
+      </div>
+
+      {/* Hero Section - Text Only */}
+      <section className="mb-16">
+        <div className="container mx-auto px-4">
+          <div className="max-w-3xl">
+            <h1 className="text-4xl md:text-6xl font-serif font-medium text-gray-900 mb-6">
+              {activeCollectionName || "La Boutique"}
+            </h1>
+            <p className="text-gray-500 font-light text-lg leading-relaxed max-w-xl">
+              {t("shop.hero.subtitle") ||
+                "Une sélection de pièces pensées pour l'élégance du quotidien."}
+            </p>
+          </div>
+        </div>
+      </section>
+
+      <div className="container mx-auto px-4">
+        {/* Filters Bar */}
+        <div className="sticky top-[80px] z-30 bg-white/95 backdrop-blur-sm border-b border-gray-100 mb-12 -mx-4 px-4 py-4">
+          <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4">
+            {/* Left - Collection filters */}
+            <div className="flex flex-wrap items-center gap-6">
+              <button
+                onClick={() => setActiveCollection(null)}
+                className={cn(
+                  "text-sm font-medium transition-all uppercase tracking-wide hover:text-gray-900",
+                  !activeCollection ? "text-gray-900" : "text-gray-400",
+                )}
+              >
+                Tous
+              </button>
+              {collections.map((collection) => (
+                <button
+                  key={collection.id}
+                  onClick={() => setActiveCollection(collection.id)}
+                  className={cn(
+                    "text-sm font-medium transition-all uppercase tracking-wide hover:text-gray-900",
+                    activeCollection === collection.id
+                      ? "text-gray-900"
+                      : "text-gray-400",
+                  )}
+                >
+                  {language === "fr" ? collection.nameFr : collection.nameAr}
+                </button>
+              ))}
             </div>
 
-            {/* Hero Section - Text Only */}
-            <section className="mb-16">
-                <div className="container mx-auto px-4">
-                    <div className="max-w-3xl">
-                        <h1 className="text-4xl md:text-6xl font-serif font-medium text-gray-900 mb-6">
-                            {activeCollectionName || "La Boutique"}
-                        </h1>
-                        <p className="text-gray-500 font-light text-lg leading-relaxed max-w-xl">
-                            {t("shop.hero.subtitle") || "Une sélection de pièces pensées pour l'élégance du quotidien."}
-                        </p>
-                    </div>
-                </div>
-            </section>
-
-            <div className="container mx-auto px-4">
-                {/* Filters Bar */}
-                <div className="sticky top-[80px] z-30 bg-white/95 backdrop-blur-sm border-b border-gray-100 mb-12 -mx-4 px-4 py-4">
-                    <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4">
-                        {/* Left - Collection filters */}
-                        <div className="flex flex-wrap items-center gap-6">
-                             <button
-                                onClick={() => setActiveCollection(null)}
-                                className={cn(
-                                    "text-sm font-medium transition-all uppercase tracking-wide hover:text-gray-900",
-                                    !activeCollection ? "text-gray-900" : "text-gray-400"
-                                )}
-                            >
-                                Tous
-                            </button>
-                            {collections.map((collection) => (
-                                <button
-                                    key={collection.id}
-                                    onClick={() => setActiveCollection(collection.id)}
-                                    className={cn(
-                                        "text-sm font-medium transition-all uppercase tracking-wide hover:text-gray-900",
-                                        activeCollection === collection.id ? "text-gray-900" : "text-gray-400"
-                                    )}
-                                >
-                                    {language === "fr" ? collection.nameFr : collection.nameAr}
-                                </button>
-                            ))}
-                        </div>
-
-                         {/* Right - Search & Sort */}
-                        <div className="flex items-center gap-6 ml-auto">
-                             {/* Search */}
-                             <div className="relative group hidden md:block">
-                                <Search size={16} className="absolute left-0 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-gray-900 transition-colors" />
-                                <input
-                                    type="text"
-                                    placeholder="Rechercher..."
-                                    value={searchQuery}
-                                    onChange={(e) => setSearchQuery(e.target.value)}
-                                    className="w-[200px] pl-6 pr-0 py-1 bg-transparent border-b border-transparent focus:border-gray-900 text-sm outline-none transition-all placeholder:text-gray-400 text-gray-900"
-                                />
-                            </div>
-
-                            {/* Sort */}
-                            <div className="relative flex items-center gap-2">
-                                <span className="text-xs text-gray-400 uppercase tracking-wider hidden sm:inline">Trier</span>
-                                <div className="relative">
-                                    <select
-                                        value={sortBy}
-                                        onChange={(e) => setSortBy(e.target.value as SortOption)}
-                                        className="appearance-none bg-transparent text-sm font-medium text-gray-900 focus:outline-none cursor-pointer pr-4"
-                                    >
-                                        <option value="newest">Nouveautés</option>
-                                        <option value="price-asc">Prix croissant</option>
-                                        <option value="price-desc">Prix décroissant</option>
-                                    </select>
-                                    <ChevronDown size={12} className="absolute right-0 top-1/2 -translate-y-1/2 pointer-events-none text-gray-900" />
-                                </div>
-                            </div>
-                        </div>
-                    </div>
-                    
-                    {/* Mobile Search (visible only on mobile) */}
-                     <div className="md:hidden mt-4 pt-4 border-t border-gray-100">
-                        <div className="relative w-full">
-                            <Search size={16} className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" />
-                            <input
-                                type="text"
-                                placeholder="Rechercher..."
-                                value={searchQuery}
-                                onChange={(e) => setSearchQuery(e.target.value)}
-                                className="w-full pl-10 pr-4 py-2 bg-gray-50 rounded-full text-sm outline-none focus:bg-gray-100 transition-colors"
-                            />
-                        </div>
-                    </div>
-                </div>
+            {/* Right - Search & Sort */}
+            <div className="flex items-center gap-6 ml-auto">
+              {/* Search */}
+              <div className="relative group hidden md:block">
+                <Search
+                  size={16}
+                  className="absolute left-0 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-gray-900 transition-colors"
+                />
+                <input
+                  type="text"
+                  placeholder="Rechercher..."
+                  value={searchQuery}
+                  onChange={(e) => setSearchQuery(e.target.value)}
+                  className="w-[200px] pl-6 pr-0 py-1 bg-transparent border-b border-transparent focus:border-gray-900 text-sm outline-none transition-all placeholder:text-gray-400 text-gray-900"
+                />
+              </div>
 
-                {/* Results Count & Active Filters */}
-                <div className="flex items-center justify-between mb-8">
-                     <span className="text-xs text-gray-400 uppercase tracking-widest">
-                        {sortedProducts.length} {sortedProducts.length > 1 ? 'Produits' : 'Produit'}
-                    </span>
-                    
-                     {(activeCollection || searchQuery) && (
-                        <button
-                            onClick={() => { setActiveCollection(null); setSearchQuery(""); }}
-                            className="text-xs text-gray-400 hover:text-gray-900 underline transition-colors"
-                        >
-                            Effacer les filtres
-                        </button>
-                    )}
+              {/* Sort */}
+              <div className="relative flex items-center gap-2">
+                <span className="text-xs text-gray-400 uppercase tracking-wider hidden sm:inline">
+                  Trier
+                </span>
+                <div className="relative">
+                  <select
+                    value={sortBy}
+                    onChange={(e) => setSortBy(e.target.value as SortOption)}
+                    className="appearance-none bg-transparent text-sm font-medium text-gray-900 focus:outline-none cursor-pointer pr-4"
+                  >
+                    <option value="newest">Nouveautés</option>
+                    <option value="price-asc">Prix croissant</option>
+                    <option value="price-desc">Prix décroissant</option>
+                  </select>
+                  <ChevronDown
+                    size={12}
+                    className="absolute right-0 top-1/2 -translate-y-1/2 pointer-events-none text-gray-900"
+                  />
                 </div>
+              </div>
+            </div>
+          </div>
 
-                {/* Products Grid */}
-                {loading ? (
-                    <ProductGridSkeleton count={8} />
-                ) : sortedProducts.length > 0 ? (
-                    <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-x-6 gap-y-12">
-                        {sortedProducts.map((product, index) => {
-                            const images = JSON.parse(product.images);
-                            const collection = collections.find(c => c.id === product.collectionId);
-                            return (
-                                <div
-                                    key={product.id}
-                                    className="animate-fade-in-up"
-                                    style={{ animationDelay: `${Math.min(index * 50, 400)}ms` }}
-                                >
-                                    <ProductCard
-                                        id={product.id}
-                                        name={language === "fr" ? product.nameFr : product.nameAr}
-                                        price={product.price}
-                                        image={images[0]}
-                                        category={collection ? (language === "fr" ? collection.nameFr : collection.nameAr) : undefined}
-                                        isNew={new Date(product.createdAt) > new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)}
-                                    />
-                                </div>
-                            );
-                        })}
-                    </div>
-                ) : (
-                    <div className="text-center py-32 border-t border-gray-100">
-                        <div className="w-16 h-16 mx-auto bg-gray-50 rounded-full flex items-center justify-center mb-6">
-                            <Package size={24} className="text-gray-400" />
-                        </div>
-                        <h3 className="text-lg font-serif font-medium text-gray-900 mb-2">
-                            Aucun produit trouvé
-                        </h3>
-                        <p className="text-gray-500 font-light mb-8 max-w-md mx-auto">
-                            Nous ne trouvons pas ce que vous cherchez. Essayez de modifier vos filtres.
-                        </p>
-                        <button
-                            onClick={() => { setActiveCollection(null); setSearchQuery(""); }}
-                            className="text-sm border-b border-gray-900 pb-0.5 hover:text-gray-600 hover:border-gray-600 transition-all uppercase tracking-widest"
-                        >
-                            Voir tous les produits
-                        </button>
-                    </div>
-                )}
+          {/* Mobile Search (visible only on mobile) */}
+          <div className="md:hidden mt-4 pt-4 border-t border-gray-100">
+            <div className="relative w-full">
+              <Search
+                size={16}
+                className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
+              />
+              <input
+                type="text"
+                placeholder="Rechercher..."
+                value={searchQuery}
+                onChange={(e) => setSearchQuery(e.target.value)}
+                className="w-full pl-10 pr-4 py-2 bg-gray-50 rounded-full text-sm outline-none focus:bg-gray-100 transition-colors"
+              />
             </div>
+          </div>
+        </div>
+
+        {/* Results Count & Active Filters */}
+        <div className="flex items-center justify-between mb-8">
+          <span className="text-xs text-gray-400 uppercase tracking-widest">
+            {sortedProducts.length}{" "}
+            {sortedProducts.length > 1 ? "Produits" : "Produit"}
+          </span>
+
+          {(activeCollection || searchQuery) && (
+            <button
+              onClick={() => {
+                setActiveCollection(null);
+                setSearchQuery("");
+              }}
+              className="text-xs text-gray-400 hover:text-gray-900 underline transition-colors"
+            >
+              Effacer les filtres
+            </button>
+          )}
         </div>
-    );
+
+        {/* Products Grid */}
+        {loading ? (
+          <ProductGridSkeleton count={8} />
+        ) : sortedProducts.length > 0 ? (
+          <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-x-6 gap-y-12">
+            {sortedProducts.map((product, index) => {
+              const images = JSON.parse(product.images);
+              const collection = collections.find(
+                (c) => c.id === product.collectionId,
+              );
+              return (
+                <div
+                  key={product.id}
+                  className="animate-fade-in-up"
+                  style={{ animationDelay: `${Math.min(index * 50, 400)}ms` }}
+                >
+                  <ProductCard
+                    id={product.id}
+                    name={language === "fr" ? product.nameFr : product.nameAr}
+                    price={product.price}
+                    image={images[0]}
+                    category={
+                      collection
+                        ? language === "fr"
+                          ? collection.nameFr
+                          : collection.nameAr
+                        : undefined
+                    }
+                    isNew={
+                      new Date(product.createdAt) >
+                      new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)
+                    }
+                  />
+                </div>
+              );
+            })}
+          </div>
+        ) : (
+          <div className="text-center py-32 border-t border-gray-100">
+            <div className="w-16 h-16 mx-auto bg-gray-50 rounded-full flex items-center justify-center mb-6">
+              <Package size={24} className="text-gray-400" />
+            </div>
+            <h3 className="text-lg font-serif font-medium text-gray-900 mb-2">
+              Aucun produit trouvé
+            </h3>
+            <p className="text-gray-500 font-light mb-8 max-w-md mx-auto">
+              Nous ne trouvons pas ce que vous cherchez. Essayez de modifier vos
+              filtres.
+            </p>
+            <button
+              onClick={() => {
+                setActiveCollection(null);
+                setSearchQuery("");
+              }}
+              className="text-sm border-b border-gray-900 pb-0.5 hover:text-gray-600 hover:border-gray-600 transition-all uppercase tracking-widest"
+            >
+              Voir tous les produits
+            </button>
+          </div>
+        )}
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/sitemap.ts b/src/app/sitemap.ts
index 36cb1a6..413710e 100644
--- a/src/app/sitemap.ts
+++ b/src/app/sitemap.ts
@@ -4,86 +4,86 @@ import { PrismaClient } from "@prisma/client";
 const prisma = new PrismaClient();
 
 export default async function sitemap(): Promise<MetadataRoute.Sitemap> {
-    const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || "https://harp-dz.com";
+  const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || "https://harp-dz.com";
 
-    // Pages statiques
-    const staticPages = [
-        {
-            url: baseUrl,
-            lastModified: new Date(),
-            changeFrequency: "daily" as const,
-            priority: 1,
-        },
-        {
-            url: `${baseUrl}/shop`,
-            lastModified: new Date(),
-            changeFrequency: "daily" as const,
-            priority: 0.9,
-        },
-        {
-            url: `${baseUrl}/about`,
-            lastModified: new Date(),
-            changeFrequency: "monthly" as const,
-            priority: 0.6,
-        },
-        {
-            url: `${baseUrl}/contact`,
-            lastModified: new Date(),
-            changeFrequency: "monthly" as const,
-            priority: 0.5,
-        },
-        {
-            url: `${baseUrl}/suivi`,
-            lastModified: new Date(),
-            changeFrequency: "monthly" as const,
-            priority: 0.4,
-        },
-        {
-            url: `${baseUrl}/privacy`,
-            lastModified: new Date(),
-            changeFrequency: "yearly" as const,
-            priority: 0.3,
-        },
-        {
-            url: `${baseUrl}/terms`,
-            lastModified: new Date(),
-            changeFrequency: "yearly" as const,
-            priority: 0.3,
-        },
-    ];
+  // Pages statiques
+  const staticPages = [
+    {
+      url: baseUrl,
+      lastModified: new Date(),
+      changeFrequency: "daily" as const,
+      priority: 1,
+    },
+    {
+      url: `${baseUrl}/shop`,
+      lastModified: new Date(),
+      changeFrequency: "daily" as const,
+      priority: 0.9,
+    },
+    {
+      url: `${baseUrl}/about`,
+      lastModified: new Date(),
+      changeFrequency: "monthly" as const,
+      priority: 0.6,
+    },
+    {
+      url: `${baseUrl}/contact`,
+      lastModified: new Date(),
+      changeFrequency: "monthly" as const,
+      priority: 0.5,
+    },
+    {
+      url: `${baseUrl}/suivi`,
+      lastModified: new Date(),
+      changeFrequency: "monthly" as const,
+      priority: 0.4,
+    },
+    {
+      url: `${baseUrl}/privacy`,
+      lastModified: new Date(),
+      changeFrequency: "yearly" as const,
+      priority: 0.3,
+    },
+    {
+      url: `${baseUrl}/terms`,
+      lastModified: new Date(),
+      changeFrequency: "yearly" as const,
+      priority: 0.3,
+    },
+  ];
 
-    // Récupérer les produits pour le sitemap (utilise slug si disponible, sinon id)
-    const products = await prisma.product.findMany({
-        where: { isActive: true },
-        select: {
-            id: true,
-            slug: true,
-            updatedAt: true,
-        },
-    });
+  // Récupérer les produits pour le sitemap (utilise slug si disponible, sinon id)
+  const products = await prisma.product.findMany({
+    where: { isActive: true },
+    select: {
+      id: true,
+      slug: true,
+      updatedAt: true,
+    },
+  });
 
-    const productUrls = products.map((product) => ({
-        url: `${baseUrl}/product/${product.slug || product.id}`,
-        lastModified: product.updatedAt,
-        changeFrequency: "weekly" as const,
-        priority: 0.8,
-    }));
+  const productUrls = products.map((product) => ({
+    url: `${baseUrl}/product/${product.slug || product.id}`,
+    lastModified: product.updatedAt,
+    changeFrequency: "weekly" as const,
+    priority: 0.8,
+  }));
 
-    // Récupérer les collections pour le sitemap
-    const collections = await prisma.collection.findMany({
-        select: {
-            id: true,
-            slug: true,
-            updatedAt: true,
-        },
-    });
+  // Récupérer les collections pour le sitemap
+  const collections = await prisma.collection.findMany({
+    select: {
+      id: true,
+      slug: true,
+      updatedAt: true,
+    },
+  });
 
-    const collectionUrls = collections.map((collection) => ({
-        url: `${baseUrl}/collection/${collection.slug || collection.id}`,
-        lastModified: collection.updatedAt,
-        changeFrequency: "weekly" as const,
-        priority: 0.7,
-    }));
+  const collectionUrls = collections.map((collection) => ({
+    url: `${baseUrl}/collection/${collection.slug || collection.id}`,
+    lastModified: collection.updatedAt,
+    changeFrequency: "weekly" as const,
+    priority: 0.7,
+  }));
 
-    return [...staticPages, ...productUrls, ...collectionUrls];
+  return [...staticPages, ...productUrls, ...collectionUrls];
 }
diff --git a/src/app/suivi/page.tsx b/src/app/suivi/page.tsx
index d70ffb8..a20544a 100644
--- a/src/app/suivi/page.tsx
+++ b/src/app/suivi/page.tsx
@@ -2,254 +2,310 @@
 
 import { useState } from "react";
 import { useLanguage } from "@/components/LanguageProvider";
-import { 
-    Search, 
-    Package, 
-    Truck, 
-    CheckCircle2, 
-    Clock, 
-    MapPin,
-    Phone,
-    Loader2,
-    AlertCircle,
-    ArrowRight
+import {
+  Search,
+  Package,
+  Truck,
+  CheckCircle2,
+  Clock,
+  MapPin,
+  Phone,
+  Loader2,
+  AlertCircle,
+  ArrowRight,
 } from "lucide-react";
 import Link from "next/link";
 
 interface TrackingStep {
-    status: string;
-    date: string;
-    location?: string;
-    completed: boolean;
-    current: boolean;
+  status: string;
+  date: string;
+  location?: string;
+  completed: boolean;
+  current: boolean;
 }
 
 interface TrackingResult {
-    found: boolean;
-    provider: string;
-    tracking: string;
-    status: string;
-    customerName?: string;
-    destination?: string;
-    history?: TrackingStep[];
-    estimatedDelivery?: string;
-    error?: string;
+  found: boolean;
+  provider: string;
+  tracking: string;
+  status: string;
+  customerName?: string;
+  destination?: string;
+  history?: TrackingStep[];
+  estimatedDelivery?: string;
+  error?: string;
 }
 
 export default function TrackingPage() {
-    const { t } = useLanguage();
-    const [trackingNumber, setTrackingNumber] = useState("");
-    const [loading, setLoading] = useState(false);
-    const [result, setResult] = useState<TrackingResult | null>(null);
-    const [error, setError] = useState("");
-
-    const handleTrack = async (e: React.FormEvent) => {
-        e.preventDefault();
-        if (!trackingNumber.trim()) return;
-
-        setLoading(true);
-        setError("");
-        setResult(null);
-
-        try {
-            // Determine provider from tracking number format
-            const isYalidine = trackingNumber.toLowerCase().startsWith("yal-");
-            const provider = isYalidine ? "yalidine" : "zrexpress";
-            
-            const response = await fetch(`/api/tracking?tracking=${trackingNumber}&provider=${provider}`);
-            const data = await response.json();
-
-            if (data.error) {
-                setError(data.error);
-            } else {
-                setResult(data);
-            }
-        } catch (err) {
-            setError("Une erreur est survenue. Veuillez réessayer.");
-        } finally {
-            setLoading(false);
-        }
-    };
-
-    const getStatusColor = (status: string) => {
-        const statusLower = status.toLowerCase();
-        if (statusLower.includes("livré") || statusLower.includes("delivered")) return "text-green-600";
-        if (statusLower.includes("expédié") || statusLower.includes("transit") || statusLower.includes("sorti")) return "text-blue-600";
-        if (statusLower.includes("retour") || statusLower.includes("échec") || statusLower.includes("annul")) return "text-red-600";
-        return "text-amber-600";
-    };
-
-    const getStatusIcon = (status: string) => {
-        const statusLower = status.toLowerCase();
-        if (statusLower.includes("livré") || statusLower.includes("delivered")) return <CheckCircle2 className="text-green-600" size={24} />;
-        if (statusLower.includes("expédié") || statusLower.includes("transit") || statusLower.includes("sorti")) return <Truck className="text-blue-600" size={24} />;
-        if (statusLower.includes("retour") || statusLower.includes("échec")) return <AlertCircle className="text-red-600" size={24} />;
-        return <Package className="text-amber-600" size={24} />;
-    };
-
-    return (
-        <div className="min-h-screen bg-white pt-32 pb-20">
-            <div className="container mx-auto px-4 max-w-2xl">
-                {/* Header */}
-                <div className="text-center mb-12">
-                    <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
-                        Suivi de Commande
-                    </span>
-                    <h1 className="text-3xl md:text-5xl font-serif font-medium text-gray-900 mb-6">
-                        Où est mon colis ?
-                    </h1>
-                    <p className="text-gray-500 font-light max-w-md mx-auto">
-                        Entrez votre numéro de suivi ci-dessous pour localiser votre commande en temps réel.
-                    </p>
-                </div>
+  const { t } = useLanguage();
+  const [trackingNumber, setTrackingNumber] = useState("");
+  const [loading, setLoading] = useState(false);
+  const [result, setResult] = useState<TrackingResult | null>(null);
+  const [error, setError] = useState("");
 
-                {/* Search Form */}
-                <form onSubmit={handleTrack} className="mb-12">
-                    <div className="relative group">
-                        <div className="absolute inset-0 bg-white rounded-full shadow-[0_4px_20px_rgba(0,0,0,0.05)] transition-shadow group-hover:shadow-[0_8px_30px_rgba(0,0,0,0.08)]" />
-                        <div className="relative flex items-center p-2">
-                            <div className="pl-6">
-                                <Search size={20} className="text-gray-400" />
-                            </div>
-                            <input
-                                type="text"
-                                value={trackingNumber}
-                                onChange={(e) => setTrackingNumber(e.target.value.toUpperCase())}
-                                placeholder="YAL-XXXXXX ou ZRXXXXXXX"
-                                className="w-full pl-4 pr-4 py-4 bg-transparent border-none focus:ring-0 outline-none text-lg placeholder:text-gray-300 text-gray-900 font-medium"
-                            />
-                            <button
-                                type="submit"
-                                disabled={loading || !trackingNumber.trim()}
-                                className="px-8 py-4 bg-gray-900 text-white rounded-full font-medium hover:bg-harp-brown transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-md"
-                            >
-                                {loading ? (
-                                    <Loader2 size={20} className="animate-spin" />
-                                ) : (
-                                    <ArrowRight size={20} />
-                                )}
-                            </button>
-                        </div>
-                    </div>
-                    
-                    <div className="mt-6 text-center">
-                        <p className="text-xs text-gray-400 uppercase tracking-widest mb-2">Formats acceptés</p>
-                        <div className="flex justify-center gap-3 text-sm text-gray-500 font-mono">
-                            <span className="bg-gray-50 px-3 py-1 rounded-md border border-gray-100">YAL-XXXXXX</span>
-                            <span className="bg-gray-50 px-3 py-1 rounded-md border border-gray-100">ZRXXXXXXX</span>
-                        </div>
-                    </div>
-                </form>
+  const handleTrack = async (e: React.FormEvent) => {
+    e.preventDefault();
+    if (!trackingNumber.trim()) return;
 
-                {/* Error Message */}
-                {error && (
-                    <div className="bg-red-50 border border-red-100 rounded-xl p-6 mb-8 text-center animate-fade-in">
-                        <AlertCircle className="text-red-500 mx-auto mb-3" size={24} />
-                        <p className="text-red-600 font-medium">{error}</p>
-                    </div>
+    setLoading(true);
+    setError("");
+    setResult(null);
+
+    try {
+      // Determine provider from tracking number format
+      const isYalidine = trackingNumber.toLowerCase().startsWith("yal-");
+      const provider = isYalidine ? "yalidine" : "zrexpress";
+
+      const response = await fetch(
+        `/api/tracking?tracking=${trackingNumber}&provider=${provider}`,
+      );
+      const data = await response.json();
+
+      if (data.error) {
+        setError(data.error);
+      } else {
+        setResult(data);
+      }
+    } catch (err) {
+      setError("Une erreur est survenue. Veuillez réessayer.");
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const getStatusColor = (status: string) => {
+    const statusLower = status.toLowerCase();
+    if (statusLower.includes("livré") || statusLower.includes("delivered"))
+      return "text-green-600";
+    if (
+      statusLower.includes("expédié") ||
+      statusLower.includes("transit") ||
+      statusLower.includes("sorti")
+    )
+      return "text-blue-600";
+    if (
+      statusLower.includes("retour") ||
+      statusLower.includes("échec") ||
+      statusLower.includes("annul")
+    )
+      return "text-red-600";
+    return "text-amber-600";
+  };
+
+  const getStatusIcon = (status: string) => {
+    const statusLower = status.toLowerCase();
+    if (statusLower.includes("livré") || statusLower.includes("delivered"))
+      return <CheckCircle2 className="text-green-600" size={24} />;
+    if (
+      statusLower.includes("expédié") ||
+      statusLower.includes("transit") ||
+      statusLower.includes("sorti")
+    )
+      return <Truck className="text-blue-600" size={24} />;
+    if (statusLower.includes("retour") || statusLower.includes("échec"))
+      return <AlertCircle className="text-red-600" size={24} />;
+    return <Package className="text-amber-600" size={24} />;
+  };
+
+  return (
+    <div className="min-h-screen bg-white pt-32 pb-20">
+      <div className="container mx-auto px-4 max-w-2xl">
+        {/* Header */}
+        <div className="text-center mb-12">
+          <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
+            Suivi de Commande
+          </span>
+          <h1 className="text-3xl md:text-5xl font-serif font-medium text-gray-900 mb-6">
+            Où est mon colis ?
+          </h1>
+          <p className="text-gray-500 font-light max-w-md mx-auto">
+            Entrez votre numéro de suivi ci-dessous pour localiser votre
+            commande en temps réel.
+          </p>
+        </div>
+
+        {/* Search Form */}
+        <form onSubmit={handleTrack} className="mb-12">
+          <div className="relative group">
+            <div className="absolute inset-0 bg-white rounded-full shadow-[0_4px_20px_rgba(0,0,0,0.05)] transition-shadow group-hover:shadow-[0_8px_30px_rgba(0,0,0,0.08)]" />
+            <div className="relative flex items-center p-2">
+              <div className="pl-6">
+                <Search size={20} className="text-gray-400" />
+              </div>
+              <input
+                type="text"
+                value={trackingNumber}
+                onChange={(e) =>
+                  setTrackingNumber(e.target.value.toUpperCase())
+                }
+                placeholder="YAL-XXXXXX ou ZRXXXXXXX"
+                className="w-full pl-4 pr-4 py-4 bg-transparent border-none focus:ring-0 outline-none text-lg placeholder:text-gray-300 text-gray-900 font-medium"
+              />
+              <button
+                type="submit"
+                disabled={loading || !trackingNumber.trim()}
+                className="px-8 py-4 bg-gray-900 text-white rounded-full font-medium hover:bg-harp-brown transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-md"
+              >
+                {loading ? (
+                  <Loader2 size={20} className="animate-spin" />
+                ) : (
+                  <ArrowRight size={20} />
                 )}
+              </button>
+            </div>
+          </div>
 
-                {/* Tracking Result */}
-                {result && result.found && (
-                    <div className="bg-white rounded-3xl shadow-[0_10px_40px_-10px_rgba(0,0,0,0.08)] border border-gray-100 overflow-hidden animate-fade-in-up">
-                        {/* Status Header */}
-                        <div className="p-8 bg-gray-50 border-b border-gray-100">
-                            <div className="flex flex-col sm:flex-row items-start justify-between gap-6">
-                                <div>
-                                    <div className="flex items-center gap-2 mb-2">
-                                        <span className="text-xs font-bold uppercase tracking-widest text-gray-400">Numéro de suivi</span>
-                                        <span className="px-2 py-0.5 bg-white border border-gray-200 text-gray-600 text-[10px] uppercase tracking-wider rounded font-bold">
-                                            {result.provider}
-                                        </span>
-                                    </div>
-                                    <p className="text-2xl font-serif font-bold text-gray-900 tracking-wide">{result.tracking}</p>
-                                </div>
-                                <div className="p-3 bg-white rounded-2xl shadow-sm border border-gray-100">
-                                    {getStatusIcon(result.status)}
-                                </div>
-                            </div>
-                            
-                            <div className="mt-8 flex items-center justify-between p-4 bg-white rounded-2xl border border-gray-200">
-                                <div className="flex flex-col">
-                                    <span className="text-xs text-gray-400 uppercase tracking-widest mb-1">Statut</span>
-                                    <span className={`font-medium ${getStatusColor(result.status)}`}>
-                                        {result.status}
-                                    </span>
-                                </div>
-                                {result.destination && (
-                                    <div className="text-right flex flex-col">
-                                        <span className="text-xs text-gray-400 uppercase tracking-widest mb-1">Destination</span>
-                                        <span className="font-medium text-gray-900">{result.destination}</span>
-                                    </div>
-                                )}
-                            </div>
-                        </div>
+          <div className="mt-6 text-center">
+            <p className="text-xs text-gray-400 uppercase tracking-widest mb-2">
+              Formats acceptés
+            </p>
+            <div className="flex justify-center gap-3 text-sm text-gray-500 font-mono">
+              <span className="bg-gray-50 px-3 py-1 rounded-md border border-gray-100">
+                YAL-XXXXXX
+              </span>
+              <span className="bg-gray-50 px-3 py-1 rounded-md border border-gray-100">
+                ZRXXXXXXX
+              </span>
+            </div>
+          </div>
+        </form>
 
-                        {/* Tracking History */}
-                        {result.history && result.history.length > 0 && (
-                            <div className="p-8">
-                                <h3 className="font-serif font-medium text-gray-900 mb-8">Historique</h3>
-                                <div className="relative pl-4 space-y-8 before:absolute before:left-[19px] before:top-2 before:bottom-2 before:w-0.5 before:bg-gray-100">
-                                    {result.history.map((step, index) => (
-                                        <div key={index} className="relative flex gap-6">
-                                            <div className={`relative z-10 w-2.5 h-2.5 rounded-full mt-2 ${
-                                                step.current 
-                                                    ? 'bg-gray-900 ring-4 ring-gray-100' 
-                                                    : step.completed 
-                                                        ? 'bg-green-500' 
-                                                        : 'bg-gray-300'
-                                            }`} />
-                                            <div className="flex-1">
-                                                <p className={`font-medium ${step.current ? 'text-gray-900 text-lg' : 'text-gray-600'}`}>
-                                                    {step.status}
-                                                </p>
-                                                <div className="flex flex-wrap items-center gap-4 text-sm text-gray-400 mt-1 font-light">
-                                                    <span className="flex items-center gap-1.5">
-                                                        <Clock size={14} />
-                                                        {step.date}
-                                                    </span>
-                                                    {step.location && (
-                                                        <span className="flex items-center gap-1.5">
-                                                            <MapPin size={14} />
-                                                            {step.location}
-                                                        </span>
-                                                    )}
-                                                </div>
-                                            </div>
-                                        </div>
-                                    ))}
-                                </div>
-                            </div>
-                        )}
-
-                        {/* Contact Support */}
-                        <div className="p-6 bg-gray-50 border-t border-gray-100 text-center">
-                            <p className="text-sm text-gray-500 mb-3">
-                                Un problème avec votre livraison ?
-                            </p>
-                            <a href="/contact" className="inline-flex items-center gap-2 text-sm font-medium text-gray-900 hover:text-harp-brown transition-colors border-b border-gray-900 pb-0.5 hover:border-harp-brown">
-                                Contacter le support
-                            </a>
-                        </div>
-                    </div>
+        {/* Error Message */}
+        {error && (
+          <div className="bg-red-50 border border-red-100 rounded-xl p-6 mb-8 text-center animate-fade-in">
+            <AlertCircle className="text-red-500 mx-auto mb-3" size={24} />
+            <p className="text-red-600 font-medium">{error}</p>
+          </div>
+        )}
+
+        {/* Tracking Result */}
+        {result && result.found && (
+          <div className="bg-white rounded-3xl shadow-[0_10px_40px_-10px_rgba(0,0,0,0.08)] border border-gray-100 overflow-hidden animate-fade-in-up">
+            {/* Status Header */}
+            <div className="p-8 bg-gray-50 border-b border-gray-100">
+              <div className="flex flex-col sm:flex-row items-start justify-between gap-6">
+                <div>
+                  <div className="flex items-center gap-2 mb-2">
+                    <span className="text-xs font-bold uppercase tracking-widest text-gray-400">
+                      Numéro de suivi
+                    </span>
+                    <span className="px-2 py-0.5 bg-white border border-gray-200 text-gray-600 text-[10px] uppercase tracking-wider rounded font-bold">
+                      {result.provider}
+                    </span>
+                  </div>
+                  <p className="text-2xl font-serif font-bold text-gray-900 tracking-wide">
+                    {result.tracking}
+                  </p>
+                </div>
+                <div className="p-3 bg-white rounded-2xl shadow-sm border border-gray-100">
+                  {getStatusIcon(result.status)}
+                </div>
+              </div>
+
+              <div className="mt-8 flex items-center justify-between p-4 bg-white rounded-2xl border border-gray-200">
+                <div className="flex flex-col">
+                  <span className="text-xs text-gray-400 uppercase tracking-widest mb-1">
+                    Statut
+                  </span>
+                  <span
+                    className={`font-medium ${getStatusColor(result.status)}`}
+                  >
+                    {result.status}
+                  </span>
+                </div>
+                {result.destination && (
+                  <div className="text-right flex flex-col">
+                    <span className="text-xs text-gray-400 uppercase tracking-widest mb-1">
+                      Destination
+                    </span>
+                    <span className="font-medium text-gray-900">
+                      {result.destination}
+                    </span>
+                  </div>
                 )}
+              </div>
+            </div>
 
-                {/* Not Found */}
-                {result && !result.found && (
-                    <div className="bg-white rounded-3xl shadow-lg border border-gray-100 p-12 text-center animate-fade-in">
-                        <div className="w-20 h-20 rounded-full bg-gray-50 flex items-center justify-center mx-auto mb-6">
-                            <Package size={32} className="text-gray-300" />
-                        </div>
-                        <h3 className="text-xl font-serif font-medium text-gray-900 mb-3">Introuvable</h3>
-                        <p className="text-gray-500 font-light mb-8">
-                            Nous ne trouvons pas ce numéro de suivi. Vérifiez qu'il est correct.
+            {/* Tracking History */}
+            {result.history && result.history.length > 0 && (
+              <div className="p-8">
+                <h3 className="font-serif font-medium text-gray-900 mb-8">
+                  Historique
+                </h3>
+                <div className="relative pl-4 space-y-8 before:absolute before:left-[19px] before:top-2 before:bottom-2 before:w-0.5 before:bg-gray-100">
+                  {result.history.map((step, index) => (
+                    <div key={index} className="relative flex gap-6">
+                      <div
+                        className={`relative z-10 w-2.5 h-2.5 rounded-full mt-2 ${
+                          step.current
+                            ? "bg-gray-900 ring-4 ring-gray-100"
+                            : step.completed
+                              ? "bg-green-500"
+                              : "bg-gray-300"
+                        }`}
+                      />
+                      <div className="flex-1">
+                        <p
+                          className={`font-medium ${step.current ? "text-gray-900 text-lg" : "text-gray-600"}`}
+                        >
+                          {step.status}
                         </p>
-                        <Link href="/contact" className="text-gray-900 font-medium border-b border-gray-900 pb-1 hover:text-harp-brown hover:border-harp-brown transition-colors">
-                            Contacter le support
-                        </Link>
+                        <div className="flex flex-wrap items-center gap-4 text-sm text-gray-400 mt-1 font-light">
+                          <span className="flex items-center gap-1.5">
+                            <Clock size={14} />
+                            {step.date}
+                          </span>
+                          {step.location && (
+                            <span className="flex items-center gap-1.5">
+                              <MapPin size={14} />
+                              {step.location}
+                            </span>
+                          )}
+                        </div>
+                      </div>
                     </div>
-                )}
+                  ))}
+                </div>
+              </div>
+            )}
+
+            {/* Contact Support */}
+            <div className="p-6 bg-gray-50 border-t border-gray-100 text-center">
+              <p className="text-sm text-gray-500 mb-3">
+                Un problème avec votre livraison ?
+              </p>
+              <a
+                href="/contact"
+                className="inline-flex items-center gap-2 text-sm font-medium text-gray-900 hover:text-harp-brown transition-colors border-b border-gray-900 pb-0.5 hover:border-harp-brown"
+              >
+                Contacter le support
+              </a>
             </div>
-        </div>
-    );
+          </div>
+        )}
+
+        {/* Not Found */}
+        {result && !result.found && (
+          <div className="bg-white rounded-3xl shadow-lg border border-gray-100 p-12 text-center animate-fade-in">
+            <div className="w-20 h-20 rounded-full bg-gray-50 flex items-center justify-center mx-auto mb-6">
+              <Package size={32} className="text-gray-300" />
+            </div>
+            <h3 className="text-xl font-serif font-medium text-gray-900 mb-3">
+              Introuvable
+            </h3>
+            <p className="text-gray-500 font-light mb-8">
+              Nous ne trouvons pas ce numéro de suivi. Vérifiez qu'il est
+              correct.
+            </p>
+            <Link
+              href="/contact"
+              className="text-gray-900 font-medium border-b border-gray-900 pb-1 hover:text-harp-brown hover:border-harp-brown transition-colors"
+            >
+              Contacter le support
+            </Link>
+          </div>
+        )}
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/terms/page.tsx b/src/app/terms/page.tsx
index 63a86e5..215a81f 100644
--- a/src/app/terms/page.tsx
+++ b/src/app/terms/page.tsx
@@ -1,205 +1,225 @@
 "use client";
 
 import { useLanguage } from "@/components/LanguageProvider";
-import { FileText, ShoppingBag, Truck, RefreshCw, CreditCard, AlertCircle, Scale, HelpCircle } from "lucide-react";
+import {
+  FileText,
+  ShoppingBag,
+  Truck,
+  RefreshCw,
+  CreditCard,
+  AlertCircle,
+  Scale,
+  HelpCircle,
+} from "lucide-react";
 
 export default function TermsPage() {
-    const { language } = useLanguage();
-    const isAr = language === "ar";
+  const { language } = useLanguage();
+  const isAr = language === "ar";
 
-    const content = {
-        fr: {
-            title: "Conditions Générales de Vente",
-            lastUpdate: "Dernière mise à jour : Novembre 2025",
-            intro: "Les présentes Conditions Générales de Vente (CGV) définissent le cadre contractuel de nos relations. En choisissant Harp, vous acceptez ces conditions conçues pour protéger nos intérêts mutuels.",
-            sections: [
-                {
-                    icon: FileText,
-                    title: "1. Objet",
-                    content: `Ces CGV régissent exclusivement les ventes réalisées sur notre site par Harp, marque algérienne de prêt-à-porter.
+  const content = {
+    fr: {
+      title: "Conditions Générales de Vente",
+      lastUpdate: "Dernière mise à jour : Novembre 2025",
+      intro:
+        "Les présentes Conditions Générales de Vente (CGV) définissent le cadre contractuel de nos relations. En choisissant Harp, vous acceptez ces conditions conçues pour protéger nos intérêts mutuels.",
+      sections: [
+        {
+          icon: FileText,
+          title: "1. Objet",
+          content: `Ces CGV régissent exclusivement les ventes réalisées sur notre site par Harp, marque algérienne de prêt-à-porter.
                     
-Nous nous réservons le droit d'adapter ces conditions. Les CGV applicables sont celles en vigueur au jour de votre commande.`
-                },
-                {
-                    icon: ShoppingBag,
-                    title: "2. Produits",
-                    content: `Nos créations sont présentées avec la plus grande précision. 
+Nous nous réservons le droit d'adapter ces conditions. Les CGV applicables sont celles en vigueur au jour de votre commande.`,
+        },
+        {
+          icon: ShoppingBag,
+          title: "2. Produits",
+          content: `Nos créations sont présentées avec la plus grande précision. 
                     
 • **Photos** : Non contractuelles (variations minimes de couleur possibles)
 • **Disponibilité** : Dans la limite des stocks. Nous vous informons rapidement en cas de rupture.
-• **Tailles** : Consultez notre guide des tailles avant toute commande.`
-                },
-                {
-                    icon: CreditCard,
-                    title: "3. Prix et Paiement",
-                    content: `• **Prix** : Indiqués en Dinars Algériens (DZD) TTC. Hors frais de livraison.
+• **Tailles** : Consultez notre guide des tailles avant toute commande.`,
+        },
+        {
+          icon: CreditCard,
+          title: "3. Prix et Paiement",
+          content: `• **Prix** : Indiqués en Dinars Algériens (DZD) TTC. Hors frais de livraison.
 • **Paiement** : Exclusivement à la livraison (Cash on Delivery).
-• **Validation** : Votre commande est définitive après confirmation téléphonique de notre service client (sous 24-48h).`
-                },
-                {
-                    icon: Truck,
-                    title: "4. Livraison",
-                    content: `Nous livrons sur les 58 wilayas via nos partenaires de confiance (Yalidine, ZR Express).
+• **Validation** : Votre commande est définitive après confirmation téléphonique de notre service client (sous 24-48h).`,
+        },
+        {
+          icon: Truck,
+          title: "4. Livraison",
+          content: `Nous livrons sur les 58 wilayas via nos partenaires de confiance (Yalidine, ZR Express).
 
 • **Délais** : 1 à 7 jours ouvrés selon la wilaya.
 • **Tarifs** : Calculés selon la destination et le mode (domicile/stop-desk).
-• **Réception** : Vérifiez l'état du colis devant le livreur. Tout dommage doit être signalé immédiatement.`
-                },
-                {
-                    icon: RefreshCw,
-                    title: "5. Échanges",
-                    content: `Vous disposez de **2 jours** après réception pour demander un échange (taille, défaut, non-conformité).
+• **Réception** : Vérifiez l'état du colis devant le livreur. Tout dommage doit être signalé immédiatement.`,
+        },
+        {
+          icon: RefreshCw,
+          title: "5. Échanges",
+          content: `Vous disposez de **2 jours** après réception pour demander un échange (taille, défaut, non-conformité).
 
 • **Conditions** : Produit neuf, non porté, avec étiquettes et emballage d'origine.
 • **Frais** : Pris en charge par Harp en cas d'erreur de notre part.
 • **Procédure** : Contactez-nous sur WhatsApp avec votre n° de commande.
 
-*Note : Aucun remboursement n'est effectué, seuls les échanges sont acceptés.*`
-                },
-                {
-                    icon: AlertCircle,
-                    title: "6. Responsabilité",
-                    content: `Harp n'est pas responsable des retards de livraison imputables aux transporteurs ou des cas de force majeure.
+*Note : Aucun remboursement n'est effectué, seuls les échanges sont acceptés.*`,
+        },
+        {
+          icon: AlertCircle,
+          title: "6. Responsabilité",
+          content: `Harp n'est pas responsable des retards de livraison imputables aux transporteurs ou des cas de force majeure.
                     
-Nous déclinons toute responsabilité en cas d'utilisation ou d'entretien non conforme de nos produits.`
-                },
-                {
-                    icon: Scale,
-                    title: "7. Litiges",
-                    content: `Nous privilégions toujours une solution amiable. Notre service client est à votre écoute pour résoudre tout différend.
+Nous déclinons toute responsabilité en cas d'utilisation ou d'entretien non conforme de nos produits.`,
+        },
+        {
+          icon: Scale,
+          title: "7. Litiges",
+          content: `Nous privilégions toujours une solution amiable. Notre service client est à votre écoute pour résoudre tout différend.
                     
-À défaut, les tribunaux algériens sont seuls compétents.`
-                },
-                {
-                    icon: HelpCircle,
-                    title: "8. Contact",
-                    content: `Notre équipe est à votre disposition du dimanche au jeudi (9h-18h).
+À défaut, les tribunaux algériens sont seuls compétents.`,
+        },
+        {
+          icon: HelpCircle,
+          title: "8. Contact",
+          content: `Notre équipe est à votre disposition du dimanche au jeudi (9h-18h).
 
 • **WhatsApp** : Service Client
-• **Email** : contact@harpalgeria.com`
-                }
-            ]
-        },
-        ar: {
-            title: "الشروط العامة للبيع",
-            lastUpdate: "آخر تحديث: نوفمبر 2025",
-            intro: "تحدد هذه الشروط العامة للبيع الإطار التعاقدي لعلاقاتنا. باختيارك هارب، فإنك توافق على هذه الشروط المصممة لحماية مصالحنا المشتركة.",
-            sections: [
-                {
-                    icon: FileText,
-                    title: "1. الهدف",
-                    content: `تحكم هذه الشروط حصرياً المبيعات التي تتم على موقعنا من قبل هارب، العلامة التجارية الجزائرية للملابس الجاهزة.
+• **Email** : contact@harpalgeria.com`,
+        },
+      ],
+    },
+    ar: {
+      title: "الشروط العامة للبيع",
+      lastUpdate: "آخر تحديث: نوفمبر 2025",
+      intro:
+        "تحدد هذه الشروط العامة للبيع الإطار التعاقدي لعلاقاتنا. باختيارك هارب، فإنك توافق على هذه الشروط المصممة لحماية مصالحنا المشتركة.",
+      sections: [
+        {
+          icon: FileText,
+          title: "1. الهدف",
+          content: `تحكم هذه الشروط حصرياً المبيعات التي تتم على موقعنا من قبل هارب، العلامة التجارية الجزائرية للملابس الجاهزة.
                     
-نحتفظ بالحق في تعديل هذه الشروط. الشروط المطبقة هي تلك السارية يوم طلبك.`
-                },
-                {
-                    icon: ShoppingBag,
-                    title: "2. المنتجات",
-                    content: `يتم عرض إبداعاتنا بأكبر قدر من الدقة. 
+نحتفظ بالحق في تعديل هذه الشروط. الشروط المطبقة هي تلك السارية يوم طلبك.`,
+        },
+        {
+          icon: ShoppingBag,
+          title: "2. المنتجات",
+          content: `يتم عرض إبداعاتنا بأكبر قدر من الدقة. 
                     
 • **الصور**: غير تعاقدية (اختلافات طفيفة في اللون ممكنة)
 • **التوفر**: في حدود المخزون. نبلغكم بسرعة في حالة النفاد.
-• **المقاسات**: راجعي دليل المقاسات قبل أي طلب.`
-                },
-                {
-                    icon: CreditCard,
-                    title: "3. الأسعار والدفع",
-                    content: `• **الأسعار**: مبينة بالدينار الجزائري شاملة جميع الرسوم. غير شاملة تكاليف التوصيل.
+• **المقاسات**: راجعي دليل المقاسات قبل أي طلب.`,
+        },
+        {
+          icon: CreditCard,
+          title: "3. الأسعار والدفع",
+          content: `• **الأسعار**: مبينة بالدينار الجزائري شاملة جميع الرسوم. غير شاملة تكاليف التوصيل.
 • **الدفع**: حصرياً عند الاستلام.
-• **التأكيد**: يصبح طلبك نهائياً بعد التأكيد الهاتفي من خدمة العملاء (خلال 24-48 ساعة).`
-                },
-                {
-                    icon: Truck,
-                    title: "4. التوصيل",
-                    content: `نقوم بالتوصيل إلى 58 ولاية عبر شركائنا الموثوقين (Yalidine، ZR Express).
+• **التأكيد**: يصبح طلبك نهائياً بعد التأكيد الهاتفي من خدمة العملاء (خلال 24-48 ساعة).`,
+        },
+        {
+          icon: Truck,
+          title: "4. التوصيل",
+          content: `نقوم بالتوصيل إلى 58 ولاية عبر شركائنا الموثوقين (Yalidine، ZR Express).
 
 • **الآجال**: 1 إلى 7 أيام عمل حسب الولاية.
 • **الأسعار**: تحسب حسب الوجهة والطريقة (المنزل/المكتب).
-• **الاستلام**: تحققي من حالة الطرد أمام عامل التوصيل. يجب الإبلاغ عن أي ضرر فوراً.`
-                },
-                {
-                    icon: RefreshCw,
-                    title: "5. الاستبدال",
-                    content: `لديك **يومان** بعد الاستلام لطلب استبدال (مقاس، عيب، عدم مطابقة).
+• **الاستلام**: تحققي من حالة الطرد أمام عامل التوصيل. يجب الإبلاغ عن أي ضرر فوراً.`,
+        },
+        {
+          icon: RefreshCw,
+          title: "5. الاستبدال",
+          content: `لديك **يومان** بعد الاستلام لطلب استبدال (مقاس، عيب، عدم مطابقة).
 
 • **الشروط**: منتج جديد، غير ملبوس، مع العلامات والتغليف الأصلي.
 • **التكاليف**: تتحملها هارب في حالة الخطأ من جانبنا.
 • **الإجراء**: تواصل معنا عبر واتساب مع رقم الطلب.
 
-*ملاحظة: لا يتم استرداد الأموال، يقبل الاستبدال فقط.*`
-                },
-                {
-                    icon: AlertCircle,
-                    title: "6. المسؤولية",
-                    content: `هارب ليست مسؤولة عن تأخيرات التوصيل المنسوبة للناقلين أو حالات القوة القاهرة.
+*ملاحظة: لا يتم استرداد الأموال، يقبل الاستبدال فقط.*`,
+        },
+        {
+          icon: AlertCircle,
+          title: "6. المسؤولية",
+          content: `هارب ليست مسؤولة عن تأخيرات التوصيل المنسوبة للناقلين أو حالات القوة القاهرة.
                     
-نخلي مسؤوليتنا في حالة الاستخدام أو العناية غير المطابقة لمنتجاتنا.`
-                },
-                {
-                    icon: Scale,
-                    title: "7. النزاعات",
-                    content: `نفضل دائماً الحل الودي. خدمة العملاء لدينا تحت تصرفك لحل أي خلاف.
+نخلي مسؤوليتنا في حالة الاستخدام أو العناية غير المطابقة لمنتجاتنا.`,
+        },
+        {
+          icon: Scale,
+          title: "7. النزاعات",
+          content: `نفضل دائماً الحل الودي. خدمة العملاء لدينا تحت تصرفك لحل أي خلاف.
                     
-في حالة عدم التوصل لحل، تكون المحاكم الجزائرية هي المختصة.`
-                },
-                {
-                    icon: HelpCircle,
-                    title: "8. الاتصال",
-                    content: `فريقنا تحت تصرفكم من الأحد إلى الخميس (9سا-18سا).
+في حالة عدم التوصل لحل، تكون المحاكم الجزائرية هي المختصة.`,
+        },
+        {
+          icon: HelpCircle,
+          title: "8. الاتصال",
+          content: `فريقنا تحت تصرفكم من الأحد إلى الخميس (9سا-18سا).
 
 • **واتساب**: خدمة العملاء
-• **البريد الإلكتروني**: contact@harpalgeria.com`
-                }
-            ]
-        }
-    };
+• **البريد الإلكتروني**: contact@harpalgeria.com`,
+        },
+      ],
+    },
+  };
 
-    const t = isAr ? content.ar : content.fr;
+  const t = isAr ? content.ar : content.fr;
 
-    return (
-        <div className={`min-h-screen bg-white pt-32 pb-20 ${isAr ? 'rtl' : ''}`}>
-            <div className="container mx-auto px-4 max-w-3xl">
-                {/* Header */}
-                <div className="text-center mb-16">
-                    <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
-                        Légal
-                    </span>
-                    <h1 className="text-3xl md:text-5xl font-serif font-medium text-gray-900 mb-6">
-                        {t.title}
-                    </h1>
-                    <p className="text-gray-500 font-light">
-                        {t.lastUpdate}
-                    </p>
-                </div>
+  return (
+    <div className={`min-h-screen bg-white pt-32 pb-20 ${isAr ? "rtl" : ""}`}>
+      <div className="container mx-auto px-4 max-w-3xl">
+        {/* Header */}
+        <div className="text-center mb-16">
+          <span className="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4 block">
+            Légal
+          </span>
+          <h1 className="text-3xl md:text-5xl font-serif font-medium text-gray-900 mb-6">
+            {t.title}
+          </h1>
+          <p className="text-gray-500 font-light">{t.lastUpdate}</p>
+        </div>
 
-                {/* Intro */}
-                <div className="mb-16 text-center">
-                    <p className="text-lg text-gray-600 font-light leading-relaxed max-w-2xl mx-auto">
-                        {t.intro}
-                    </p>
-                </div>
+        {/* Intro */}
+        <div className="mb-16 text-center">
+          <p className="text-lg text-gray-600 font-light leading-relaxed max-w-2xl mx-auto">
+            {t.intro}
+          </p>
+        </div>
 
-                {/* Sections */}
-                <div className="space-y-12">
-                    {t.sections.map((section, index) => (
-                        <div key={index} className="group border-t border-gray-100 pt-12">
-                            <div className="flex flex-col md:flex-row gap-6 md:gap-12">
-                                <div className="md:w-1/3 flex items-start gap-4">
-                                    <section.icon size={20} className="text-gray-400 mt-1 group-hover:text-gray-900 transition-colors" />
-                                    <h2 className="text-xl font-serif font-medium text-gray-900">{section.title}</h2>
-                                </div>
-                                <div className="md:w-2/3">
-                                    <div className="text-gray-500 font-light leading-relaxed whitespace-pre-line">
-                                        {section.content.split('**').map((part, i) => 
-                                            i % 2 === 1 ? <strong key={i} className="text-gray-900 font-medium">{part}</strong> : part
-                                        )}
-                                    </div>
-                                </div>
-                            </div>
-                        </div>
-                    ))}
+        {/* Sections */}
+        <div className="space-y-12">
+          {t.sections.map((section, index) => (
+            <div key={index} className="group border-t border-gray-100 pt-12">
+              <div className="flex flex-col md:flex-row gap-6 md:gap-12">
+                <div className="md:w-1/3 flex items-start gap-4">
+                  <section.icon
+                    size={20}
+                    className="text-gray-400 mt-1 group-hover:text-gray-900 transition-colors"
+                  />
+                  <h2 className="text-xl font-serif font-medium text-gray-900">
+                    {section.title}
+                  </h2>
+                </div>
+                <div className="md:w-2/3">
+                  <div className="text-gray-500 font-light leading-relaxed whitespace-pre-line">
+                    {section.content.split("**").map((part, i) =>
+                      i % 2 === 1 ? (
+                        <strong key={i} className="text-gray-900 font-medium">
+                          {part}
+                        </strong>
+                      ) : (
+                        part
+                      ),
+                    )}
+                  </div>
                 </div>
+              </div>
             </div>
+          ))}
         </div>
-    );
+      </div>
+    </div>
+  );
 }
diff --git a/src/app/wishlist/page.tsx b/src/app/wishlist/page.tsx
index a37d7c2..c4e58a6 100644
--- a/src/app/wishlist/page.tsx
+++ b/src/app/wishlist/page.tsx
@@ -29,7 +29,7 @@ export default function WishlistPage() {
     // For now, simplified: if session, fetch from API. If not, maybe local?
     // The requirement says "Pré-wishlist via localStorage si non connecté → synchronisation au login"
     // We handled sync in a separate thought/route logic, here we display.
-    
+
     if (session) {
       fetchWishlist();
     } else {
@@ -58,7 +58,7 @@ export default function WishlistPage() {
       setLoading(false);
       return;
     }
-    
+
     // Need to fetch product details for these IDs.
     // Ideally we have an endpoint to get multiple products by ID.
     // Or we can reuse the wishlist endpoint if we pass IDs? No, better reuse /api/products if available or specific.
@@ -66,26 +66,26 @@ export default function WishlistPage() {
     // I'll mock fetch details by hitting product endpoint one by one or creating a bulk endpoint.
     // Actually, let's skip detailed local rendering for now or just mock it if complex.
     // Better: The user is likely to login.
-    
+
     // Let's just try to fetch details via a public product API if exists?
     // Currently we don't have a bulk product fetcher in the prompt context.
-    
+
     // Fallback: just show empty or loading.
     setLoading(false);
   };
 
   const removeFromWishlist = async (productId: string) => {
     if (session) {
-        await fetch("/api/v3/wishlist/toggle", {
-            method: "POST",
-            body: JSON.stringify({ productId })
-        });
-        fetchWishlist();
+      await fetch("/api/v3/wishlist/toggle", {
+        method: "POST",
+        body: JSON.stringify({ productId }),
+      });
+      fetchWishlist();
     } else {
-        const local = JSON.parse(localStorage.getItem("harp_wishlist") || "[]");
-        const newLocal = local.filter((id: string) => id !== productId);
-        localStorage.setItem("harp_wishlist", JSON.stringify(newLocal));
-        loadLocalWishlist();
+      const local = JSON.parse(localStorage.getItem("harp_wishlist") || "[]");
+      const newLocal = local.filter((id: string) => id !== productId);
+      localStorage.setItem("harp_wishlist", JSON.stringify(newLocal));
+      loadLocalWishlist();
     }
   };
 
@@ -97,7 +97,7 @@ export default function WishlistPage() {
       image: JSON.parse(product.images)[0],
       color: "Default", // TODO: Size/Color selection
       size: "M",
-      quantity: 1
+      quantity: 1,
     });
     setIsOpen(true);
   };
@@ -112,63 +112,76 @@ export default function WishlistPage() {
             <Heart className="fill-harp-brown text-harp-brown" />
             Ma Wishlist
           </h1>
-          <p className="text-gray-500">
-            {items.length} articles sauvegardés
-          </p>
+          <p className="text-gray-500">{items.length} articles sauvegardés</p>
         </div>
 
         {items.length === 0 ? (
           <div className="text-center py-12 bg-gray-50 rounded-2xl">
             <Heart size={48} className="mx-auto mb-4 text-gray-300" />
-            <h2 className="text-xl font-medium text-gray-900 mb-2">Votre wishlist est vide</h2>
-            <p className="text-gray-500 mb-6">Sauvegardez vos coups de cœur pour plus tard.</p>
-            <Link href="/shop" className="inline-flex items-center gap-2 bg-harp-brown text-white px-6 py-3 rounded-xl hover:bg-harp-caramel transition-colors">
+            <h2 className="text-xl font-medium text-gray-900 mb-2">
+              Votre wishlist est vide
+            </h2>
+            <p className="text-gray-500 mb-6">
+              Sauvegardez vos coups de cœur pour plus tard.
+            </p>
+            <Link
+              href="/shop"
+              className="inline-flex items-center gap-2 bg-harp-brown text-white px-6 py-3 rounded-xl hover:bg-harp-caramel transition-colors"
+            >
               Découvrir la collection <ArrowRight size={16} />
             </Link>
           </div>
         ) : (
           <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
             {items.map((item) => {
-                // Handle data structure difference between local (simulated) and DB
-                const product = item.product;
-                const images = typeof product.images === 'string' ? JSON.parse(product.images) : product.images;
-                const image = Array.isArray(images) ? images[0] : images;
-
-                return (
-                  <div key={product.id} className="group relative bg-white border border-gray-100 rounded-2xl overflow-hidden hover:shadow-lg transition-shadow">
-                    <div className="aspect-[3/4] relative bg-gray-100">
-                      <Image
-                        src={image || "/placeholder.jpg"}
-                        alt={product.nameFr}
-                        fill
-                        className="object-cover"
-                      />
-                      <button
-                        onClick={() => removeFromWishlist(product.id)}
-                        className="absolute top-3 right-3 p-2 bg-white/80 backdrop-blur-sm rounded-full text-gray-500 hover:text-red-500 transition-colors"
-                      >
-                        <Trash2 size={18} />
-                      </button>
-                    </div>
-                    
-                    <div className="p-4">
-                      <Link href={`/product/${product.slug}`}>
-                        <h3 className="font-serif text-lg text-harp-brown mb-1 truncate group-hover:text-harp-caramel transition-colors">
-                          {product.nameFr}
-                        </h3>
-                      </Link>
-                      <p className="text-gray-900 font-medium mb-4">{formatPrice(product.price)}</p>
-                      
-                      <button
-                        onClick={() => moveToCart(product)}
-                        className="w-full bg-gray-900 text-white py-3 rounded-xl flex items-center justify-center gap-2 hover:bg-gray-800 transition-colors"
-                      >
-                        <ShoppingBag size={18} />
-                        Ajouter au panier
-                      </button>
-                    </div>
+              // Handle data structure difference between local (simulated) and DB
+              const product = item.product;
+              const images =
+                typeof product.images === "string"
+                  ? JSON.parse(product.images)
+                  : product.images;
+              const image = Array.isArray(images) ? images[0] : images;
+
+              return (
+                <div
+                  key={product.id}
+                  className="group relative bg-white border border-gray-100 rounded-2xl overflow-hidden hover:shadow-lg transition-shadow"
+                >
+                  <div className="aspect-[3/4] relative bg-gray-100">
+                    <Image
+                      src={image || "/placeholder.jpg"}
+                      alt={product.nameFr}
+                      fill
+                      className="object-cover"
+                    />
+                    <button
+                      onClick={() => removeFromWishlist(product.id)}
+                      className="absolute top-3 right-3 p-2 bg-white/80 backdrop-blur-sm rounded-full text-gray-500 hover:text-red-500 transition-colors"
+                    >
+                      <Trash2 size={18} />
+                    </button>
+                  </div>
+
+                  <div className="p-4">
+                    <Link href={`/product/${product.slug}`}>
+                      <h3 className="font-serif text-lg text-harp-brown mb-1 truncate group-hover:text-harp-caramel transition-colors">
+                        {product.nameFr}
+                      </h3>
+                    </Link>
+                    <p className="text-gray-900 font-medium mb-4">
+                      {formatPrice(product.price)}
+                    </p>
+
+                    <button
+                      onClick={() => moveToCart(product)}
+                      className="w-full bg-gray-900 text-white py-3 rounded-xl flex items-center justify-center gap-2 hover:bg-gray-800 transition-colors"
+                    >
+                      <ShoppingBag size={18} />
+                      Ajouter au panier
+                    </button>
                   </div>
-                );
+                </div>
+              );
             })}
           </div>
         )}
diff --git a/src/components/Analytics.tsx b/src/components/Analytics.tsx
index e61fdde..0cbe49d 100644
--- a/src/components/Analytics.tsx
+++ b/src/components/Analytics.tsx
@@ -8,16 +8,16 @@ const FB_PIXEL_ID = process.env.NEXT_PUBLIC_FB_PIXEL_ID || "";
 
 // Google Analytics Component
 export function GoogleAnalytics() {
-    if (!GA_MEASUREMENT_ID) return null;
+  if (!GA_MEASUREMENT_ID) return null;
 
-    return (
-        <>
-            <Script
-                src={`https://www.googletagmanager.com/gtag/js?id=${GA_MEASUREMENT_ID}`}
-                strategy="afterInteractive"
-            />
-            <Script id="google-analytics" strategy="afterInteractive">
-                {`
+  return (
+    <>
+      <Script
+        src={`https://www.googletagmanager.com/gtag/js?id=${GA_MEASUREMENT_ID}`}
+        strategy="afterInteractive"
+      />
+      <Script id="google-analytics" strategy="afterInteractive">
+        {`
                     window.dataLayer = window.dataLayer || [];
                     function gtag(){dataLayer.push(arguments);}
                     gtag('js', new Date());
@@ -25,19 +25,19 @@ export function GoogleAnalytics() {
                         page_path: window.location.pathname,
                     });
                 `}
-            </Script>
-        </>
-    );
+      </Script>
+    </>
+  );
 }
 
 // Facebook Pixel Component
 export function FacebookPixel() {
-    if (!FB_PIXEL_ID) return null;
+  if (!FB_PIXEL_ID) return null;
 
-    return (
-        <>
-            <Script id="facebook-pixel" strategy="afterInteractive">
-                {`
+  return (
+    <>
+      <Script id="facebook-pixel" strategy="afterInteractive">
+        {`
                     !function(f,b,e,v,n,t,s)
                     {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
                     n.callMethod.apply(n,arguments):n.queue.push(arguments)};
@@ -49,117 +49,122 @@ export function FacebookPixel() {
                     fbq('init', '${FB_PIXEL_ID}');
                     fbq('track', 'PageView');
                 `}
-            </Script>
-            <noscript>
-                <img 
-                    height="1" 
-                    width="1" 
-                    style={{ display: 'none' }}
-                    src={`https://www.facebook.com/tr?id=${FB_PIXEL_ID}&ev=PageView&noscript=1`}
-                    alt=""
-                />
-            </noscript>
-        </>
-    );
+      </Script>
+      <noscript>
+        <img
+          height="1"
+          width="1"
+          style={{ display: "none" }}
+          src={`https://www.facebook.com/tr?id=${FB_PIXEL_ID}&ev=PageView&noscript=1`}
+          alt=""
+        />
+      </noscript>
+    </>
+  );
 }
 
 // Combined Analytics Component
 export function Analytics() {
-    return (
-        <>
-            <GoogleAnalytics />
-            <FacebookPixel />
-        </>
-    );
+  return (
+    <>
+      <GoogleAnalytics />
+      <FacebookPixel />
+    </>
+  );
 }
 
 // Analytics Event Tracking Functions
 export const trackEvent = {
-    // Google Analytics Events
-    ga: {
-        pageView: (url: string) => {
-            if (typeof window !== 'undefined' && (window as any).gtag) {
-                (window as any).gtag('config', GA_MEASUREMENT_ID, { page_path: url });
-            }
-        },
-        event: (action: string, category: string, label?: string, value?: number) => {
-            if (typeof window !== 'undefined' && (window as any).gtag) {
-                (window as any).gtag('event', action, {
-                    event_category: category,
-                    event_label: label,
-                    value: value,
-                });
-            }
-        },
-        purchase: (orderId: string, total: number, items: any[]) => {
-            if (typeof window !== 'undefined' && (window as any).gtag) {
-                (window as any).gtag('event', 'purchase', {
-                    transaction_id: orderId,
-                    value: total,
-                    currency: 'DZD',
-                    items: items,
-                });
-            }
-        },
-        addToCart: (productId: string, name: string, price: number) => {
-            if (typeof window !== 'undefined' && (window as any).gtag) {
-                (window as any).gtag('event', 'add_to_cart', {
-                    currency: 'DZD',
-                    value: price,
-                    items: [{ item_id: productId, item_name: name, price: price }],
-                });
-            }
-        },
+  // Google Analytics Events
+  ga: {
+    pageView: (url: string) => {
+      if (typeof window !== "undefined" && (window as any).gtag) {
+        (window as any).gtag("config", GA_MEASUREMENT_ID, { page_path: url });
+      }
     },
-    
-    // Facebook Pixel Events
-    fb: {
-        pageView: () => {
-            if (typeof window !== 'undefined' && (window as any).fbq) {
-                (window as any).fbq('track', 'PageView');
-            }
-        },
-        viewContent: (productId: string, name: string, price: number) => {
-            if (typeof window !== 'undefined' && (window as any).fbq) {
-                (window as any).fbq('track', 'ViewContent', {
-                    content_ids: [productId],
-                    content_name: name,
-                    content_type: 'product',
-                    value: price,
-                    currency: 'DZD',
-                });
-            }
-        },
-        addToCart: (productId: string, name: string, price: number) => {
-            if (typeof window !== 'undefined' && (window as any).fbq) {
-                (window as any).fbq('track', 'AddToCart', {
-                    content_ids: [productId],
-                    content_name: name,
-                    content_type: 'product',
-                    value: price,
-                    currency: 'DZD',
-                });
-            }
-        },
-        initiateCheckout: (total: number, itemCount: number) => {
-            if (typeof window !== 'undefined' && (window as any).fbq) {
-                (window as any).fbq('track', 'InitiateCheckout', {
-                    value: total,
-                    currency: 'DZD',
-                    num_items: itemCount,
-                });
-            }
-        },
-        purchase: (orderId: string, total: number, items: any[]) => {
-            if (typeof window !== 'undefined' && (window as any).fbq) {
-                (window as any).fbq('track', 'Purchase', {
-                    value: total,
-                    currency: 'DZD',
-                    content_ids: items.map(i => i.productId),
-                    content_type: 'product',
-                    num_items: items.length,
-                });
-            }
-        },
+    event: (
+      action: string,
+      category: string,
+      label?: string,
+      value?: number,
+    ) => {
+      if (typeof window !== "undefined" && (window as any).gtag) {
+        (window as any).gtag("event", action, {
+          event_category: category,
+          event_label: label,
+          value: value,
+        });
+      }
     },
+    purchase: (orderId: string, total: number, items: any[]) => {
+      if (typeof window !== "undefined" && (window as any).gtag) {
+        (window as any).gtag("event", "purchase", {
+          transaction_id: orderId,
+          value: total,
+          currency: "DZD",
+          items: items,
+        });
+      }
+    },
+    addToCart: (productId: string, name: string, price: number) => {
+      if (typeof window !== "undefined" && (window as any).gtag) {
+        (window as any).gtag("event", "add_to_cart", {
+          currency: "DZD",
+          value: price,
+          items: [{ item_id: productId, item_name: name, price: price }],
+        });
+      }
+    },
+  },
+
+  // Facebook Pixel Events
+  fb: {
+    pageView: () => {
+      if (typeof window !== "undefined" && (window as any).fbq) {
+        (window as any).fbq("track", "PageView");
+      }
+    },
+    viewContent: (productId: string, name: string, price: number) => {
+      if (typeof window !== "undefined" && (window as any).fbq) {
+        (window as any).fbq("track", "ViewContent", {
+          content_ids: [productId],
+          content_name: name,
+          content_type: "product",
+          value: price,
+          currency: "DZD",
+        });
+      }
+    },
+    addToCart: (productId: string, name: string, price: number) => {
+      if (typeof window !== "undefined" && (window as any).fbq) {
+        (window as any).fbq("track", "AddToCart", {
+          content_ids: [productId],
+          content_name: name,
+          content_type: "product",
+          value: price,
+          currency: "DZD",
+        });
+      }
+    },
+    initiateCheckout: (total: number, itemCount: number) => {
+      if (typeof window !== "undefined" && (window as any).fbq) {
+        (window as any).fbq("track", "InitiateCheckout", {
+          value: total,
+          currency: "DZD",
+          num_items: itemCount,
+        });
+      }
+    },
+    purchase: (orderId: string, total: number, items: any[]) => {
+      if (typeof window !== "undefined" && (window as any).fbq) {
+        (window as any).fbq("track", "Purchase", {
+          value: total,
+          currency: "DZD",
+          content_ids: items.map((i) => i.productId),
+          content_type: "product",
+          num_items: items.length,
+        });
+      }
+    },
+  },
 };
diff --git a/src/components/BackInStockAlert.tsx b/src/components/BackInStockAlert.tsx
index a3ba06b..9f45ed5 100644
--- a/src/components/BackInStockAlert.tsx
+++ b/src/components/BackInStockAlert.tsx
@@ -5,179 +5,197 @@ import { Bell, Check, Loader2, Mail, Phone } from "lucide-react";
 import { cn } from "@/lib/utils";
 
 interface BackInStockAlertProps {
-    productId: string;
-    productName: string;
-    size?: string;
-    color?: string;
-    className?: string;
+  productId: string;
+  productName: string;
+  size?: string;
+  color?: string;
+  className?: string;
 }
 
-export function BackInStockAlert({ productId, productName, size, color, className }: BackInStockAlertProps) {
-    const [isOpen, setIsOpen] = useState(false);
-    const [email, setEmail] = useState("");
-    const [phone, setPhone] = useState("");
-    const [method, setMethod] = useState<"email" | "phone">("phone");
-    const [loading, setLoading] = useState(false);
-    const [success, setSuccess] = useState(false);
-    const [error, setError] = useState("");
+export function BackInStockAlert({
+  productId,
+  productName,
+  size,
+  color,
+  className,
+}: BackInStockAlertProps) {
+  const [isOpen, setIsOpen] = useState(false);
+  const [email, setEmail] = useState("");
+  const [phone, setPhone] = useState("");
+  const [method, setMethod] = useState<"email" | "phone">("phone");
+  const [loading, setLoading] = useState(false);
+  const [success, setSuccess] = useState(false);
+  const [error, setError] = useState("");
 
-    const handleSubmit = async (e: React.FormEvent) => {
-        e.preventDefault();
-        setLoading(true);
-        setError("");
+  const handleSubmit = async (e: React.FormEvent) => {
+    e.preventDefault();
+    setLoading(true);
+    setError("");
 
-        try {
-            const res = await fetch("/api/stock-alerts", {
-                method: "POST",
-                headers: { "Content-Type": "application/json" },
-                body: JSON.stringify({
-                    productId,
-                    email: method === "email" ? email : undefined,
-                    phone: method === "phone" ? phone : undefined,
-                    size,
-                    color,
-                }),
-            });
+    try {
+      const res = await fetch("/api/stock-alerts", {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify({
+          productId,
+          email: method === "email" ? email : undefined,
+          phone: method === "phone" ? phone : undefined,
+          size,
+          color,
+        }),
+      });
 
-            const data = await res.json();
+      const data = await res.json();
 
-            if (res.ok) {
-                setSuccess(true);
-            } else {
-                setError(data.error || "Une erreur est survenue");
-            }
-        } catch {
-            setError("Erreur de connexion");
-        } finally {
-            setLoading(false);
-        }
-    };
-
-    if (success) {
-        return (
-            <div className={cn("bg-green-50 border border-green-200 rounded-xl p-4", className)}>
-                <div className="flex items-center gap-3 text-green-700">
-                    <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
-                        <Check size={20} />
-                    </div>
-                    <div>
-                        <p className="font-medium">Alerte créée !</p>
-                        <p className="text-sm text-green-600">
-                            Vous serez notifié(e) dès que ce produit sera disponible.
-                        </p>
-                    </div>
-                </div>
-            </div>
-        );
+      if (res.ok) {
+        setSuccess(true);
+      } else {
+        setError(data.error || "Une erreur est survenue");
+      }
+    } catch {
+      setError("Erreur de connexion");
+    } finally {
+      setLoading(false);
     }
+  };
 
+  if (success) {
     return (
-        <div className={cn("bg-amber-50 border border-amber-200 rounded-xl p-4", className)}>
-            {!isOpen ? (
-                <div className="flex items-center justify-between">
-                    <div className="flex items-center gap-3">
-                        <div className="w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center">
-                            <Bell size={18} className="text-amber-600" />
-                        </div>
-                        <div>
-                            <p className="font-medium text-amber-800">Produit épuisé</p>
-                            <p className="text-sm text-amber-600">Ce produit est temporairement indisponible</p>
-                        </div>
-                    </div>
-                    <button
-                        onClick={() => setIsOpen(true)}
-                        className="px-4 py-2 bg-amber-600 text-white rounded-lg text-sm font-medium hover:bg-amber-700 transition-colors"
-                    >
-                        M'alerter
-                    </button>
-                </div>
-            ) : (
-                <form onSubmit={handleSubmit} className="space-y-4">
-                    <div className="flex items-center gap-3 mb-4">
-                        <Bell size={20} className="text-amber-600" />
-                        <p className="font-medium text-amber-800">Recevoir une alerte pour "{productName}"</p>
-                    </div>
+      <div
+        className={cn(
+          "bg-green-50 border border-green-200 rounded-xl p-4",
+          className,
+        )}
+      >
+        <div className="flex items-center gap-3 text-green-700">
+          <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
+            <Check size={20} />
+          </div>
+          <div>
+            <p className="font-medium">Alerte créée !</p>
+            <p className="text-sm text-green-600">
+              Vous serez notifié(e) dès que ce produit sera disponible.
+            </p>
+          </div>
+        </div>
+      </div>
+    );
+  }
+
+  return (
+    <div
+      className={cn(
+        "bg-amber-50 border border-amber-200 rounded-xl p-4",
+        className,
+      )}
+    >
+      {!isOpen ? (
+        <div className="flex items-center justify-between">
+          <div className="flex items-center gap-3">
+            <div className="w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center">
+              <Bell size={18} className="text-amber-600" />
+            </div>
+            <div>
+              <p className="font-medium text-amber-800">Produit épuisé</p>
+              <p className="text-sm text-amber-600">
+                Ce produit est temporairement indisponible
+              </p>
+            </div>
+          </div>
+          <button
+            onClick={() => setIsOpen(true)}
+            className="px-4 py-2 bg-amber-600 text-white rounded-lg text-sm font-medium hover:bg-amber-700 transition-colors"
+          >
+            M'alerter
+          </button>
+        </div>
+      ) : (
+        <form onSubmit={handleSubmit} className="space-y-4">
+          <div className="flex items-center gap-3 mb-4">
+            <Bell size={20} className="text-amber-600" />
+            <p className="font-medium text-amber-800">
+              Recevoir une alerte pour "{productName}"
+            </p>
+          </div>
 
-                    {/* Method selector */}
-                    <div className="flex gap-2">
-                        <button
-                            type="button"
-                            onClick={() => setMethod("phone")}
-                            className={cn(
-                                "flex-1 py-2 px-3 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",
-                                method === "phone"
-                                    ? "bg-amber-600 text-white"
-                                    : "bg-white border border-amber-200 text-amber-700 hover:bg-amber-50"
-                            )}
-                        >
-                            <Phone size={16} />
-                            WhatsApp
-                        </button>
-                        <button
-                            type="button"
-                            onClick={() => setMethod("email")}
-                            className={cn(
-                                "flex-1 py-2 px-3 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",
-                                method === "email"
-                                    ? "bg-amber-600 text-white"
-                                    : "bg-white border border-amber-200 text-amber-700 hover:bg-amber-50"
-                            )}
-                        >
-                            <Mail size={16} />
-                            Email
-                        </button>
-                    </div>
+          {/* Method selector */}
+          <div className="flex gap-2">
+            <button
+              type="button"
+              onClick={() => setMethod("phone")}
+              className={cn(
+                "flex-1 py-2 px-3 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",
+                method === "phone"
+                  ? "bg-amber-600 text-white"
+                  : "bg-white border border-amber-200 text-amber-700 hover:bg-amber-50",
+              )}
+            >
+              <Phone size={16} />
+              WhatsApp
+            </button>
+            <button
+              type="button"
+              onClick={() => setMethod("email")}
+              className={cn(
+                "flex-1 py-2 px-3 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",
+                method === "email"
+                  ? "bg-amber-600 text-white"
+                  : "bg-white border border-amber-200 text-amber-700 hover:bg-amber-50",
+              )}
+            >
+              <Mail size={16} />
+              Email
+            </button>
+          </div>
 
-                    {/* Input */}
-                    {method === "phone" ? (
-                        <input
-                            type="tel"
-                            value={phone}
-                            onChange={(e) => setPhone(e.target.value)}
-                            placeholder="0550 12 34 56"
-                            className="w-full px-4 py-3 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500"
-                            required
-                        />
-                    ) : (
-                        <input
-                            type="email"
-                            value={email}
-                            onChange={(e) => setEmail(e.target.value)}
-                            placeholder="votre@email.com"
-                            className="w-full px-4 py-3 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500"
-                            required
-                        />
-                    )}
+          {/* Input */}
+          {method === "phone" ? (
+            <input
+              type="tel"
+              value={phone}
+              onChange={(e) => setPhone(e.target.value)}
+              placeholder="0550 12 34 56"
+              className="w-full px-4 py-3 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500"
+              required
+            />
+          ) : (
+            <input
+              type="email"
+              value={email}
+              onChange={(e) => setEmail(e.target.value)}
+              placeholder="votre@email.com"
+              className="w-full px-4 py-3 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500"
+              required
+            />
+          )}
 
-                    {error && (
-                        <p className="text-red-600 text-sm">{error}</p>
-                    )}
+          {error && <p className="text-red-600 text-sm">{error}</p>}
 
-                    <div className="flex gap-2">
-                        <button
-                            type="button"
-                            onClick={() => setIsOpen(false)}
-                            className="flex-1 py-2 px-4 border border-amber-200 rounded-lg text-amber-700 hover:bg-amber-50 transition-colors"
-                        >
-                            Annuler
-                        </button>
-                        <button
-                            type="submit"
-                            disabled={loading}
-                            className="flex-1 py-2 px-4 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2"
-                        >
-                            {loading ? (
-                                <Loader2 size={18} className="animate-spin" />
-                            ) : (
-                                <>
-                                    <Bell size={18} />
-                                    Créer l'alerte
-                                </>
-                            )}
-                        </button>
-                    </div>
-                </form>
-            )}
-        </div>
-    );
+          <div className="flex gap-2">
+            <button
+              type="button"
+              onClick={() => setIsOpen(false)}
+              className="flex-1 py-2 px-4 border border-amber-200 rounded-lg text-amber-700 hover:bg-amber-50 transition-colors"
+            >
+              Annuler
+            </button>
+            <button
+              type="submit"
+              disabled={loading}
+              className="flex-1 py-2 px-4 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2"
+            >
+              {loading ? (
+                <Loader2 size={18} className="animate-spin" />
+              ) : (
+                <>
+                  <Bell size={18} />
+                  Créer l'alerte
+                </>
+              )}
+            </button>
+          </div>
+        </form>
+      )}
+    </div>
+  );
 }
diff --git a/src/components/CartDrawer.tsx b/src/components/CartDrawer.tsx
index 392ae26..e360bba 100644
--- a/src/components/CartDrawer.tsx
+++ b/src/components/CartDrawer.tsx
@@ -1,7 +1,16 @@
 "use client";
 
 import { useState, useEffect } from "react";
-import { X, Minus, Plus, Trash2, Truck, Gift, Sparkles, ChevronRight } from "lucide-react";
+import {
+  X,
+  Minus,
+  Plus,
+  Trash2,
+  Truck,
+  Gift,
+  Sparkles,
+  ChevronRight,
+} from "lucide-react";
 import { useCart } from "./CartProvider";
 import { useLanguage } from "./LanguageProvider";
 import { cn, formatPrice } from "@/lib/utils";
@@ -13,246 +22,295 @@ const FREE_SHIPPING_THRESHOLD = 15000; // DZD
 
 // Suggestions de produits (à remplacer par API)
 interface SuggestedProduct {
-    id: string;
-    name: string;
-    price: number;
-    image: string;
+  id: string;
+  name: string;
+  price: number;
+  image: string;
 }
 
 export function CartDrawer() {
-    const { isOpen, setIsOpen, items, removeItem, updateQuantity, total, addItem } = useCart();
-    const { t, dir } = useLanguage();
-    const [suggestions, setSuggestions] = useState<SuggestedProduct[]>([]);
+  const {
+    isOpen,
+    setIsOpen,
+    items,
+    removeItem,
+    updateQuantity,
+    total,
+    addItem,
+  } = useCart();
+  const { t, dir } = useLanguage();
+  const [suggestions, setSuggestions] = useState<SuggestedProduct[]>([]);
 
-    // Calculs livraison gratuite
-    const remaining = Math.max(0, FREE_SHIPPING_THRESHOLD - total);
-    const progress = Math.min(100, (total / FREE_SHIPPING_THRESHOLD) * 100);
-    const hasFreeShipping = total >= FREE_SHIPPING_THRESHOLD;
+  // Calculs livraison gratuite
+  const remaining = Math.max(0, FREE_SHIPPING_THRESHOLD - total);
+  const progress = Math.min(100, (total / FREE_SHIPPING_THRESHOLD) * 100);
+  const hasFreeShipping = total >= FREE_SHIPPING_THRESHOLD;
 
-    // Charger suggestions
-    useEffect(() => {
-        if (isOpen && items.length > 0) {
-            fetch('/api/products?limit=4')
-                .then(res => res.json())
-                .then(data => {
-                    // Filtrer les produits déjà dans le panier
-                    const cartProductIds = items.map(i => i.productId);
-                    const filtered = data
-                        .filter((p: any) => !cartProductIds.includes(p.id))
-                        .slice(0, 3)
-                        .map((p: any) => ({
-                            id: p.id,
-                            name: p.nameFr,
-                            price: p.price,
-                            image: JSON.parse(p.images)[0]
-                        }));
-                    setSuggestions(filtered);
-                })
-                .catch(() => setSuggestions([]));
-        }
-    }, [isOpen, items]);
+  // Charger suggestions
+  useEffect(() => {
+    if (isOpen && items.length > 0) {
+      fetch("/api/products?limit=4")
+        .then((res) => res.json())
+        .then((data) => {
+          // Filtrer les produits déjà dans le panier
+          const cartProductIds = items.map((i) => i.productId);
+          const filtered = data
+            .filter((p: any) => !cartProductIds.includes(p.id))
+            .slice(0, 3)
+            .map((p: any) => ({
+              id: p.id,
+              name: p.nameFr,
+              price: p.price,
+              image: JSON.parse(p.images)[0],
+            }));
+          setSuggestions(filtered);
+        })
+        .catch(() => setSuggestions([]));
+    }
+  }, [isOpen, items]);
 
-    if (!isOpen) return null;
+  if (!isOpen) return null;
 
-    return (
-        <div className="fixed inset-0 z-[100] flex justify-end">
-            {/* Backdrop */}
-            <div
-                className="absolute inset-0 bg-black/20 backdrop-blur-sm"
-                onClick={() => setIsOpen(false)}
-            />
+  return (
+    <div className="fixed inset-0 z-[100] flex justify-end">
+      {/* Backdrop */}
+      <div
+        className="absolute inset-0 bg-black/20 backdrop-blur-sm"
+        onClick={() => setIsOpen(false)}
+      />
+
+      {/* Drawer */}
+      <div
+        className={cn(
+          "relative w-full max-w-md bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",
+          dir === "rtl" ? "slide-in-from-left" : "",
+        )}
+      >
+        {/* Header */}
+        <div className="p-4 border-b border-harp-beige flex items-center justify-between">
+          <div>
+            <h2 className="text-xl font-serif font-bold text-harp-brown">
+              {t("cart.title")}
+            </h2>
+            <p className="text-xs text-gray-500">
+              {items.length} {t("cart.items")}
+            </p>
+          </div>
+          <button
+            onClick={() => setIsOpen(false)}
+            className="p-2 hover:bg-gray-100 rounded-full"
+          >
+            <X size={24} />
+          </button>
+        </div>
 
-            {/* Drawer */}
-            <div className={cn(
-                "relative w-full max-w-md bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",
-                dir === "rtl" ? "slide-in-from-left" : ""
-            )}>
-                {/* Header */}
-                <div className="p-4 border-b border-harp-beige flex items-center justify-between">
+        {/* Free Shipping Progress Bar */}
+        {items.length > 0 && (
+          <div className="px-4 py-3 bg-gradient-to-r from-harp-cream to-harp-beige border-b border-harp-beige">
+            {hasFreeShipping ? (
+              <div className="flex items-center gap-2 text-harp-brown">
+                <Gift size={18} className="text-harp-brown" />
+                <span className="text-sm font-medium">
+                  {t("cart.freeShipping.congrats")}
+                </span>
+              </div>
+            ) : (
+              <>
+                <div className="flex items-center justify-between text-sm mb-2">
+                  <span className="text-gray-600 flex items-center gap-1">
+                    <Truck size={14} />
+                    {t("cart.freeShipping.title")}
+                  </span>
+                  <span className="font-medium text-harp-brown">
+                    {t("cart.freeShipping.remaining")} {formatPrice(remaining)}
+                  </span>
+                </div>
+                <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
+                  <div
+                    className="h-full bg-gradient-to-r from-sky-400 to-harp-brown rounded-full transition-all duration-500"
+                    style={{ width: `${progress}%` }}
+                  />
+                </div>
+              </>
+            )}
+          </div>
+        )}
+
+        {/* Items */}
+        <div className="flex-1 overflow-y-auto p-4 space-y-4">
+          {items.length === 0 ? (
+            <div className="h-full flex flex-col items-center justify-center text-center">
+              <div className="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4">
+                <Truck size={32} className="text-gray-400" />
+              </div>
+              <p className="text-gray-500 mb-4">{t("cart.empty")}</p>
+              <Link
+                href="/shop"
+                onClick={() => setIsOpen(false)}
+                className="text-harp-brown font-medium hover:underline flex items-center gap-1"
+              >
+                {t("cart.discoverCollection")} <ChevronRight size={16} />
+              </Link>
+            </div>
+          ) : (
+            <>
+              {items.map((item) => (
+                <div
+                  key={item.id}
+                  className="flex gap-3 bg-gray-50 rounded-xl p-3"
+                >
+                  <div className="relative w-20 h-24 bg-gray-100 rounded-lg overflow-hidden shrink-0">
+                    <Image
+                      src={item.image}
+                      alt={item.name}
+                      fill
+                      className="object-cover"
+                    />
+                  </div>
+                  <div className="flex-1 flex flex-col justify-between min-w-0">
                     <div>
-                        <h2 className="text-xl font-serif font-bold text-harp-brown">{t("cart.title")}</h2>
-                        <p className="text-xs text-gray-500">{items.length} {t("cart.items")}</p>
+                      <h3 className="font-medium text-gray-900 text-sm truncate">
+                        {item.name}
+                      </h3>
+                      <p className="text-xs text-gray-500">
+                        {item.size} • {item.color}
+                      </p>
+                      <p className="text-sm font-bold text-harp-brown mt-1">
+                        {formatPrice(item.price)}
+                      </p>
                     </div>
-                    <button onClick={() => setIsOpen(false)} className="p-2 hover:bg-gray-100 rounded-full">
-                        <X size={24} />
-                    </button>
-                </div>
 
-                {/* Free Shipping Progress Bar */}
-                {items.length > 0 && (
-                    <div className="px-4 py-3 bg-gradient-to-r from-harp-cream to-harp-beige border-b border-harp-beige">
-                        {hasFreeShipping ? (
-                            <div className="flex items-center gap-2 text-harp-brown">
-                                <Gift size={18} className="text-harp-brown" />
-                                <span className="text-sm font-medium">{t("cart.freeShipping.congrats")}</span>
-                            </div>
-                        ) : (
-                            <>
-                                <div className="flex items-center justify-between text-sm mb-2">
-                                    <span className="text-gray-600 flex items-center gap-1">
-                                        <Truck size={14} />
-                                        {t("cart.freeShipping.title")}
-                                    </span>
-                                    <span className="font-medium text-harp-brown">
-                                        {t("cart.freeShipping.remaining")} {formatPrice(remaining)}
-                                    </span>
-                                </div>
-                                <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
-                                    <div 
-                                        className="h-full bg-gradient-to-r from-sky-400 to-harp-brown rounded-full transition-all duration-500"
-                                        style={{ width: `${progress}%` }}
-                                    />
-                                </div>
-                            </>
-                        )}
+                    <div className="flex items-center justify-between">
+                      <div className="flex items-center gap-1 bg-white border border-gray-200 rounded-lg">
+                        <button
+                          onClick={() =>
+                            updateQuantity(item.id, item.quantity - 1)
+                          }
+                          className="p-1.5 hover:text-harp-caramel"
+                        >
+                          <Minus size={12} />
+                        </button>
+                        <span className="text-sm w-6 text-center font-medium">
+                          {item.quantity}
+                        </span>
+                        <button
+                          onClick={() =>
+                            updateQuantity(item.id, item.quantity + 1)
+                          }
+                          className="p-1.5 hover:text-harp-caramel"
+                        >
+                          <Plus size={12} />
+                        </button>
+                      </div>
+                      <button
+                        onClick={() => removeItem(item.id)}
+                        className="p-1.5 text-gray-400 hover:text-red-500 transition-colors"
+                      >
+                        <Trash2 size={16} />
+                      </button>
                     </div>
-                )}
+                  </div>
+                </div>
+              ))}
 
-                {/* Items */}
-                <div className="flex-1 overflow-y-auto p-4 space-y-4">
-                    {items.length === 0 ? (
-                        <div className="h-full flex flex-col items-center justify-center text-center">
-                            <div className="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4">
-                                <Truck size={32} className="text-gray-400" />
-                            </div>
-                            <p className="text-gray-500 mb-4">{t("cart.empty")}</p>
-                            <Link 
-                                href="/shop" 
-                                onClick={() => setIsOpen(false)}
-                                className="text-harp-brown font-medium hover:underline flex items-center gap-1"
-                            >
-                                {t("cart.discoverCollection")} <ChevronRight size={16} />
-                            </Link>
+              {/* Cross-sell Section */}
+              {suggestions.length > 0 && (
+                <div className="mt-6 pt-4 border-t border-gray-100">
+                  <h4 className="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2">
+                    <Sparkles size={14} className="text-amber-500" />
+                    {t("cart.completeLook")}
+                  </h4>
+                  <div className="space-y-2">
+                    {suggestions.map((product) => (
+                      <Link
+                        key={product.id}
+                        href={`/product/${product.id}`}
+                        onClick={() => setIsOpen(false)}
+                        className="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors group"
+                      >
+                        <div className="relative w-12 h-14 bg-gray-100 rounded-md overflow-hidden shrink-0">
+                          <Image
+                            src={product.image}
+                            alt={product.name}
+                            fill
+                            className="object-cover"
+                          />
                         </div>
-                    ) : (
-                        <>
-                            {items.map((item) => (
-                                <div key={item.id} className="flex gap-3 bg-gray-50 rounded-xl p-3">
-                                    <div className="relative w-20 h-24 bg-gray-100 rounded-lg overflow-hidden shrink-0">
-                                        <Image
-                                            src={item.image}
-                                            alt={item.name}
-                                            fill
-                                            className="object-cover"
-                                        />
-                                    </div>
-                                    <div className="flex-1 flex flex-col justify-between min-w-0">
-                                        <div>
-                                            <h3 className="font-medium text-gray-900 text-sm truncate">{item.name}</h3>
-                                            <p className="text-xs text-gray-500">{item.size} • {item.color}</p>
-                                            <p className="text-sm font-bold text-harp-brown mt-1">{formatPrice(item.price)}</p>
-                                        </div>
-
-                                        <div className="flex items-center justify-between">
-                                            <div className="flex items-center gap-1 bg-white border border-gray-200 rounded-lg">
-                                                <button
-                                                    onClick={() => updateQuantity(item.id, item.quantity - 1)}
-                                                    className="p-1.5 hover:text-harp-caramel"
-                                                >
-                                                    <Minus size={12} />
-                                                </button>
-                                                <span className="text-sm w-6 text-center font-medium">{item.quantity}</span>
-                                                <button
-                                                    onClick={() => updateQuantity(item.id, item.quantity + 1)}
-                                                    className="p-1.5 hover:text-harp-caramel"
-                                                >
-                                                    <Plus size={12} />
-                                                </button>
-                                            </div>
-                                            <button
-                                                onClick={() => removeItem(item.id)}
-                                                className="p-1.5 text-gray-400 hover:text-red-500 transition-colors"
-                                            >
-                                                <Trash2 size={16} />
-                                            </button>
-                                        </div>
-                                    </div>
-                                </div>
-                            ))}
-
-                            {/* Cross-sell Section */}
-                            {suggestions.length > 0 && (
-                                <div className="mt-6 pt-4 border-t border-gray-100">
-                                    <h4 className="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2">
-                                        <Sparkles size={14} className="text-amber-500" />
-                                        {t("cart.completeLook")}
-                                    </h4>
-                                    <div className="space-y-2">
-                                        {suggestions.map((product) => (
-                                            <Link
-                                                key={product.id}
-                                                href={`/product/${product.id}`}
-                                                onClick={() => setIsOpen(false)}
-                                                className="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors group"
-                                            >
-                                                <div className="relative w-12 h-14 bg-gray-100 rounded-md overflow-hidden shrink-0">
-                                                    <Image
-                                                        src={product.image}
-                                                        alt={product.name}
-                                                        fill
-                                                        className="object-cover"
-                                                    />
-                                                </div>
-                                                <div className="flex-1 min-w-0">
-                                                    <p className="text-sm font-medium text-gray-900 truncate">{product.name}</p>
-                                                    <p className="text-xs text-harp-brown font-semibold">{formatPrice(product.price)}</p>
-                                                </div>
-                                                <ChevronRight size={16} className="text-gray-400 group-hover:text-harp-brown transition-colors" />
-                                            </Link>
-                                        ))}
-                                    </div>
-                                </div>
-                            )}
-                        </>
-                    )}
+                        <div className="flex-1 min-w-0">
+                          <p className="text-sm font-medium text-gray-900 truncate">
+                            {product.name}
+                          </p>
+                          <p className="text-xs text-harp-brown font-semibold">
+                            {formatPrice(product.price)}
+                          </p>
+                        </div>
+                        <ChevronRight
+                          size={16}
+                          className="text-gray-400 group-hover:text-harp-brown transition-colors"
+                        />
+                      </Link>
+                    ))}
+                  </div>
                 </div>
+              )}
+            </>
+          )}
+        </div>
 
-                {/* Footer */}
-                {items.length > 0 && (
-                    <div className="p-4 border-t border-harp-beige bg-white shadow-[0_-4px_20px_rgba(0,0,0,0.05)]">
-                        {/* Totals */}
-                        <div className="space-y-2 mb-4">
-                            <div className="flex items-center justify-between text-sm">
-                                <span className="text-gray-600">{t("cart.subtotal")}</span>
-                                <span className="font-medium">{formatPrice(total)}</span>
-                            </div>
-                            <div className="flex items-center justify-between text-sm">
-                                <span className="text-gray-600">{t("cart.shipping")}</span>
-                                {hasFreeShipping ? (
-                                    <span className="text-green-600 font-medium">{t("cart.free")}</span>
-                                ) : (
-                                    <span className="text-gray-500">{t("cart.calculatedAtCheckout")}</span>
-                                )}
-                            </div>
-                            <div className="flex items-center justify-between pt-2 border-t border-gray-100">
-                                <span className="font-semibold text-gray-900">{t("cart.total")}</span>
-                                <span className="font-serif font-bold text-xl text-harp-brown">{formatPrice(total)}</span>
-                            </div>
-                        </div>
+        {/* Footer */}
+        {items.length > 0 && (
+          <div className="p-4 border-t border-harp-beige bg-white shadow-[0_-4px_20px_rgba(0,0,0,0.05)]">
+            {/* Totals */}
+            <div className="space-y-2 mb-4">
+              <div className="flex items-center justify-between text-sm">
+                <span className="text-gray-600">{t("cart.subtotal")}</span>
+                <span className="font-medium">{formatPrice(total)}</span>
+              </div>
+              <div className="flex items-center justify-between text-sm">
+                <span className="text-gray-600">{t("cart.shipping")}</span>
+                {hasFreeShipping ? (
+                  <span className="text-green-600 font-medium">
+                    {t("cart.free")}
+                  </span>
+                ) : (
+                  <span className="text-gray-500">
+                    {t("cart.calculatedAtCheckout")}
+                  </span>
+                )}
+              </div>
+              <div className="flex items-center justify-between pt-2 border-t border-gray-100">
+                <span className="font-semibold text-gray-900">
+                  {t("cart.total")}
+                </span>
+                <span className="font-serif font-bold text-xl text-harp-brown">
+                  {formatPrice(total)}
+                </span>
+              </div>
+            </div>
 
-                        {/* Checkout Button */}
-                        <Link
-                            href="/checkout"
-                            onClick={() => setIsOpen(false)}
-                            className="block w-full bg-harp-brown text-white text-center py-4 rounded-xl font-medium hover:bg-harp-caramel transition-colors"
-                        >
-                            {t("cart.checkout")}
-                        </Link>
+            {/* Checkout Button */}
+            <Link
+              href="/checkout"
+              onClick={() => setIsOpen(false)}
+              className="block w-full bg-harp-brown text-white text-center py-4 rounded-xl font-medium hover:bg-harp-caramel transition-colors"
+            >
+              {t("cart.checkout")}
+            </Link>
 
-                        {/* Trust badges */}
-                        <div className="flex items-center justify-center gap-4 mt-3 text-xs text-gray-500">
-                            <span className="flex items-center gap-1">
-                                <Truck size={12} />
-                                {t("cart.badges.delivery")}
-                            </span>
-                            <span>•</span>
-                            <span>{t("cart.badges.cod")}</span>
-                            <span>•</span>
-                            <span>{t("cart.badges.tracking")}</span>
-                        </div>
-                    </div>
-                )}
+            {/* Trust badges */}
+            <div className="flex items-center justify-center gap-4 mt-3 text-xs text-gray-500">
+              <span className="flex items-center gap-1">
+                <Truck size={12} />
+                {t("cart.badges.delivery")}
+              </span>
+              <span>•</span>
+              <span>{t("cart.badges.cod")}</span>
+              <span>•</span>
+              <span>{t("cart.badges.tracking")}</span>
             </div>
-        </div>
-    );
+          </div>
+        )}
+      </div>
+    </div>
+  );
 }
diff --git a/src/components/CartProvider.tsx b/src/components/CartProvider.tsx
index f5b2a66..d6ba7b3 100644
--- a/src/components/CartProvider.tsx
+++ b/src/components/CartProvider.tsx
@@ -1,119 +1,129 @@
 "use client";
 
-import React, { createContext, useContext, useState, useEffect, useCallback, useSyncExternalStore } from "react";
+import React, {
+  createContext,
+  useContext,
+  useState,
+  useEffect,
+  useCallback,
+  useSyncExternalStore,
+} from "react";
 
 export interface CartItem {
-    id: string; // unique id for cart item (product + size + color)
-    productId: string;
-    name: string;
-    price: number;
-    image: string;
-    size: string;
-    color: string;
-    quantity: number;
+  id: string; // unique id for cart item (product + size + color)
+  productId: string;
+  name: string;
+  price: number;
+  image: string;
+  size: string;
+  color: string;
+  quantity: number;
 }
 
 interface CartContextType {
-    items: CartItem[];
-    addItem: (item: Omit<CartItem, "id">) => void;
-    removeItem: (id: string) => void;
-    updateQuantity: (id: string, quantity: number) => void;
-    clearCart: () => void;
-    total: number;
-    isOpen: boolean;
-    setIsOpen: (isOpen: boolean) => void;
+  items: CartItem[];
+  addItem: (item: Omit<CartItem, "id">) => void;
+  removeItem: (id: string) => void;
+  updateQuantity: (id: string, quantity: number) => void;
+  clearCart: () => void;
+  total: number;
+  isOpen: boolean;
+  setIsOpen: (isOpen: boolean) => void;
 }
 
 const CartContext = createContext<CartContextType | undefined>(undefined);
 
 // Hook to detect client-side mounting
 function useIsMounted() {
-    return useSyncExternalStore(
-        () => () => {},
-        () => true,
-        () => false
-    );
+  return useSyncExternalStore(
+    () => () => {},
+    () => true,
+    () => false,
+  );
 }
 
 export function CartProvider({ children }: { children: React.ReactNode }) {
-    const isMounted = useIsMounted();
-    const [items, setItems] = useState<CartItem[]>([]);
-    const [isOpen, setIsOpen] = useState(false);
+  const isMounted = useIsMounted();
+  const [items, setItems] = useState<CartItem[]>([]);
+  const [isOpen, setIsOpen] = useState(false);
 
-    // Load cart from local storage only on client side
-    useEffect(() => {
-        if (isMounted) {
-            const savedCart = localStorage.getItem("harp-cart");
-            if (savedCart) {
-                try {
-                    setItems(JSON.parse(savedCart));
-                } catch {
-                    // Invalid JSON, ignore
-                }
-            }
+  // Load cart from local storage only on client side
+  useEffect(() => {
+    if (isMounted) {
+      const savedCart = localStorage.getItem("harp-cart");
+      if (savedCart) {
+        try {
+          setItems(JSON.parse(savedCart));
+        } catch {
+          // Invalid JSON, ignore
         }
-    }, [isMounted]);
+      }
+    }
+  }, [isMounted]);
 
-    // Save cart to local storage
-    useEffect(() => {
-        localStorage.setItem("harp-cart", JSON.stringify(items));
-    }, [items]);
+  // Save cart to local storage
+  useEffect(() => {
+    localStorage.setItem("harp-cart", JSON.stringify(items));
+  }, [items]);
 
-    const addItem = (newItem: Omit<CartItem, "id">) => {
-        const id = `${newItem.productId}-${newItem.size}-${newItem.color}`;
-        setItems((prev) => {
-            const existing = prev.find((item) => item.id === id);
-            if (existing) {
-                return prev.map((item) =>
-                    item.id === id
-                        ? { ...item, quantity: item.quantity + newItem.quantity }
-                        : item
-                );
-            }
-            return [...prev, { ...newItem, id }];
-        });
-        setIsOpen(true);
-    };
+  const addItem = (newItem: Omit<CartItem, "id">) => {
+    const id = `${newItem.productId}-${newItem.size}-${newItem.color}`;
+    setItems((prev) => {
+      const existing = prev.find((item) => item.id === id);
+      if (existing) {
+        return prev.map((item) =>
+          item.id === id
+            ? { ...item, quantity: item.quantity + newItem.quantity }
+            : item,
+        );
+      }
+      return [...prev, { ...newItem, id }];
+    });
+    setIsOpen(true);
+  };
 
-    const removeItem = (id: string) => {
-        setItems((prev) => prev.filter((item) => item.id !== id));
-    };
+  const removeItem = (id: string) => {
+    setItems((prev) => prev.filter((item) => item.id !== id));
+  };
 
-    const updateQuantity = (id: string, quantity: number) => {
-        if (quantity < 1) return;
-        setItems((prev) =>
-            prev.map((item) => (item.id === id ? { ...item, quantity } : item))
-        );
-    };
+  const updateQuantity = (id: string, quantity: number) => {
+    if (quantity < 1) return;
+    setItems((prev) =>
+      prev.map((item) => (item.id === id ? { ...item, quantity } : item)),
+    );
+  };
 
-    const clearCart = () => {
-        setItems([]);
-    };
+  const clearCart = () => {
+    setItems([]);
+  };
 
-    const total = items.reduce((sum, item) => sum + item.price * item.quantity, 0);
+  const total = items.reduce(
+    (sum, item) => sum + item.price * item.quantity,
+    0,
+  );
 
-    return (
-        <CartContext.Provider
-            value={{
-                items,
-                addItem,
-                removeItem,
-                updateQuantity,
-                clearCart,
-                total,
-                isOpen,
-                setIsOpen,
-            }}
-        >
-            {children}
-        </CartContext.Provider>
-    );
+  return (
+    <CartContext.Provider
+      value={{
+        items,
+        addItem,
+        removeItem,
+        updateQuantity,
+        clearCart,
+        total,
+        isOpen,
+        setIsOpen,
+      }}
+    >
+      {children}
+    </CartContext.Provider>
+  );
 }
 
 export function useCart() {
-    const context = useContext(CartContext);
-    if (context === undefined) {
-        throw new Error("useCart must be used within a CartProvider");
-    }
-    return context;
+  const context = useContext(CartContext);
+  if (context === undefined) {
+    throw new Error("useCart must be used within a CartProvider");
+  }
+  return context;
 }
diff --git a/src/components/ErrorBoundary.tsx b/src/components/ErrorBoundary.tsx
index 4a624b2..83aef06 100644
--- a/src/components/ErrorBoundary.tsx
+++ b/src/components/ErrorBoundary.tsx
@@ -5,135 +5,135 @@ import { AlertTriangle, RefreshCw, Home } from "lucide-react";
 import Link from "next/link";
 
 interface Props {
-    children: ReactNode;
-    fallback?: ReactNode;
+  children: ReactNode;
+  fallback?: ReactNode;
 }
 
 interface State {
-    hasError: boolean;
-    error: Error | null;
-    errorInfo: ErrorInfo | null;
+  hasError: boolean;
+  error: Error | null;
+  errorInfo: ErrorInfo | null;
 }
 
 export class ErrorBoundary extends Component<Props, State> {
-    constructor(props: Props) {
-        super(props);
-        this.state = {
-            hasError: false,
-            error: null,
-            errorInfo: null,
-        };
-    }
+  constructor(props: Props) {
+    super(props);
+    this.state = {
+      hasError: false,
+      error: null,
+      errorInfo: null,
+    };
+  }
 
-    static getDerivedStateFromError(error: Error): Partial<State> {
-        return { hasError: true, error };
-    }
+  static getDerivedStateFromError(error: Error): Partial<State> {
+    return { hasError: true, error };
+  }
 
-    componentDidCatch(error: Error, errorInfo: ErrorInfo): void {
-        this.setState({ errorInfo });
-        
-        // Log to external service in production
-        if (process.env.NODE_ENV === "production") {
-            // Example: Sentry.captureException(error);
-            console.error("Error caught by boundary:", error, errorInfo);
-        }
+  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {
+    this.setState({ errorInfo });
+
+    // Log to external service in production
+    if (process.env.NODE_ENV === "production") {
+      // Example: Sentry.captureException(error);
+      console.error("Error caught by boundary:", error, errorInfo);
     }
+  }
 
-    handleReset = (): void => {
-        this.setState({
-            hasError: false,
-            error: null,
-            errorInfo: null,
-        });
-    };
+  handleReset = (): void => {
+    this.setState({
+      hasError: false,
+      error: null,
+      errorInfo: null,
+    });
+  };
+
+  render(): ReactNode {
+    if (this.state.hasError) {
+      // Custom fallback UI
+      if (this.props.fallback) {
+        return this.props.fallback;
+      }
 
-    render(): ReactNode {
-        if (this.state.hasError) {
-            // Custom fallback UI
-            if (this.props.fallback) {
-                return this.props.fallback;
-            }
-
-            return (
-                <div className="min-h-[400px] flex items-center justify-center p-4">
-                    <div className="text-center max-w-md">
-                        <div className="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
-                            <AlertTriangle size={32} className="text-red-600" />
-                        </div>
-                        
-                        <h2 className="text-2xl font-serif font-bold text-gray-900 mb-3">
-                            Oups ! Une erreur s&apos;est produite
-                        </h2>
-                        
-                        <p className="text-gray-600 mb-6">
-                            Nous sommes désolés, quelque chose ne s&apos;est pas passé comme prévu.
-                            Veuillez réessayer ou retourner à l&apos;accueil.
-                        </p>
-
-                        {process.env.NODE_ENV === "development" && this.state.error && (
-                            <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-6 text-left">
-                                <p className="text-sm font-mono text-red-800 break-all">
-                                    {this.state.error.message}
-                                </p>
-                                {this.state.errorInfo && (
-                                    <details className="mt-2">
-                                        <summary className="text-xs text-red-600 cursor-pointer">
-                                            Stack trace
-                                        </summary>
-                                        <pre className="text-xs text-red-700 mt-2 overflow-auto max-h-40">
-                                            {this.state.errorInfo.componentStack}
-                                        </pre>
-                                    </details>
-                                )}
-                            </div>
-                        )}
-
-                        <div className="flex flex-col sm:flex-row gap-3 justify-center">
-                            <button
-                                onClick={this.handleReset}
-                                className="inline-flex items-center justify-center gap-2 px-6 py-3 bg-harp-brown text-white rounded-lg font-medium hover:bg-harp-caramel transition-colors"
-                            >
-                                <RefreshCw size={18} />
-                                Réessayer
-                            </button>
-                            <Link
-                                href="/"
-                                className="inline-flex items-center justify-center gap-2 px-6 py-3 border-2 border-harp-brown text-harp-brown rounded-lg font-medium hover:bg-harp-brown hover:text-white transition-colors"
-                            >
-                                <Home size={18} />
-                                Accueil
-                            </Link>
-                        </div>
-                    </div>
-                </div>
-            );
-        }
-
-        return this.props.children;
+      return (
+        <div className="min-h-[400px] flex items-center justify-center p-4">
+          <div className="text-center max-w-md">
+            <div className="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
+              <AlertTriangle size={32} className="text-red-600" />
+            </div>
+
+            <h2 className="text-2xl font-serif font-bold text-gray-900 mb-3">
+              Oups ! Une erreur s&apos;est produite
+            </h2>
+
+            <p className="text-gray-600 mb-6">
+              Nous sommes désolés, quelque chose ne s&apos;est pas passé comme
+              prévu. Veuillez réessayer ou retourner à l&apos;accueil.
+            </p>
+
+            {process.env.NODE_ENV === "development" && this.state.error && (
+              <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-6 text-left">
+                <p className="text-sm font-mono text-red-800 break-all">
+                  {this.state.error.message}
+                </p>
+                {this.state.errorInfo && (
+                  <details className="mt-2">
+                    <summary className="text-xs text-red-600 cursor-pointer">
+                      Stack trace
+                    </summary>
+                    <pre className="text-xs text-red-700 mt-2 overflow-auto max-h-40">
+                      {this.state.errorInfo.componentStack}
+                    </pre>
+                  </details>
+                )}
+              </div>
+            )}
+
+            <div className="flex flex-col sm:flex-row gap-3 justify-center">
+              <button
+                onClick={this.handleReset}
+                className="inline-flex items-center justify-center gap-2 px-6 py-3 bg-harp-brown text-white rounded-lg font-medium hover:bg-harp-caramel transition-colors"
+              >
+                <RefreshCw size={18} />
+                Réessayer
+              </button>
+              <Link
+                href="/"
+                className="inline-flex items-center justify-center gap-2 px-6 py-3 border-2 border-harp-brown text-harp-brown rounded-lg font-medium hover:bg-harp-brown hover:text-white transition-colors"
+              >
+                <Home size={18} />
+                Accueil
+              </Link>
+            </div>
+          </div>
+        </div>
+      );
     }
+
+    return this.props.children;
+  }
 }
 
 // Hook for functional components to trigger error boundary
 export function useErrorHandler() {
-    const [, setError] = React.useState<Error | null>(null);
+  const [, setError] = React.useState<Error | null>(null);
 
-    return React.useCallback((error: Error) => {
-        setError(() => {
-            throw error;
-        });
-    }, []);
+  return React.useCallback((error: Error) => {
+    setError(() => {
+      throw error;
+    });
+  }, []);
 }
 
 // Simple wrapper component for easier use
 export function withErrorBoundary<P extends object>(
-    WrappedComponent: React.ComponentType<P>,
-    fallback?: ReactNode
+  WrappedComponent: React.ComponentType<P>,
+  fallback?: ReactNode,
 ) {
-    return function WithErrorBoundaryWrapper(props: P) {
-        return (
-            <ErrorBoundary fallback={fallback}>
-                <WrappedComponent {...props} />
-            </ErrorBoundary>
-        );
-    };
+  return function WithErrorBoundaryWrapper(props: P) {
+    return (
+      <ErrorBoundary fallback={fallback}>
+        <WrappedComponent {...props} />
+      </ErrorBoundary>
+    );
+  };
 }
diff --git a/src/components/Footer.tsx b/src/components/Footer.tsx
index decffff..06198ff 100644
--- a/src/components/Footer.tsx
+++ b/src/components/Footer.tsx
@@ -2,184 +2,274 @@
 
 import Link from "next/link";
 import Image from "next/image";
-import { Instagram, Phone, Mail, MapPin, ArrowRight, Send, Facebook } from "lucide-react";
+import {
+  Instagram,
+  Phone,
+  Mail,
+  MapPin,
+  ArrowRight,
+  Send,
+  Facebook,
+} from "lucide-react";
 import { useState } from "react";
 import { useLanguage } from "./LanguageProvider";
 import { siteConfig, getWhatsAppLink } from "@/lib/config";
 
 // TikTok icon (not in Lucide)
 const TikTokIcon = ({ size = 18 }: { size?: number }) => (
-    <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor">
-        <path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z"/>
-    </svg>
+  <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor">
+    <path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z" />
+  </svg>
 );
 
 export function Footer() {
-    const { t } = useLanguage();
-    const [email, setEmail] = useState("");
-    const [isSubscribed, setIsSubscribed] = useState(false);
-
-    const handleSubscribe = (e: React.FormEvent) => {
-        e.preventDefault();
-        if (email) {
-            setIsSubscribed(true);
-            setEmail("");
-            setTimeout(() => setIsSubscribed(false), 3000);
-        }
-    };
+  const { t } = useLanguage();
+  const [email, setEmail] = useState("");
+  const [isSubscribed, setIsSubscribed] = useState(false);
 
-    return (
-        <footer 
-            role="contentinfo"
-            aria-label="Pied de page"
-            className="mt-auto bg-gradient-to-b from-white to-harp-cream/30 border-t border-harp-sand/50"
-        >
-            {/* Newsletter Section */}
-            <section className="py-16 md:py-20 border-b border-harp-sand/50 bg-harp-sand/20">
-                <div className="container mx-auto px-4">
-                    <div className="max-w-xl mx-auto text-center">
-                        <h3 className="text-3xl font-serif font-medium text-gray-900 mb-4">
-                            {t("footer.newsletter.title")}
-                        </h3>
-                        <p className="text-gray-500 mb-8 font-light">
-                            {t("footer.newsletter.desc")}
-                        </p>
-
-                        <form onSubmit={handleSubscribe} className="flex flex-col sm:flex-row gap-3" aria-label="Newsletter inscription">
-                            <input
-                                type="email"
-                                value={email}
-                                onChange={(e) => setEmail(e.target.value)}
-                                placeholder={t("footer.newsletter.placeholder")}
-                                aria-label="Adresse email pour newsletter"
-                                required
-                                className="flex-1 px-5 py-3.5 bg-white border border-harp-sand rounded-full text-sm focus:border-harp-caramel focus:ring-0 outline-none transition-all placeholder:text-gray-400"
-                            />
-                            <button
-                                type="submit"
-                                className="group px-8 py-3.5 bg-harp-brown text-white rounded-full font-medium text-sm uppercase tracking-wider hover:bg-harp-caramel transition-colors flex items-center justify-center gap-2"
-                            >
-                                {isSubscribed ? t("footer.newsletter.subscribed") : t("footer.newsletter.button")}
-                                {!isSubscribed && <ArrowRight size={16} className="group-hover:translate-x-1 transition-transform" />}
-                            </button>
-                        </form>
-                    </div>
-                </div>
-            </section>
-
-            {/* Main Footer */}
-            <div className="pt-16 pb-8">
-                <div className="container mx-auto px-4">
-                    <div className="grid grid-cols-1 md:grid-cols-12 gap-12 mb-16">
-                        {/* Brand - 4 cols */}
-                        <div className="md:col-span-4 space-y-6">
-                            <Link href="/" className="block">
-                                <Image
-                                    src="/logo.svg"
-                                    alt="Harp"
-                                    width={120}
-                                    height={40}
-                                    className="h-10 w-auto"
-                                />
-                            </Link>
-                            <p className="text-gray-500 leading-relaxed font-light max-w-sm">
-                                {t("hero.subtitle")}
-                            </p>
-                            <div className="flex gap-4 pt-2">
-                                <SocialLink href="https://instagram.com/harp_algeria" icon={Instagram} />
-                                <SocialLink href="https://www.facebook.com/profile.php?id=61566880453440" icon={Facebook} />
-                                <SocialLink href="https://www.tiktok.com/@harp.algeria" icon={TikTokIcon} />
-                                <SocialLink href={getWhatsAppLink()} icon={Phone} />
-                            </div>
-                        </div>
-
-                        {/* Navigation - 2 cols */}
-                        <div className="md:col-span-2">
-                            <h4 className="font-serif font-medium text-gray-900 text-lg mb-6">{t("footer.nav.title")}</h4>
-                            <ul className="space-y-4">
-                                <FooterLink href="/">{t("nav.home")}</FooterLink>
-                                <FooterLink href="/shop">{t("nav.shop")}</FooterLink>
-                                <FooterLink href="/about">{t("nav.about")}</FooterLink>
-                                <FooterLink href="/contact">{t("nav.contact")}</FooterLink>
-                            </ul>
-                        </div>
-
-                        {/* Service - 3 cols */}
-                        <div className="md:col-span-3">
-                            <h4 className="font-serif font-medium text-gray-900 text-lg mb-6">{t("footer.service.title")}</h4>
-                            <ul className="space-y-4">
-                                <li className="text-gray-500 text-sm">{t("footer.service.delivery")}</li>
-                                <li className="text-gray-500 text-sm">{t("footer.service.payment")}</li>
-                                <li className="text-gray-500 text-sm">{t("footer.service.exchange")}</li>
-                                <li className="text-gray-500 text-sm">{t("footer.service.support")}</li>
-                            </ul>
-                        </div>
-
-                        {/* Contact - 3 cols */}
-                        <div className="md:col-span-3">
-                             <h4 className="font-serif font-medium text-gray-900 text-lg mb-6">{t("footer.contact.title")}</h4>
-                             <ul className="space-y-4">
-                                <ContactItem icon={Phone} text={siteConfig.whatsapp.display} href={getWhatsAppLink()} />
-                                <ContactItem icon={Mail} text="contact@harpalgeria.com" href="mailto:contact@harpalgeria.com" />
-                                <ContactItem icon={MapPin} text={t("footer.contact.location")} />
-                             </ul>
-                        </div>
-                    </div>
-
-                    {/* Bottom Bar */}
-                    <div className="border-t border-harp-sand/50 pt-8 flex flex-col md:flex-row justify-between items-center gap-4">
-                        <p className="text-xs text-gray-400 uppercase tracking-widest">
-                            © {t("footer.copyright")}
-                        </p>
-                        <div className="flex items-center gap-8">
-                            <Link href="/privacy" className="text-xs text-gray-400 uppercase tracking-widest hover:text-gray-900 transition-colors">
-                                {t("footer.legal.privacy")}
-                            </Link>
-                            <Link href="/terms" className="text-xs text-gray-400 uppercase tracking-widest hover:text-gray-900 transition-colors">
-                                {t("footer.legal.terms")}
-                            </Link>
-                        </div>
-                    </div>
-                </div>
+  const handleSubscribe = (e: React.FormEvent) => {
+    e.preventDefault();
+    if (email) {
+      setIsSubscribed(true);
+      setEmail("");
+      setTimeout(() => setIsSubscribed(false), 3000);
+    }
+  };
+
+  return (
+    <footer
+      role="contentinfo"
+      aria-label="Pied de page"
+      className="mt-auto bg-gradient-to-b from-white to-harp-cream/30 border-t border-harp-sand/50"
+    >
+      {/* Newsletter Section */}
+      <section className="py-16 md:py-20 border-b border-harp-sand/50 bg-harp-sand/20">
+        <div className="container mx-auto px-4">
+          <div className="max-w-xl mx-auto text-center">
+            <h3 className="text-3xl font-serif font-medium text-gray-900 mb-4">
+              {t("footer.newsletter.title")}
+            </h3>
+            <p className="text-gray-500 mb-8 font-light">
+              {t("footer.newsletter.desc")}
+            </p>
+
+            <form
+              onSubmit={handleSubscribe}
+              className="flex flex-col sm:flex-row gap-3"
+              aria-label="Newsletter inscription"
+            >
+              <input
+                type="email"
+                value={email}
+                onChange={(e) => setEmail(e.target.value)}
+                placeholder={t("footer.newsletter.placeholder")}
+                aria-label="Adresse email pour newsletter"
+                required
+                className="flex-1 px-5 py-3.5 bg-white border border-harp-sand rounded-full text-sm focus:border-harp-caramel focus:ring-0 outline-none transition-all placeholder:text-gray-400"
+              />
+              <button
+                type="submit"
+                className="group px-8 py-3.5 bg-harp-brown text-white rounded-full font-medium text-sm uppercase tracking-wider hover:bg-harp-caramel transition-colors flex items-center justify-center gap-2"
+              >
+                {isSubscribed
+                  ? t("footer.newsletter.subscribed")
+                  : t("footer.newsletter.button")}
+                {!isSubscribed && (
+                  <ArrowRight
+                    size={16}
+                    className="group-hover:translate-x-1 transition-transform"
+                  />
+                )}
+              </button>
+            </form>
+          </div>
+        </div>
+      </section>
+
+      {/* Main Footer */}
+      <div className="pt-16 pb-8">
+        <div className="container mx-auto px-4">
+          <div className="grid grid-cols-1 md:grid-cols-12 gap-12 mb-16">
+            {/* Brand - 4 cols */}
+            <div className="md:col-span-4 space-y-6">
+              <Link href="/" className="block">
+                <Image
+                  src="/logo.svg"
+                  alt="Harp"
+                  width={120}
+                  height={40}
+                  className="h-10 w-auto"
+                />
+              </Link>
+              <p className="text-gray-500 leading-relaxed font-light max-w-sm">
+                {t("hero.subtitle")}
+              </p>
+              <div className="flex gap-4 pt-2">
+                <SocialLink
+                  href="https://instagram.com/harp_algeria"
+                  icon={Instagram}
+                />
+                <SocialLink
+                  href="https://www.facebook.com/profile.php?id=61566880453440"
+                  icon={Facebook}
+                />
+                <SocialLink
+                  href="https://www.tiktok.com/@harp.algeria"
+                  icon={TikTokIcon}
+                />
+                <SocialLink href={getWhatsAppLink()} icon={Phone} />
+              </div>
             </div>
-        </footer>
-    );
+
+            {/* Navigation - 2 cols */}
+            <div className="md:col-span-2">
+              <h4 className="font-serif font-medium text-gray-900 text-lg mb-6">
+                {t("footer.nav.title")}
+              </h4>
+              <ul className="space-y-4">
+                <FooterLink href="/">{t("nav.home")}</FooterLink>
+                <FooterLink href="/shop">{t("nav.shop")}</FooterLink>
+                <FooterLink href="/about">{t("nav.about")}</FooterLink>
+                <FooterLink href="/contact">{t("nav.contact")}</FooterLink>
+              </ul>
+            </div>
+
+            {/* Service - 3 cols */}
+            <div className="md:col-span-3">
+              <h4 className="font-serif font-medium text-gray-900 text-lg mb-6">
+                {t("footer.service.title")}
+              </h4>
+              <ul className="space-y-4">
+                <li className="text-gray-500 text-sm">
+                  {t("footer.service.delivery")}
+                </li>
+                <li className="text-gray-500 text-sm">
+                  {t("footer.service.payment")}
+                </li>
+                <li className="text-gray-500 text-sm">
+                  {t("footer.service.exchange")}
+                </li>
+                <li className="text-gray-500 text-sm">
+                  {t("footer.service.support")}
+                </li>
+              </ul>
+            </div>
+
+            {/* Contact - 3 cols */}
+            <div className="md:col-span-3">
+              <h4 className="font-serif font-medium text-gray-900 text-lg mb-6">
+                {t("footer.contact.title")}
+              </h4>
+              <ul className="space-y-4">
+                <ContactItem
+                  icon={Phone}
+                  text={siteConfig.whatsapp.display}
+                  href={getWhatsAppLink()}
+                />
+                <ContactItem
+                  icon={Mail}
+                  text="contact@harpalgeria.com"
+                  href="mailto:contact@harpalgeria.com"
+                />
+                <ContactItem
+                  icon={MapPin}
+                  text={t("footer.contact.location")}
+                />
+              </ul>
+            </div>
+          </div>
+
+          {/* Bottom Bar */}
+          <div className="border-t border-harp-sand/50 pt-8 flex flex-col md:flex-row justify-between items-center gap-4">
+            <p className="text-xs text-gray-400 uppercase tracking-widest">
+              © {t("footer.copyright")}
+            </p>
+            <div className="flex items-center gap-8">
+              <Link
+                href="/privacy"
+                className="text-xs text-gray-400 uppercase tracking-widest hover:text-gray-900 transition-colors"
+              >
+                {t("footer.legal.privacy")}
+              </Link>
+              <Link
+                href="/terms"
+                className="text-xs text-gray-400 uppercase tracking-widest hover:text-gray-900 transition-colors"
+              >
+                {t("footer.legal.terms")}
+              </Link>
+            </div>
+          </div>
+        </div>
+      </div>
+    </footer>
+  );
 }
 
 function SocialLink({ href, icon: Icon }: { href: string; icon: any }) {
-    return (
-        <a
-            href={href}
-            target="_blank"
-            rel="noopener noreferrer"
-            className="w-10 h-10 rounded-full bg-harp-sand/50 flex items-center justify-center text-harp-brown hover:bg-harp-brown hover:text-white transition-all"
-        >
-            <Icon size={18} />
-        </a>
-    );
+  return (
+    <a
+      href={href}
+      target="_blank"
+      rel="noopener noreferrer"
+      className="w-10 h-10 rounded-full bg-harp-sand/50 flex items-center justify-center text-harp-brown hover:bg-harp-brown hover:text-white transition-all"
+    >
+      <Icon size={18} />
+    </a>
+  );
 }
 
-function FooterLink({ href, children }: { href: string; children: React.ReactNode }) {
-    return (
-        <li>
-            <Link href={href} className="text-sm text-gray-500 hover:text-harp-brown transition-colors block">
-                {children}
-            </Link>
-        </li>
-    );
+function FooterLink({
+  href,
+  children,
+}: {
+  href: string;
+  children: React.ReactNode;
+}) {
+  return (
+    <li>
+      <Link
+        href={href}
+        className="text-sm text-gray-500 hover:text-harp-brown transition-colors block"
+      >
+        {children}
+      </Link>
+    </li>
+  );
 }
 
-function ContactItem({ icon: Icon, text, href }: { icon: any; text: string; href?: string }) {
-    const content = (
-        <div className="flex items-start gap-3 group">
-            <Icon size={18} className="text-gray-400 group-hover:text-harp-brown transition-colors mt-0.5" />
-            <span className="text-sm text-gray-500 group-hover:text-gray-900 transition-colors">{text}</span>
-        </div>
-    );
+function ContactItem({
+  icon: Icon,
+  text,
+  href,
+}: {
+  icon: any;
+  text: string;
+  href?: string;
+}) {
+  const content = (
+    <div className="flex items-start gap-3 group">
+      <Icon
+        size={18}
+        className="text-gray-400 group-hover:text-harp-brown transition-colors mt-0.5"
+      />
+      <span className="text-sm text-gray-500 group-hover:text-gray-900 transition-colors">
+        {text}
+      </span>
+    </div>
+  );
 
-    if (href) {
-        return <a href={href} target="_blank" rel="noopener noreferrer" className="block">{content}</a>;
-    }
+  if (href) {
+    return (
+      <a
+        href={href}
+        target="_blank"
+        rel="noopener noreferrer"
+        className="block"
+      >
+        {content}
+      </a>
+    );
+  }
 
-    return <li>{content}</li>;
+  return <li>{content}</li>;
 }
diff --git a/src/components/Header.tsx b/src/components/Header.tsx
index 3595932..c366104 100644
--- a/src/components/Header.tsx
+++ b/src/components/Header.tsx
@@ -11,241 +11,252 @@ import { useSession } from "next-auth/react";
 import { cn } from "@/lib/utils";
 
 export function Header() {
-    const { t, language, setLanguage } = useLanguage();
-    const { setIsOpen: setCartOpen, items } = useCart();
-    const { data: session } = useSession();
-    const [isMenuOpen, setIsMenuOpen] = useState(false);
-    const [isScrolled, setIsScrolled] = useState(false);
-    const pathname = usePathname();
-
-    const cartCount = items.reduce((acc, item) => acc + item.quantity, 0);
-
-    // Handle scroll effect
-    useEffect(() => {
-        const handleScroll = () => {
-            setIsScrolled(window.scrollY > 20);
-        };
-        window.addEventListener("scroll", handleScroll);
-        return () => window.removeEventListener("scroll", handleScroll);
-    }, []);
-
-    // Close menu on route change
-    useEffect(() => {
-        if (isMenuOpen) {
-            setIsMenuOpen(false);
-        }
-    }, [pathname, isMenuOpen]);
-
-    // Prevent body scroll when menu is open
-    useEffect(() => {
-        if (isMenuOpen) {
-            document.body.style.overflow = "hidden";
-        } else {
-            document.body.style.overflow = "";
-        }
-        return () => {
-            document.body.style.overflow = "";
-        };
-    }, [isMenuOpen]);
-
-    const toggleLanguage = () => {
-        setLanguage(language === "fr" ? "ar" : "fr");
+  const { t, language, setLanguage } = useLanguage();
+  const { setIsOpen: setCartOpen, items } = useCart();
+  const { data: session } = useSession();
+  const [isMenuOpen, setIsMenuOpen] = useState(false);
+  const [isScrolled, setIsScrolled] = useState(false);
+  const pathname = usePathname();
+
+  const cartCount = items.reduce((acc, item) => acc + item.quantity, 0);
+
+  // Handle scroll effect
+  useEffect(() => {
+    const handleScroll = () => {
+      setIsScrolled(window.scrollY > 20);
     };
+    window.addEventListener("scroll", handleScroll);
+    return () => window.removeEventListener("scroll", handleScroll);
+  }, []);
+
+  // Close menu on route change
+  useEffect(() => {
+    if (isMenuOpen) {
+      setIsMenuOpen(false);
+    }
+  }, [pathname, isMenuOpen]);
+
+  // Prevent body scroll when menu is open
+  useEffect(() => {
+    if (isMenuOpen) {
+      document.body.style.overflow = "hidden";
+    } else {
+      document.body.style.overflow = "";
+    }
+    return () => {
+      document.body.style.overflow = "";
+    };
+  }, [isMenuOpen]);
+
+  const toggleLanguage = () => {
+    setLanguage(language === "fr" ? "ar" : "fr");
+  };
+
+  const navLinks = [
+    { href: "/", label: "nav.home" },
+    { href: "/shop", label: "nav.shop" },
+    { href: "/about", label: "nav.about" },
+    { href: "/contact", label: "nav.contact" },
+  ];
 
-    const navLinks = [
-        { href: "/", label: "nav.home" },
-        { href: "/shop", label: "nav.shop" },
-        { href: "/about", label: "nav.about" },
-        { href: "/contact", label: "nav.contact" },
-    ];
-
-    return (
-        <>
-            <header
-                role="banner"
-                aria-label="Navigation principale"
+  return (
+    <>
+      <header
+        role="banner"
+        aria-label="Navigation principale"
+        className={cn(
+          "sticky top-0 z-50 transition-all duration-300 border-b",
+          isScrolled
+            ? "bg-white/95 backdrop-blur-md shadow-[0_2px_10px_-2px_rgba(61,35,20,0.05)] border-harp-sand/50"
+            : "bg-harp-cream/80 backdrop-blur-md border-harp-sand/30",
+        )}
+      >
+        <div className="container mx-auto px-4 h-20 flex items-center justify-between">
+          {/* Mobile Menu Button */}
+          <button
+            className="md:hidden p-2 hover:bg-harp-sand/50 rounded-full transition-colors"
+            onClick={() => setIsMenuOpen(!isMenuOpen)}
+            aria-label="Menu"
+          >
+            <Menu
+              size={22}
+              className={cn(
+                "transition-transform duration-300 text-gray-900",
+                isMenuOpen && "rotate-90 opacity-0",
+              )}
+            />
+          </button>
+
+          {/* Logo */}
+          <Link
+            href="/"
+            className="transition-opacity hover:opacity-80 relative"
+          >
+            <Image
+              src="/logo.svg"
+              alt="Harp"
+              width={150}
+              height={48}
+              className="h-12 w-auto"
+              priority
+            />
+          </Link>
+
+          {/* Desktop Navigation */}
+          <nav className="hidden md:flex items-center gap-10">
+            {navLinks.map((link) => (
+              <Link
+                key={link.href}
+                href={link.href}
                 className={cn(
-                    "sticky top-0 z-50 transition-all duration-300 border-b",
-                    isScrolled
-                        ? "bg-white/95 backdrop-blur-md shadow-[0_2px_10px_-2px_rgba(61,35,20,0.05)] border-harp-sand/50"
-                        : "bg-harp-cream/80 backdrop-blur-md border-harp-sand/30"
+                  "text-sm uppercase tracking-[0.15em] transition-colors py-2 relative group",
+                  pathname === link.href
+                    ? "text-gray-900 font-medium"
+                    : "text-gray-500 hover:text-gray-900",
                 )}
+              >
+                {t(link.label)}
+                <span
+                  className={cn(
+                    "absolute bottom-0 left-0 w-full h-px bg-gray-900 origin-left transition-transform duration-300",
+                    pathname === link.href
+                      ? "scale-x-100"
+                      : "scale-x-0 group-hover:scale-x-100",
+                  )}
+                />
+              </Link>
+            ))}
+          </nav>
+
+          {/* Actions */}
+          <div className="flex items-center gap-2 md:gap-4">
+            <button
+              onClick={toggleLanguage}
+              className="hidden md:block px-4 py-1.5 text-xs font-medium uppercase tracking-wider text-harp-caramel hover:text-harp-brown hover:bg-harp-sand/50 rounded-full transition-all"
             >
-                <div className="container mx-auto px-4 h-20 flex items-center justify-between">
-                    {/* Mobile Menu Button */}
-                    <button
-                        className="md:hidden p-2 hover:bg-harp-sand/50 rounded-full transition-colors"
-                        onClick={() => setIsMenuOpen(!isMenuOpen)}
-                        aria-label="Menu"
-                    >
-                        <Menu size={22} className={cn(
-                            "transition-transform duration-300 text-gray-900",
-                            isMenuOpen && "rotate-90 opacity-0"
-                        )} />
-                    </button>
-
-                    {/* Logo */}
-                    <Link
-                        href="/"
-                        className="transition-opacity hover:opacity-80 relative"
-                    >
-                        <Image
-                            src="/logo.svg"
-                            alt="Harp"
-                            width={150}
-                            height={48}
-                            className="h-12 w-auto"
-                            priority
-                        />
-                    </Link>
-
-                    {/* Desktop Navigation */}
-                    <nav className="hidden md:flex items-center gap-10">
-                        {navLinks.map((link) => (
-                            <Link
-                                key={link.href}
-                                href={link.href}
-                                className={cn(
-                                    "text-sm uppercase tracking-[0.15em] transition-colors py-2 relative group",
-                                    pathname === link.href
-                                        ? "text-gray-900 font-medium"
-                                        : "text-gray-500 hover:text-gray-900"
-                                )}
-                            >
-                                {t(link.label)}
-                                <span className={cn(
-                                    "absolute bottom-0 left-0 w-full h-px bg-gray-900 origin-left transition-transform duration-300",
-                                    pathname === link.href ? "scale-x-100" : "scale-x-0 group-hover:scale-x-100"
-                                )} />
-                            </Link>
-                        ))}
-                    </nav>
-
-                    {/* Actions */}
-                    <div className="flex items-center gap-2 md:gap-4">
-                        <button
-                            onClick={toggleLanguage}
-                            className="hidden md:block px-4 py-1.5 text-xs font-medium uppercase tracking-wider text-harp-caramel hover:text-harp-brown hover:bg-harp-sand/50 rounded-full transition-all"
-                        >
-                            {language === "fr" ? "العربية" : "FR"}
-                        </button>
-
-                        <button
-                            onClick={() => setCartOpen(true)}
-                            className="relative p-2.5 hover:bg-harp-sand/50 rounded-full transition-colors group text-harp-brown"
-                            aria-label="Panier"
-                        >
-                            <ShoppingBag size={20} />
-                            {cartCount > 0 && (
-                                <span className="absolute top-0.5 right-0 bg-harp-brown text-white text-[10px] w-4 h-4 rounded-full flex items-center justify-center font-medium shadow-sm">
-                                    {cartCount}
-                                </span>
-                            )}
-                        </button>
-
-                        <Link
-                            href={session ? "/account" : "/auth/magic-link-request"}
-                            className="p-2.5 hover:bg-harp-sand/50 rounded-full transition-colors text-harp-brown"
-                            aria-label="Compte"
-                        >
-                            <User size={20} />
-                        </Link>
-                    </div>
-                </div>
-            </header>
-
-            {/* Mobile Menu Overlay */}
-            <div
-                className={cn(
-                    "fixed inset-0 bg-black/20 backdrop-blur-sm z-40 md:hidden transition-opacity duration-300",
-                    isMenuOpen ? "opacity-100" : "opacity-0 pointer-events-none"
-                )}
-                onClick={() => setIsMenuOpen(false)}
+              {language === "fr" ? "العربية" : "FR"}
+            </button>
+
+            <button
+              onClick={() => setCartOpen(true)}
+              className="relative p-2.5 hover:bg-harp-sand/50 rounded-full transition-colors group text-harp-brown"
+              aria-label="Panier"
+            >
+              <ShoppingBag size={20} />
+              {cartCount > 0 && (
+                <span className="absolute top-0.5 right-0 bg-harp-brown text-white text-[10px] w-4 h-4 rounded-full flex items-center justify-center font-medium shadow-sm">
+                  {cartCount}
+                </span>
+              )}
+            </button>
+
+            <Link
+              href={session ? "/account" : "/auth/magic-link-request"}
+              className="p-2.5 hover:bg-harp-sand/50 rounded-full transition-colors text-harp-brown"
+              aria-label="Compte"
+            >
+              <User size={20} />
+            </Link>
+          </div>
+        </div>
+      </header>
+
+      {/* Mobile Menu Overlay */}
+      <div
+        className={cn(
+          "fixed inset-0 bg-black/20 backdrop-blur-sm z-40 md:hidden transition-opacity duration-300",
+          isMenuOpen ? "opacity-100" : "opacity-0 pointer-events-none",
+        )}
+        onClick={() => setIsMenuOpen(false)}
+      />
+
+      {/* Mobile Navigation Drawer */}
+      <div
+        className={cn(
+          "fixed top-0 left-0 h-full w-[300px] max-w-[85vw] bg-white z-50 md:hidden transition-transform duration-500 cubic-bezier(0.32, 0.72, 0, 1) shadow-2xl",
+          isMenuOpen ? "translate-x-0" : "-translate-x-full",
+        )}
+      >
+        {/* Drawer Header */}
+        <div className="flex items-center justify-between p-6 border-b border-gray-100">
+          <Link href="/" onClick={() => setIsMenuOpen(false)}>
+            <Image
+              src="/logo.svg"
+              alt="Harp"
+              width={120}
+              height={40}
+              className="h-10 w-auto"
             />
+          </Link>
+          <button
+            onClick={() => setIsMenuOpen(false)}
+            className="p-2 hover:bg-gray-100 rounded-full transition-colors text-gray-500"
+            aria-label="Fermer le menu"
+          >
+            <X size={20} />
+          </button>
+        </div>
 
-            {/* Mobile Navigation Drawer */}
-            <div
+        {/* Navigation Links */}
+        <nav className="p-6 flex flex-col h-[calc(100%-80px)] justify-between">
+          <div className="space-y-1">
+            {navLinks.map((link, index) => (
+              <Link
+                key={link.href}
+                href={link.href}
                 className={cn(
-                    "fixed top-0 left-0 h-full w-[300px] max-w-[85vw] bg-white z-50 md:hidden transition-transform duration-500 cubic-bezier(0.32, 0.72, 0, 1) shadow-2xl",
-                    isMenuOpen ? "translate-x-0" : "-translate-x-full"
+                  "block py-4 text-2xl font-serif font-medium transition-all duration-300",
+                  pathname === link.href
+                    ? "text-gray-900 pl-4 border-l-2 border-harp-brown"
+                    : "text-gray-400 hover:text-gray-900 hover:pl-4",
+                  isMenuOpen && "animate-fade-in-up",
                 )}
+                style={{ animationDelay: `${index * 50}ms` }}
+                onClick={() => setIsMenuOpen(false)}
+              >
+                {t(link.label)}
+              </Link>
+            ))}
+          </div>
+
+          {/* Bottom Actions */}
+          <div className="space-y-6 pt-8 border-t border-gray-100">
+            <Link
+              href={session ? "/account" : "/auth/magic-link-request"}
+              onClick={() => setIsMenuOpen(false)}
+              className="flex items-center gap-3 text-gray-600 hover:text-gray-900 transition-colors"
+            >
+              <User size={20} />
+              <span className="text-sm uppercase tracking-widest">
+                {session ? "Mon Compte" : "Se connecter"}
+              </span>
+            </Link>
+
+            <button
+              onClick={() => {
+                toggleLanguage();
+                setIsMenuOpen(false);
+              }}
+              className="flex items-center gap-3 text-gray-600 hover:text-gray-900 transition-colors"
             >
-                {/* Drawer Header */}
-                <div className="flex items-center justify-between p-6 border-b border-gray-100">
-                    <Link
-                        href="/"
-                        onClick={() => setIsMenuOpen(false)}
-                    >
-                        <Image
-                            src="/logo.svg"
-                            alt="Harp"
-                            width={120}
-                            height={40}
-                            className="h-10 w-auto"
-                        />
-                    </Link>
-                    <button
-                        onClick={() => setIsMenuOpen(false)}
-                        className="p-2 hover:bg-gray-100 rounded-full transition-colors text-gray-500"
-                        aria-label="Fermer le menu"
-                    >
-                        <X size={20} />
-                    </button>
-                </div>
-
-                {/* Navigation Links */}
-                <nav className="p-6 flex flex-col h-[calc(100%-80px)] justify-between">
-                    <div className="space-y-1">
-                        {navLinks.map((link, index) => (
-                            <Link
-                                key={link.href}
-                                href={link.href}
-                                className={cn(
-                                    "block py-4 text-2xl font-serif font-medium transition-all duration-300",
-                                    pathname === link.href
-                                        ? "text-gray-900 pl-4 border-l-2 border-harp-brown"
-                                        : "text-gray-400 hover:text-gray-900 hover:pl-4",
-                                    isMenuOpen && "animate-fade-in-up"
-                                )}
-                                style={{ animationDelay: `${index * 50}ms` }}
-                                onClick={() => setIsMenuOpen(false)}
-                            >
-                                {t(link.label)}
-                            </Link>
-                        ))}
-                    </div>
-
-                    {/* Bottom Actions */}
-                    <div className="space-y-6 pt-8 border-t border-gray-100">
-                        <Link
-                            href={session ? "/account" : "/auth/magic-link-request"}
-                            onClick={() => setIsMenuOpen(false)}
-                            className="flex items-center gap-3 text-gray-600 hover:text-gray-900 transition-colors"
-                        >
-                            <User size={20} />
-                            <span className="text-sm uppercase tracking-widest">
-                                {session ? "Mon Compte" : "Se connecter"}
-                            </span>
-                        </Link>
-
-                        <button
-                            onClick={() => { toggleLanguage(); setIsMenuOpen(false); }}
-                            className="flex items-center gap-3 text-gray-600 hover:text-gray-900 transition-colors"
-                        >
-                            <span className="text-sm uppercase tracking-widest">{t("nav.language")}</span>
-                            <span className="font-medium">{language === "fr" ? "العربية" : "Français"}</span>
-                        </button>
-                        
-                        <div className="flex gap-4">
-                             {/* Social icons placeholder if needed */}
-                        </div>
-                        
-                        <p className="text-[10px] text-gray-400 uppercase tracking-widest mt-auto">
-                            © {t("footer.copyright")}
-                        </p>
-                    </div>
-                </nav>
+              <span className="text-sm uppercase tracking-widest">
+                {t("nav.language")}
+              </span>
+              <span className="font-medium">
+                {language === "fr" ? "العربية" : "Français"}
+              </span>
+            </button>
+
+            <div className="flex gap-4">
+              {/* Social icons placeholder if needed */}
             </div>
-        </>
-    );
+
+            <p className="text-[10px] text-gray-400 uppercase tracking-widest mt-auto">
+              © {t("footer.copyright")}
+            </p>
+          </div>
+        </nav>
+      </div>
+    </>
+  );
 }
diff --git a/src/components/JsonLd.tsx b/src/components/JsonLd.tsx
index e4e9af6..82c075e 100644
--- a/src/components/JsonLd.tsx
+++ b/src/components/JsonLd.tsx
@@ -1,257 +1,267 @@
-import Script from 'next/script';
+import Script from "next/script";
 
 interface ProductJsonLdProps {
-    product: {
-        name: string;
-        description: string;
-        price: number;
-        image: string;
-        images?: string[];
-        sku: string;
-        slug?: string;
-        stock?: number;
-        colors?: string[];
-        sizes?: string[];
-        category?: string;
-        availability?: 'InStock' | 'OutOfStock' | 'PreOrder';
-    };
-    reviews?: {
-        rating: number;
-        author: string;
-        text: string;
-    }[];
+  product: {
+    name: string;
+    description: string;
+    price: number;
+    image: string;
+    images?: string[];
+    sku: string;
+    slug?: string;
+    stock?: number;
+    colors?: string[];
+    sizes?: string[];
+    category?: string;
+    availability?: "InStock" | "OutOfStock" | "PreOrder";
+  };
+  reviews?: {
+    rating: number;
+    author: string;
+    text: string;
+  }[];
 }
 
 export function ProductJsonLd({ product, reviews = [] }: ProductJsonLdProps) {
-    const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || 'https://harp-dz.com';
-    
-    // Calculate aggregate rating from reviews
-    const aggregateRating = reviews.length > 0 ? {
-        "@type": "AggregateRating",
-        "ratingValue": (reviews.reduce((acc, r) => acc + r.rating, 0) / reviews.length).toFixed(1),
-        "reviewCount": reviews.length,
-        "bestRating": "5",
-        "worstRating": "1"
-    } : undefined;
+  const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || "https://harp-dz.com";
 
-    const jsonLd = {
-        "@context": "https://schema.org",
-        "@type": "Product",
-        "name": product.name,
-        "description": product.description,
-        "image": product.images || [product.image],
-        "sku": product.sku,
-        "url": product.slug ? `${baseUrl}/product/${product.slug}` : undefined,
-        "brand": {
-            "@type": "Brand",
-            "name": "Harp",
-            "logo": `${baseUrl}/logo.svg`
+  // Calculate aggregate rating from reviews
+  const aggregateRating =
+    reviews.length > 0
+      ? {
+          "@type": "AggregateRating",
+          ratingValue: (
+            reviews.reduce((acc, r) => acc + r.rating, 0) / reviews.length
+          ).toFixed(1),
+          reviewCount: reviews.length,
+          bestRating: "5",
+          worstRating: "1",
+        }
+      : undefined;
+
+  const jsonLd = {
+    "@context": "https://schema.org",
+    "@type": "Product",
+    name: product.name,
+    description: product.description,
+    image: product.images || [product.image],
+    sku: product.sku,
+    url: product.slug ? `${baseUrl}/product/${product.slug}` : undefined,
+    brand: {
+      "@type": "Brand",
+      name: "Harp",
+      logo: `${baseUrl}/logo.svg`,
+    },
+    category: product.category || "Vêtements femme",
+    color: product.colors?.join(", "),
+    size: product.sizes?.join(", "),
+    offers: {
+      "@type": "Offer",
+      priceCurrency: "DZD",
+      price: product.price,
+      availability: `https://schema.org/${product.stock && product.stock > 0 ? "InStock" : product.availability || "InStock"}`,
+      itemCondition: "https://schema.org/NewCondition",
+      seller: {
+        "@type": "Organization",
+        name: "Harp",
+      },
+      shippingDetails: {
+        "@type": "OfferShippingDetails",
+        shippingRate: {
+          "@type": "MonetaryAmount",
+          value: "400",
+          currency: "DZD",
+        },
+        shippingDestination: {
+          "@type": "DefinedRegion",
+          addressCountry: "DZ",
+        },
+        deliveryTime: {
+          "@type": "ShippingDeliveryTime",
+          handlingTime: {
+            "@type": "QuantitativeValue",
+            minValue: 1,
+            maxValue: 2,
+            unitCode: "DAY",
+          },
+          transitTime: {
+            "@type": "QuantitativeValue",
+            minValue: 1,
+            maxValue: 3,
+            unitCode: "DAY",
+          },
         },
-        "category": product.category || "Vêtements femme",
-        "color": product.colors?.join(', '),
-        "size": product.sizes?.join(', '),
-        "offers": {
-            "@type": "Offer",
-            "priceCurrency": "DZD",
-            "price": product.price,
-            "availability": `https://schema.org/${product.stock && product.stock > 0 ? 'InStock' : product.availability || 'InStock'}`,
-            "itemCondition": "https://schema.org/NewCondition",
-            "seller": {
-                "@type": "Organization",
-                "name": "Harp"
-            },
-            "shippingDetails": {
-                "@type": "OfferShippingDetails",
-                "shippingRate": {
-                    "@type": "MonetaryAmount",
-                    "value": "400",
-                    "currency": "DZD"
-                },
-                "shippingDestination": {
-                    "@type": "DefinedRegion",
-                    "addressCountry": "DZ"
-                },
-                "deliveryTime": {
-                    "@type": "ShippingDeliveryTime",
-                    "handlingTime": {
-                        "@type": "QuantitativeValue",
-                        "minValue": 1,
-                        "maxValue": 2,
-                        "unitCode": "DAY"
-                    },
-                    "transitTime": {
-                        "@type": "QuantitativeValue",
-                        "minValue": 1,
-                        "maxValue": 3,
-                        "unitCode": "DAY"
-                    }
-                }
-            },
-            "hasMerchantReturnPolicy": {
-                "@type": "MerchantReturnPolicy",
-                "applicableCountry": "DZ",
-                "returnPolicyCategory": "https://schema.org/MerchantReturnFiniteReturnWindow",
-                "merchantReturnDays": 2,
-                "returnMethod": "https://schema.org/ReturnByMail"
-            }
+      },
+      hasMerchantReturnPolicy: {
+        "@type": "MerchantReturnPolicy",
+        applicableCountry: "DZ",
+        returnPolicyCategory:
+          "https://schema.org/MerchantReturnFiniteReturnWindow",
+        merchantReturnDays: 2,
+        returnMethod: "https://schema.org/ReturnByMail",
+      },
+    },
+    ...(aggregateRating && { aggregateRating }),
+    ...(reviews.length > 0 && {
+      review: reviews.map((r) => ({
+        "@type": "Review",
+        reviewRating: {
+          "@type": "Rating",
+          ratingValue: r.rating,
+          bestRating: "5",
         },
-        ...(aggregateRating && { aggregateRating }),
-        ...(reviews.length > 0 && {
-            "review": reviews.map(r => ({
-                "@type": "Review",
-                "reviewRating": {
-                    "@type": "Rating",
-                    "ratingValue": r.rating,
-                    "bestRating": "5"
-                },
-                "author": {
-                    "@type": "Person",
-                    "name": r.author
-                },
-                "reviewBody": r.text
-            }))
-        })
-    };
+        author: {
+          "@type": "Person",
+          name: r.author,
+        },
+        reviewBody: r.text,
+      })),
+    }),
+  };
 
-    return (
-        <Script
-            id="product-jsonld"
-            type="application/ld+json"
-            dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
-        />
-    );
+  return (
+    <Script
+      id="product-jsonld"
+      type="application/ld+json"
+      dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
+    />
+  );
 }
 
 // FAQ Schema for product pages
 interface FAQJsonLdProps {
-    questions: { question: string; answer: string }[];
+  questions: { question: string; answer: string }[];
 }
 
 export function FAQJsonLd({ questions }: FAQJsonLdProps) {
-    const jsonLd = {
-        "@context": "https://schema.org",
-        "@type": "FAQPage",
-        "mainEntity": questions.map(q => ({
-            "@type": "Question",
-            "name": q.question,
-            "acceptedAnswer": {
-                "@type": "Answer",
-                "text": q.answer
-            }
-        }))
-    };
+  const jsonLd = {
+    "@context": "https://schema.org",
+    "@type": "FAQPage",
+    mainEntity: questions.map((q) => ({
+      "@type": "Question",
+      name: q.question,
+      acceptedAnswer: {
+        "@type": "Answer",
+        text: q.answer,
+      },
+    })),
+  };
 
-    return (
-        <Script
-            id="faq-jsonld"
-            type="application/ld+json"
-            dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
-        />
-    );
+  return (
+    <Script
+      id="faq-jsonld"
+      type="application/ld+json"
+      dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
+    />
+  );
 }
 
 // Collection/Category Schema
 interface CollectionJsonLdProps {
-    collection: {
-        name: string;
-        description?: string;
-        slug: string;
-        image?: string;
-    };
-    products?: { name: string; price: number; image: string; slug: string }[];
+  collection: {
+    name: string;
+    description?: string;
+    slug: string;
+    image?: string;
+  };
+  products?: { name: string; price: number; image: string; slug: string }[];
 }
 
-export function CollectionJsonLd({ collection, products = [] }: CollectionJsonLdProps) {
-    const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || 'https://harp-dz.com';
-    
-    const jsonLd = {
-        "@context": "https://schema.org",
-        "@type": "CollectionPage",
-        "name": collection.name,
-        "description": collection.description || `Collection ${collection.name} - Harp Algérie`,
-        "url": `${baseUrl}/collection/${collection.slug}`,
-        "image": collection.image,
-        "mainEntity": {
-            "@type": "ItemList",
-            "itemListElement": products.map((p, i) => ({
-                "@type": "ListItem",
-                "position": i + 1,
-                "url": `${baseUrl}/product/${p.slug}`,
-                "name": p.name,
-                "image": p.image
-            }))
-        }
-    };
+export function CollectionJsonLd({
+  collection,
+  products = [],
+}: CollectionJsonLdProps) {
+  const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || "https://harp-dz.com";
+
+  const jsonLd = {
+    "@context": "https://schema.org",
+    "@type": "CollectionPage",
+    name: collection.name,
+    description:
+      collection.description || `Collection ${collection.name} - Harp Algérie`,
+    url: `${baseUrl}/collection/${collection.slug}`,
+    image: collection.image,
+    mainEntity: {
+      "@type": "ItemList",
+      itemListElement: products.map((p, i) => ({
+        "@type": "ListItem",
+        position: i + 1,
+        url: `${baseUrl}/product/${p.slug}`,
+        name: p.name,
+        image: p.image,
+      })),
+    },
+  };
 
-    return (
-        <Script
-            id="collection-jsonld"
-            type="application/ld+json"
-            dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
-        />
-    );
+  return (
+    <Script
+      id="collection-jsonld"
+      type="application/ld+json"
+      dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
+    />
+  );
 }
 
 interface OrganizationJsonLdProps {
-    name?: string;
-    url?: string;
-    logo?: string;
+  name?: string;
+  url?: string;
+  logo?: string;
 }
 
-export function OrganizationJsonLd({ 
-    name = "Harp", 
-    url = "https://harp-web.com",
-    logo = "/logo.svg"
+export function OrganizationJsonLd({
+  name = "Harp",
+  url = "https://harp-web.com",
+  logo = "/logo.svg",
 }: OrganizationJsonLdProps) {
-    const jsonLd = {
-        "@context": "https://schema.org",
-        "@type": "Organization",
-        "name": name,
-        "url": url,
-        "logo": logo,
-        "sameAs": [
-            "https://www.instagram.com/harp_algeria",
-            "https://www.facebook.com/profile.php?id=61566880453440",
-            "https://www.tiktok.com/@harp.algeria"
-        ],
-        "contactPoint": {
-            "@type": "ContactPoint",
-            "telephone": "+213561777397",
-            "contactType": "customer service",
-            "availableLanguage": ["French", "Arabic"]
-        }
-    };
+  const jsonLd = {
+    "@context": "https://schema.org",
+    "@type": "Organization",
+    name: name,
+    url: url,
+    logo: logo,
+    sameAs: [
+      "https://www.instagram.com/harp_algeria",
+      "https://www.facebook.com/profile.php?id=61566880453440",
+      "https://www.tiktok.com/@harp.algeria",
+    ],
+    contactPoint: {
+      "@type": "ContactPoint",
+      telephone: "+213561777397",
+      contactType: "customer service",
+      availableLanguage: ["French", "Arabic"],
+    },
+  };
 
-    return (
-        <Script
-            id="organization-jsonld"
-            type="application/ld+json"
-            dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
-        />
-    );
+  return (
+    <Script
+      id="organization-jsonld"
+      type="application/ld+json"
+      dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
+    />
+  );
 }
 
 interface BreadcrumbJsonLdProps {
-    items: { name: string; url: string }[];
+  items: { name: string; url: string }[];
 }
 
 export function BreadcrumbJsonLd({ items }: BreadcrumbJsonLdProps) {
-    const jsonLd = {
-        "@context": "https://schema.org",
-        "@type": "BreadcrumbList",
-        "itemListElement": items.map((item, index) => ({
-            "@type": "ListItem",
-            "position": index + 1,
-            "name": item.name,
-            "item": item.url
-        }))
-    };
+  const jsonLd = {
+    "@context": "https://schema.org",
+    "@type": "BreadcrumbList",
+    itemListElement: items.map((item, index) => ({
+      "@type": "ListItem",
+      position: index + 1,
+      name: item.name,
+      item: item.url,
+    })),
+  };
 
-    return (
-        <Script
-            id="breadcrumb-jsonld"
-            type="application/ld+json"
-            dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
-        />
-    );
+  return (
+    <Script
+      id="breadcrumb-jsonld"
+      type="application/ld+json"
+      dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}
+    />
+  );
 }
diff --git a/src/components/LanguageProvider.tsx b/src/components/LanguageProvider.tsx
index a06738a..940556d 100644
--- a/src/components/LanguageProvider.tsx
+++ b/src/components/LanguageProvider.tsx
@@ -5,53 +5,55 @@ import React, { createContext, useContext, useState, useEffect } from "react";
 type Language = "fr" | "ar";
 
 interface LanguageContextType {
-    language: Language;
-    setLanguage: (lang: Language) => void;
-    dir: "ltr" | "rtl";
-    t: (key: string) => string;
+  language: Language;
+  setLanguage: (lang: Language) => void;
+  dir: "ltr" | "rtl";
+  t: (key: string) => string;
 }
 
-const LanguageContext = createContext<LanguageContextType | undefined>(undefined);
+const LanguageContext = createContext<LanguageContextType | undefined>(
+  undefined,
+);
 
 import { translations } from "@/lib/translations";
 
 export function LanguageProvider({ children }: { children: React.ReactNode }) {
-    const [language, setLanguage] = useState<Language>("fr");
-
-    useEffect(() => {
-        document.documentElement.lang = language;
-        document.documentElement.dir = language === "ar" ? "rtl" : "ltr";
-    }, [language]);
-
-    const t = (key: string) => {
-        const keys = key.split('.');
-        let value: any = translations[language];
-        
-        for (const k of keys) {
-            value = value?.[k as keyof typeof value];
-        }
-        
-        return (value as string) || (translations[language] as any)[key] || key;
-    };
-
-    return (
-        <LanguageContext.Provider
-            value={{
-                language,
-                setLanguage,
-                dir: language === "ar" ? "rtl" : "ltr",
-                t,
-            }}
-        >
-            {children}
-        </LanguageContext.Provider>
-    );
+  const [language, setLanguage] = useState<Language>("fr");
+
+  useEffect(() => {
+    document.documentElement.lang = language;
+    document.documentElement.dir = language === "ar" ? "rtl" : "ltr";
+  }, [language]);
+
+  const t = (key: string) => {
+    const keys = key.split(".");
+    let value: any = translations[language];
+
+    for (const k of keys) {
+      value = value?.[k as keyof typeof value];
+    }
+
+    return (value as string) || (translations[language] as any)[key] || key;
+  };
+
+  return (
+    <LanguageContext.Provider
+      value={{
+        language,
+        setLanguage,
+        dir: language === "ar" ? "rtl" : "ltr",
+        t,
+      }}
+    >
+      {children}
+    </LanguageContext.Provider>
+  );
 }
 
 export function useLanguage() {
-    const context = useContext(LanguageContext);
-    if (context === undefined) {
-        throw new Error("useLanguage must be used within a LanguageProvider");
-    }
-    return context;
+  const context = useContext(LanguageContext);
+  if (context === undefined) {
+    throw new Error("useLanguage must be used within a LanguageProvider");
+  }
+  return context;
 }
diff --git a/src/components/LoyaltyWidget.tsx b/src/components/LoyaltyWidget.tsx
index f65c765..6ba8104 100644
--- a/src/components/LoyaltyWidget.tsx
+++ b/src/components/LoyaltyWidget.tsx
@@ -1,263 +1,318 @@
 "use client";
 
 import { useState, useEffect } from "react";
-import { Gift, Star, Award, ChevronRight, Loader2, X, Sparkles } from "lucide-react";
+import {
+  Gift,
+  Star,
+  Award,
+  ChevronRight,
+  Loader2,
+  X,
+  Sparkles,
+} from "lucide-react";
 import { cn } from "@/lib/utils";
 
 interface LoyaltyConfig {
-    pointsPerDinar: number;
-    redeemThreshold: number;
-    redeemValue: number;
-    birthdayBonus: number;
-    reviewBonus: number;
-    firstOrderBonus: number;
+  pointsPerDinar: number;
+  redeemThreshold: number;
+  redeemValue: number;
+  birthdayBonus: number;
+  reviewBonus: number;
+  firstOrderBonus: number;
 }
 
 interface Customer {
-    id: string;
-    phone: string;
-    name?: string;
-    points: number;
-    totalSpent: number;
-    totalOrders: number;
-    redeemablePoints: number;
-    redeemableValue: number;
+  id: string;
+  phone: string;
+  name?: string;
+  points: number;
+  totalSpent: number;
+  totalOrders: number;
+  redeemablePoints: number;
+  redeemableValue: number;
 }
 
 interface LoyaltyWidgetProps {
-    phone?: string;
-    className?: string;
-    onPointsRedeemed?: (discount: number) => void;
+  phone?: string;
+  className?: string;
+  onPointsRedeemed?: (discount: number) => void;
 }
 
-export function LoyaltyWidget({ phone: initialPhone, className, onPointsRedeemed }: LoyaltyWidgetProps) {
-    const [isOpen, setIsOpen] = useState(false);
-    const [phone, setPhone] = useState(initialPhone || "");
-    const [customer, setCustomer] = useState<Customer | null>(null);
-    const [config, setConfig] = useState<LoyaltyConfig | null>(null);
-    const [loading, setLoading] = useState(false);
-    const [error, setError] = useState("");
+export function LoyaltyWidget({
+  phone: initialPhone,
+  className,
+  onPointsRedeemed,
+}: LoyaltyWidgetProps) {
+  const [isOpen, setIsOpen] = useState(false);
+  const [phone, setPhone] = useState(initialPhone || "");
+  const [customer, setCustomer] = useState<Customer | null>(null);
+  const [config, setConfig] = useState<LoyaltyConfig | null>(null);
+  const [loading, setLoading] = useState(false);
+  const [error, setError] = useState("");
 
-    const checkLoyalty = async (phoneNumber: string) => {
-        if (!phoneNumber || phoneNumber.length < 10) return;
-        
-        setLoading(true);
-        setError("");
+  const checkLoyalty = async (phoneNumber: string) => {
+    if (!phoneNumber || phoneNumber.length < 10) return;
 
-        try {
-            const res = await fetch(`/api/loyalty?phone=${encodeURIComponent(phoneNumber)}`);
-            const data = await res.json();
+    setLoading(true);
+    setError("");
 
-            if (res.ok) {
-                setConfig(data.config);
-                if (data.exists) {
-                    setCustomer(data.customer);
-                } else {
-                    setCustomer(null);
-                }
-            }
-        } catch {
-            setError("Erreur de connexion");
-        } finally {
-            setLoading(false);
+    try {
+      const res = await fetch(
+        `/api/loyalty?phone=${encodeURIComponent(phoneNumber)}`,
+      );
+      const data = await res.json();
+
+      if (res.ok) {
+        setConfig(data.config);
+        if (data.exists) {
+          setCustomer(data.customer);
+        } else {
+          setCustomer(null);
         }
-    };
+      }
+    } catch {
+      setError("Erreur de connexion");
+    } finally {
+      setLoading(false);
+    }
+  };
 
-    const handleRedeem = async () => {
-        if (!customer || customer.redeemablePoints < (config?.redeemThreshold || 2000)) return;
+  const handleRedeem = async () => {
+    if (
+      !customer ||
+      customer.redeemablePoints < (config?.redeemThreshold || 2000)
+    )
+      return;
 
-        setLoading(true);
-        try {
-            const res = await fetch("/api/loyalty", {
-                method: "POST",
-                headers: { "Content-Type": "application/json" },
-                body: JSON.stringify({
-                    phone: customer.phone,
-                    action: "REDEEM",
-                }),
-            });
+    setLoading(true);
+    try {
+      const res = await fetch("/api/loyalty", {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify({
+          phone: customer.phone,
+          action: "REDEEM",
+        }),
+      });
 
-            const data = await res.json();
+      const data = await res.json();
 
-            if (res.ok) {
-                setCustomer(data.customer);
-                if (onPointsRedeemed) {
-                    const discount = (config?.redeemThreshold || 2000) / (config?.redeemThreshold || 2000) * (config?.redeemValue || 200);
-                    onPointsRedeemed(discount);
-                }
-            }
-        } catch {
-            setError("Erreur lors de la conversion");
-        } finally {
-            setLoading(false);
+      if (res.ok) {
+        setCustomer(data.customer);
+        if (onPointsRedeemed) {
+          const discount =
+            ((config?.redeemThreshold || 2000) /
+              (config?.redeemThreshold || 2000)) *
+            (config?.redeemValue || 200);
+          onPointsRedeemed(discount);
         }
-    };
-
-    useEffect(() => {
-        if (initialPhone) {
-            checkLoyalty(initialPhone);
-        }
-    }, [initialPhone]);
+      }
+    } catch {
+      setError("Erreur lors de la conversion");
+    } finally {
+      setLoading(false);
+    }
+  };
 
-    // Mini badge (closed state)
-    if (!isOpen) {
-        return (
-            <button
-                onClick={() => setIsOpen(true)}
-                className={cn(
-                    "fixed bottom-24 right-4 z-40 bg-gradient-to-r from-amber-500 to-amber-600 text-white px-4 py-3 rounded-full shadow-lg hover:shadow-xl transition-all flex items-center gap-2 group",
-                    className
-                )}
-            >
-                <Gift size={20} />
-                <span className="font-medium">Programme Fidélité</span>
-                <ChevronRight size={16} className="group-hover:translate-x-1 transition-transform" />
-            </button>
-        );
+  useEffect(() => {
+    if (initialPhone) {
+      checkLoyalty(initialPhone);
     }
+  }, [initialPhone]);
 
-    // Full widget (open state)
+  // Mini badge (closed state)
+  if (!isOpen) {
     return (
-        <div className={cn(
-            "fixed bottom-24 right-4 z-40 w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden",
-            className
-        )}>
-            {/* Header */}
-            <div className="bg-gradient-to-r from-amber-500 to-amber-600 text-white p-4">
-                <div className="flex items-center justify-between mb-2">
-                    <div className="flex items-center gap-2">
-                        <Gift size={20} />
-                        <span className="font-semibold">Programme Fidélité</span>
-                    </div>
-                    <button
-                        onClick={() => setIsOpen(false)}
-                        className="p-1 hover:bg-white/20 rounded-full transition-colors"
-                    >
-                        <X size={18} />
-                    </button>
-                </div>
-                <p className="text-sm text-white/80">
-                    Gagnez des points à chaque commande !
-                </p>
-            </div>
+      <button
+        onClick={() => setIsOpen(true)}
+        className={cn(
+          "fixed bottom-24 right-4 z-40 bg-gradient-to-r from-amber-500 to-amber-600 text-white px-4 py-3 rounded-full shadow-lg hover:shadow-xl transition-all flex items-center gap-2 group",
+          className,
+        )}
+      >
+        <Gift size={20} />
+        <span className="font-medium">Programme Fidélité</span>
+        <ChevronRight
+          size={16}
+          className="group-hover:translate-x-1 transition-transform"
+        />
+      </button>
+    );
+  }
 
-            <div className="p-4">
-                {/* Phone input */}
-                {!customer && (
-                    <div className="mb-4">
-                        <label className="block text-sm font-medium text-gray-700 mb-2">
-                            Votre numéro de téléphone
-                        </label>
-                        <div className="flex gap-2">
-                            <input
-                                type="tel"
-                                value={phone}
-                                onChange={(e) => setPhone(e.target.value)}
-                                placeholder="0550 12 34 56"
-                                className="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-500"
-                            />
-                            <button
-                                onClick={() => checkLoyalty(phone)}
-                                disabled={loading || phone.length < 10}
-                                className="px-4 py-2 bg-amber-500 text-white rounded-lg text-sm font-medium hover:bg-amber-600 transition-colors disabled:opacity-50"
-                            >
-                                {loading ? <Loader2 size={16} className="animate-spin" /> : "Vérifier"}
-                            </button>
-                        </div>
-                    </div>
-                )}
+  // Full widget (open state)
+  return (
+    <div
+      className={cn(
+        "fixed bottom-24 right-4 z-40 w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden",
+        className,
+      )}
+    >
+      {/* Header */}
+      <div className="bg-gradient-to-r from-amber-500 to-amber-600 text-white p-4">
+        <div className="flex items-center justify-between mb-2">
+          <div className="flex items-center gap-2">
+            <Gift size={20} />
+            <span className="font-semibold">Programme Fidélité</span>
+          </div>
+          <button
+            onClick={() => setIsOpen(false)}
+            className="p-1 hover:bg-white/20 rounded-full transition-colors"
+          >
+            <X size={18} />
+          </button>
+        </div>
+        <p className="text-sm text-white/80">
+          Gagnez des points à chaque commande !
+        </p>
+      </div>
 
-                {/* Customer info */}
-                {customer && (
-                    <div className="space-y-4">
-                        {/* Points balance */}
-                        <div className="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-4 text-center">
-                            <div className="flex items-center justify-center gap-2 mb-2">
-                                <Star size={20} className="text-amber-500" />
-                                <span className="text-3xl font-bold text-amber-600">{customer.points.toLocaleString()}</span>
-                            </div>
-                            <p className="text-sm text-gray-600">points disponibles</p>
-                        </div>
+      <div className="p-4">
+        {/* Phone input */}
+        {!customer && (
+          <div className="mb-4">
+            <label className="block text-sm font-medium text-gray-700 mb-2">
+              Votre numéro de téléphone
+            </label>
+            <div className="flex gap-2">
+              <input
+                type="tel"
+                value={phone}
+                onChange={(e) => setPhone(e.target.value)}
+                placeholder="0550 12 34 56"
+                className="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-500"
+              />
+              <button
+                onClick={() => checkLoyalty(phone)}
+                disabled={loading || phone.length < 10}
+                className="px-4 py-2 bg-amber-500 text-white rounded-lg text-sm font-medium hover:bg-amber-600 transition-colors disabled:opacity-50"
+              >
+                {loading ? (
+                  <Loader2 size={16} className="animate-spin" />
+                ) : (
+                  "Vérifier"
+                )}
+              </button>
+            </div>
+          </div>
+        )}
 
-                        {/* Stats */}
-                        <div className="grid grid-cols-2 gap-3">
-                            <div className="bg-gray-50 rounded-lg p-3 text-center">
-                                <p className="text-lg font-bold text-gray-900">{customer.totalOrders}</p>
-                                <p className="text-xs text-gray-500">Commandes</p>
-                            </div>
-                            <div className="bg-gray-50 rounded-lg p-3 text-center">
-                                <p className="text-lg font-bold text-gray-900">{customer.totalSpent.toLocaleString()}</p>
-                                <p className="text-xs text-gray-500">DZD dépensés</p>
-                            </div>
-                        </div>
+        {/* Customer info */}
+        {customer && (
+          <div className="space-y-4">
+            {/* Points balance */}
+            <div className="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-4 text-center">
+              <div className="flex items-center justify-center gap-2 mb-2">
+                <Star size={20} className="text-amber-500" />
+                <span className="text-3xl font-bold text-amber-600">
+                  {customer.points.toLocaleString()}
+                </span>
+              </div>
+              <p className="text-sm text-gray-600">points disponibles</p>
+            </div>
 
-                        {/* Redeem section */}
-                        {customer.redeemablePoints >= (config?.redeemThreshold || 2000) ? (
-                            <div className="bg-green-50 border border-green-200 rounded-xl p-4">
-                                <div className="flex items-center gap-2 mb-2">
-                                    <Sparkles size={18} className="text-green-600" />
-                                    <span className="font-medium text-green-800">Récompense disponible !</span>
-                                </div>
-                                <p className="text-sm text-green-700 mb-3">
-                                    Convertissez {config?.redeemThreshold || 2000} points en {config?.redeemValue || 200} DZD de réduction
-                                </p>
-                                <button
-                                    onClick={handleRedeem}
-                                    disabled={loading}
-                                    className="w-full py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50"
-                                >
-                                    {loading ? "Conversion..." : "Utiliser mes points"}
-                                </button>
-                            </div>
-                        ) : (
-                            <div className="bg-gray-50 rounded-xl p-4">
-                                <p className="text-sm text-gray-600">
-                                    Plus que <strong>{((config?.redeemThreshold || 2000) - customer.points).toLocaleString()} points</strong> pour débloquer une réduction de {config?.redeemValue || 200} DZD
-                                </p>
-                                <div className="mt-2 h-2 bg-gray-200 rounded-full overflow-hidden">
-                                    <div
-                                        className="h-full bg-amber-500 rounded-full transition-all"
-                                        style={{ width: `${Math.min(100, (customer.points / (config?.redeemThreshold || 2000)) * 100)}%` }}
-                                    />
-                                </div>
-                            </div>
-                        )}
+            {/* Stats */}
+            <div className="grid grid-cols-2 gap-3">
+              <div className="bg-gray-50 rounded-lg p-3 text-center">
+                <p className="text-lg font-bold text-gray-900">
+                  {customer.totalOrders}
+                </p>
+                <p className="text-xs text-gray-500">Commandes</p>
+              </div>
+              <div className="bg-gray-50 rounded-lg p-3 text-center">
+                <p className="text-lg font-bold text-gray-900">
+                  {customer.totalSpent.toLocaleString()}
+                </p>
+                <p className="text-xs text-gray-500">DZD dépensés</p>
+              </div>
+            </div>
 
-                        {/* Change account */}
-                        <button
-                            onClick={() => setCustomer(null)}
-                            className="w-full text-sm text-gray-500 hover:text-gray-700"
-                        >
-                            Changer de compte
-                        </button>
-                    </div>
-                )}
+            {/* Redeem section */}
+            {customer.redeemablePoints >= (config?.redeemThreshold || 2000) ? (
+              <div className="bg-green-50 border border-green-200 rounded-xl p-4">
+                <div className="flex items-center gap-2 mb-2">
+                  <Sparkles size={18} className="text-green-600" />
+                  <span className="font-medium text-green-800">
+                    Récompense disponible !
+                  </span>
+                </div>
+                <p className="text-sm text-green-700 mb-3">
+                  Convertissez {config?.redeemThreshold || 2000} points en{" "}
+                  {config?.redeemValue || 200} DZD de réduction
+                </p>
+                <button
+                  onClick={handleRedeem}
+                  disabled={loading}
+                  className="w-full py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50"
+                >
+                  {loading ? "Conversion..." : "Utiliser mes points"}
+                </button>
+              </div>
+            ) : (
+              <div className="bg-gray-50 rounded-xl p-4">
+                <p className="text-sm text-gray-600">
+                  Plus que{" "}
+                  <strong>
+                    {(
+                      (config?.redeemThreshold || 2000) - customer.points
+                    ).toLocaleString()}{" "}
+                    points
+                  </strong>{" "}
+                  pour débloquer une réduction de {config?.redeemValue || 200}{" "}
+                  DZD
+                </p>
+                <div className="mt-2 h-2 bg-gray-200 rounded-full overflow-hidden">
+                  <div
+                    className="h-full bg-amber-500 rounded-full transition-all"
+                    style={{
+                      width: `${Math.min(100, (customer.points / (config?.redeemThreshold || 2000)) * 100)}%`,
+                    }}
+                  />
+                </div>
+              </div>
+            )}
 
-                {/* How it works */}
-                {!customer && (
-                    <div className="space-y-3 mt-4 pt-4 border-t border-gray-100">
-                        <p className="text-sm font-medium text-gray-900">Comment ça marche ?</p>
-                        <div className="space-y-2">
-                            <div className="flex items-start gap-2 text-sm">
-                                <Award size={16} className="text-amber-500 mt-0.5 shrink-0" />
-                                <span className="text-gray-600">1 DZD = 1 point sur chaque commande</span>
-                            </div>
-                            <div className="flex items-start gap-2 text-sm">
-                                <Gift size={16} className="text-amber-500 mt-0.5 shrink-0" />
-                                <span className="text-gray-600">2000 points = 200 DZD de réduction</span>
-                            </div>
-                            <div className="flex items-start gap-2 text-sm">
-                                <Star size={16} className="text-amber-500 mt-0.5 shrink-0" />
-                                <span className="text-gray-600">Bonus anniversaire + premier achat</span>
-                            </div>
-                        </div>
-                    </div>
-                )}
+            {/* Change account */}
+            <button
+              onClick={() => setCustomer(null)}
+              className="w-full text-sm text-gray-500 hover:text-gray-700"
+            >
+              Changer de compte
+            </button>
+          </div>
+        )}
 
-                {error && (
-                    <p className="text-red-600 text-sm mt-2">{error}</p>
-                )}
+        {/* How it works */}
+        {!customer && (
+          <div className="space-y-3 mt-4 pt-4 border-t border-gray-100">
+            <p className="text-sm font-medium text-gray-900">
+              Comment ça marche ?
+            </p>
+            <div className="space-y-2">
+              <div className="flex items-start gap-2 text-sm">
+                <Award size={16} className="text-amber-500 mt-0.5 shrink-0" />
+                <span className="text-gray-600">
+                  1 DZD = 1 point sur chaque commande
+                </span>
+              </div>
+              <div className="flex items-start gap-2 text-sm">
+                <Gift size={16} className="text-amber-500 mt-0.5 shrink-0" />
+                <span className="text-gray-600">
+                  2000 points = 200 DZD de réduction
+                </span>
+              </div>
+              <div className="flex items-start gap-2 text-sm">
+                <Star size={16} className="text-amber-500 mt-0.5 shrink-0" />
+                <span className="text-gray-600">
+                  Bonus anniversaire + premier achat
+                </span>
+              </div>
             </div>
-        </div>
-    );
+          </div>
+        )}
+
+        {error && <p className="text-red-600 text-sm mt-2">{error}</p>}
+      </div>
+    </div>
+  );
 }
diff --git a/src/components/MainLayout.tsx b/src/components/MainLayout.tsx
index 2d63fcd..8beb17b 100644
--- a/src/components/MainLayout.tsx
+++ b/src/components/MainLayout.tsx
@@ -10,47 +10,43 @@ import { useLanguage } from "./LanguageProvider";
 
 // Custom hook to detect client-side mounting
 function useIsMounted() {
-    return useSyncExternalStore(
-        () => () => {},
-        () => true,
-        () => false
-    );
+  return useSyncExternalStore(
+    () => () => {},
+    () => true,
+    () => false,
+  );
 }
 
 export function MainLayout({ children }: { children: React.ReactNode }) {
-    const pathname = usePathname();
-    const isMounted = useIsMounted();
-    const { language } = useLanguage();
-    
-    const isAdmin = useMemo(() => {
-        return pathname?.startsWith("/admin") || false;
-    }, [pathname]);
-
-    // Show loading or neutral state during hydration
-    if (!isMounted) {
-        return (
-            <div className="bg-harp-beige text-harp-brown">
-                <main className="min-h-screen">
-                    {children}
-                </main>
-            </div>
-        );
-    }
+  const pathname = usePathname();
+  const isMounted = useIsMounted();
+  const { language } = useLanguage();
 
-    if (isAdmin) {
-        // Admin pages have their own layout, no header/footer
-        return <>{children}</>;
-    }
+  const isAdmin = useMemo(() => {
+    return pathname?.startsWith("/admin") || false;
+  }, [pathname]);
 
+  // Show loading or neutral state during hydration
+  if (!isMounted) {
     return (
-        <div className="bg-harp-beige text-harp-brown">
-            <PromoBanner lang={language} />
-            <Header />
-            <CartDrawer />
-            <main className="min-h-screen">
-                {children}
-            </main>
-            <Footer />
-        </div>
+      <div className="bg-harp-beige text-harp-brown">
+        <main className="min-h-screen">{children}</main>
+      </div>
     );
+  }
+
+  if (isAdmin) {
+    // Admin pages have their own layout, no header/footer
+    return <>{children}</>;
+  }
+
+  return (
+    <div className="bg-harp-beige text-harp-brown">
+      <PromoBanner lang={language} />
+      <Header />
+      <CartDrawer />
+      <main className="min-h-screen">{children}</main>
+      <Footer />
+    </div>
+  );
 }
diff --git a/src/components/ProductCard.tsx b/src/components/ProductCard.tsx
index d8f308e..0153259 100644
--- a/src/components/ProductCard.tsx
+++ b/src/components/ProductCard.tsx
@@ -8,104 +8,131 @@ import { useLanguage } from "./LanguageProvider";
 import { formatPrice } from "@/lib/utils";
 
 interface ProductCardProps {
-    id: string;
-    name: string;
-    price: number | string | any; // Support Prisma Decimal
-    image: string;
-    category?: string;
-    isNew?: boolean;
-    originalPrice?: number | string | any;
+  id: string;
+  name: string;
+  price: number | string | any; // Support Prisma Decimal
+  image: string;
+  category?: string;
+  isNew?: boolean;
+  originalPrice?: number | string | any;
 }
 
-export function ProductCard({ id, name, price, image, category, isNew, originalPrice }: ProductCardProps) {
-    const { t } = useLanguage();
-    const [isWishlisted, setIsWishlisted] = useState(false);
-    const [imageError, setImageError] = useState(false);
+export function ProductCard({
+  id,
+  name,
+  price,
+  image,
+  category,
+  isNew,
+  originalPrice,
+}: ProductCardProps) {
+  const { t } = useLanguage();
+  const [isWishlisted, setIsWishlisted] = useState(false);
+  const [imageError, setImageError] = useState(false);
 
-    // Fallback image
-    const fallbackImage = `https://placehold.co/600x800/F5F1EC/4A3A2A?text=${encodeURIComponent(name)}`;
+  // Fallback image
+  const fallbackImage = `https://placehold.co/600x800/F5F1EC/4A3A2A?text=${encodeURIComponent(name)}`;
 
-    const numericPrice = typeof price === 'object' && 'toNumber' in price ? price.toNumber() : Number(price);
-    const numericOriginalPrice = originalPrice ? (typeof originalPrice === 'object' && 'toNumber' in originalPrice ? originalPrice.toNumber() : Number(originalPrice)) : 0;
+  const numericPrice =
+    typeof price === "object" && "toNumber" in price
+      ? price.toNumber()
+      : Number(price);
+  const numericOriginalPrice = originalPrice
+    ? typeof originalPrice === "object" && "toNumber" in originalPrice
+      ? originalPrice.toNumber()
+      : Number(originalPrice)
+    : 0;
 
-    const discount = numericOriginalPrice ? Math.round((1 - numericPrice / numericOriginalPrice) * 100) : 0;
+  const discount = numericOriginalPrice
+    ? Math.round((1 - numericPrice / numericOriginalPrice) * 100)
+    : 0;
 
-    return (
-        <div className="group relative card-hover rounded-2xl overflow-hidden bg-white">
-            <Link href={`/product/${id}`} className="block h-full">
-                {/* Image Container */}
-                <div className="relative aspect-[3/4] overflow-hidden bg-gradient-to-br from-gray-50 to-gray-100">
-                    <Image
-                        src={imageError ? fallbackImage : image}
-                        alt={name}
-                        fill
-                        sizes="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 25vw"
-                        className="object-cover img-zoom"
-                        onError={() => setImageError(true)}
-                    />
+  return (
+    <div className="group relative card-hover rounded-2xl overflow-hidden bg-white">
+      <Link href={`/product/${id}`} className="block h-full">
+        {/* Image Container */}
+        <div className="relative aspect-[3/4] overflow-hidden bg-gradient-to-br from-gray-50 to-gray-100">
+          <Image
+            src={imageError ? fallbackImage : image}
+            alt={name}
+            fill
+            sizes="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 25vw"
+            className="object-cover img-zoom"
+            onError={() => setImageError(true)}
+          />
 
-                    {/* Gradient overlay on hover */}
-                    <div className="absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500" />
+          {/* Gradient overlay on hover */}
+          <div className="absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500" />
 
-                    {/* Quick View Button */}
-                    <div className="absolute bottom-0 left-0 right-0 p-4 opacity-0 translate-y-4 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-500">
-                        <span className="glass block text-harp-brown px-6 py-3 text-xs uppercase tracking-widest font-medium text-center rounded-xl hover:bg-harp-brown hover:text-white transition-all duration-300">
-                            {t("product.card.view")}
-                        </span>
-                    </div>
+          {/* Quick View Button */}
+          <div className="absolute bottom-0 left-0 right-0 p-4 opacity-0 translate-y-4 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-500">
+            <span className="glass block text-harp-brown px-6 py-3 text-xs uppercase tracking-widest font-medium text-center rounded-xl hover:bg-harp-brown hover:text-white transition-all duration-300">
+              {t("product.card.view")}
+            </span>
+          </div>
 
-                    {/* Badges */}
-                    <div className="absolute top-4 left-4 flex flex-col gap-2">
-                        {isNew && (
-                            <span className="glass text-harp-brown text-[10px] uppercase tracking-widest px-3 py-1.5 font-semibold rounded-full shadow-sm">
-                                ✨ {t("shop.badge.new")}
-                            </span>
-                        )}
-                        {discount > 0 && (
-                            <span className="bg-gradient-to-r from-harp-brown to-harp-caramel text-white text-[10px] uppercase tracking-widest px-3 py-1.5 font-semibold rounded-full shadow-sm">
-                                -{discount}%
-                            </span>
-                        )}
-                    </div>
-                </div>
-
-                {/* Product Info */}
-                <div className="p-4 text-center">
-                    {category && (
-                        <p className="text-[10px] text-harp-caramel uppercase tracking-[0.2em] mb-2 font-medium">{category}</p>
-                    )}
-                    <h3 className="font-serif text-lg text-harp-brown mb-3 group-hover:text-harp-caramel transition-colors duration-300 line-clamp-1">
-                        {name}
-                    </h3>
-                    <div className="flex items-center justify-center gap-3">
-                        <p className="text-base font-semibold text-harp-brown">{formatPrice(price)}</p>
-                        {originalPrice && (
-                            <p className="text-sm text-gray-400 line-through">{formatPrice(originalPrice)}</p>
-                        )}
-                    </div>
-                </div>
-            </Link>
+          {/* Badges */}
+          <div className="absolute top-4 left-4 flex flex-col gap-2">
+            {isNew && (
+              <span className="glass text-harp-brown text-[10px] uppercase tracking-widest px-3 py-1.5 font-semibold rounded-full shadow-sm">
+                ✨ {t("shop.badge.new")}
+              </span>
+            )}
+            {discount > 0 && (
+              <span className="bg-gradient-to-r from-harp-brown to-harp-caramel text-white text-[10px] uppercase tracking-widest px-3 py-1.5 font-semibold rounded-full shadow-sm">
+                -{discount}%
+              </span>
+            )}
+          </div>
+        </div>
 
-            {/* Wishlist button */}
-            <button
-                onClick={(e) => {
-                    e.preventDefault();
-                    setIsWishlisted(!isWishlisted);
-                }}
-                className={`absolute top-4 right-4 p-3 rounded-full shadow-lg transition-all duration-300 z-10 ${
-                    isWishlisted 
-                        ? 'bg-red-50 scale-110' 
-                        : 'glass opacity-0 group-hover:opacity-100'
-                }`}
-                aria-label={isWishlisted ? t("product.card.wishlist.remove") : t("product.card.wishlist.add")}
-            >
-                <Heart
-                    size={18}
-                    className={`transition-all duration-300 ${
-                        isWishlisted ? "fill-red-500 text-red-500" : "text-harp-brown"
-                    }`}
-                />
-            </button>
+        {/* Product Info */}
+        <div className="p-4 text-center">
+          {category && (
+            <p className="text-[10px] text-harp-caramel uppercase tracking-[0.2em] mb-2 font-medium">
+              {category}
+            </p>
+          )}
+          <h3 className="font-serif text-lg text-harp-brown mb-3 group-hover:text-harp-caramel transition-colors duration-300 line-clamp-1">
+            {name}
+          </h3>
+          <div className="flex items-center justify-center gap-3">
+            <p className="text-base font-semibold text-harp-brown">
+              {formatPrice(price)}
+            </p>
+            {originalPrice && (
+              <p className="text-sm text-gray-400 line-through">
+                {formatPrice(originalPrice)}
+              </p>
+            )}
+          </div>
         </div>
-    );
+      </Link>
+
+      {/* Wishlist button */}
+      <button
+        onClick={(e) => {
+          e.preventDefault();
+          setIsWishlisted(!isWishlisted);
+        }}
+        className={`absolute top-4 right-4 p-3 rounded-full shadow-lg transition-all duration-300 z-10 ${
+          isWishlisted
+            ? "bg-red-50 scale-110"
+            : "glass opacity-0 group-hover:opacity-100"
+        }`}
+        aria-label={
+          isWishlisted
+            ? t("product.card.wishlist.remove")
+            : t("product.card.wishlist.add")
+        }
+      >
+        <Heart
+          size={18}
+          className={`transition-all duration-300 ${
+            isWishlisted ? "fill-red-500 text-red-500" : "text-harp-brown"
+          }`}
+        />
+      </button>
+    </div>
+  );
 }
diff --git a/src/components/SessionProvider.tsx b/src/components/SessionProvider.tsx
index 6b36b1c..e194e5f 100644
--- a/src/components/SessionProvider.tsx
+++ b/src/components/SessionProvider.tsx
@@ -3,5 +3,5 @@
 import { SessionProvider as NextAuthSessionProvider } from "next-auth/react";
 
 export function SessionProvider({ children }: { children: React.ReactNode }) {
-    return <NextAuthSessionProvider>{children}</NextAuthSessionProvider>;
+  return <NextAuthSessionProvider>{children}</NextAuthSessionProvider>;
 }
diff --git a/src/components/Skeleton.tsx b/src/components/Skeleton.tsx
index 0b11c0e..ff7c47f 100644
--- a/src/components/Skeleton.tsx
+++ b/src/components/Skeleton.tsx
@@ -3,53 +3,53 @@
 import { cn } from "@/lib/utils";
 
 interface SkeletonProps {
-    className?: string;
+  className?: string;
 }
 
 export function Skeleton({ className }: SkeletonProps) {
-    return (
-        <div
-            className={cn(
-                "bg-gradient-to-r from-gray-200 via-gray-100 to-gray-200 bg-[length:200%_100%] animate-shimmer rounded",
-                className
-            )}
-        />
-    );
+  return (
+    <div
+      className={cn(
+        "bg-gradient-to-r from-gray-200 via-gray-100 to-gray-200 bg-[length:200%_100%] animate-shimmer rounded",
+        className,
+      )}
+    />
+  );
 }
 
 export function ProductCardSkeleton() {
-    return (
-        <div className="block">
-            <Skeleton className="aspect-[3/4] mb-4" />
-            <div className="text-center space-y-2">
-                <Skeleton className="h-3 w-20 mx-auto" />
-                <Skeleton className="h-5 w-32 mx-auto" />
-                <Skeleton className="h-4 w-16 mx-auto" />
-            </div>
-        </div>
-    );
+  return (
+    <div className="block">
+      <Skeleton className="aspect-[3/4] mb-4" />
+      <div className="text-center space-y-2">
+        <Skeleton className="h-3 w-20 mx-auto" />
+        <Skeleton className="h-5 w-32 mx-auto" />
+        <Skeleton className="h-4 w-16 mx-auto" />
+      </div>
+    </div>
+  );
 }
 
 export function ProductGridSkeleton({ count = 4 }: { count?: number }) {
-    return (
-        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
-            {Array.from({ length: count }).map((_, i) => (
-                <ProductCardSkeleton key={i} />
-            ))}
-        </div>
-    );
+  return (
+    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
+      {Array.from({ length: count }).map((_, i) => (
+        <ProductCardSkeleton key={i} />
+      ))}
+    </div>
+  );
 }
 
 export function HeroSkeleton() {
-    return (
-        <div className="relative h-[80vh] w-full bg-gray-100">
-            <div className="absolute inset-0 flex items-center justify-center">
-                <div className="max-w-2xl bg-white/80 p-8 md:p-12 space-y-4">
-                    <Skeleton className="h-12 w-64 mx-auto" />
-                    <Skeleton className="h-6 w-80 mx-auto" />
-                    <Skeleton className="h-12 w-48 mx-auto mt-8" />
-                </div>
-            </div>
+  return (
+    <div className="relative h-[80vh] w-full bg-gray-100">
+      <div className="absolute inset-0 flex items-center justify-center">
+        <div className="max-w-2xl bg-white/80 p-8 md:p-12 space-y-4">
+          <Skeleton className="h-12 w-64 mx-auto" />
+          <Skeleton className="h-6 w-80 mx-auto" />
+          <Skeleton className="h-12 w-48 mx-auto mt-8" />
         </div>
-    );
+      </div>
+    </div>
+  );
 }
diff --git a/src/components/admin/AdminHeroEditor.tsx b/src/components/admin/AdminHeroEditor.tsx
index 436ad39..a3b3c25 100644
--- a/src/components/admin/AdminHeroEditor.tsx
+++ b/src/components/admin/AdminHeroEditor.tsx
@@ -1,18 +1,18 @@
 "use client";
 
 import { useState, useRef } from "react";
-import { 
-  Upload, 
-  Image as ImageIcon, 
-  Smartphone, 
-  Monitor, 
-  Eye, 
-  Save, 
-  RotateCcw, 
+import {
+  Upload,
+  Image as ImageIcon,
+  Smartphone,
+  Monitor,
+  Eye,
+  Save,
+  RotateCcw,
   Loader2,
   Trash2,
   History,
-  X
+  X,
 } from "lucide-react";
 import { cn } from "@/lib/utils";
 
@@ -42,7 +42,7 @@ const PRESETS = [
   { value: "classic", label: "Classique", desc: "Texte en bas à gauche" },
   { value: "minimal", label: "Minimal", desc: "Texte centré, simple" },
   { value: "glass", label: "Glass", desc: "Effet verre dépoli" },
-  { value: "centered", label: "Centré", desc: "Tout centré" }
+  { value: "centered", label: "Centré", desc: "Tout centré" },
 ];
 
 export default function AdminHeroEditor({ initial }: Props) {
@@ -59,15 +59,20 @@ export default function AdminHeroEditor({ initial }: Props) {
     heroOverlayOpacity: initial?.heroOverlayOpacity ?? 0.35,
     heroPreset: initial?.heroPreset || "classic",
     heroActive: initial?.heroActive ?? true,
-    heroVariant: initial?.heroVariant || "image"
+    heroVariant: initial?.heroVariant || "image",
   });
 
-  const [previewMode, setPreviewMode] = useState<"desktop" | "mobile">("desktop");
+  const [previewMode, setPreviewMode] = useState<"desktop" | "mobile">(
+    "desktop",
+  );
   const [saving, setSaving] = useState(false);
   const [uploading, setUploading] = useState<"desktop" | "mobile" | null>(null);
   const [showHistory, setShowHistory] = useState(false);
   const [history, setHistory] = useState<any[]>([]);
-  const [message, setMessage] = useState<{ type: "success" | "error"; text: string } | null>(null);
+  const [message, setMessage] = useState<{
+    type: "success" | "error";
+    text: string;
+  } | null>(null);
 
   const desktopInputRef = useRef<HTMLInputElement>(null);
   const mobileInputRef = useRef<HTMLInputElement>(null);
@@ -93,7 +98,7 @@ export default function AdminHeroEditor({ initial }: Props) {
 
       const uploadRes = await fetch(
         `https://api.cloudinary.com/v1_1/${sign.cloudName}/auto/upload`,
-        { method: "POST", body: form }
+        { method: "POST", body: form },
       );
 
       if (!uploadRes.ok) throw new Error("Upload failed");
@@ -101,23 +106,26 @@ export default function AdminHeroEditor({ initial }: Props) {
 
       // Update settings
       if (type === "desktop") {
-        setSettings(prev => ({
+        setSettings((prev) => ({
           ...prev,
           heroImageUrl: result.secure_url,
-          heroImagePublicId: result.public_id
+          heroImagePublicId: result.public_id,
         }));
       } else {
-        setSettings(prev => ({
+        setSettings((prev) => ({
           ...prev,
           heroMobileImageUrl: result.secure_url,
-          heroMobilePublicId: result.public_id
+          heroMobilePublicId: result.public_id,
         }));
       }
 
       setMessage({ type: "success", text: "Image uploadée avec succès" });
     } catch (err: any) {
       console.error("Upload error:", err);
-      setMessage({ type: "error", text: err.message || "Erreur lors de l'upload" });
+      setMessage({
+        type: "error",
+        text: err.message || "Erreur lors de l'upload",
+      });
     } finally {
       setUploading(null);
     }
@@ -132,7 +140,7 @@ export default function AdminHeroEditor({ initial }: Props) {
       const res = await fetch("/api/v3/site/settings/hero", {
         method: "PUT",
         headers: { "Content-Type": "application/json" },
-        body: JSON.stringify(settings)
+        body: JSON.stringify(settings),
       });
 
       const data = await res.json();
@@ -169,7 +177,7 @@ export default function AdminHeroEditor({ initial }: Props) {
       const res = await fetch("/api/v3/site/hero/rollback", {
         method: "POST",
         headers: { "Content-Type": "application/json" },
-        body: JSON.stringify({ historyId })
+        body: JSON.stringify({ historyId }),
       });
 
       const data = await res.json();
@@ -190,7 +198,7 @@ export default function AdminHeroEditor({ initial }: Props) {
           heroOverlayOpacity: newSettings.heroOverlayOpacity ?? 0.35,
           heroPreset: newSettings.heroPreset || "classic",
           heroActive: newSettings.heroActive ?? true,
-          heroVariant: newSettings.heroVariant || "image"
+          heroVariant: newSettings.heroVariant || "image",
         });
         setShowHistory(false);
         setMessage({ type: "success", text: "Version restaurée !" });
@@ -202,18 +210,23 @@ export default function AdminHeroEditor({ initial }: Props) {
     }
   }
 
-  const previewImage = previewMode === "mobile" && settings.heroMobileImageUrl
-    ? settings.heroMobileImageUrl
-    : settings.heroImageUrl;
+  const previewImage =
+    previewMode === "mobile" && settings.heroMobileImageUrl
+      ? settings.heroMobileImageUrl
+      : settings.heroImageUrl;
 
   return (
     <div className="space-y-6">
       {/* Message */}
       {message && (
-        <div className={cn(
-          "p-4 rounded-lg flex items-center justify-between",
-          message.type === "success" ? "bg-green-50 text-green-700" : "bg-red-50 text-red-700"
-        )}>
+        <div
+          className={cn(
+            "p-4 rounded-lg flex items-center justify-between",
+            message.type === "success"
+              ? "bg-green-50 text-green-700"
+              : "bg-red-50 text-red-700",
+          )}
+        >
           <span>{message.text}</span>
           <button onClick={() => setMessage(null)}>
             <X size={16} />
@@ -230,7 +243,12 @@ export default function AdminHeroEditor({ initial }: Props) {
               <input
                 type="checkbox"
                 checked={settings.heroActive}
-                onChange={e => setSettings(prev => ({ ...prev, heroActive: e.target.checked }))}
+                onChange={(e) =>
+                  setSettings((prev) => ({
+                    ...prev,
+                    heroActive: e.target.checked,
+                  }))
+                }
                 className="w-5 h-5 rounded border-gray-300 text-harp-brown focus:ring-harp-brown"
               />
               <span className="font-medium">Hero actif</span>
@@ -255,13 +273,21 @@ export default function AdminHeroEditor({ initial }: Props) {
                 ref={desktopInputRef}
                 accept="image/*"
                 className="hidden"
-                onChange={e => e.target.files?.[0] && handleUpload(e.target.files[0], "desktop")}
+                onChange={(e) =>
+                  e.target.files?.[0] &&
+                  handleUpload(e.target.files[0], "desktop")
+                }
               />
               <div className="flex gap-2">
                 <input
                   type="text"
                   value={settings.heroImageUrl || ""}
-                  onChange={e => setSettings(prev => ({ ...prev, heroImageUrl: e.target.value }))}
+                  onChange={(e) =>
+                    setSettings((prev) => ({
+                      ...prev,
+                      heroImageUrl: e.target.value,
+                    }))
+                  }
                   placeholder="URL de l'image ou uploader"
                   className="flex-1 px-3 py-2 border rounded-lg text-sm"
                 />
@@ -270,7 +296,11 @@ export default function AdminHeroEditor({ initial }: Props) {
                   disabled={uploading === "desktop"}
                   className="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors flex items-center gap-2"
                 >
-                  {uploading === "desktop" ? <Loader2 size={16} className="animate-spin" /> : <Upload size={16} />}
+                  {uploading === "desktop" ? (
+                    <Loader2 size={16} className="animate-spin" />
+                  ) : (
+                    <Upload size={16} />
+                  )}
                 </button>
               </div>
             </div>
@@ -286,13 +316,21 @@ export default function AdminHeroEditor({ initial }: Props) {
                 ref={mobileInputRef}
                 accept="image/*"
                 className="hidden"
-                onChange={e => e.target.files?.[0] && handleUpload(e.target.files[0], "mobile")}
+                onChange={(e) =>
+                  e.target.files?.[0] &&
+                  handleUpload(e.target.files[0], "mobile")
+                }
               />
               <div className="flex gap-2">
                 <input
                   type="text"
                   value={settings.heroMobileImageUrl || ""}
-                  onChange={e => setSettings(prev => ({ ...prev, heroMobileImageUrl: e.target.value }))}
+                  onChange={(e) =>
+                    setSettings((prev) => ({
+                      ...prev,
+                      heroMobileImageUrl: e.target.value,
+                    }))
+                  }
                   placeholder="URL de l'image mobile"
                   className="flex-1 px-3 py-2 border rounded-lg text-sm"
                 />
@@ -301,7 +339,11 @@ export default function AdminHeroEditor({ initial }: Props) {
                   disabled={uploading === "mobile"}
                   className="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors flex items-center gap-2"
                 >
-                  {uploading === "mobile" ? <Loader2 size={16} className="animate-spin" /> : <Upload size={16} />}
+                  {uploading === "mobile" ? (
+                    <Loader2 size={16} className="animate-spin" />
+                  ) : (
+                    <Upload size={16} />
+                  )}
                 </button>
               </div>
             </div>
@@ -309,20 +351,34 @@ export default function AdminHeroEditor({ initial }: Props) {
             {/* Alt Text */}
             <div className="grid grid-cols-2 gap-4">
               <div>
-                <label className="text-sm text-gray-600 mb-1 block">Alt FR</label>
+                <label className="text-sm text-gray-600 mb-1 block">
+                  Alt FR
+                </label>
                 <input
                   type="text"
                   value={settings.heroAltFr || ""}
-                  onChange={e => setSettings(prev => ({ ...prev, heroAltFr: e.target.value }))}
+                  onChange={(e) =>
+                    setSettings((prev) => ({
+                      ...prev,
+                      heroAltFr: e.target.value,
+                    }))
+                  }
                   className="w-full px-3 py-2 border rounded-lg text-sm"
                 />
               </div>
               <div>
-                <label className="text-sm text-gray-600 mb-1 block">Alt AR</label>
+                <label className="text-sm text-gray-600 mb-1 block">
+                  Alt AR
+                </label>
                 <input
                   type="text"
                   value={settings.heroAltAr || ""}
-                  onChange={e => setSettings(prev => ({ ...prev, heroAltAr: e.target.value }))}
+                  onChange={(e) =>
+                    setSettings((prev) => ({
+                      ...prev,
+                      heroAltAr: e.target.value,
+                    }))
+                  }
                   className="w-full px-3 py-2 border rounded-lg text-sm"
                   dir="rtl"
                 />
@@ -336,21 +392,35 @@ export default function AdminHeroEditor({ initial }: Props) {
 
             <div className="grid grid-cols-2 gap-4">
               <div>
-                <label className="text-sm text-gray-600 mb-1 block">Titre FR</label>
+                <label className="text-sm text-gray-600 mb-1 block">
+                  Titre FR
+                </label>
                 <input
                   type="text"
                   value={settings.heroCaptionFr || ""}
-                  onChange={e => setSettings(prev => ({ ...prev, heroCaptionFr: e.target.value }))}
+                  onChange={(e) =>
+                    setSettings((prev) => ({
+                      ...prev,
+                      heroCaptionFr: e.target.value,
+                    }))
+                  }
                   placeholder="Nouvelle Collection"
                   className="w-full px-3 py-2 border rounded-lg text-sm"
                 />
               </div>
               <div>
-                <label className="text-sm text-gray-600 mb-1 block">Titre AR</label>
+                <label className="text-sm text-gray-600 mb-1 block">
+                  Titre AR
+                </label>
                 <input
                   type="text"
                   value={settings.heroCaptionAr || ""}
-                  onChange={e => setSettings(prev => ({ ...prev, heroCaptionAr: e.target.value }))}
+                  onChange={(e) =>
+                    setSettings((prev) => ({
+                      ...prev,
+                      heroCaptionAr: e.target.value,
+                    }))
+                  }
                   className="w-full px-3 py-2 border rounded-lg text-sm"
                   dir="rtl"
                 />
@@ -359,21 +429,35 @@ export default function AdminHeroEditor({ initial }: Props) {
 
             <div className="grid grid-cols-2 gap-4">
               <div>
-                <label className="text-sm text-gray-600 mb-1 block">Bouton FR</label>
+                <label className="text-sm text-gray-600 mb-1 block">
+                  Bouton FR
+                </label>
                 <input
                   type="text"
                   value={settings.heroCtaTextFr || ""}
-                  onChange={e => setSettings(prev => ({ ...prev, heroCtaTextFr: e.target.value }))}
+                  onChange={(e) =>
+                    setSettings((prev) => ({
+                      ...prev,
+                      heroCtaTextFr: e.target.value,
+                    }))
+                  }
                   placeholder="Découvrir"
                   className="w-full px-3 py-2 border rounded-lg text-sm"
                 />
               </div>
               <div>
-                <label className="text-sm text-gray-600 mb-1 block">Bouton AR</label>
+                <label className="text-sm text-gray-600 mb-1 block">
+                  Bouton AR
+                </label>
                 <input
                   type="text"
                   value={settings.heroCtaTextAr || ""}
-                  onChange={e => setSettings(prev => ({ ...prev, heroCtaTextAr: e.target.value }))}
+                  onChange={(e) =>
+                    setSettings((prev) => ({
+                      ...prev,
+                      heroCtaTextAr: e.target.value,
+                    }))
+                  }
                   className="w-full px-3 py-2 border rounded-lg text-sm"
                   dir="rtl"
                 />
@@ -381,11 +465,18 @@ export default function AdminHeroEditor({ initial }: Props) {
             </div>
 
             <div>
-              <label className="text-sm text-gray-600 mb-1 block">Lien du bouton</label>
+              <label className="text-sm text-gray-600 mb-1 block">
+                Lien du bouton
+              </label>
               <input
                 type="text"
                 value={settings.heroCtaUrl || ""}
-                onChange={e => setSettings(prev => ({ ...prev, heroCtaUrl: e.target.value }))}
+                onChange={(e) =>
+                  setSettings((prev) => ({
+                    ...prev,
+                    heroCtaUrl: e.target.value,
+                  }))
+                }
                 placeholder="/shop"
                 className="w-full px-3 py-2 border rounded-lg text-sm"
               />
@@ -400,15 +491,20 @@ export default function AdminHeroEditor({ initial }: Props) {
             <div>
               <label className="text-sm text-gray-600 mb-2 block">Preset</label>
               <div className="grid grid-cols-2 gap-2">
-                {PRESETS.map(preset => (
+                {PRESETS.map((preset) => (
                   <button
                     key={preset.value}
-                    onClick={() => setSettings(prev => ({ ...prev, heroPreset: preset.value }))}
+                    onClick={() =>
+                      setSettings((prev) => ({
+                        ...prev,
+                        heroPreset: preset.value,
+                      }))
+                    }
                     className={cn(
                       "p-3 border rounded-lg text-left transition-all",
                       settings.heroPreset === preset.value
                         ? "border-harp-brown bg-harp-brown/5"
-                        : "border-gray-200 hover:border-gray-300"
+                        : "border-gray-200 hover:border-gray-300",
                     )}
                   >
                     <div className="font-medium text-sm">{preset.label}</div>
@@ -421,7 +517,8 @@ export default function AdminHeroEditor({ initial }: Props) {
             {/* Overlay */}
             <div>
               <label className="text-sm text-gray-600 mb-2 block">
-                Opacité overlay: {Math.round((settings.heroOverlayOpacity || 0) * 100)}%
+                Opacité overlay:{" "}
+                {Math.round((settings.heroOverlayOpacity || 0) * 100)}%
               </label>
               <input
                 type="range"
@@ -429,7 +526,12 @@ export default function AdminHeroEditor({ initial }: Props) {
                 max="1"
                 step="0.05"
                 value={settings.heroOverlayOpacity || 0}
-                onChange={e => setSettings(prev => ({ ...prev, heroOverlayOpacity: parseFloat(e.target.value) }))}
+                onChange={(e) =>
+                  setSettings((prev) => ({
+                    ...prev,
+                    heroOverlayOpacity: parseFloat(e.target.value),
+                  }))
+                }
                 className="w-full"
               />
             </div>
@@ -448,7 +550,9 @@ export default function AdminHeroEditor({ initial }: Props) {
                 onClick={() => setPreviewMode("desktop")}
                 className={cn(
                   "p-2 rounded-md transition-colors",
-                  previewMode === "desktop" ? "bg-white shadow-sm" : "hover:bg-gray-200"
+                  previewMode === "desktop"
+                    ? "bg-white shadow-sm"
+                    : "hover:bg-gray-200",
                 )}
               >
                 <Monitor size={16} />
@@ -457,7 +561,9 @@ export default function AdminHeroEditor({ initial }: Props) {
                 onClick={() => setPreviewMode("mobile")}
                 className={cn(
                   "p-2 rounded-md transition-colors",
-                  previewMode === "mobile" ? "bg-white shadow-sm" : "hover:bg-gray-200"
+                  previewMode === "mobile"
+                    ? "bg-white shadow-sm"
+                    : "hover:bg-gray-200",
                 )}
               >
                 <Smartphone size={16} />
@@ -466,10 +572,14 @@ export default function AdminHeroEditor({ initial }: Props) {
           </div>
 
           {/* Preview Container */}
-          <div className={cn(
-            "relative overflow-hidden rounded-xl border bg-gray-100 mx-auto transition-all",
-            previewMode === "desktop" ? "w-full aspect-[16/9]" : "w-[280px] aspect-[9/16]"
-          )}>
+          <div
+            className={cn(
+              "relative overflow-hidden rounded-xl border bg-gray-100 mx-auto transition-all",
+              previewMode === "desktop"
+                ? "w-full aspect-[16/9]"
+                : "w-[280px] aspect-[9/16]",
+            )}
+          >
             {previewImage ? (
               <>
                 <img
@@ -479,19 +589,27 @@ export default function AdminHeroEditor({ initial }: Props) {
                 />
                 <div
                   className="absolute inset-0"
-                  style={{ backgroundColor: `rgba(0,0,0,${settings.heroOverlayOpacity || 0})` }}
+                  style={{
+                    backgroundColor: `rgba(0,0,0,${settings.heroOverlayOpacity || 0})`,
+                  }}
                 />
-                <div className={cn(
-                  "absolute inset-0 flex p-6",
-                  settings.heroPreset === "centered" ? "items-center justify-center text-center" :
-                  settings.heroPreset === "minimal" ? "items-center justify-center text-center" :
-                  "items-end"
-                )}>
+                <div
+                  className={cn(
+                    "absolute inset-0 flex p-6",
+                    settings.heroPreset === "centered"
+                      ? "items-center justify-center text-center"
+                      : settings.heroPreset === "minimal"
+                        ? "items-center justify-center text-center"
+                        : "items-end",
+                  )}
+                >
                   <div className="text-white">
-                    <h2 className={cn(
-                      "font-serif font-bold",
-                      previewMode === "desktop" ? "text-3xl" : "text-xl"
-                    )}>
+                    <h2
+                      className={cn(
+                        "font-serif font-bold",
+                        previewMode === "desktop" ? "text-3xl" : "text-xl",
+                      )}
+                    >
                       {settings.heroCaptionFr || "Titre du Hero"}
                     </h2>
                     {settings.heroCtaTextFr && (
@@ -519,7 +637,11 @@ export default function AdminHeroEditor({ initial }: Props) {
               disabled={saving}
               className="flex-1 px-4 py-3 bg-harp-brown text-white rounded-xl font-medium hover:bg-harp-brown/90 transition-colors flex items-center justify-center gap-2 disabled:opacity-50"
             >
-              {saving ? <Loader2 size={18} className="animate-spin" /> : <Save size={18} />}
+              {saving ? (
+                <Loader2 size={18} className="animate-spin" />
+              ) : (
+                <Save size={18} />
+              )}
               Enregistrer
             </button>
             <button
@@ -544,10 +666,15 @@ export default function AdminHeroEditor({ initial }: Props) {
             </div>
             <div className="p-4 overflow-y-auto max-h-[60vh] space-y-2">
               {history.length === 0 ? (
-                <p className="text-gray-500 text-center py-8">Aucun historique</p>
+                <p className="text-gray-500 text-center py-8">
+                  Aucun historique
+                </p>
               ) : (
-                history.map(h => (
-                  <div key={h.id} className="p-3 border rounded-lg flex items-center justify-between">
+                history.map((h) => (
+                  <div
+                    key={h.id}
+                    className="p-3 border rounded-lg flex items-center justify-between"
+                  >
                     <div>
                       <div className="text-sm font-medium">
                         {new Date(h.createdAt).toLocaleString("fr-FR")}
diff --git a/src/components/loyalty/AccountBirthdayBanner.tsx b/src/components/loyalty/AccountBirthdayBanner.tsx
index 1d1b2e9..a02c4db 100644
--- a/src/components/loyalty/AccountBirthdayBanner.tsx
+++ b/src/components/loyalty/AccountBirthdayBanner.tsx
@@ -8,8 +8,12 @@ interface AccountBirthdayBannerProps {
   initialBirthDate?: string | null;
 }
 
-export function AccountBirthdayBanner({ initialBirthDate }: AccountBirthdayBannerProps) {
-  const [birthDate, setBirthDate] = useState(initialBirthDate ? initialBirthDate.slice(0, 10) : "");
+export function AccountBirthdayBanner({
+  initialBirthDate,
+}: AccountBirthdayBannerProps) {
+  const [birthDate, setBirthDate] = useState(
+    initialBirthDate ? initialBirthDate.slice(0, 10) : "",
+  );
   const [saving, setSaving] = useState(false);
   const [saved, setSaved] = useState(false);
   const [error, setError] = useState<string | null>(null);
@@ -23,31 +27,33 @@ export function AccountBirthdayBanner({ initialBirthDate }: AccountBirthdayBanne
     const today = new Date();
     const next = new Date(today.getFullYear(), dob.getMonth(), dob.getDate());
     if (next < today) next.setFullYear(next.getFullYear() + 1);
-    return Math.ceil((next.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));
+    return Math.ceil(
+      (next.getTime() - today.getTime()) / (1000 * 60 * 60 * 24),
+    );
   };
 
   const daysUntil = getDaysUntilBirthday();
 
   async function saveBirthDate() {
     if (!birthDate) return;
-    
+
     setSaving(true);
     setError(null);
-    
+
     try {
       const res = await fetch("/api/v3/account/profile", {
         method: "PATCH",
         credentials: "include",
         headers: { "Content-Type": "application/json" },
-        body: JSON.stringify({ birthDate })
+        body: JSON.stringify({ birthDate }),
       });
-      
+
       const data = await res.json();
-      
+
       if (!res.ok || !data.success) {
         throw new Error(data.error || "Erreur lors de la sauvegarde");
       }
-      
+
       setSaved(true);
       setTimeout(() => setSaved(false), 3000);
     } catch (e: any) {
@@ -72,12 +78,19 @@ export function AccountBirthdayBanner({ initialBirthDate }: AccountBirthdayBanne
             <p className="text-sm text-gray-600 mt-1">
               {daysUntil === 0 ? (
                 <span className="font-semibold text-amber-600">
-                  🎉 C'est votre anniversaire ! Vos 5 000 points ont été ajoutés.
+                  🎉 C'est votre anniversaire ! Vos 5 000 points ont été
+                  ajoutés.
                 </span>
               ) : daysUntil === 1 ? (
-                <>Demain c'est votre anniversaire ! Vous recevrez <strong>5 000 points</strong>.</>
+                <>
+                  Demain c'est votre anniversaire ! Vous recevrez{" "}
+                  <strong>5 000 points</strong>.
+                </>
               ) : (
-                <>Votre anniversaire est dans <strong>{daysUntil} jours</strong>. Vous recevrez <strong>5 000 points</strong> automatiquement.</>
+                <>
+                  Votre anniversaire est dans <strong>{daysUntil} jours</strong>
+                  . Vous recevrez <strong>5 000 points</strong> automatiquement.
+                </>
               )}
             </p>
           </div>
@@ -98,12 +111,16 @@ export function AccountBirthdayBanner({ initialBirthDate }: AccountBirthdayBanne
             Gagnez 5 000 points !
           </h3>
           <p className="text-sm text-gray-600 mt-1 mb-4">
-            Renseignez votre date de naissance et recevez <strong>5 000 points</strong> le jour de votre anniversaire.
+            Renseignez votre date de naissance et recevez{" "}
+            <strong>5 000 points</strong> le jour de votre anniversaire.
           </p>
-          
+
           <div className="flex flex-wrap gap-3 items-center">
             <div className="relative">
-              <Calendar className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={16} />
+              <Calendar
+                className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
+                size={16}
+              />
               <input
                 type="date"
                 value={birthDate}
@@ -111,17 +128,17 @@ export function AccountBirthdayBanner({ initialBirthDate }: AccountBirthdayBanne
                 className="pl-10 pr-4 py-2.5 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-harp-brown/20 focus:border-harp-brown"
               />
             </div>
-            
-            <button 
+
+            <button
               onClick={saveBirthDate}
               disabled={saving || !birthDate}
               className={cn(
                 "px-5 py-2.5 rounded-lg text-sm font-medium transition-all flex items-center gap-2",
-                saving || !birthDate 
+                saving || !birthDate
                   ? "bg-gray-100 text-gray-400 cursor-not-allowed"
                   : saved
-                  ? "bg-green-500 text-white"
-                  : "bg-harp-brown text-white hover:bg-harp-brown/90"
+                    ? "bg-green-500 text-white"
+                    : "bg-harp-brown text-white hover:bg-harp-brown/90",
               )}
             >
               {saving ? (
@@ -139,10 +156,8 @@ export function AccountBirthdayBanner({ initialBirthDate }: AccountBirthdayBanne
               )}
             </button>
           </div>
-          
-          {error && (
-            <p className="text-sm text-red-500 mt-2">{error}</p>
-          )}
+
+          {error && <p className="text-sm text-red-500 mt-2">{error}</p>}
         </div>
       </div>
     </div>
diff --git a/src/components/loyalty/LoyaltyDashboard.tsx b/src/components/loyalty/LoyaltyDashboard.tsx
index ff1dd55..6bae5f9 100644
--- a/src/components/loyalty/LoyaltyDashboard.tsx
+++ b/src/components/loyalty/LoyaltyDashboard.tsx
@@ -35,9 +35,9 @@ export function LoyaltyDashboard() {
       const [resLoyalty, resRewards, resProfile] = await Promise.all([
         fetch("/api/v3/loyalty/balance"),
         fetch("/api/v3/loyalty/rewards"),
-        fetch("/api/v3/account/profile")
+        fetch("/api/v3/account/profile"),
       ]);
-      
+
       if (resLoyalty.ok) setLoyalty(await resLoyalty.json());
       if (resRewards.ok) setRewards(await resRewards.json());
       if (resProfile.ok) setUserProfile(await resProfile.json());
@@ -53,9 +53,9 @@ export function LoyaltyDashboard() {
       const res = await fetch("/api/v3/loyalty/redeem", {
         method: "POST",
         headers: { "Content-Type": "application/json" },
-        body: JSON.stringify({ rewardId })
+        body: JSON.stringify({ rewardId }),
       });
-      
+
       if (res.ok) {
         fetchData();
         alert("Récompense débloquée avec succès !");
@@ -73,21 +73,33 @@ export function LoyaltyDashboard() {
     return (
       <div className="p-8 text-center border rounded-2xl bg-gray-50">
         <Crown size={48} className="mx-auto mb-4 text-harp-gold" />
-        <h2 className="text-2xl font-serif mb-2 text-harp-brown">Rejoignez HARP REWARDS</h2>
-        <p className="text-gray-600 mb-6">Connectez-vous pour accéder à vos avantages exclusifs.</p>
-        <a href="/login" className="inline-block bg-harp-brown text-white px-8 py-3 rounded-xl font-medium hover:bg-harp-brown/90 transition-colors">
+        <h2 className="text-2xl font-serif mb-2 text-harp-brown">
+          Rejoignez HARP REWARDS
+        </h2>
+        <p className="text-gray-600 mb-6">
+          Connectez-vous pour accéder à vos avantages exclusifs.
+        </p>
+        <a
+          href="/login"
+          className="inline-block bg-harp-brown text-white px-8 py-3 rounded-xl font-medium hover:bg-harp-brown/90 transition-colors"
+        >
           Se connecter
         </a>
       </div>
     );
   }
 
-  if (loading || !loyalty) return <div className="p-12 text-center text-gray-400">Chargement de votre statut VIP...</div>;
+  if (loading || !loyalty)
+    return (
+      <div className="p-12 text-center text-gray-400">
+        Chargement de votre statut VIP...
+      </div>
+    );
 
   return (
     <div className="space-y-8">
       {/* Profile Completion Banner */}
-      <ProfileCompletionBanner 
+      <ProfileCompletionBanner
         initialName={userProfile?.name}
         initialPhone={userProfile?.phone}
         initialBirthDate={userProfile?.birthDate}
@@ -98,23 +110,33 @@ export function LoyaltyDashboard() {
         <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
           {/* Left: Status */}
           <div className="flex items-center gap-4">
-            <div className={cn(
-              "w-14 h-14 rounded-xl flex items-center justify-center",
-              loyalty.vipLevel === "BLACK" ? "bg-gray-900" : 
-              loyalty.vipLevel === "GOLD" ? "bg-amber-500" : 
-              "bg-harp-brown"
-            )}>
+            <div
+              className={cn(
+                "w-14 h-14 rounded-xl flex items-center justify-center",
+                loyalty.vipLevel === "BLACK"
+                  ? "bg-gray-900"
+                  : loyalty.vipLevel === "GOLD"
+                    ? "bg-amber-500"
+                    : "bg-harp-brown",
+              )}
+            >
               <Crown className="text-white" size={24} />
             </div>
             <div>
-              <p className="text-xs text-gray-400 uppercase tracking-widest mb-1">Votre statut</p>
-              <h2 className="text-2xl font-serif font-bold text-harp-brown">{loyalty.vipLevel}</h2>
+              <p className="text-xs text-gray-400 uppercase tracking-widest mb-1">
+                Votre statut
+              </p>
+              <h2 className="text-2xl font-serif font-bold text-harp-brown">
+                {loyalty.vipLevel}
+              </h2>
             </div>
           </div>
-          
+
           {/* Right: Points */}
           <div className="text-left md:text-right">
-            <p className="text-xs text-gray-400 uppercase tracking-widest mb-1">Points disponibles</p>
+            <p className="text-xs text-gray-400 uppercase tracking-widest mb-1">
+              Points disponibles
+            </p>
             <div className="text-4xl font-serif font-bold text-harp-brown">
               {loyalty.balance.toLocaleString()}
               <span className="text-lg text-gray-400 ml-1">pts</span>
@@ -127,22 +149,35 @@ export function LoyaltyDashboard() {
           <div className="mt-8 pt-6 border-t border-gray-100">
             <div className="flex justify-between items-center text-sm mb-3">
               <span className="text-gray-500">
-                Progression vers <span className="font-medium text-harp-brown">{loyalty.nextLevel.name}</span>
+                Progression vers{" "}
+                <span className="font-medium text-harp-brown">
+                  {loyalty.nextLevel.name}
+                </span>
+              </span>
+              <span className="font-medium text-harp-brown">
+                {Math.round(loyalty.progress)}%
               </span>
-              <span className="font-medium text-harp-brown">{Math.round(loyalty.progress)}%</span>
             </div>
             <div className="h-1.5 bg-gray-100 rounded-full overflow-hidden">
-              <div 
+              <div
                 className={cn(
                   "h-full rounded-full transition-all duration-1000 ease-out",
-                  loyalty.vipLevel === "SILVER" ? "bg-harp-brown" :
-                  loyalty.vipLevel === "GOLD" ? "bg-amber-500" : "bg-gray-900"
+                  loyalty.vipLevel === "SILVER"
+                    ? "bg-harp-brown"
+                    : loyalty.vipLevel === "GOLD"
+                      ? "bg-amber-500"
+                      : "bg-gray-900",
                 )}
                 style={{ width: `${Math.max(2, loyalty.progress)}%` }}
               />
             </div>
             <p className="text-xs text-gray-400 mt-2">
-              Plus que {(loyalty.nextLevel.threshold * (1 - loyalty.progress / 100)).toLocaleString()} points
+              Plus que{" "}
+              {(
+                loyalty.nextLevel.threshold *
+                (1 - loyalty.progress / 100)
+              ).toLocaleString()}{" "}
+              points
             </p>
           </div>
         )}
@@ -158,7 +193,10 @@ export function LoyaltyDashboard() {
           </h3>
           <ul className="space-y-4">
             {loyalty.benefits.map((benefit, idx) => (
-              <li key={idx} className="flex items-start gap-3 text-sm text-gray-600">
+              <li
+                key={idx}
+                className="flex items-start gap-3 text-sm text-gray-600"
+              >
                 <div className="p-1 bg-green-100 rounded-full mt-0.5 text-green-600">
                   <Check size={12} strokeWidth={3} />
                 </div>
@@ -174,15 +212,15 @@ export function LoyaltyDashboard() {
             <Gift size={20} />
             Boutique Récompenses
           </h3>
-          
+
           <div className="grid sm:grid-cols-2 gap-4">
             {rewards.length > 0 ? (
               rewards.map((reward) => (
-                <RewardCard 
-                  key={reward.id} 
-                  reward={reward} 
-                  userBalance={loyalty.balance} 
-                  onRedeem={redeem} 
+                <RewardCard
+                  key={reward.id}
+                  reward={reward}
+                  userBalance={loyalty.balance}
+                  onRedeem={redeem}
                 />
               ))
             ) : (
@@ -200,7 +238,7 @@ export function LoyaltyDashboard() {
           <History size={20} />
           Historique des points
         </h3>
-        
+
         <div className="overflow-x-auto">
           <table className="w-full text-sm text-left">
             <thead className="text-xs text-gray-500 uppercase bg-gray-50 border-b border-gray-100">
@@ -215,26 +253,38 @@ export function LoyaltyDashboard() {
                 loyalty.history.map((item: any) => (
                   <tr key={item.id} className="hover:bg-gray-50/50">
                     <td className="px-4 py-3 text-gray-600">
-                      {new Date(item.createdAt).toLocaleDateString('fr-FR')}
+                      {new Date(item.createdAt).toLocaleDateString("fr-FR")}
                     </td>
                     <td className="px-4 py-3 font-medium text-gray-900">
                       {item.reason === "PURCHASE" && "Commande confirmée"}
                       {item.reason === "SIGNUP" && "Bienvenue chez HARP"}
-                      {item.reason === "REWARD_REDEMPTION" && "Récompense débloquée"}
+                      {item.reason === "REWARD_REDEMPTION" &&
+                        "Récompense débloquée"}
                       {item.reason === "WISHLIST_ADD" && "Ajout Wishlist"}
-                      {!["PURCHASE", "SIGNUP", "REWARD_REDEMPTION", "WISHLIST_ADD"].includes(item.reason) && item.reason}
+                      {![
+                        "PURCHASE",
+                        "SIGNUP",
+                        "REWARD_REDEMPTION",
+                        "WISHLIST_ADD",
+                      ].includes(item.reason) && item.reason}
                     </td>
-                    <td className={cn(
-                      "px-4 py-3 text-right font-bold font-mono",
-                      item.amount > 0 ? "text-green-600" : "text-red-500"
-                    )}>
-                      {item.amount > 0 ? "+" : ""}{item.amount}
+                    <td
+                      className={cn(
+                        "px-4 py-3 text-right font-bold font-mono",
+                        item.amount > 0 ? "text-green-600" : "text-red-500",
+                      )}
+                    >
+                      {item.amount > 0 ? "+" : ""}
+                      {item.amount}
                     </td>
                   </tr>
                 ))
               ) : (
                 <tr>
-                  <td colSpan={3} className="px-4 py-8 text-center text-gray-400 italic">
+                  <td
+                    colSpan={3}
+                    className="px-4 py-8 text-center text-gray-400 italic"
+                  >
                     Aucun historique disponible.
                   </td>
                 </tr>
diff --git a/src/components/loyalty/ProfileCompletionBanner.tsx b/src/components/loyalty/ProfileCompletionBanner.tsx
index 8641906..b32a284 100644
--- a/src/components/loyalty/ProfileCompletionBanner.tsx
+++ b/src/components/loyalty/ProfileCompletionBanner.tsx
@@ -11,21 +11,22 @@ interface ProfileCompletionBannerProps {
   initialBirthDate?: string | null;
 }
 
-export function ProfileCompletionBanner({ 
-  initialName, 
-  initialPhone, 
-  initialBirthDate 
+export function ProfileCompletionBanner({
+  initialName,
+  initialPhone,
+  initialBirthDate,
 }: ProfileCompletionBannerProps) {
   const [name, setName] = useState(initialName || "");
   const [phone, setPhone] = useState(initialPhone || "");
   const [birthDate, setBirthDate] = useState(
-    initialBirthDate ? initialBirthDate.slice(0, 10) : ""
+    initialBirthDate ? initialBirthDate.slice(0, 10) : "",
   );
   const [saving, setSaving] = useState(false);
   const [saved, setSaved] = useState(false);
   const [error, setError] = useState<string | null>(null);
 
-  const isProfileComplete = !!initialName && !!initialPhone && !!initialBirthDate;
+  const isProfileComplete =
+    !!initialName && !!initialPhone && !!initialBirthDate;
 
   // Calculate days until next birthday
   const getDaysUntilBirthday = () => {
@@ -35,7 +36,9 @@ export function ProfileCompletionBanner({
     const today = new Date();
     const next = new Date(today.getFullYear(), dob.getMonth(), dob.getDate());
     if (next < today) next.setFullYear(next.getFullYear() + 1);
-    return Math.ceil((next.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));
+    return Math.ceil(
+      (next.getTime() - today.getTime()) / (1000 * 60 * 60 * 24),
+    );
   };
 
   // Phone input handler - only allow digits
@@ -52,33 +55,33 @@ export function ProfileCompletionBanner({
       setError("Veuillez renseigner votre date de naissance");
       return;
     }
-    
+
     if (phone && !algerianPhoneRegex.test(phone)) {
       setError("Le numéro doit contenir 10 chiffres (ex: 0551234567)");
       return;
     }
-    
+
     setSaving(true);
     setError(null);
-    
+
     try {
       const res = await fetch("/api/v3/account/profile", {
         method: "PATCH",
         credentials: "include",
         headers: { "Content-Type": "application/json" },
-        body: JSON.stringify({ 
+        body: JSON.stringify({
           name: name || undefined,
           phone: phone || undefined,
-          birthDate 
-        })
+          birthDate,
+        }),
       });
-      
+
       const data = await res.json();
-      
+
       if (!res.ok || !data.success) {
         throw new Error(data.error || "Erreur lors de la sauvegarde");
       }
-      
+
       setSaved(true);
       setTimeout(() => {
         setSaved(false);
@@ -109,12 +112,19 @@ export function ProfileCompletionBanner({
             <p className="text-sm text-gray-600 mt-1">
               {daysUntil === 0 ? (
                 <span className="font-semibold text-amber-600">
-                  🎉 C'est votre anniversaire ! Vos 5 000 points ont été ajoutés.
+                  🎉 C'est votre anniversaire ! Vos 5 000 points ont été
+                  ajoutés.
                 </span>
               ) : daysUntil === 1 ? (
-                <>Demain c'est votre anniversaire ! Vous recevrez <strong>5 000 points</strong>.</>
+                <>
+                  Demain c'est votre anniversaire ! Vous recevrez{" "}
+                  <strong>5 000 points</strong>.
+                </>
               ) : (
-                <>Votre anniversaire est dans <strong>{daysUntil} jours</strong>. Vous recevrez <strong>5 000 points</strong> automatiquement.</>
+                <>
+                  Votre anniversaire est dans <strong>{daysUntil} jours</strong>
+                  . Vous recevrez <strong>5 000 points</strong> automatiquement.
+                </>
               )}
             </p>
           </div>
@@ -135,14 +145,18 @@ export function ProfileCompletionBanner({
             🎁 Complétez votre profil — Gagnez 5 000 points !
           </h3>
           <p className="text-sm text-gray-600 mt-1 mb-4">
-            Renseignez vos informations et recevez <strong>5 000 points</strong> le jour de votre anniversaire.
+            Renseignez vos informations et recevez <strong>5 000 points</strong>{" "}
+            le jour de votre anniversaire.
           </p>
-          
+
           <div className="grid sm:grid-cols-3 gap-3">
             {/* Name */}
             {!initialName && (
               <div className="relative">
-                <User className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={16} />
+                <User
+                  className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
+                  size={16}
+                />
                 <input
                   type="text"
                   value={name}
@@ -156,7 +170,10 @@ export function ProfileCompletionBanner({
             {/* Phone */}
             {!initialPhone && (
               <div className="relative">
-                <Phone className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={16} />
+                <Phone
+                  className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
+                  size={16}
+                />
                 <input
                   type="tel"
                   value={phone}
@@ -166,9 +183,9 @@ export function ProfileCompletionBanner({
                   pattern="^0[1-9][0-9]{8}$"
                   className={cn(
                     "w-full pl-10 pr-4 py-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-harp-brown/20",
-                    phone && !isPhoneValid 
-                      ? "border-red-300 focus:border-red-400" 
-                      : "border-gray-200 focus:border-harp-brown"
+                    phone && !isPhoneValid
+                      ? "border-red-300 focus:border-red-400"
+                      : "border-gray-200 focus:border-harp-brown",
                   )}
                 />
               </div>
@@ -177,7 +194,10 @@ export function ProfileCompletionBanner({
             {/* Birthday */}
             {!initialBirthDate && (
               <div className="relative">
-                <Calendar className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={16} />
+                <Calendar
+                  className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
+                  size={16}
+                />
                 <input
                   type="date"
                   value={birthDate}
@@ -194,19 +214,21 @@ export function ProfileCompletionBanner({
               Format: 10 chiffres commençant par 0 (ex: 0551234567)
             </p>
           )}
-          
+
           {/* Save button */}
           <div className="mt-4">
-            <button 
+            <button
               onClick={saveProfile}
-              disabled={saving || !birthDate || (phone.length > 0 && !isPhoneValid)}
+              disabled={
+                saving || !birthDate || (phone.length > 0 && !isPhoneValid)
+              }
               className={cn(
                 "px-6 py-2.5 rounded-lg text-sm font-medium transition-all flex items-center gap-2",
                 saving || !birthDate || (phone.length > 0 && !isPhoneValid)
                   ? "bg-gray-100 text-gray-400 cursor-not-allowed"
                   : saved
-                  ? "bg-green-500 text-white"
-                  : "bg-harp-brown text-white hover:bg-harp-brown/90"
+                    ? "bg-green-500 text-white"
+                    : "bg-harp-brown text-white hover:bg-harp-brown/90",
               )}
             >
               {saving ? (
@@ -224,10 +246,8 @@ export function ProfileCompletionBanner({
               )}
             </button>
           </div>
-          
-          {error && (
-            <p className="text-sm text-red-500 mt-2">{error}</p>
-          )}
+
+          {error && <p className="text-sm text-red-500 mt-2">{error}</p>}
         </div>
       </div>
     </div>
diff --git a/src/components/loyalty/RewardCard.tsx b/src/components/loyalty/RewardCard.tsx
index 98b3f54..4f6f00e 100644
--- a/src/components/loyalty/RewardCard.tsx
+++ b/src/components/loyalty/RewardCard.tsx
@@ -25,22 +25,28 @@ export function RewardCard({ reward, userBalance, onRedeem }: RewardCardProps) {
           {reward.cost} pts
         </span>
       </div>
-      <p className="text-xs text-gray-500 mb-4 min-h-[2.5em]">{reward.descriptionFr}</p>
-      
-      <button 
+      <p className="text-xs text-gray-500 mb-4 min-h-[2.5em]">
+        {reward.descriptionFr}
+      </p>
+
+      <button
         onClick={() => onRedeem(reward.id)}
         disabled={!canAfford}
         className={cn(
           "w-full py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",
           canAfford
-            ? "bg-harp-brown text-white hover:bg-harp-caramel" 
-            : "bg-gray-100 text-gray-400 cursor-not-allowed"
+            ? "bg-harp-brown text-white hover:bg-harp-caramel"
+            : "bg-gray-100 text-gray-400 cursor-not-allowed",
         )}
       >
         {canAfford ? (
-          <>Obtenir <Gift size={14} /></>
+          <>
+            Obtenir <Gift size={14} />
+          </>
         ) : (
-          <>Points insuffisants <Lock size={14} /></>
+          <>
+            Points insuffisants <Lock size={14} />
+          </>
         )}
       </button>
     </div>
diff --git a/src/components/wishlist/WishlistButton.tsx b/src/components/wishlist/WishlistButton.tsx
index 2c9203b..2e29c38 100644
--- a/src/components/wishlist/WishlistButton.tsx
+++ b/src/components/wishlist/WishlistButton.tsx
@@ -13,11 +13,11 @@ interface WishlistButtonProps {
   onToggle?: (isAdded: boolean) => void;
 }
 
-export function WishlistButton({ 
-  productId, 
-  initialIsWishlisted = false, 
+export function WishlistButton({
+  productId,
+  initialIsWishlisted = false,
   className,
-  onToggle 
+  onToggle,
 }: WishlistButtonProps) {
   const { data: session } = useSession();
   const [isWishlisted, setIsWishlisted] = useState(initialIsWishlisted);
@@ -26,7 +26,7 @@ export function WishlistButton({
 
   // Sync with localStorage if not logged in, or just handle UI state
   // Real sync happens on page load/auth
-  
+
   useEffect(() => {
     if (!session) {
       // Check local storage
@@ -48,7 +48,7 @@ export function WishlistButton({
 
       // Ensure guest key exists for future sync
       if (!localStorage.getItem("guest_wishlist_key")) {
-          localStorage.setItem("guest_wishlist_key", crypto.randomUUID());
+        localStorage.setItem("guest_wishlist_key", crypto.randomUUID());
       }
 
       if (local.includes(productId)) {
@@ -58,7 +58,7 @@ export function WishlistButton({
         newLocal = [...local, productId];
         newState = true;
       }
-      
+
       localStorage.setItem("guest_wishlist", JSON.stringify(newLocal));
       setIsWishlisted(newState);
       if (onToggle) onToggle(newState);
@@ -70,9 +70,9 @@ export function WishlistButton({
       const res = await fetch("/api/v3/wishlist/toggle", {
         method: "POST",
         headers: { "Content-Type": "application/json" },
-        body: JSON.stringify({ productId })
+        body: JSON.stringify({ productId }),
       });
-      
+
       if (res.ok) {
         const data = await res.json();
         setIsWishlisted(data.added);
@@ -92,7 +92,7 @@ export function WishlistButton({
       className={cn(
         "p-2 rounded-full transition-all duration-300 active:scale-95",
         isWishlisted ? "bg-red-50" : "hover:bg-gray-100",
-        className
+        className,
       )}
       aria-label={isWishlisted ? "Remove from wishlist" : "Add to wishlist"}
     >
@@ -100,7 +100,7 @@ export function WishlistButton({
         size={20}
         className={cn(
           "transition-all duration-300",
-          isWishlisted ? "fill-red-500 text-red-500" : "text-gray-600"
+          isWishlisted ? "fill-red-500 text-red-500" : "text-gray-600",
         )}
       />
     </button>
diff --git a/src/lib/accounting/constants.ts b/src/lib/accounting/constants.ts
index 7ba4c7f..5d4afe5 100644
--- a/src/lib/accounting/constants.ts
+++ b/src/lib/accounting/constants.ts
@@ -9,7 +9,8 @@ export const InventoryType = {
   PACKAGING: "PACKAGING",
   FINISHED: "FINISHED",
 } as const;
-export type InventoryTypeValue = typeof InventoryType[keyof typeof InventoryType];
+export type InventoryTypeValue =
+  (typeof InventoryType)[keyof typeof InventoryType];
 
 // Inventory Units
 export const InventoryUnit = {
@@ -19,7 +20,8 @@ export const InventoryUnit = {
   KG: "KG",
   LITER: "LITER",
 } as const;
-export type InventoryUnitValue = typeof InventoryUnit[keyof typeof InventoryUnit];
+export type InventoryUnitValue =
+  (typeof InventoryUnit)[keyof typeof InventoryUnit];
 
 // Purchase Status
 export const PurchaseStatus = {
@@ -29,7 +31,8 @@ export const PurchaseStatus = {
   RECEIVED: "RECEIVED",
   CANCELLED: "CANCELLED",
 } as const;
-export type PurchaseStatusValue = typeof PurchaseStatus[keyof typeof PurchaseStatus];
+export type PurchaseStatusValue =
+  (typeof PurchaseStatus)[keyof typeof PurchaseStatus];
 
 // Supplier Advance Status
 export const AdvanceStatus = {
@@ -38,7 +41,8 @@ export const AdvanceStatus = {
   APPLIED: "APPLIED",
   REFUNDED: "REFUNDED",
 } as const;
-export type AdvanceStatusValue = typeof AdvanceStatus[keyof typeof AdvanceStatus];
+export type AdvanceStatusValue =
+  (typeof AdvanceStatus)[keyof typeof AdvanceStatus];
 
 // Charge Categories
 export const ChargeCategory = {
@@ -50,7 +54,8 @@ export const ChargeCategory = {
   LABOR: "LABOR",
   OTHER: "OTHER",
 } as const;
-export type ChargeCategoryValue = typeof ChargeCategory[keyof typeof ChargeCategory];
+export type ChargeCategoryValue =
+  (typeof ChargeCategory)[keyof typeof ChargeCategory];
 
 // Charge Scope
 export const ChargeScope = {
@@ -58,14 +63,14 @@ export const ChargeScope = {
   COLLECTION: "COLLECTION",
   MODEL: "MODEL",
 } as const;
-export type ChargeScopeValue = typeof ChargeScope[keyof typeof ChargeScope];
+export type ChargeScopeValue = (typeof ChargeScope)[keyof typeof ChargeScope];
 
 // Transaction Direction
 export const TxDirection = {
   IN: "IN",
   OUT: "OUT",
 } as const;
-export type TxDirectionValue = typeof TxDirection[keyof typeof TxDirection];
+export type TxDirectionValue = (typeof TxDirection)[keyof typeof TxDirection];
 
 // Transaction Types
 export const TxType = {
@@ -77,7 +82,7 @@ export const TxType = {
   RELEASE: "RELEASE",
   INITIAL: "INITIAL",
 } as const;
-export type TxTypeValue = typeof TxType[keyof typeof TxType];
+export type TxTypeValue = (typeof TxType)[keyof typeof TxType];
 
 // Production Batch Status
 export const BatchStatus = {
@@ -86,7 +91,7 @@ export const BatchStatus = {
   COMPLETED: "COMPLETED",
   CANCELLED: "CANCELLED",
 } as const;
-export type BatchStatusValue = typeof BatchStatus[keyof typeof BatchStatus];
+export type BatchStatusValue = (typeof BatchStatus)[keyof typeof BatchStatus];
 
 // Reconciliation Status
 export const ReconcileStatus = {
@@ -95,7 +100,8 @@ export const ReconcileStatus = {
   ADJUSTED: "ADJUSTED",
   IGNORED: "IGNORED",
 } as const;
-export type ReconcileStatusValue = typeof ReconcileStatus[keyof typeof ReconcileStatus];
+export type ReconcileStatusValue =
+  (typeof ReconcileStatus)[keyof typeof ReconcileStatus];
 
 // Payment Methods
 export const PaymentMethod = {
@@ -104,7 +110,8 @@ export const PaymentMethod = {
   TRANSFER: "TRANSFER",
   CCP: "CCP",
 } as const;
-export type PaymentMethodValue = typeof PaymentMethod[keyof typeof PaymentMethod];
+export type PaymentMethodValue =
+  (typeof PaymentMethod)[keyof typeof PaymentMethod];
 
 // Platforms (for marketing)
 export const Platform = {
@@ -114,7 +121,7 @@ export const Platform = {
   GOOGLE: "GOOGLE",
   OTHER: "OTHER",
 } as const;
-export type PlatformValue = typeof Platform[keyof typeof Platform];
+export type PlatformValue = (typeof Platform)[keyof typeof Platform];
 
 // =============================================================================
 // LABELS (pour l'UI)
@@ -192,7 +199,10 @@ export const BatchStatusLabels: Record<BatchStatusValue, string> = {
 // COULEURS STATUS
 // =============================================================================
 
-export const PurchaseStatusColors: Record<PurchaseStatusValue, { bg: string; text: string }> = {
+export const PurchaseStatusColors: Record<
+  PurchaseStatusValue,
+  { bg: string; text: string }
+> = {
   DRAFT: { bg: "bg-gray-100", text: "text-gray-700" },
   ORDERED: { bg: "bg-blue-100", text: "text-blue-700" },
   PARTIAL: { bg: "bg-orange-100", text: "text-orange-700" },
@@ -200,14 +210,20 @@ export const PurchaseStatusColors: Record<PurchaseStatusValue, { bg: string; tex
   CANCELLED: { bg: "bg-red-100", text: "text-red-700" },
 };
 
-export const AdvanceStatusColors: Record<AdvanceStatusValue, { bg: string; text: string }> = {
+export const AdvanceStatusColors: Record<
+  AdvanceStatusValue,
+  { bg: string; text: string }
+> = {
   PENDING: { bg: "bg-amber-100", text: "text-amber-700" },
   PARTIAL: { bg: "bg-blue-100", text: "text-blue-700" },
   APPLIED: { bg: "bg-green-100", text: "text-green-700" },
   REFUNDED: { bg: "bg-gray-100", text: "text-gray-700" },
 };
 
-export const BatchStatusColors: Record<BatchStatusValue, { bg: string; text: string }> = {
+export const BatchStatusColors: Record<
+  BatchStatusValue,
+  { bg: string; text: string }
+> = {
   PLANNED: { bg: "bg-gray-100", text: "text-gray-700" },
   IN_PROGRESS: { bg: "bg-blue-100", text: "text-blue-700" },
   COMPLETED: { bg: "bg-green-100", text: "text-green-700" },
@@ -219,10 +235,10 @@ export const BatchStatusColors: Record<BatchStatusValue, { bg: string; text: str
 // =============================================================================
 
 export const DEFAULTS = {
-  MARGIN_TARGET: 40,        // 40% marge cible
-  RETURN_MARGIN: 150,       // 150 DZD marge retours
-  WASTE_FACTOR: 1.05,       // 5% perte matière
-  ESTIMATED_UNITS: 100,     // Unités estimées par défaut
+  MARGIN_TARGET: 40, // 40% marge cible
+  RETURN_MARGIN: 150, // 150 DZD marge retours
+  WASTE_FACTOR: 1.05, // 5% perte matière
+  ESTIMATED_UNITS: 100, // Unités estimées par défaut
   CURRENCY: "DZD",
   LOW_STOCK_THRESHOLD: 10,
 } as const;
diff --git a/src/lib/accounting/services/__tests__/cost.service.test.ts b/src/lib/accounting/services/__tests__/cost.service.test.ts
index f138b70..90410b6 100644
--- a/src/lib/accounting/services/__tests__/cost.service.test.ts
+++ b/src/lib/accounting/services/__tests__/cost.service.test.ts
@@ -57,7 +57,8 @@ describe("Cost Calculations", () => {
       const laborCost = 1500;
       const marketingCost = 500;
       const transportCost = 200;
-      const totalCost = materialsCost + laborCost + marketingCost + transportCost;
+      const totalCost =
+        materialsCost + laborCost + marketingCost + transportCost;
 
       expect(totalCost).toBe(5000);
     });
@@ -89,7 +90,12 @@ describe("Cost Calculations", () => {
       const cost = 60000;
       const profit = revenue - cost;
       const marginPercent = (profit / revenue) * 100;
-      const status = marginPercent >= 10 ? "PROFITABLE" : profit >= 0 ? "BREAK_EVEN" : "LOSS";
+      const status =
+        marginPercent >= 10
+          ? "PROFITABLE"
+          : profit >= 0
+            ? "BREAK_EVEN"
+            : "LOSS";
 
       expect(profit).toBe(40000);
       expect(marginPercent).toBe(40);
@@ -101,7 +107,8 @@ describe("Cost Calculations", () => {
       const cost = 60000;
       const profit = revenue - cost;
       const marginPercent = (profit / revenue) * 100;
-      const status = profit < 0 ? "LOSS" : marginPercent < 10 ? "BREAK_EVEN" : "PROFITABLE";
+      const status =
+        profit < 0 ? "LOSS" : marginPercent < 10 ? "BREAK_EVEN" : "PROFITABLE";
 
       expect(profit).toBe(-10000);
       expect(marginPercent).toBe(-20);
@@ -113,7 +120,8 @@ describe("Cost Calculations", () => {
       const cost = 95000;
       const profit = revenue - cost;
       const marginPercent = (profit / revenue) * 100;
-      const status = profit < 0 ? "LOSS" : marginPercent < 10 ? "BREAK_EVEN" : "PROFITABLE";
+      const status =
+        profit < 0 ? "LOSS" : marginPercent < 10 ? "BREAK_EVEN" : "PROFITABLE";
 
       expect(profit).toBe(5000);
       expect(marginPercent).toBe(5);
diff --git a/src/lib/accounting/services/__tests__/inventory.service.test.ts b/src/lib/accounting/services/__tests__/inventory.service.test.ts
index fa2d027..bcd8486 100644
--- a/src/lib/accounting/services/__tests__/inventory.service.test.ts
+++ b/src/lib/accounting/services/__tests__/inventory.service.test.ts
@@ -8,7 +8,7 @@ describe("Inventory Service", () => {
   describe("calculateCUMP", () => {
     it("should calculate CUMP correctly for first entry", () => {
       const result = calculateCUMP(0, 0, 100, 500);
-      
+
       expect(result.newQuantity).toBe(100);
       expect(result.newAverageCost).toBe(500);
       expect(result.newTotalValue).toBe(50000);
@@ -19,9 +19,9 @@ describe("Inventory Service", () => {
       // New: 50 units at 600 DZD = 30,000 DZD
       // Total: 150 units, 80,000 DZD
       // CUMP = 80,000 / 150 = 533.33
-      
+
       const result = calculateCUMP(100, 500, 50, 600);
-      
+
       expect(result.newQuantity).toBe(150);
       expect(result.newTotalValue).toBe(80000);
       expect(result.newAverageCost).toBeCloseTo(533.33, 2);
@@ -29,7 +29,7 @@ describe("Inventory Service", () => {
 
     it("should handle zero existing stock", () => {
       const result = calculateCUMP(0, 0, 200, 750);
-      
+
       expect(result.newQuantity).toBe(200);
       expect(result.newAverageCost).toBe(750);
       expect(result.newTotalValue).toBe(150000);
@@ -37,7 +37,7 @@ describe("Inventory Service", () => {
 
     it("should handle same price purchases", () => {
       const result = calculateCUMP(100, 500, 100, 500);
-      
+
       expect(result.newQuantity).toBe(200);
       expect(result.newAverageCost).toBe(500);
       expect(result.newTotalValue).toBe(100000);
@@ -48,9 +48,9 @@ describe("Inventory Service", () => {
       // New: 100 units at 400 DZD = 40,000 DZD
       // Total: 200 units, 100,000 DZD
       // CUMP = 100,000 / 200 = 500
-      
+
       const result = calculateCUMP(100, 600, 100, 400);
-      
+
       expect(result.newQuantity).toBe(200);
       expect(result.newAverageCost).toBe(500);
       expect(result.newTotalValue).toBe(100000);
@@ -61,9 +61,9 @@ describe("Inventory Service", () => {
       // New: 100 units at 600 DZD = 60,000 DZD
       // Total: 200 units, 100,000 DZD
       // CUMP = 100,000 / 200 = 500
-      
+
       const result = calculateCUMP(100, 400, 100, 600);
-      
+
       expect(result.newQuantity).toBe(200);
       expect(result.newAverageCost).toBe(500);
       expect(result.newTotalValue).toBe(100000);
@@ -71,7 +71,7 @@ describe("Inventory Service", () => {
 
     it("should handle decimal quantities", () => {
       const result = calculateCUMP(10.5, 100, 5.25, 120);
-      
+
       expect(result.newQuantity).toBe(15.75);
       // (10.5 * 100) + (5.25 * 120) = 1050 + 630 = 1680
       // 1680 / 15.75 = 106.67
@@ -86,14 +86,14 @@ describe("Stock Validation", () => {
     // For now, we're testing the pure calculation logic
     const currentQty = 50;
     const requestedQty = 100;
-    
+
     expect(currentQty < requestedQty).toBe(true);
   });
 
   it("should allow valid stock withdrawal", () => {
     const currentQty = 100;
     const requestedQty = 50;
-    
+
     expect(currentQty >= requestedQty).toBe(true);
     expect(currentQty - requestedQty).toBe(50);
   });
diff --git a/src/lib/accounting/services/advance.service.ts b/src/lib/accounting/services/advance.service.ts
index b74c780..e3283eb 100644
--- a/src/lib/accounting/services/advance.service.ts
+++ b/src/lib/accounting/services/advance.service.ts
@@ -117,7 +117,7 @@ export async function createAdvance(input: AdvanceCreateInput): Promise<any> {
  * Applique une avance à un achat fournisseur
  */
 export async function applyAdvanceToPurchase(
-  input: AdvanceApplicationInput
+  input: AdvanceApplicationInput,
 ): Promise<AdvanceApplicationResult> {
   return prisma.$transaction(async (tx) => {
     // Récupérer l'avance
@@ -155,13 +155,13 @@ export async function applyAdvanceToPurchase(
 
     if (Number(advance.amountRemaining) < input.amount) {
       throw new Error(
-        `Montant demandé (${input.amount}) supérieur au solde disponible (${advance.amountRemaining})`
+        `Montant demandé (${input.amount}) supérieur au solde disponible (${advance.amountRemaining})`,
       );
     }
 
     if (input.amount > Number(purchase.amountDue)) {
       throw new Error(
-        `Montant demandé (${input.amount}) supérieur au montant dû (${purchase.amountDue})`
+        `Montant demandé (${input.amount}) supérieur au montant dû (${purchase.amountDue})`,
       );
     }
 
@@ -178,7 +178,7 @@ export async function applyAdvanceToPurchase(
     // Mettre à jour l'avance
     const newAmountUsed = Number(advance.amountUsed) + input.amount;
     const newAmountRemaining = Number(advance.amount) - newAmountUsed;
-    
+
     let newStatus: string = AdvanceStatus.PARTIAL;
     if (newAmountRemaining <= 0) {
       newStatus = AdvanceStatus.APPLIED;
@@ -239,7 +239,7 @@ export async function applyAdvanceToPurchase(
  */
 export async function cancelAdvanceApplication(
   purchaseAdvanceId: string,
-  cancelledBy?: string
+  cancelledBy?: string,
 ): Promise<AdvanceApplicationResult> {
   return prisma.$transaction(async (tx) => {
     const application = await tx.purchaseAdvance.findUnique({
@@ -264,7 +264,7 @@ export async function cancelAdvanceApplication(
     // Restaurer l'avance
     const newAmountUsed = Number(advance.amountUsed) - Number(amount);
     const newAmountRemaining = Number(advance.amount) - newAmountUsed;
-    
+
     let newStatus: string = AdvanceStatus.PENDING;
     if (newAmountUsed > 0) {
       newStatus = AdvanceStatus.PARTIAL;
@@ -319,7 +319,7 @@ export async function cancelAdvanceApplication(
  */
 export async function refundAdvance(
   advanceId: string,
-  refundedBy?: string
+  refundedBy?: string,
 ): Promise<any> {
   return prisma.$transaction(async (tx) => {
     const advance = await tx.supplierAdvance.findUnique({
@@ -333,7 +333,7 @@ export async function refundAdvance(
 
     if (Number(advance.amountUsed) > 0) {
       throw new Error(
-        "Cette avance a déjà été partiellement utilisée. Annulez d'abord les applications."
+        "Cette avance a déjà été partiellement utilisée. Annulez d'abord les applications.",
       );
     }
 
@@ -435,7 +435,7 @@ export async function getAdvanceById(id: string): Promise<any> {
  * Récupère les avances disponibles pour un fournisseur
  */
 export async function getAvailableAdvancesForSupplier(
-  supplierId: string
+  supplierId: string,
 ): Promise<any[]> {
   return prisma.supplierAdvance.findMany({
     where: {
@@ -454,7 +454,7 @@ export async function getAvailableAdvancesForSupplier(
  * Récupère les avances applicables à un achat
  */
 export async function getApplicableAdvancesForPurchase(
-  purchaseId: string
+  purchaseId: string,
 ): Promise<any[]> {
   const purchase = await prisma.purchase.findUnique({
     where: { id: purchaseId },
@@ -477,8 +477,8 @@ export async function getAdvanceStats(supplierId?: string): Promise<{
   totalAvailable: number;
   byStatus: Record<string, number>;
 }> {
-  const where: Prisma.SupplierAdvanceWhereInput = supplierId 
-    ? { supplierId } 
+  const where: Prisma.SupplierAdvanceWhereInput = supplierId
+    ? { supplierId }
     : {};
 
   const advances = await prisma.supplierAdvance.findMany({ where });
diff --git a/src/lib/accounting/services/cost.service.ts b/src/lib/accounting/services/cost.service.ts
index 97186a4..6f68d92 100644
--- a/src/lib/accounting/services/cost.service.ts
+++ b/src/lib/accounting/services/cost.service.ts
@@ -13,23 +13,23 @@ export interface CostBreakdown {
   accessoryCost: number;
   packagingCost: number;
   materialsCost: number;
-  
+
   // Production
   laborCost: number;
   atelierCost: number;
   productionCost: number;
-  
+
   // Marketing
   adsCost: number;
   shootingCost: number;
   influencerCost: number;
   marketingCost: number;
-  
+
   // Autres
   transportCost: number;
   otherCost: number;
   returnMargin: number;
-  
+
   // Total
   totalCost: number;
 }
@@ -118,8 +118,11 @@ export async function computeCostPerUnit(modelId: string): Promise<CostResult> {
   let accessoryCost = 0;
 
   for (const bomItem of model.bom) {
-    const itemCost = Number(bomItem.quantity) * Number(bomItem.wasteFactor) * Number(bomItem.inventoryItem.averageCost);
-    
+    const itemCost =
+      Number(bomItem.quantity) *
+      Number(bomItem.wasteFactor) *
+      Number(bomItem.inventoryItem.averageCost);
+
     if (bomItem.inventoryItem.type === "FABRIC") {
       fabricCost += itemCost;
     } else {
@@ -128,64 +131,80 @@ export async function computeCostPerUnit(modelId: string): Promise<CostResult> {
   }
 
   // Packaging détaillé
-  const packagingCost = 
-    Number(model.packagingBox) + 
-    Number(model.packagingBag) + 
-    Number(model.packagingLabel) + 
-    Number(model.packagingTag) + 
-    Number(model.packagingCard) + 
+  const packagingCost =
+    Number(model.packagingBox) +
+    Number(model.packagingBag) +
+    Number(model.packagingLabel) +
+    Number(model.packagingTag) +
+    Number(model.packagingCard) +
     Number(model.packagingOther);
 
   const materialsCost = fabricCost + accessoryCost + packagingCost;
 
   // === COÛTS PRODUCTION ===
   const laborCost = Number(model.laborCost);
-  
+
   // Charges atelier allouées à ce modèle
   const atelierCharges = model.charges.filter(
-    c => c.category === "ATELIER" && c.scope === ChargeScope.MODEL
+    (c) => c.category === "ATELIER" && c.scope === ChargeScope.MODEL,
   );
-  const atelierCost = atelierCharges.reduce((sum, c) => sum + Number(c.amount), 0) / units;
-  
+  const atelierCost =
+    atelierCharges.reduce((sum, c) => sum + Number(c.amount), 0) / units;
+
   const productionCost = laborCost + atelierCost;
 
   // === COÛTS MARKETING ===
   // Charges directes au modèle
-  const modelCharges = model.charges.filter(c => c.scope === ChargeScope.MODEL);
-  
-  const adsCost = modelCharges
-    .filter(c => c.category === "ADS")
-    .reduce((sum, c) => sum + Number(c.amount), 0) / units;
+  const modelCharges = model.charges.filter(
+    (c) => c.scope === ChargeScope.MODEL,
+  );
 
-  const shootingCost = modelCharges
-    .filter(c => c.category === "SHOOTING")
-    .reduce((sum, c) => sum + Number(c.amount), 0) / units;
+  const adsCost =
+    modelCharges
+      .filter((c) => c.category === "ADS")
+      .reduce((sum, c) => sum + Number(c.amount), 0) / units;
 
-  const influencerCost = modelCharges
-    .filter(c => c.category === "INFLUENCER")
-    .reduce((sum, c) => sum + Number(c.amount), 0) / units;
+  const shootingCost =
+    modelCharges
+      .filter((c) => c.category === "SHOOTING")
+      .reduce((sum, c) => sum + Number(c.amount), 0) / units;
+
+  const influencerCost =
+    modelCharges
+      .filter((c) => c.category === "INFLUENCER")
+      .reduce((sum, c) => sum + Number(c.amount), 0) / units;
 
   const marketingCost = adsCost + shootingCost + influencerCost;
 
   // === AUTRES COÛTS ===
-  const transportCost = modelCharges
-    .filter(c => c.category === "TRANSPORT")
-    .reduce((sum, c) => sum + Number(c.amount), 0) / units;
-
-  const otherCost = Number(model.otherCost) + modelCharges
-    .filter(c => c.category === "OTHER")
-    .reduce((sum, c) => sum + Number(c.amount), 0) / units;
+  const transportCost =
+    modelCharges
+      .filter((c) => c.category === "TRANSPORT")
+      .reduce((sum, c) => sum + Number(c.amount), 0) / units;
+
+  const otherCost =
+    Number(model.otherCost) +
+    modelCharges
+      .filter((c) => c.category === "OTHER")
+      .reduce((sum, c) => sum + Number(c.amount), 0) /
+      units;
 
   const returnMargin = Number(model.returnMargin) / units;
 
   // === TOTAL ===
-  const totalCost = materialsCost + productionCost + marketingCost + transportCost + otherCost + returnMargin;
+  const totalCost =
+    materialsCost +
+    productionCost +
+    marketingCost +
+    transportCost +
+    otherCost +
+    returnMargin;
 
   // === PRIX SUGGÉRÉS ===
   const suggestedPrices = {
-    margin30: Math.round(totalCost / 0.70),
-    margin40: Math.round(totalCost / 0.60),
-    margin50: Math.round(totalCost / 0.50),
+    margin30: Math.round(totalCost / 0.7),
+    margin40: Math.round(totalCost / 0.6),
+    margin50: Math.round(totalCost / 0.5),
   };
 
   // === MARGE ACTUELLE ===
@@ -243,7 +262,7 @@ export async function computeCostPerUnit(modelId: string): Promise<CostResult> {
  */
 export async function simulatePrice(
   modelId: string,
-  params: SimulationParams
+  params: SimulationParams,
 ): Promise<CostResult> {
   const model = await prisma.model.findUnique({
     where: { id: modelId },
@@ -267,9 +286,12 @@ export async function simulatePrice(
   let accessoryCost = 0;
 
   for (const bomItem of model.bom) {
-    const unitCost = overrides[bomItem.inventoryItemId] ?? Number(bomItem.inventoryItem.averageCost);
-    const itemCost = Number(bomItem.quantity) * Number(bomItem.wasteFactor) * unitCost;
-    
+    const unitCost =
+      overrides[bomItem.inventoryItemId] ??
+      Number(bomItem.inventoryItem.averageCost);
+    const itemCost =
+      Number(bomItem.quantity) * Number(bomItem.wasteFactor) * unitCost;
+
     if (bomItem.inventoryItem.type === "FABRIC") {
       fabricCost += itemCost;
     } else {
@@ -277,28 +299,35 @@ export async function simulatePrice(
     }
   }
 
-  const packagingCost = params.packagingCost ?? (
-    Number(model.packagingBox) + 
-    Number(model.packagingBag) + 
-    Number(model.packagingLabel) + 
-    Number(model.packagingTag) + 
-    Number(model.packagingCard) + 
-    Number(model.packagingOther)
-  );
+  const packagingCost =
+    params.packagingCost ??
+    Number(model.packagingBox) +
+      Number(model.packagingBag) +
+      Number(model.packagingLabel) +
+      Number(model.packagingTag) +
+      Number(model.packagingCard) +
+      Number(model.packagingOther);
 
   const materialsCost = fabricCost + accessoryCost + packagingCost;
   const laborCost = params.laborCost ?? Number(model.laborCost);
 
   // Charges réparties sur les unités
-  const modelCharges = model.charges.filter(c => c.scope === ChargeScope.MODEL);
-  const chargesPerUnit = modelCharges.reduce((sum, c) => sum + Number(c.amount), 0) / units;
+  const modelCharges = model.charges.filter(
+    (c) => c.scope === ChargeScope.MODEL,
+  );
+  const chargesPerUnit =
+    modelCharges.reduce((sum, c) => sum + Number(c.amount), 0) / units;
 
-  const totalCost = materialsCost + laborCost + chargesPerUnit + Number(model.returnMargin) / units;
+  const totalCost =
+    materialsCost +
+    laborCost +
+    chargesPerUnit +
+    Number(model.returnMargin) / units;
 
   const suggestedPrices = {
-    margin30: Math.round(totalCost / 0.70),
-    margin40: Math.round(totalCost / 0.60),
-    margin50: Math.round(totalCost / 0.50),
+    margin30: Math.round(totalCost / 0.7),
+    margin40: Math.round(totalCost / 0.6),
+    margin50: Math.round(totalCost / 0.5),
   };
 
   // Prix pour marge cible
@@ -346,7 +375,9 @@ export async function simulatePrice(
 /**
  * Calcule la rentabilité d'un modèle basée sur les ventes réelles
  */
-export async function computeModelProfitability(modelId: string): Promise<ProfitabilityResult> {
+export async function computeModelProfitability(
+  modelId: string,
+): Promise<ProfitabilityResult> {
   const model = await prisma.model.findUnique({
     where: { id: modelId },
   });
@@ -364,21 +395,26 @@ export async function computeModelProfitability(modelId: string): Promise<Profit
   });
 
   // Filtrer les commandes complétées/livrées
-  const completedItems = orderItems.filter(
-    item => ["DELIVERED", "COMPLETED", "SHIPPED"].includes(item.order.status)
+  const completedItems = orderItems.filter((item) =>
+    ["DELIVERED", "COMPLETED", "SHIPPED"].includes(item.order.status),
   );
 
-  const unitsSold = completedItems.reduce((sum, item) => sum + item.quantity, 0);
-  const totalRevenue = completedItems.reduce((sum, item) => sum + Number(item.totalPrice), 0);
+  const unitsSold = completedItems.reduce(
+    (sum, item) => sum + item.quantity,
+    0,
+  );
+  const totalRevenue = completedItems.reduce(
+    (sum, item) => sum + Number(item.totalPrice),
+    0,
+  );
 
   // Calculer le coût
   const costResult = await computeCostPerUnit(modelId);
   const totalCost = unitsSold * costResult.costPerUnit;
 
   const grossProfit = totalRevenue - totalCost;
-  const grossMarginPercent = totalRevenue > 0 
-    ? (grossProfit / totalRevenue) * 100 
-    : 0;
+  const grossMarginPercent =
+    totalRevenue > 0 ? (grossProfit / totalRevenue) * 100 : 0;
 
   const avgSellingPrice = unitsSold > 0 ? totalRevenue / unitsSold : 0;
   const avgCostPerUnit = costResult.costPerUnit;
@@ -413,7 +449,7 @@ export async function computeModelProfitability(modelId: string): Promise<Profit
  * Calcule la rentabilité d'une collection
  */
 export async function computeCollectionProfitability(
-  collectionId: string
+  collectionId: string,
 ): Promise<CollectionProfitability> {
   const collection = await prisma.collection.findUnique({
     where: { id: collectionId },
@@ -450,13 +486,15 @@ export async function computeCollectionProfitability(
     },
   });
 
-  const chargesTotal = collectionCharges.reduce((sum, c) => sum + Number(c.amount), 0);
+  const chargesTotal = collectionCharges.reduce(
+    (sum, c) => sum + Number(c.amount),
+    0,
+  );
   totalCost += chargesTotal;
 
   const grossProfit = totalRevenue - totalCost;
-  const grossMarginPercent = totalRevenue > 0 
-    ? (grossProfit / totalRevenue) * 100 
-    : 0;
+  const grossMarginPercent =
+    totalRevenue > 0 ? (grossProfit / totalRevenue) * 100 : 0;
 
   return {
     collectionId: collection.id,
@@ -480,7 +518,7 @@ export async function computeCollectionProfitability(
 export async function createCostSnapshot(
   modelId: string,
   batchId?: string,
-  createdBy?: string
+  createdBy?: string,
 ): Promise<any> {
   const costResult = await computeCostPerUnit(modelId);
   const breakdown = costResult.breakdown;
@@ -488,7 +526,7 @@ export async function createCostSnapshot(
   // Générer numéro de snapshot
   const year = new Date().getFullYear();
   const prefix = `SNP-${year}-`;
-  
+
   const last = await prisma.costSnapshot.findFirst({
     where: { snapshotNumber: { startsWith: prefix } },
     orderBy: { snapshotNumber: "desc" },
@@ -568,14 +606,20 @@ export async function getGlobalCostReport(): Promise<{
     }
   }
 
-  const profitableModels = results.filter(r => r.status === "PROFITABLE").length;
-  const lossModels = results.filter(r => r.status === "LOSS").length;
-  const avgMargin = results.length > 0
-    ? results.reduce((sum, r) => sum + r.grossMarginPercent, 0) / results.length
-    : 0;
+  const profitableModels = results.filter(
+    (r) => r.status === "PROFITABLE",
+  ).length;
+  const lossModels = results.filter((r) => r.status === "LOSS").length;
+  const avgMargin =
+    results.length > 0
+      ? results.reduce((sum, r) => sum + r.grossMarginPercent, 0) /
+        results.length
+      : 0;
 
   // Trier pour top/worst
-  const sorted = [...results].sort((a, b) => b.grossMarginPercent - a.grossMarginPercent);
+  const sorted = [...results].sort(
+    (a, b) => b.grossMarginPercent - a.grossMarginPercent,
+  );
   const topProfitable = sorted.slice(0, 5);
   const worstPerformers = sorted.slice(-5).reverse();
 
diff --git a/src/lib/accounting/services/index.ts b/src/lib/accounting/services/index.ts
index 7f43cbd..9d3171f 100644
--- a/src/lib/accounting/services/index.ts
+++ b/src/lib/accounting/services/index.ts
@@ -88,7 +88,7 @@ export type {
 } from "./production.service";
 
 // Re-export CostBreakdown and CostResult with aliases to avoid conflict
-export type { 
+export type {
   CostBreakdown as ServiceCostBreakdown,
   CostResult as ServiceCostResult,
   SimulationParams,
diff --git a/src/lib/accounting/services/inventory.service.ts b/src/lib/accounting/services/inventory.service.ts
index 59c0c87..08dc67e 100644
--- a/src/lib/accounting/services/inventory.service.ts
+++ b/src/lib/accounting/services/inventory.service.ts
@@ -49,17 +49,18 @@ export function calculateCUMP(
   currentQty: number,
   currentAvgCost: number,
   incomingQty: number,
-  incomingUnitCost: number
+  incomingUnitCost: number,
 ): CUMPResult {
   const currentValue = currentQty * currentAvgCost;
   const incomingValue = incomingQty * incomingUnitCost;
   const newQuantity = currentQty + incomingQty;
-  
+
   // Éviter division par zéro
-  const newAverageCost = newQuantity > 0 
-    ? (currentValue + incomingValue) / newQuantity 
-    : incomingUnitCost;
-  
+  const newAverageCost =
+    newQuantity > 0
+      ? (currentValue + incomingValue) / newQuantity
+      : incomingUnitCost;
+
   const newTotalValue = newQuantity * newAverageCost;
 
   return {
@@ -79,7 +80,7 @@ export function calculateCUMP(
  */
 export async function createInventoryMovement(
   movement: InventoryMovement,
-  tx?: Prisma.TransactionClient
+  tx?: Prisma.TransactionClient,
 ): Promise<{ transaction: any; item: any }> {
   const client = tx || prisma;
 
@@ -89,7 +90,9 @@ export async function createInventoryMovement(
   });
 
   if (!item) {
-    throw new Error(`Article inventaire non trouvé: ${movement.inventoryItemId}`);
+    throw new Error(
+      `Article inventaire non trouvé: ${movement.inventoryItemId}`,
+    );
   }
 
   // Snapshots avant
@@ -108,7 +111,7 @@ export async function createInventoryMovement(
       Number(item.quantity),
       Number(item.averageCost),
       movement.quantity,
-      movement.unitCost
+      movement.unitCost,
     );
     balanceAfter = cump.newQuantity;
     avgCostAfter = cump.newAverageCost;
@@ -119,7 +122,7 @@ export async function createInventoryMovement(
     balanceAfter = Number(item.quantity) - movement.quantity;
     avgCostAfter = Number(item.averageCost);
     valueAfter = balanceAfter * avgCostAfter;
-    
+
     // Pour les sorties de type RESERVE, ne pas réduire available (déjà fait)
     if (movement.type === TxType.RESERVE) {
       availableAfter = Number(item.available); // Déjà réduit par reserveStock
@@ -133,7 +136,7 @@ export async function createInventoryMovement(
   // Validation: pas de stock négatif
   if (balanceAfter < 0) {
     throw new Error(
-      `Stock insuffisant pour ${item.name}. Disponible: ${item.quantity}, Demandé: ${movement.quantity}`
+      `Stock insuffisant pour ${item.name}. Disponible: ${item.quantity}, Demandé: ${movement.quantity}`,
     );
   }
 
@@ -167,8 +170,14 @@ export async function createInventoryMovement(
       available: Math.max(0, availableAfter),
       averageCost: avgCostAfter,
       totalValue: valueAfter,
-      lastCost: movement.direction === TxDirection.IN ? movement.unitCost : item.lastCost,
-      lastReceivedAt: movement.direction === TxDirection.IN ? new Date() : item.lastReceivedAt,
+      lastCost:
+        movement.direction === TxDirection.IN
+          ? movement.unitCost
+          : item.lastCost,
+      lastReceivedAt:
+        movement.direction === TxDirection.IN
+          ? new Date()
+          : item.lastReceivedAt,
     },
   });
 
@@ -187,7 +196,7 @@ export async function reserveStock(
   inventoryItemId: string,
   quantity: number,
   orderId: string,
-  tx?: Prisma.TransactionClient
+  tx?: Prisma.TransactionClient,
 ): Promise<any> {
   const client = tx || prisma;
 
@@ -201,7 +210,7 @@ export async function reserveStock(
 
   if (Number(item.available) < quantity) {
     throw new Error(
-      `Stock disponible insuffisant pour ${item.name}. Disponible: ${item.available}, Demandé: ${quantity}`
+      `Stock disponible insuffisant pour ${item.name}. Disponible: ${item.available}, Demandé: ${quantity}`,
     );
   }
 
@@ -215,16 +224,19 @@ export async function reserveStock(
   });
 
   // Créer transaction de réservation
-  await createInventoryMovement({
-    inventoryItemId,
-    direction: "OUT",
-    type: TxType.RESERVE,
-    quantity,
-    unitCost: Number(item.averageCost),
-    referenceType: "ORDER",
-    referenceId: orderId,
-    notes: `Réservation pour commande ${orderId}`,
-  }, client);
+  await createInventoryMovement(
+    {
+      inventoryItemId,
+      direction: "OUT",
+      type: TxType.RESERVE,
+      quantity,
+      unitCost: Number(item.averageCost),
+      referenceType: "ORDER",
+      referenceId: orderId,
+      notes: `Réservation pour commande ${orderId}`,
+    },
+    client,
+  );
 
   return updatedItem;
 }
@@ -236,7 +248,7 @@ export async function releaseStock(
   inventoryItemId: string,
   quantity: number,
   orderId: string,
-  tx?: Prisma.TransactionClient
+  tx?: Prisma.TransactionClient,
 ): Promise<any> {
   const client = tx || prisma;
 
@@ -250,7 +262,7 @@ export async function releaseStock(
 
   if (Number(item.reserved) < quantity) {
     throw new Error(
-      `Quantité réservée insuffisante pour ${item.name}. Réservé: ${item.reserved}, Demandé: ${quantity}`
+      `Quantité réservée insuffisante pour ${item.name}. Réservé: ${item.reserved}, Demandé: ${quantity}`,
     );
   }
 
@@ -264,16 +276,19 @@ export async function releaseStock(
   });
 
   // Créer transaction de libération
-  await createInventoryMovement({
-    inventoryItemId,
-    direction: "IN",
-    type: TxType.RELEASE,
-    quantity,
-    unitCost: Number(item.averageCost),
-    referenceType: "ORDER",
-    referenceId: orderId,
-    notes: `Libération pour commande ${orderId}`,
-  }, client);
+  await createInventoryMovement(
+    {
+      inventoryItemId,
+      direction: "IN",
+      type: TxType.RELEASE,
+      quantity,
+      unitCost: Number(item.averageCost),
+      referenceType: "ORDER",
+      referenceId: orderId,
+      notes: `Libération pour commande ${orderId}`,
+    },
+    client,
+  );
 
   return updatedItem;
 }
@@ -288,7 +303,7 @@ export async function releaseStock(
 export async function shipOrderStock(
   orderId: string,
   items: Array<{ inventoryItemId: string; quantity: number }>,
-  tx?: Prisma.TransactionClient
+  tx?: Prisma.TransactionClient,
 ): Promise<void> {
   const client = tx || prisma;
 
@@ -307,7 +322,9 @@ export async function shipOrderStock(
       data: {
         quantity: Number(invItem.quantity) - item.quantity,
         reserved: Math.max(0, Number(invItem.reserved) - item.quantity),
-        totalValue: (Number(invItem.quantity) - item.quantity) * Number(invItem.averageCost),
+        totalValue:
+          (Number(invItem.quantity) - item.quantity) *
+          Number(invItem.averageCost),
       },
     });
 
@@ -322,7 +339,9 @@ export async function shipOrderStock(
         balanceBefore: Number(invItem.quantity),
         balanceAfter: Number(invItem.quantity) - item.quantity,
         valueBefore: Number(invItem.totalValue),
-        valueAfter: (Number(invItem.quantity) - item.quantity) * Number(invItem.averageCost),
+        valueAfter:
+          (Number(invItem.quantity) - item.quantity) *
+          Number(invItem.averageCost),
         avgCostBefore: Number(invItem.averageCost),
         avgCostAfter: Number(invItem.averageCost),
         referenceType: "ORDER",
@@ -339,22 +358,25 @@ export async function shipOrderStock(
 export async function cancelShipment(
   orderId: string,
   items: Array<{ inventoryItemId: string; quantity: number }>,
-  tx?: Prisma.TransactionClient
+  tx?: Prisma.TransactionClient,
 ): Promise<void> {
   const client = tx || prisma;
 
   for (const item of items) {
-    await createInventoryMovement({
-      inventoryItemId: item.inventoryItemId,
-      direction: "IN",
-      type: TxType.ADJUSTMENT,
-      quantity: item.quantity,
-      unitCost: 0, // On récupère le CUMP existant
-      referenceType: "ORDER",
-      referenceId: orderId,
-      reason: "Annulation expédition",
-      notes: `Retour stock suite annulation expédition ${orderId}`,
-    }, client);
+    await createInventoryMovement(
+      {
+        inventoryItemId: item.inventoryItemId,
+        direction: "IN",
+        type: TxType.ADJUSTMENT,
+        quantity: item.quantity,
+        unitCost: 0, // On récupère le CUMP existant
+        referenceType: "ORDER",
+        referenceId: orderId,
+        reason: "Annulation expédition",
+        notes: `Retour stock suite annulation expédition ${orderId}`,
+      },
+      client,
+    );
   }
 }
 
@@ -370,7 +392,7 @@ export async function createAdjustment(
   quantity: number, // Positif = entrée, Négatif = sortie
   reason: string,
   notes?: string,
-  createdBy?: string
+  createdBy?: string,
 ): Promise<any> {
   const direction = quantity >= 0 ? TxDirection.IN : TxDirection.OUT;
   const absQuantity = Math.abs(quantity);
@@ -406,9 +428,9 @@ export async function createAdjustment(
  * Compare les quantités attendues (calculées depuis transactions) avec les quantités actuelles
  */
 export async function reconcileInventory(
-  inventoryItemIds?: string[]
+  inventoryItemIds?: string[],
 ): Promise<ReconciliationItem[]> {
-  const where = inventoryItemIds?.length 
+  const where = inventoryItemIds?.length
     ? { id: { in: inventoryItemIds } }
     : {};
 
@@ -435,9 +457,12 @@ export async function reconcileInventory(
     }
 
     const variance = Number(item.quantity) - expectedQty;
-    const variancePercent = expectedQty !== 0 
-      ? (variance / expectedQty) * 100 
-      : (variance !== 0 ? 100 : 0);
+    const variancePercent =
+      expectedQty !== 0
+        ? (variance / expectedQty) * 100
+        : variance !== 0
+          ? 100
+          : 0;
     const varianceValue = variance * Number(item.averageCost);
 
     let status: "OK" | "WARNING" | "CRITICAL" = "OK";
@@ -492,8 +517,8 @@ export async function getLowStockItems(): Promise<any[]> {
     },
   });
 
-  return items.filter(item => 
-    item.threshold !== null && item.quantity <= item.threshold
+  return items.filter(
+    (item) => item.threshold !== null && item.quantity <= item.threshold,
   );
 }
 
@@ -528,7 +553,7 @@ export async function getInventoryValuation(): Promise<{
  * Vérifie la disponibilité du stock pour une liste d'articles
  */
 export async function checkStockAvailability(
-  items: Array<{ inventoryItemId: string; quantity: number }>
+  items: Array<{ inventoryItemId: string; quantity: number }>,
 ): Promise<{
   available: boolean;
   details: Array<{
diff --git a/src/lib/accounting/services/production.service.ts b/src/lib/accounting/services/production.service.ts
index c9193ff..0bfe739 100644
--- a/src/lib/accounting/services/production.service.ts
+++ b/src/lib/accounting/services/production.service.ts
@@ -6,7 +6,10 @@
 import { prisma } from "@/lib/prisma";
 import { Prisma } from "@prisma/client";
 import { BatchStatus, TxDirection, TxType } from "../constants";
-import { createInventoryMovement, checkStockAvailability } from "./inventory.service";
+import {
+  createInventoryMovement,
+  checkStockAvailability,
+} from "./inventory.service";
 
 // Types
 export interface BatchCreateInput {
@@ -82,7 +85,9 @@ async function generateBatchNumber(): Promise<string> {
 /**
  * Crée un nouveau lot de production
  */
-export async function createProductionBatch(input: BatchCreateInput): Promise<any> {
+export async function createProductionBatch(
+  input: BatchCreateInput,
+): Promise<any> {
   return prisma.$transaction(async (tx) => {
     // Vérifier que le modèle existe
     const model = await tx.model.findUnique({
@@ -106,7 +111,10 @@ export async function createProductionBatch(input: BatchCreateInput): Promise<an
     const consumptions = [];
 
     for (const bomItem of model.bom) {
-      const requiredQty = Number(bomItem.quantity) * Number(bomItem.wasteFactor) * input.plannedQty;
+      const requiredQty =
+        Number(bomItem.quantity) *
+        Number(bomItem.wasteFactor) *
+        input.plannedQty;
       const itemCost = requiredQty * Number(bomItem.inventoryItem.averageCost);
       materialsCost += itemCost;
 
@@ -119,7 +127,8 @@ export async function createProductionBatch(input: BatchCreateInput): Promise<an
       });
     }
 
-    const laborCost = input.laborCost || Number(model.laborCost) * input.plannedQty;
+    const laborCost =
+      input.laborCost || Number(model.laborCost) * input.plannedQty;
     const overheadCost = input.overheadCost || 0;
     const totalCost = materialsCost + laborCost + overheadCost;
     const costPerUnit = input.plannedQty > 0 ? totalCost / input.plannedQty : 0;
@@ -173,7 +182,9 @@ export async function createProductionBatch(input: BatchCreateInput): Promise<an
 /**
  * Génère un aperçu de la consommation de matières pour un lot
  */
-export async function previewConsumption(batchId: string): Promise<BatchConsumptionPreview> {
+export async function previewConsumption(
+  batchId: string,
+): Promise<BatchConsumptionPreview> {
   const batch = await prisma.productionBatch.findUnique({
     where: { id: batchId },
     include: {
@@ -198,7 +209,8 @@ export async function previewConsumption(batchId: string): Promise<BatchConsumpt
   let maxProducible = batch.plannedQty;
 
   for (const bomItem of batch.model.bom) {
-    const requiredQty = Number(bomItem.quantity) * Number(bomItem.wasteFactor) * batch.plannedQty;
+    const requiredQty =
+      Number(bomItem.quantity) * Number(bomItem.wasteFactor) * batch.plannedQty;
     const inv = bomItem.inventoryItem;
     const shortage = Math.max(0, requiredQty - Number(inv.available));
     const totalCost = requiredQty * Number(inv.averageCost);
@@ -207,7 +219,8 @@ export async function previewConsumption(batchId: string): Promise<BatchConsumpt
       canProduce = false;
       // Calculer combien on peut produire
       const possibleWithStock = Math.floor(
-        Number(inv.available) / (Number(bomItem.quantity) * Number(bomItem.wasteFactor))
+        Number(inv.available) /
+          (Number(bomItem.quantity) * Number(bomItem.wasteFactor)),
       );
       maxProducible = Math.min(maxProducible, possibleWithStock);
     }
@@ -310,7 +323,7 @@ export async function startBatch(batchId: string): Promise<any> {
 export async function consumeProductionBatch(
   batchId: string,
   actualConsumptions?: ConsumptionInput[],
-  createdBy?: string
+  createdBy?: string,
 ): Promise<any> {
   return prisma.$transaction(async (tx) => {
     const batch = await tx.productionBatch.findUnique({
@@ -350,7 +363,10 @@ export async function consumeProductionBatch(
     } else {
       // Consommations selon BOM
       for (const bomItem of batch.model.bom) {
-        const requiredQty = Number(bomItem.quantity) * Number(bomItem.wasteFactor) * batch.plannedQty;
+        const requiredQty =
+          Number(bomItem.quantity) *
+          Number(bomItem.wasteFactor) *
+          batch.plannedQty;
         toConsume.set(bomItem.inventoryItemId, requiredQty);
       }
     }
@@ -393,14 +409,14 @@ export async function consumeProductionBatch(
           notes: `Production lot ${batch.batchNumber}`,
           createdBy,
         },
-        tx
+        tx,
       );
 
       actualMaterialsCost += quantity * Number(inv.averageCost);
 
       // Mettre à jour la consommation
       const consumption = batch.consumptions.find(
-        (c) => c.inventoryItemId === inventoryItemId
+        (c) => c.inventoryItemId === inventoryItemId,
       );
       if (consumption) {
         await tx.batchConsumption.update({
@@ -415,7 +431,10 @@ export async function consumeProductionBatch(
     }
 
     // Mettre à jour les coûts du lot
-    const totalCost = actualMaterialsCost + Number(batch.laborCost) + Number(batch.overheadCost);
+    const totalCost =
+      actualMaterialsCost +
+      Number(batch.laborCost) +
+      Number(batch.overheadCost);
     const costPerUnit = batch.plannedQty > 0 ? totalCost / batch.plannedQty : 0;
 
     const updated = await tx.productionBatch.update({
@@ -436,7 +455,10 @@ export async function consumeProductionBatch(
         action: "CONSUME",
         entity: "ProductionBatch",
         entityId: batchId,
-        after: JSON.stringify({ materialsCost: actualMaterialsCost, items: Array.from(toConsume) }),
+        after: JSON.stringify({
+          materialsCost: actualMaterialsCost,
+          items: Array.from(toConsume),
+        }),
         userId: createdBy,
       },
     });
@@ -455,7 +477,7 @@ export async function consumeProductionBatch(
 export async function completeBatch(
   batchId: string,
   producedQty: number,
-  wasteQty?: number
+  wasteQty?: number,
 ): Promise<any> {
   return prisma.$transaction(async (tx) => {
     const batch = await tx.productionBatch.findUnique({
@@ -472,7 +494,8 @@ export async function completeBatch(
     }
 
     // Recalculer le coût par unité avec la quantité réelle
-    const costPerUnit = producedQty > 0 ? Number(batch.totalCost) / producedQty : 0;
+    const costPerUnit =
+      producedQty > 0 ? Number(batch.totalCost) / producedQty : 0;
 
     const updated = await tx.productionBatch.update({
       where: { id: batchId },
@@ -550,7 +573,7 @@ export async function cancelBatch(batchId: string): Promise<any> {
             reason: "Annulation lot production",
             notes: `Retour stock suite annulation lot ${batch.batchNumber}`,
           },
-          tx
+          tx,
         );
       }
     }
diff --git a/src/lib/accounting/services/purchase.service.ts b/src/lib/accounting/services/purchase.service.ts
index 3116eb0..e72867e 100644
--- a/src/lib/accounting/services/purchase.service.ts
+++ b/src/lib/accounting/services/purchase.service.ts
@@ -96,9 +96,10 @@ export async function createPurchase(input: PurchaseCreateInput): Promise<any> {
     // Calculer les totaux
     const subtotal = input.items.reduce(
       (sum, item) => sum + item.quantityOrdered * item.unitPrice,
-      0
+      0,
     );
-    const totalAmount = subtotal + (input.taxAmount || 0) + (input.shippingCost || 0);
+    const totalAmount =
+      subtotal + (input.taxAmount || 0) + (input.shippingCost || 0);
 
     // Créer l'achat
     const purchase = await tx.purchase.create({
@@ -124,7 +125,9 @@ export async function createPurchase(input: PurchaseCreateInput): Promise<any> {
             unit: item.unit,
             unitPrice: item.unitPrice,
             totalPrice: item.quantityOrdered * item.unitPrice,
-            allocations: item.allocations ? JSON.stringify(item.allocations) : null,
+            allocations: item.allocations
+              ? JSON.stringify(item.allocations)
+              : null,
           })),
         },
       },
@@ -235,7 +238,9 @@ export async function cancelPurchase(purchaseId: string): Promise<any> {
 /**
  * Génère un aperçu de l'impact de la réception sur le stock
  */
-export async function previewReceive(purchaseId: string): Promise<ReceivePreview> {
+export async function previewReceive(
+  purchaseId: string,
+): Promise<ReceivePreview> {
   const purchase = await prisma.purchase.findUnique({
     where: { id: purchaseId },
     include: {
@@ -256,7 +261,8 @@ export async function previewReceive(purchaseId: string): Promise<ReceivePreview
 
   for (const item of purchase.items) {
     const inv = item.inventoryItem;
-    const quantityToReceive = Number(item.quantityOrdered) - Number(item.quantityReceived);
+    const quantityToReceive =
+      Number(item.quantityOrdered) - Number(item.quantityReceived);
 
     if (quantityToReceive <= 0) continue;
 
@@ -265,7 +271,7 @@ export async function previewReceive(purchaseId: string): Promise<ReceivePreview
       Number(inv.quantity),
       Number(inv.averageCost),
       quantityToReceive,
-      Number(item.unitPrice)
+      Number(item.unitPrice),
     );
 
     previewItems.push({
@@ -324,7 +330,7 @@ export async function previewReceive(purchaseId: string): Promise<ReceivePreview
 export async function receivePurchase(
   purchaseId: string,
   items: ReceiveItemInput[],
-  receivedBy?: string
+  receivedBy?: string,
 ): Promise<any> {
   return prisma.$transaction(async (tx) => {
     const purchase = await tx.purchase.findUnique({
@@ -353,13 +359,20 @@ export async function receivePurchase(
     let anyReceived = false;
 
     for (const receiveItem of items) {
-      const purchaseItem = purchase.items.find((pi) => pi.id === receiveItem.id);
+      const purchaseItem = purchase.items.find(
+        (pi) => pi.id === receiveItem.id,
+      );
       if (!purchaseItem) {
         throw new Error(`Article d'achat non trouvé: ${receiveItem.id}`);
       }
 
-      const remainingToReceive = Number(purchaseItem.quantityOrdered) - Number(purchaseItem.quantityReceived);
-      const qtyToReceive = Math.min(receiveItem.quantityReceived, remainingToReceive);
+      const remainingToReceive =
+        Number(purchaseItem.quantityOrdered) -
+        Number(purchaseItem.quantityReceived);
+      const qtyToReceive = Math.min(
+        receiveItem.quantityReceived,
+        remainingToReceive,
+      );
 
       if (qtyToReceive <= 0) continue;
 
@@ -369,7 +382,8 @@ export async function receivePurchase(
       await tx.purchaseItem.update({
         where: { id: purchaseItem.id },
         data: {
-          quantityReceived: Number(purchaseItem.quantityReceived) + qtyToReceive,
+          quantityReceived:
+            Number(purchaseItem.quantityReceived) + qtyToReceive,
         },
       });
 
@@ -386,7 +400,7 @@ export async function receivePurchase(
           notes: `Réception achat ${purchase.purchaseNumber} - ${purchase.supplier.name}`,
           createdBy: receivedBy,
         },
-        tx
+        tx,
       );
 
       // Vérifier si tout est reçu pour cet article
@@ -402,15 +416,15 @@ export async function receivePurchase(
     });
 
     const fullyReceived = updatedItems.every(
-      (item) => item.quantityReceived >= item.quantityOrdered
+      (item) => item.quantityReceived >= item.quantityOrdered,
     );
 
     // Mettre à jour le statut de l'achat
     const newStatus = fullyReceived
       ? PurchaseStatus.RECEIVED
       : anyReceived
-      ? PurchaseStatus.PARTIAL
-      : purchase.status;
+        ? PurchaseStatus.PARTIAL
+        : purchase.status;
 
     const updatedPurchase = await tx.purchase.update({
       where: { id: purchaseId },
@@ -544,7 +558,11 @@ export async function getPurchaseStats(period?: {
   total: number;
   totalAmount: number;
   byStatus: Record<string, number>;
-  bySupplier: Array<{ supplierId: string; supplierName: string; total: number }>;
+  bySupplier: Array<{
+    supplierId: string;
+    supplierName: string;
+    total: number;
+  }>;
 }> {
   const where: Prisma.PurchaseWhereInput = {};
 
diff --git a/src/lib/accounting/types.ts b/src/lib/accounting/types.ts
index 6c39ed7..1d32f01 100644
--- a/src/lib/accounting/types.ts
+++ b/src/lib/accounting/types.ts
@@ -79,10 +79,14 @@ export const PurchaseItemSchema = z.object({
   quantityOrdered: z.number().positive("Quantité requise"),
   unit: z.string().min(1, "Unité requise"),
   unitPrice: z.number().min(0, "Prix requis"),
-  allocations: z.array(z.object({
-    modelId: z.string(),
-    quantity: z.number().positive(),
-  })).optional(),
+  allocations: z
+    .array(
+      z.object({
+        modelId: z.string(),
+        quantity: z.number().positive(),
+      }),
+    )
+    .optional(),
 });
 
 export const PurchaseCreateSchema = z.object({
@@ -98,10 +102,12 @@ export const PurchaseCreateSchema = z.object({
 });
 
 export const PurchaseReceiveSchema = z.object({
-  items: z.array(z.object({
-    id: z.string(),
-    quantityReceived: z.number().min(0),
-  })),
+  items: z.array(
+    z.object({
+      id: z.string(),
+      quantityReceived: z.number().min(0),
+    }),
+  ),
   receivedBy: z.string().optional(),
 });
 
@@ -113,12 +119,14 @@ export const AdvanceCreateSchema = z.object({
   supplierId: z.string().min(1, "Fournisseur requis"),
   amount: z.number().positive("Montant requis"),
   paymentDate: z.string().optional(),
-  paymentMethod: z.enum([
-    PaymentMethod.CASH,
-    PaymentMethod.CHECK,
-    PaymentMethod.TRANSFER,
-    PaymentMethod.CCP,
-  ]).optional(),
+  paymentMethod: z
+    .enum([
+      PaymentMethod.CASH,
+      PaymentMethod.CHECK,
+      PaymentMethod.TRANSFER,
+      PaymentMethod.CCP,
+    ])
+    .optional(),
   reference: z.string().optional(),
   notes: z.string().optional(),
 });
@@ -146,33 +154,37 @@ export const ChargeCreateSchema = z.object({
   description: z.string().min(1, "Description requise"),
   amount: z.number().positive("Montant requis"),
   date: z.string().optional(),
-  scope: z.enum([
-    ChargeScope.GLOBAL,
-    ChargeScope.COLLECTION,
-    ChargeScope.MODEL,
-  ]).default(ChargeScope.GLOBAL),
+  scope: z
+    .enum([ChargeScope.GLOBAL, ChargeScope.COLLECTION, ChargeScope.MODEL])
+    .default(ChargeScope.GLOBAL),
   collectionId: z.string().optional(),
   modelId: z.string().optional(),
   vendor: z.string().optional(),
   invoiceRef: z.string().optional(),
   campaign: z.string().optional(),
-  platform: z.enum([
-    Platform.FACEBOOK,
-    Platform.INSTAGRAM,
-    Platform.TIKTOK,
-    Platform.GOOGLE,
-    Platform.OTHER,
-  ]).optional(),
+  platform: z
+    .enum([
+      Platform.FACEBOOK,
+      Platform.INSTAGRAM,
+      Platform.TIKTOK,
+      Platform.GOOGLE,
+      Platform.OTHER,
+    ])
+    .optional(),
   notes: z.string().optional(),
 });
 
 export const ChargeAllocateSchema = z.object({
   chargeId: z.string().min(1),
-  allocations: z.array(z.object({
-    modelId: z.string(),
-    amount: z.number().positive(),
-    percent: z.number().min(0).max(100).optional(),
-  })).min(1, "Au moins une allocation requise"),
+  allocations: z
+    .array(
+      z.object({
+        modelId: z.string(),
+        amount: z.number().positive(),
+        percent: z.number().min(0).max(100).optional(),
+      }),
+    )
+    .min(1, "Au moins une allocation requise"),
 });
 
 // =============================================================================
@@ -239,23 +251,23 @@ export interface CostBreakdown {
   accessoryCost: number;
   packagingCost: number;
   materialsCost: number;
-  
+
   // Production
   laborCost: number;
   atelierCost: number;
   productionCost: number;
-  
+
   // Marketing
   adsCost: number;
   shootingCost: number;
   influencerCost: number;
   marketingCost: number;
-  
+
   // Autres
   transportCost: number;
   otherCost: number;
   returnMargin: number;
-  
+
   // Total
   totalCost: number;
 }
@@ -366,13 +378,15 @@ export interface PaginatedResult<T> {
 // =============================================================================
 
 export const PurchaseFilterSchema = z.object({
-  status: z.enum([
-    PurchaseStatus.DRAFT,
-    PurchaseStatus.ORDERED,
-    PurchaseStatus.PARTIAL,
-    PurchaseStatus.RECEIVED,
-    PurchaseStatus.CANCELLED,
-  ]).optional(),
+  status: z
+    .enum([
+      PurchaseStatus.DRAFT,
+      PurchaseStatus.ORDERED,
+      PurchaseStatus.PARTIAL,
+      PurchaseStatus.RECEIVED,
+      PurchaseStatus.CANCELLED,
+    ])
+    .optional(),
   supplierId: z.string().optional(),
   dateFrom: z.string().optional(),
   dateTo: z.string().optional(),
@@ -380,20 +394,20 @@ export const PurchaseFilterSchema = z.object({
 });
 
 export const ChargeFilterSchema = z.object({
-  category: z.enum([
-    ChargeCategory.ATELIER,
-    ChargeCategory.SHOOTING,
-    ChargeCategory.ADS,
-    ChargeCategory.INFLUENCER,
-    ChargeCategory.TRANSPORT,
-    ChargeCategory.LABOR,
-    ChargeCategory.OTHER,
-  ]).optional(),
-  scope: z.enum([
-    ChargeScope.GLOBAL,
-    ChargeScope.COLLECTION,
-    ChargeScope.MODEL,
-  ]).optional(),
+  category: z
+    .enum([
+      ChargeCategory.ATELIER,
+      ChargeCategory.SHOOTING,
+      ChargeCategory.ADS,
+      ChargeCategory.INFLUENCER,
+      ChargeCategory.TRANSPORT,
+      ChargeCategory.LABOR,
+      ChargeCategory.OTHER,
+    ])
+    .optional(),
+  scope: z
+    .enum([ChargeScope.GLOBAL, ChargeScope.COLLECTION, ChargeScope.MODEL])
+    .optional(),
   modelId: z.string().optional(),
   collectionId: z.string().optional(),
   dateFrom: z.string().optional(),
@@ -403,15 +417,17 @@ export const ChargeFilterSchema = z.object({
 export const TransactionFilterSchema = z.object({
   inventoryItemId: z.string().optional(),
   direction: z.enum([TxDirection.IN, TxDirection.OUT]).optional(),
-  type: z.enum([
-    TxType.PURCHASE,
-    TxType.PRODUCTION,
-    TxType.SALE,
-    TxType.ADJUSTMENT,
-    TxType.RESERVE,
-    TxType.RELEASE,
-    TxType.INITIAL,
-  ]).optional(),
+  type: z
+    .enum([
+      TxType.PURCHASE,
+      TxType.PRODUCTION,
+      TxType.SALE,
+      TxType.ADJUSTMENT,
+      TxType.RESERVE,
+      TxType.RELEASE,
+      TxType.INITIAL,
+    ])
+    .optional(),
   dateFrom: z.string().optional(),
   dateTo: z.string().optional(),
 });
diff --git a/src/lib/auth-helpers.ts b/src/lib/auth-helpers.ts
index a68b720..7c42407 100644
--- a/src/lib/auth-helpers.ts
+++ b/src/lib/auth-helpers.ts
@@ -9,7 +9,11 @@ export class AuthError extends Error {
   status: number;
   code: string;
 
-  constructor(message: string, status: number = 401, code: string = "AUTH_ERROR") {
+  constructor(
+    message: string,
+    status: number = 401,
+    code: string = "AUTH_ERROR",
+  ) {
     super(message);
     this.name = "AuthError";
     this.status = status;
@@ -21,7 +25,11 @@ export class AppError extends Error {
   status: number;
   code: string;
 
-  constructor(message: string, status: number = 400, code: string = "APP_ERROR") {
+  constructor(
+    message: string,
+    status: number = 400,
+    code: string = "APP_ERROR",
+  ) {
     super(message);
     this.name = "AppError";
     this.status = status;
@@ -46,12 +54,14 @@ export interface AdminSession {
 /**
  * Require admin authentication for API routes
  * Uses NextAuth getServerSession for secure server-side auth check
- * 
+ *
  * SECURITY: No bypass allowed - all routes must authenticate
  */
-export async function requireAdmin(req?: Request | NextRequest | null): Promise<AdminSession> {
+export async function requireAdmin(
+  req?: Request | NextRequest | null,
+): Promise<AdminSession> {
   const session = await getServerSession(authOptions);
-  
+
   if (!session) {
     // Log for debugging
     if (process.env.NODE_ENV === "development") {
@@ -59,16 +69,20 @@ export async function requireAdmin(req?: Request | NextRequest | null): Promise<
     }
     throw new AuthError("Non authentifié", 401, "NOT_AUTHENTICATED");
   }
-  
+
   const role = (session.user as any)?.role ?? (session as any)?.role;
-  
+
   if (role !== "admin") {
     if (process.env.NODE_ENV === "development") {
       console.log("requireAdmin: User role is", role, "not admin");
     }
-    throw new AuthError("Accès refusé : privilèges insuffisants", 403, "NOT_ADMIN");
+    throw new AuthError(
+      "Accès refusé : privilèges insuffisants",
+      403,
+      "NOT_ADMIN",
+    );
   }
-  
+
   // Return typed session
   return {
     user: {
@@ -84,7 +98,7 @@ export async function requireAdmin(req?: Request | NextRequest | null): Promise<
  * Wrapper for API handlers with admin auth
  */
 export function withAdmin(
-  handler: (req: NextRequest, context: any) => Promise<NextResponse>
+  handler: (req: NextRequest, context: any) => Promise<NextResponse>,
 ) {
   return async (req: NextRequest, context: any) => {
     try {
@@ -94,19 +108,23 @@ export function withAdmin(
       if (error instanceof AuthError) {
         return NextResponse.json(
           { success: false, error: error.message, code: error.code },
-          { status: error.status }
+          { status: error.status },
         );
       }
       if (error instanceof AppError) {
         return NextResponse.json(
           { success: false, error: error.message, code: error.code },
-          { status: error.status }
+          { status: error.status },
         );
       }
       console.error("Unexpected error:", error);
       return NextResponse.json(
-        { success: false, error: "Erreur interne du serveur", code: "INTERNAL_ERROR" },
-        { status: 500 }
+        {
+          success: false,
+          error: "Erreur interne du serveur",
+          code: "INTERNAL_ERROR",
+        },
+        { status: 500 },
       );
     }
   };
@@ -119,18 +137,22 @@ export function handleApiError(error: unknown): NextResponse {
   if (error instanceof AuthError) {
     return NextResponse.json(
       { success: false, error: error.message, code: error.code },
-      { status: error.status }
+      { status: error.status },
     );
   }
   if (error instanceof AppError) {
     return NextResponse.json(
       { success: false, error: error.message, code: error.code },
-      { status: error.status }
+      { status: error.status },
     );
   }
   console.error("Unexpected error:", error);
   return NextResponse.json(
-    { success: false, error: "Erreur interne du serveur", code: "INTERNAL_ERROR" },
-    { status: 500 }
+    {
+      success: false,
+      error: "Erreur interne du serveur",
+      code: "INTERNAL_ERROR",
+    },
+    { status: 500 },
   );
 }
diff --git a/src/lib/auth.ts b/src/lib/auth.ts
index 48b8959..f8446cd 100644
--- a/src/lib/auth.ts
+++ b/src/lib/auth.ts
@@ -8,98 +8,101 @@ const ADMIN_PASSWORD_HASH = process.env.ADMIN_PASSWORD_HASH;
 
 // Validate required environment variables at startup
 if (!ADMIN_EMAIL || !ADMIN_PASSWORD_HASH) {
-    console.warn("⚠️ ADMIN_EMAIL and ADMIN_PASSWORD_HASH must be set in environment variables");
+  console.warn(
+    "⚠️ ADMIN_EMAIL and ADMIN_PASSWORD_HASH must be set in environment variables",
+  );
 }
 
 export const authOptions: NextAuthOptions = {
-    providers: [
-        CredentialsProvider({
-            id: "admin-login",
-            name: "Admin Login",
-            credentials: {
-                email: { label: "Email", type: "email" },
-                password: { label: "Password", type: "password" }
-            },
-            async authorize(credentials) {
-                if (!credentials?.email || !credentials?.password) {
-                    return null;
-                }
+  providers: [
+    CredentialsProvider({
+      id: "admin-login",
+      name: "Admin Login",
+      credentials: {
+        email: { label: "Email", type: "email" },
+        password: { label: "Password", type: "password" },
+      },
+      async authorize(credentials) {
+        if (!credentials?.email || !credentials?.password) {
+          return null;
+        }
 
-                // Check if admin credentials are configured
-                if (!ADMIN_EMAIL || !ADMIN_PASSWORD_HASH) {
-                    console.error("Admin credentials not configured in environment");
-                    return null;
-                }
+        // Check if admin credentials are configured
+        if (!ADMIN_EMAIL || !ADMIN_PASSWORD_HASH) {
+          console.error("Admin credentials not configured in environment");
+          return null;
+        }
 
-                // Check admin credentials
-                const isValidEmail = credentials.email === ADMIN_EMAIL;
-                const isValidPassword = await bcrypt.compare(
-                    credentials.password,
-                    ADMIN_PASSWORD_HASH
-                );
+        // Check admin credentials
+        const isValidEmail = credentials.email === ADMIN_EMAIL;
+        const isValidPassword = await bcrypt.compare(
+          credentials.password,
+          ADMIN_PASSWORD_HASH,
+        );
 
-                if (isValidEmail && isValidPassword) {
-                    return {
-                        id: "admin-1",
-                        email: credentials.email,
-                        name: "Admin Harp",
-                        role: "admin"
-                    };
-                }
+        if (isValidEmail && isValidPassword) {
+          return {
+            id: "admin-1",
+            email: credentials.email,
+            name: "Admin Harp",
+            role: "admin",
+          };
+        }
 
-                return null;
-            }
-        }),
-        CredentialsProvider({
-            id: "magic-link",
-            name: "Magic Link",
-            credentials: {
-                token: { label: "Token", type: "text" }
-            },
-            async authorize(credentials) {
-                if (!credentials?.token) return null;
-                try {
-                    const { verifyMagicLink } = await import("@/lib/auth/auto-email.service");
-                    const result = await verifyMagicLink(credentials.token);
-                    if (result && result.user) {
-                        return {
-                            id: result.user.id,
-                            email: result.user.email,
-                            name: result.user.name || "User",
-                            role: "USER"
-                        };
-                    }
-                    return null;
-                } catch (e) {
-                    console.error("Magic link auth failed:", e);
-                    return null;
-                }
-            }
-        })
-    ],
-    session: {
-        strategy: "jwt",
-        maxAge: 24 * 60 * 60, // 24 hours
-    },
-    pages: {
-        signIn: "/auth/magic-link-request", // Default sign in page for users
-        // Admin login still accessible at /admin/login via custom page logic
-    },
-    callbacks: {
-        async jwt({ token, user }) {
-            if (user) {
-                token.role = (user as any).role;
-                token.id = (user as any).id;
-            }
-            return token;
-        },
-        async session({ session, token }) {
-            if (session.user) {
-                (session.user as any).role = token.role;
-                (session.user as any).id = token.id;
-            }
-            return session;
+        return null;
+      },
+    }),
+    CredentialsProvider({
+      id: "magic-link",
+      name: "Magic Link",
+      credentials: {
+        token: { label: "Token", type: "text" },
+      },
+      async authorize(credentials) {
+        if (!credentials?.token) return null;
+        try {
+          const { verifyMagicLink } =
+            await import("@/lib/auth/auto-email.service");
+          const result = await verifyMagicLink(credentials.token);
+          if (result && result.user) {
+            return {
+              id: result.user.id,
+              email: result.user.email,
+              name: result.user.name || "User",
+              role: "USER",
+            };
+          }
+          return null;
+        } catch (e) {
+          console.error("Magic link auth failed:", e);
+          return null;
         }
+      },
+    }),
+  ],
+  session: {
+    strategy: "jwt",
+    maxAge: 24 * 60 * 60, // 24 hours
+  },
+  pages: {
+    signIn: "/auth/magic-link-request", // Default sign in page for users
+    // Admin login still accessible at /admin/login via custom page logic
+  },
+  callbacks: {
+    async jwt({ token, user }) {
+      if (user) {
+        token.role = (user as any).role;
+        token.id = (user as any).id;
+      }
+      return token;
+    },
+    async session({ session, token }) {
+      if (session.user) {
+        (session.user as any).role = token.role;
+        (session.user as any).id = token.id;
+      }
+      return session;
     },
-    secret: process.env.NEXTAUTH_SECRET,
+  },
+  secret: process.env.NEXTAUTH_SECRET,
 };
diff --git a/src/lib/auth/auto-email.service.ts b/src/lib/auth/auto-email.service.ts
index 5bd2fd5..a8c7f0c 100644
--- a/src/lib/auth/auto-email.service.ts
+++ b/src/lib/auth/auto-email.service.ts
@@ -5,7 +5,8 @@ import { earnPoints } from "@/lib/loyalty/services/loyalty.service";
 import { sendMagicLinkEmail } from "@/lib/email/magic-link";
 import { User } from "@prisma/client";
 
-const MAGIC_LINK_SECRET = process.env.MAGIC_LINK_JWT_SECRET || "default_secret_dev_only";
+const MAGIC_LINK_SECRET =
+  process.env.MAGIC_LINK_JWT_SECRET || "default_secret_dev_only";
 const MAGIC_LINK_EXP_MINUTES = parseInt(process.env.MAGIC_LINK_EXP_MIN || "15");
 const NEXTAUTH_URL = process.env.NEXTAUTH_URL || "http://localhost:3000";
 
@@ -13,20 +14,20 @@ const NEXTAUTH_URL = process.env.NEXTAUTH_URL || "http://localhost:3000";
  * Find or create a user by email (auto-account)
  */
 export async function createOrGetUserByEmail(
-  email: string, 
-  meta?: { name?: string, source?: string, guestKey?: string }
+  email: string,
+  meta?: { name?: string; source?: string; guestKey?: string },
 ): Promise<User> {
   const existingUser = await prisma.user.findUnique({
-    where: { email }
+    where: { email },
   });
 
   if (existingUser) {
     // Update guestKey if provided and not present? Or just return
     if (meta?.guestKey && !existingUser.guestKey) {
-        await prisma.user.update({
-            where: { id: existingUser.id },
-            data: { guestKey: meta.guestKey }
-        });
+      await prisma.user.update({
+        where: { id: existingUser.id },
+        data: { guestKey: meta.guestKey },
+      });
     }
     return existingUser;
   }
@@ -38,37 +39,39 @@ export async function createOrGetUserByEmail(
       createdVia: meta?.source || "AUTO_EMAIL",
       guestKey: meta?.guestKey,
       isEmailVerified: false,
-    }
+    },
   });
 }
 
 /**
  * Issue a magic link for an email
  */
-export async function issueMagicLink(email: string, reference: string = "login", guestKey?: string) {
+export async function issueMagicLink(
+  email: string,
+  reference: string = "login",
+  guestKey?: string,
+) {
   // 1. Clean up old expired tokens for this email (maintenance)
   await prisma.magicLinkToken.deleteMany({
-    where: { 
-        email, 
-        expiresAt: { lt: new Date() } 
-    }
+    where: {
+      email,
+      expiresAt: { lt: new Date() },
+    },
   });
 
   // 2. Generate JWT
-  const token = jwt.sign(
-    { email, reference, guestKey }, 
-    MAGIC_LINK_SECRET, 
-    { expiresIn: `${MAGIC_LINK_EXP_MINUTES}m` }
-  );
+  const token = jwt.sign({ email, reference, guestKey }, MAGIC_LINK_SECRET, {
+    expiresIn: `${MAGIC_LINK_EXP_MINUTES}m`,
+  });
 
   // 3. Hash token for DB storage
-  const tokenHash = crypto.createHash('sha256').update(token).digest('hex');
+  const tokenHash = crypto.createHash("sha256").update(token).digest("hex");
   const expiresAt = new Date(Date.now() + MAGIC_LINK_EXP_MINUTES * 60 * 1000);
 
-  // 4. Store in DB (idempotent: if valid token exists for same ref, maybe return it? 
+  // 4. Store in DB (idempotent: if valid token exists for same ref, maybe return it?
   // But for security, better to always issue new one or revoke old)
   // Let's issue new one.
-  
+
   // Link to user if exists
   const user = await prisma.user.findUnique({ where: { email } });
 
@@ -78,8 +81,8 @@ export async function issueMagicLink(email: string, reference: string = "login",
       email,
       userId: user?.id,
       reference,
-      expiresAt
-    }
+      expiresAt,
+    },
   });
 
   // 5. Send Email
@@ -99,10 +102,10 @@ export async function verifyMagicLink(token: string) {
     const { email, reference, guestKey } = payload;
 
     // 2. Hash to find in DB
-    const tokenHash = crypto.createHash('sha256').update(token).digest('hex');
-    
+    const tokenHash = crypto.createHash("sha256").update(token).digest("hex");
+
     const dbToken = await prisma.magicLinkToken.findUnique({
-      where: { tokenHash }
+      where: { tokenHash },
     });
 
     if (!dbToken) throw new Error("Token invalid");
@@ -113,7 +116,7 @@ export async function verifyMagicLink(token: string) {
     return await prisma.$transaction(async (tx) => {
       await tx.magicLinkToken.update({
         where: { id: dbToken.id },
-        data: { consumedAt: new Date() }
+        data: { consumedAt: new Date() },
       });
 
       // 4. Get or Create User
@@ -126,34 +129,33 @@ export async function verifyMagicLink(token: string) {
             email,
             isEmailVerified: true,
             createdVia: "AUTO_EMAIL",
-            guestKey
-          }
+            guestKey,
+          },
         });
         isNewUser = true;
       } else {
         // Mark verified
         if (!user.isEmailVerified) {
-            user = await tx.user.update({
-                where: { id: user.id },
-                data: { isEmailVerified: true }
-            });
-            isNewUser = true; // Considered "signup" upon first verification
+          user = await tx.user.update({
+            where: { id: user.id },
+            data: { isEmailVerified: true },
+          });
+          isNewUser = true; // Considered "signup" upon first verification
         }
       }
 
       // 5. Award points if new signup
       if (isNewUser) {
-         // We call earnPoints outside or inside? earnPoints handles transaction internally if not passed one.
-         // But here we are in a transaction. Ideally `earnPoints` should accept a tx.
-         // For simplicity, we'll do it after or assume `earnPoints` creates its own tx which is fine (nested tx support in Prisma is good or independent).
-         // But to be atomic, we'd need refactoring. 
-         // Let's just do the update manually here for simplicity or call it after.
-         // We'll skip atomic loyalty for now to avoid refactoring loyalty service.
+        // We call earnPoints outside or inside? earnPoints handles transaction internally if not passed one.
+        // But here we are in a transaction. Ideally `earnPoints` should accept a tx.
+        // For simplicity, we'll do it after or assume `earnPoints` creates its own tx which is fine (nested tx support in Prisma is good or independent).
+        // But to be atomic, we'd need refactoring.
+        // Let's just do the update manually here for simplicity or call it after.
+        // We'll skip atomic loyalty for now to avoid refactoring loyalty service.
       }
 
       return { user, isNewUser, guestKey };
     });
-
   } catch (error: any) {
     throw new Error(`Verification failed: ${error.message}`);
   }
@@ -162,27 +164,31 @@ export async function verifyMagicLink(token: string) {
 /**
  * Sync guest wishlist
  */
-export async function syncGuestWishlistToUser(guestKey: string, userId: string, items: { productId: string }[]) {
+export async function syncGuestWishlistToUser(
+  guestKey: string,
+  userId: string,
+  items: { productId: string }[],
+) {
   if (!items || items.length === 0) return;
 
   // This function assumes we receive the local items array from frontend
   for (const item of items) {
     try {
-        await prisma.wishlistItem.upsert({
-            where: {
-                userId_productId: {
-                    userId,
-                    productId: item.productId
-                }
-            },
-            create: {
-                userId,
-                productId: item.productId
-            },
-            update: {} // Already exists, do nothing
-        });
+      await prisma.wishlistItem.upsert({
+        where: {
+          userId_productId: {
+            userId,
+            productId: item.productId,
+          },
+        },
+        create: {
+          userId,
+          productId: item.productId,
+        },
+        update: {}, // Already exists, do nothing
+      });
     } catch (e) {
-        // Ignore errors (e.g. product not found)
+      // Ignore errors (e.g. product not found)
     }
   }
 }
diff --git a/src/lib/compta/accounting.ts b/src/lib/compta/accounting.ts
index f12b6eb..a0bc6d5 100644
--- a/src/lib/compta/accounting.ts
+++ b/src/lib/compta/accounting.ts
@@ -5,15 +5,15 @@
 
 /**
  * Calculate Weighted Average Cost (CUMP - Coût Unitaire Moyen Pondéré)
- * 
+ *
  * Formula: newCUMP = (oldQty × oldAvg + recvQty × recvUnitPrice) / (oldQty + recvQty)
- * 
+ *
  * @param oldQty - Current quantity in stock
  * @param oldAvgCost - Current average cost per unit
  * @param receivedQty - Quantity being received
  * @param receivedUnitPrice - Unit price of received goods
  * @returns New weighted average cost
- * 
+ *
  * @example
  * // Stock: 100 units @ 500 DZD, receiving 50 units @ 600 DZD
  * calculateCUMP(100, 500, 50, 600) // Returns 533.33
@@ -22,91 +22,108 @@ export function calculateCUMP(
   oldQty: number,
   oldAvgCost: number,
   receivedQty: number,
-  receivedUnitPrice: number
+  receivedUnitPrice: number,
 ): number {
   const newQty = oldQty + receivedQty;
-  
+
   // If no stock after operation, return the received unit price
   if (newQty === 0) {
     return receivedUnitPrice;
   }
-  
+
   // If receiving nothing, return existing average
   if (receivedQty === 0) {
     return oldAvgCost;
   }
-  
+
   // Standard CUMP formula
   const oldValue = oldQty * oldAvgCost;
   const receivedValue = receivedQty * receivedUnitPrice;
   const newCUMP = (oldValue + receivedValue) / newQty;
-  
+
   // Round to 2 decimal places for currency precision
   return Math.round(newCUMP * 100) / 100;
 }
 
 /**
  * Calculate total stock value
- * 
+ *
  * @param quantity - Stock quantity
  * @param averageCost - Average cost per unit
  * @returns Total value (quantity × averageCost)
  */
-export function calculateTotalValue(quantity: number, averageCost: number): number {
+export function calculateTotalValue(
+  quantity: number,
+  averageCost: number,
+): number {
   return Math.round(quantity * averageCost * 100) / 100;
 }
 
 /**
  * Calculate remaining quantity to receive
- * 
+ *
  * @param ordered - Quantity originally ordered
  * @param received - Quantity already received
  * @returns Remaining quantity
  */
-export function calculateRemainingQty(ordered: number, received: number): number {
+export function calculateRemainingQty(
+  ordered: number,
+  received: number,
+): number {
   return Math.max(0, ordered - received);
 }
 
 /**
  * Determine purchase status based on received quantities
- * 
+ *
  * @param items - Array of { quantityOrdered, quantityReceived }
  * @returns Purchase status: DRAFT, PARTIAL, or RECEIVED
  */
 export function determinePurchaseStatus(
-  items: Array<{ quantityOrdered: number | { toNumber?(): number }; quantityReceived: number | { toNumber?(): number } }>
-): 'DRAFT' | 'PARTIAL' | 'RECEIVED' {
-  const totalOrdered = items.reduce((sum, item) => sum + Number(item.quantityOrdered), 0);
-  const totalReceived = items.reduce((sum, item) => sum + Number(item.quantityReceived), 0);
-  
+  items: Array<{
+    quantityOrdered: number | { toNumber?(): number };
+    quantityReceived: number | { toNumber?(): number };
+  }>,
+): "DRAFT" | "PARTIAL" | "RECEIVED" {
+  const totalOrdered = items.reduce(
+    (sum, item) => sum + Number(item.quantityOrdered),
+    0,
+  );
+  const totalReceived = items.reduce(
+    (sum, item) => sum + Number(item.quantityReceived),
+    0,
+  );
+
   if (totalReceived === 0) {
-    return 'DRAFT';
+    return "DRAFT";
   }
-  
+
   if (totalReceived >= totalOrdered) {
-    return 'RECEIVED';
+    return "RECEIVED";
   }
-  
-  return 'PARTIAL';
+
+  return "PARTIAL";
 }
 
 /**
  * Format currency value (DZD)
- * 
+ *
  * @param value - Numeric value
  * @returns Formatted string with DZD symbol
  */
 export function formatDZD(value: number): string {
-  return new Intl.NumberFormat('fr-DZ', {
-    style: 'decimal',
-    minimumFractionDigits: 2,
-    maximumFractionDigits: 2,
-  }).format(value) + ' DZD';
+  return (
+    new Intl.NumberFormat("fr-DZ", {
+      style: "decimal",
+      minimumFractionDigits: 2,
+      maximumFractionDigits: 2,
+    }).format(value) + " DZD"
+  );
 }
 
 /**
  * Validate that a quantity doesn't exceed limit
- * 
+ *
  * @param quantity - Quantity to validate
  * @param limit - Maximum allowed
  * @param fieldName - Field name for error message
@@ -115,9 +132,11 @@ export function formatDZD(value: number): string {
 export function validateQuantityLimit(
   quantity: number,
   limit: number,
-  fieldName: string = 'Quantité'
+  fieldName: string = "Quantité",
 ): void {
   if (quantity > limit) {
-    throw new Error(`${fieldName} (${quantity}) dépasse le maximum autorisé (${limit})`);
+    throw new Error(
+      `${fieldName} (${quantity}) dépasse le maximum autorisé (${limit})`,
+    );
   }
 }
diff --git a/src/lib/compta/schemas/production.schemas.ts b/src/lib/compta/schemas/production.schemas.ts
index 235443b..43ebb3a 100644
--- a/src/lib/compta/schemas/production.schemas.ts
+++ b/src/lib/compta/schemas/production.schemas.ts
@@ -3,7 +3,7 @@
  * Phase 2 - HARP Comptabilité V3
  */
 
-import { z } from 'zod';
+import { z } from "zod";
 
 // =============================================================================
 // PRODUCTION BATCH SCHEMAS
@@ -13,11 +13,11 @@ import { z } from 'zod';
  * Schema for creating a new production batch
  */
 export const CreateBatchSchema = z.object({
-  modelId: z.string().min(1, 'Modèle requis'),
-  plannedQty: z.number().int().positive('Quantité doit être positive'),
+  modelId: z.string().min(1, "Modèle requis"),
+  plannedQty: z.number().int().positive("Quantité doit être positive"),
   plannedDate: z.string().datetime().optional(),
-  laborCost: z.number().min(0, 'Coût MO invalide').default(0),
-  overheadCost: z.number().min(0, 'Frais atelier invalides').default(0),
+  laborCost: z.number().min(0, "Coût MO invalide").default(0),
+  overheadCost: z.number().min(0, "Frais atelier invalides").default(0),
   notes: z.string().optional(),
 });
 
@@ -32,7 +32,9 @@ export const UpdateBatchSchema = z.object({
   laborCost: z.number().min(0).optional(),
   overheadCost: z.number().min(0).optional(),
   notes: z.string().optional(),
-  status: z.enum(['PLANNED', 'IN_PROGRESS', 'COMPLETED', 'CANCELLED', 'ON_HOLD']).optional(),
+  status: z
+    .enum(["PLANNED", "IN_PROGRESS", "COMPLETED", "CANCELLED", "ON_HOLD"])
+    .optional(),
 });
 
 export type UpdateBatchInput = z.infer<typeof UpdateBatchSchema>;
@@ -41,8 +43,12 @@ export type UpdateBatchInput = z.infer<typeof UpdateBatchSchema>;
  * Schema for completing a production batch
  */
 export const CompleteBatchSchema = z.object({
-  producedQty: z.number().int().nonnegative('Quantité produite doit être >= 0'),
-  wasteQty: z.number().int().nonnegative('Quantité déchets doit être >= 0').default(0),
+  producedQty: z.number().int().nonnegative("Quantité produite doit être >= 0"),
+  wasteQty: z
+    .number()
+    .int()
+    .nonnegative("Quantité déchets doit être >= 0")
+    .default(0),
   notes: z.string().optional(),
 });
 
@@ -56,8 +62,8 @@ export type CompleteBatchInput = z.infer<typeof CompleteBatchSchema>;
  * Schema for a single consumption item
  */
 export const ConsumptionItemSchema = z.object({
-  inventoryItemId: z.string().min(1, 'Article requis'),
-  quantity: z.number().positive('Quantité doit être positive'),
+  inventoryItemId: z.string().min(1, "Article requis"),
+  quantity: z.number().positive("Quantité doit être positive"),
 });
 
 /**
@@ -75,7 +81,9 @@ export type ConsumeInput = z.infer<typeof ConsumeSchema>;
 // =============================================================================
 
 export const BatchFilterSchema = z.object({
-  status: z.enum(['PLANNED', 'IN_PROGRESS', 'COMPLETED', 'CANCELLED', 'ON_HOLD']).optional(),
+  status: z
+    .enum(["PLANNED", "IN_PROGRESS", "COMPLETED", "CANCELLED", "ON_HOLD"])
+    .optional(),
   modelId: z.string().optional(),
   search: z.string().optional(),
   dateFrom: z.string().datetime().optional(),
diff --git a/src/lib/compta/schemas/purchase.schemas.ts b/src/lib/compta/schemas/purchase.schemas.ts
index 36c6e3d..2f7228a 100644
--- a/src/lib/compta/schemas/purchase.schemas.ts
+++ b/src/lib/compta/schemas/purchase.schemas.ts
@@ -3,7 +3,7 @@
  * Phase 1 - HARP Comptabilité V3
  */
 
-import { z } from 'zod';
+import { z } from "zod";
 
 // =============================================================================
 // PURCHASE SCHEMAS
@@ -13,21 +13,21 @@ import { z } from 'zod';
  * Schema for creating a new purchase item
  */
 export const PurchaseItemCreateSchema = z.object({
-  inventoryItemId: z.string().min(1, 'Article requis'),
-  quantityOrdered: z.number().positive('Quantité doit être positive'),
-  unitPrice: z.number().min(0, 'Prix unitaire invalide'),
+  inventoryItemId: z.string().min(1, "Article requis"),
+  quantityOrdered: z.number().positive("Quantité doit être positive"),
+  unitPrice: z.number().min(0, "Prix unitaire invalide"),
 });
 
 /**
  * Schema for creating a new purchase
  */
 export const PurchaseCreateSchema = z.object({
-  supplierId: z.string().min(1, 'Fournisseur requis'),
+  supplierId: z.string().min(1, "Fournisseur requis"),
   invoiceNumber: z.string().optional(),
   invoiceDate: z.string().datetime().optional(),
   expectedDate: z.string().datetime().optional(),
   notes: z.string().optional(),
-  items: z.array(PurchaseItemCreateSchema).min(1, 'Au moins un article requis'),
+  items: z.array(PurchaseItemCreateSchema).min(1, "Au moins un article requis"),
 });
 
 export type PurchaseCreateInput = z.infer<typeof PurchaseCreateSchema>;
@@ -36,15 +36,15 @@ export type PurchaseCreateInput = z.infer<typeof PurchaseCreateSchema>;
  * Schema for receiving a single purchase item
  */
 export const ReceiveItemSchema = z.object({
-  purchaseItemId: z.string().min(1, 'ID article achat requis'),
-  quantityReceived: z.number().min(0, 'Quantité reçue doit être >= 0'),
+  purchaseItemId: z.string().min(1, "ID article achat requis"),
+  quantityReceived: z.number().min(0, "Quantité reçue doit être >= 0"),
 });
 
 /**
  * Schema for receiving a purchase
  */
 export const ReceivePurchaseSchema = z.object({
-  items: z.array(ReceiveItemSchema).min(1, 'Au moins un article à recevoir'),
+  items: z.array(ReceiveItemSchema).min(1, "Au moins un article à recevoir"),
   receivedBy: z.string().optional(),
   notes: z.string().optional(),
 });
@@ -65,13 +65,16 @@ export type PreviewReceiveInput = z.infer<typeof PreviewReceiveSchema>;
  * Schema for creating a new inventory item
  */
 export const InventoryItemCreateSchema = z.object({
-  sku: z.string().min(1, 'SKU requis').max(50, 'SKU trop long'),
-  name: z.string().min(1, 'Nom requis').max(200, 'Nom trop long'),
-  type: z.enum(['FABRIC', 'ACCESSORY', 'PACKAGING', 'FINISHED', 'TRIM', 'LABEL'], {
-    message: 'Type invalide',
-  }),
-  unit: z.enum(['METER', 'ROLL', 'PIECE', 'KG', 'LITER', 'SET'], {
-    message: 'Unité invalide',
+  sku: z.string().min(1, "SKU requis").max(50, "SKU trop long"),
+  name: z.string().min(1, "Nom requis").max(200, "Nom trop long"),
+  type: z.enum(
+    ["FABRIC", "ACCESSORY", "PACKAGING", "FINISHED", "TRIM", "LABEL"],
+    {
+      message: "Type invalide",
+    },
+  ),
+  unit: z.enum(["METER", "ROLL", "PIECE", "KG", "LITER", "SET"], {
+    message: "Unité invalide",
   }),
   quantity: z.number().min(0).optional().default(0),
   averageCost: z.number().min(0).optional().default(0),
@@ -85,22 +88,26 @@ export const InventoryItemCreateSchema = z.object({
   notes: z.string().optional(),
 });
 
-export type InventoryItemCreateInput = z.infer<typeof InventoryItemCreateSchema>;
+export type InventoryItemCreateInput = z.infer<
+  typeof InventoryItemCreateSchema
+>;
 
 /**
  * Schema for inventory adjustment
  */
 export const InventoryAdjustmentSchema = z.object({
-  inventoryItemId: z.string().min(1, 'Article requis'),
-  adjustmentType: z.enum(['ADD', 'REMOVE', 'SET'], {
-    message: 'Type ajustement invalide (ADD, REMOVE, SET)',
+  inventoryItemId: z.string().min(1, "Article requis"),
+  adjustmentType: z.enum(["ADD", "REMOVE", "SET"], {
+    message: "Type ajustement invalide (ADD, REMOVE, SET)",
   }),
-  quantity: z.number().min(0, 'Quantité doit être >= 0'),
-  reason: z.string().min(1, 'Raison requise').max(500, 'Raison trop longue'),
+  quantity: z.number().min(0, "Quantité doit être >= 0"),
+  reason: z.string().min(1, "Raison requise").max(500, "Raison trop longue"),
   notes: z.string().optional(),
 });
 
-export type InventoryAdjustmentInput = z.infer<typeof InventoryAdjustmentSchema>;
+export type InventoryAdjustmentInput = z.infer<
+  typeof InventoryAdjustmentSchema
+>;
 
 // =============================================================================
 // PAGINATION SCHEMAS
@@ -118,13 +125,17 @@ export type PaginationInput = z.infer<typeof PaginationSchema>;
 // =============================================================================
 
 export const PurchaseFilterSchema = z.object({
-  status: z.enum(['DRAFT', 'ORDERED', 'PARTIAL', 'RECEIVED', 'CANCELLED']).optional(),
+  status: z
+    .enum(["DRAFT", "ORDERED", "PARTIAL", "RECEIVED", "CANCELLED"])
+    .optional(),
   supplierId: z.string().optional(),
   search: z.string().optional(),
 });
 
 export const InventoryFilterSchema = z.object({
-  type: z.enum(['FABRIC', 'ACCESSORY', 'PACKAGING', 'FINISHED', 'TRIM', 'LABEL']).optional(),
+  type: z
+    .enum(["FABRIC", "ACCESSORY", "PACKAGING", "FINISHED", "TRIM", "LABEL"])
+    .optional(),
   lowStock: z.coerce.boolean().optional(),
   search: z.string().optional(),
   isActive: z.coerce.boolean().optional(),
diff --git a/src/lib/compta/services/index.ts b/src/lib/compta/services/index.ts
index cbe4490..40ad07d 100644
--- a/src/lib/compta/services/index.ts
+++ b/src/lib/compta/services/index.ts
@@ -1,9 +1,9 @@
 /**
  * COMPTA Services Index
- * 
+ *
  * NOTE: Services are being consolidated into /lib/accounting/services/
  * This file re-exports from the canonical location for backward compatibility.
- * 
+ *
  * @deprecated Use imports from '@/lib/accounting/services' directly
  */
 
diff --git a/src/lib/compta/services/inventory-service.ts b/src/lib/compta/services/inventory-service.ts
index 7ebe5a4..d4406af 100644
--- a/src/lib/compta/services/inventory-service.ts
+++ b/src/lib/compta/services/inventory-service.ts
@@ -3,15 +3,15 @@
  * Handles inventory operations: list, detail, transactions, adjustments, reconciliation
  */
 
-import { prisma } from '@/lib/prisma';
-import { Prisma } from '@prisma/client';
-import { calculateCUMP, calculateTotalValue } from '../accounting';
+import { prisma } from "@/lib/prisma";
+import { Prisma } from "@prisma/client";
+import { calculateCUMP, calculateTotalValue } from "../accounting";
 import type {
   InventoryItemCreateInput,
   InventoryAdjustmentInput,
   PaginatedResponse,
   ReconciliationMismatch,
-} from '../schemas/purchase.schemas';
+} from "../schemas/purchase.schemas";
 
 // =============================================================================
 // TYPES
@@ -41,7 +41,7 @@ interface InventoryDetail extends InventoryItem {
  */
 export async function getInventoryList(
   { page = 1, pageSize = 20 }: { page?: number; pageSize?: number } = {},
-  filters: InventoryListFilters = {}
+  filters: InventoryListFilters = {},
 ): Promise<PaginatedResponse<InventoryItem>> {
   const skip = (page - 1) * pageSize;
 
@@ -68,7 +68,7 @@ export async function getInventoryList(
     where,
     take: pageSize * 2, // Fetch more for lowStock filtering
     skip: filters.lowStock ? 0 : skip,
-    orderBy: { name: 'asc' },
+    orderBy: { name: "asc" },
   });
 
   // Apply lowStock filter in memory
@@ -90,7 +90,9 @@ export async function getInventoryList(
       page,
       pageSize,
       total: filters.lowStock ? items.length : total,
-      totalPages: Math.ceil((filters.lowStock ? items.length : total) / pageSize),
+      totalPages: Math.ceil(
+        (filters.lowStock ? items.length : total) / pageSize,
+      ),
     },
   };
 }
@@ -98,7 +100,9 @@ export async function getInventoryList(
 /**
  * Get inventory item detail with transactions and supplier
  */
-export async function getInventoryDetail(id: string): Promise<InventoryDetail | null> {
+export async function getInventoryDetail(
+  id: string,
+): Promise<InventoryDetail | null> {
   const item = await prisma.inventoryItem.findUnique({
     where: { id },
     include: {
@@ -106,7 +110,7 @@ export async function getInventoryDetail(id: string): Promise<InventoryDetail |
         select: { id: true, name: true, code: true },
       },
       transactions: {
-        orderBy: { createdAt: 'desc' },
+        orderBy: { createdAt: "desc" },
         take: 50,
       },
     },
@@ -123,7 +127,7 @@ export async function getInventoryDetail(id: string): Promise<InventoryDetail |
  * Create a new inventory item
  */
 export async function createInventoryItem(
-  data: InventoryItemCreateInput
+  data: InventoryItemCreateInput,
 ): Promise<InventoryItem> {
   // Check SKU uniqueness
   const existing = await prisma.inventoryItem.findUnique({
@@ -134,8 +138,11 @@ export async function createInventoryItem(
     throw new Error(`SKU "${data.sku}" existe déjà`);
   }
 
-  const totalValue = calculateTotalValue(data.quantity ?? 0, data.averageCost ?? 0);
-  const available = (data.quantity ?? 0); // No reserved initially
+  const totalValue = calculateTotalValue(
+    data.quantity ?? 0,
+    data.averageCost ?? 0,
+  );
+  const available = data.quantity ?? 0; // No reserved initially
 
   const item = await prisma.inventoryItem.create({
     data: {
@@ -164,11 +171,11 @@ export async function createInventoryItem(
   if ((data.quantity ?? 0) > 0) {
     await createInventoryTransaction({
       inventoryItemId: item.id,
-      direction: 'IN',
-      type: 'ADJUSTMENT',
+      direction: "IN",
+      type: "ADJUSTMENT",
       quantity: data.quantity!,
       unitCost: data.averageCost ?? 0,
-      reason: 'Stock initial',
+      reason: "Stock initial",
       balanceBefore: 0,
       balanceAfter: data.quantity!,
     });
@@ -183,8 +190,14 @@ export async function createInventoryItem(
 
 interface CreateTransactionParams {
   inventoryItemId: string;
-  direction: 'IN' | 'OUT';
-  type: 'PURCHASE' | 'PRODUCTION' | 'SALE' | 'ADJUSTMENT' | 'RESERVE' | 'RELEASE';
+  direction: "IN" | "OUT";
+  type:
+    | "PURCHASE"
+    | "PRODUCTION"
+    | "SALE"
+    | "ADJUSTMENT"
+    | "RESERVE"
+    | "RELEASE";
   quantity: number;
   unitCost?: number;
   referenceType?: string;
@@ -205,7 +218,7 @@ interface CreateTransactionParams {
  */
 export async function createInventoryTransaction(
   params: CreateTransactionParams,
-  tx?: Prisma.TransactionClient
+  tx?: Prisma.TransactionClient,
 ): Promise<InventoryTransaction> {
   const client = tx ?? prisma;
 
@@ -242,7 +255,7 @@ export async function createInventoryTransaction(
  */
 export async function applyAdjustment(
   data: InventoryAdjustmentInput,
-  userId?: string
+  userId?: string,
 ): Promise<{ item: InventoryItem; transaction: InventoryTransaction }> {
   return prisma.$transaction(async (tx) => {
     // Get current item
@@ -251,39 +264,44 @@ export async function applyAdjustment(
     });
 
     if (!item) {
-      throw new Error('Article non trouvé');
+      throw new Error("Article non trouvé");
     }
 
     // Calculate new quantity
     let newQuantity: number;
     let adjustedQty: number;
-    let direction: 'IN' | 'OUT';
+    let direction: "IN" | "OUT";
 
     switch (data.adjustmentType) {
-      case 'ADD':
+      case "ADD":
         newQuantity = Number(item.quantity) + data.quantity;
         adjustedQty = data.quantity;
-        direction = 'IN';
+        direction = "IN";
         break;
-      case 'REMOVE':
+      case "REMOVE":
         newQuantity = Number(item.quantity) - data.quantity;
         adjustedQty = data.quantity;
-        direction = 'OUT';
+        direction = "OUT";
         if (newQuantity < 0) {
-          throw new Error(`Stock insuffisant: ${item.quantity} disponible, ${data.quantity} demandé`);
+          throw new Error(
+            `Stock insuffisant: ${item.quantity} disponible, ${data.quantity} demandé`,
+          );
         }
         break;
-      case 'SET':
+      case "SET":
         adjustedQty = Math.abs(data.quantity - Number(item.quantity));
-        direction = data.quantity >= Number(item.quantity) ? 'IN' : 'OUT';
+        direction = data.quantity >= Number(item.quantity) ? "IN" : "OUT";
         newQuantity = data.quantity;
         break;
       default:
-        throw new Error('Type ajustement invalide');
+        throw new Error("Type ajustement invalide");
     }
 
     const newAvailable = newQuantity - Number(item.reserved);
-    const newTotalValue = calculateTotalValue(newQuantity, Number(item.averageCost));
+    const newTotalValue = calculateTotalValue(
+      newQuantity,
+      Number(item.averageCost),
+    );
 
     // Update item
     const updatedItem = await tx.inventoryItem.update({
@@ -300,7 +318,7 @@ export async function applyAdjustment(
       {
         inventoryItemId: item.id,
         direction,
-        type: 'ADJUSTMENT',
+        type: "ADJUSTMENT",
         quantity: adjustedQty,
         unitCost: Number(item.averageCost),
         balanceBefore: Number(item.quantity),
@@ -311,14 +329,14 @@ export async function applyAdjustment(
         notes: data.notes,
         createdBy: userId,
       },
-      tx
+      tx,
     );
 
     // Create audit log
     await tx.auditLog.create({
       data: {
-        action: 'ADJUSTMENT',
-        entity: 'InventoryItem',
+        action: "ADJUSTMENT",
+        entity: "InventoryItem",
         entityId: item.id,
         userId,
         before: JSON.stringify({
@@ -368,7 +386,7 @@ export async function reconcileInventory(): Promise<ReconciliationMismatch[]> {
     const inSum = await prisma.inventoryTransaction.aggregate({
       where: {
         inventoryItemId: item.id,
-        direction: 'IN',
+        direction: "IN",
       },
       _sum: {
         quantity: true,
@@ -379,7 +397,7 @@ export async function reconcileInventory(): Promise<ReconciliationMismatch[]> {
     const outSum = await prisma.inventoryTransaction.aggregate({
       where: {
         inventoryItemId: item.id,
-        direction: 'OUT',
+        direction: "OUT",
       },
       _sum: {
         quantity: true,
@@ -401,7 +419,8 @@ export async function reconcileInventory(): Promise<ReconciliationMismatch[]> {
         expectedQty,
         actualQty,
         variance,
-        variancePercent: expectedQty !== 0 ? (variance / expectedQty) * 100 : 100,
+        variancePercent:
+          expectedQty !== 0 ? (variance / expectedQty) * 100 : 100,
       });
     }
   }
diff --git a/src/lib/compta/services/models-service.ts b/src/lib/compta/services/models-service.ts
index 7085ddf..efd123a 100644
--- a/src/lib/compta/services/models-service.ts
+++ b/src/lib/compta/services/models-service.ts
@@ -2,13 +2,13 @@ import { prisma } from "@/lib/prisma";
 
 export async function computeCostPerUnit(modelId: string) {
   // placeholder — detailed implementation in Sprint 1
-  const model = await prisma.model.findUnique({ 
-    where: { id: modelId }, 
-    include: { 
-      bom: { include: { inventoryItem: true } }, 
-      charges: true 
-    } 
+  const model = await prisma.model.findUnique({
+    where: { id: modelId },
+    include: {
+      bom: { include: { inventoryItem: true } },
+      charges: true,
+    },
   });
-  if (!model) throw new Error('Model not found');
+  if (!model) throw new Error("Model not found");
   return { breakdown: {}, totalCost: 0, suggestedPrices: {} };
 }
diff --git a/src/lib/compta/services/production-service.ts b/src/lib/compta/services/production-service.ts
index 7d0f138..f463d71 100644
--- a/src/lib/compta/services/production-service.ts
+++ b/src/lib/compta/services/production-service.ts
@@ -3,15 +3,15 @@
  * Handles production batch operations: create, preview, consume, complete
  */
 
-import { prisma } from '@/lib/prisma';
-import { Prisma } from '@prisma/client';
+import { prisma } from "@/lib/prisma";
+import { Prisma } from "@prisma/client";
 import type {
   CreateBatchInput,
   CompleteBatchInput,
   BOMRequirement,
   ConsumptionPreview,
   BatchCostBreakdown,
-} from '../schemas/production.schemas';
+} from "../schemas/production.schemas";
 
 // =============================================================================
 // TYPES
@@ -54,17 +54,17 @@ async function generateBatchNumber(): Promise<string> {
 
   const lastBatch = await prisma.productionBatch.findFirst({
     where: { batchNumber: { startsWith: prefix } },
-    orderBy: { batchNumber: 'desc' },
+    orderBy: { batchNumber: "desc" },
     select: { batchNumber: true },
   });
 
   let nextNumber = 1;
   if (lastBatch) {
-    const parts = lastBatch.batchNumber.split('-');
+    const parts = lastBatch.batchNumber.split("-");
     nextNumber = parseInt(parts[parts.length - 1], 10) + 1;
   }
 
-  return `${prefix}${nextNumber.toString().padStart(4, '0')}`;
+  return `${prefix}${nextNumber.toString().padStart(4, "0")}`;
 }
 
 /**
@@ -84,12 +84,18 @@ export function calculateBOMRequirements(
       averageCost: number | { toNumber?(): number };
     };
   }>,
-  plannedQty: number
+  plannedQty: number,
 ): BOMRequirement[] {
   return bom.map((item) => {
-    const required = Math.round(Number(item.quantity) * Number(item.wasteFactor) * plannedQty * 100) / 100;
+    const required =
+      Math.round(
+        Number(item.quantity) * Number(item.wasteFactor) * plannedQty * 100,
+      ) / 100;
     const available = Number(item.inventoryItem.available);
-    const shortage = Math.max(0, Math.round((required - available) * 100) / 100);
+    const shortage = Math.max(
+      0,
+      Math.round((required - available) * 100) / 100,
+    );
     const unitCost = Number(item.inventoryItem.averageCost);
     const totalCost = Math.round(required * unitCost * 100) / 100;
 
@@ -116,14 +122,15 @@ export function calculateBOMRequirements(
 export function calculateBatchCosts(
   batch: { materialsCost: number; laborCost: number; overheadCost: number },
   model: { otherCost: number },
-  producedQty: number
+  producedQty: number,
 ): BatchCostBreakdown {
   const materialsCost = batch.materialsCost;
   const laborCost = batch.laborCost;
   const overheadCost = batch.overheadCost;
   const otherCost = model.otherCost * producedQty;
   const totalCost = materialsCost + laborCost + overheadCost + otherCost;
-  const costPerUnit = producedQty > 0 ? Math.round((totalCost / producedQty) * 100) / 100 : 0;
+  const costPerUnit =
+    producedQty > 0 ? Math.round((totalCost / producedQty) * 100) / 100 : 0;
 
   return {
     materialsCost,
@@ -144,8 +151,11 @@ export function calculateBatchCosts(
  */
 export async function getProductionList(
   { page = 1, pageSize = 20 }: { page?: number; pageSize?: number } = {},
-  filters: BatchFilters = {}
-): Promise<{ items: BatchListItem[]; meta: { page: number; pageSize: number; total: number; totalPages: number } }> {
+  filters: BatchFilters = {},
+): Promise<{
+  items: BatchListItem[];
+  meta: { page: number; pageSize: number; total: number; totalPages: number };
+}> {
   const skip = (page - 1) * pageSize;
 
   const where: Prisma.ProductionBatchWhereInput = {};
@@ -175,7 +185,7 @@ export async function getProductionList(
       },
       take: pageSize,
       skip,
-      orderBy: { createdAt: 'desc' },
+      orderBy: { createdAt: "desc" },
     }),
     prisma.productionBatch.count({ where }),
   ]);
@@ -194,7 +204,9 @@ export async function getProductionList(
 /**
  * Get batch detail with model, BOM, and consumptions
  */
-export async function getProductionDetail(batchId: string): Promise<BatchWithModel | null> {
+export async function getProductionDetail(
+  batchId: string,
+): Promise<BatchWithModel | null> {
   return prisma.productionBatch.findUnique({
     where: { id: batchId },
     include: {
@@ -216,7 +228,7 @@ export async function getProductionDetail(batchId: string): Promise<BatchWithMod
  * Create a new production batch in PLANNED status
  */
 export async function createProductionBatch(
-  data: CreateBatchInput
+  data: CreateBatchInput,
 ): Promise<BatchWithModel> {
   // Verify model exists
   const model = await prisma.model.findUnique({
@@ -224,7 +236,7 @@ export async function createProductionBatch(
   });
 
   if (!model) {
-    throw new Error('Modèle non trouvé');
+    throw new Error("Modèle non trouvé");
   }
 
   const batchNumber = await generateBatchNumber();
@@ -245,7 +257,7 @@ export async function createProductionBatch(
       materialsCost: 0,
       totalCost: 0,
       costPerUnit: 0,
-      status: 'PLANNED',
+      status: "PLANNED",
       notes: data.notes,
     },
     include: {
@@ -269,7 +281,7 @@ export async function createProductionBatch(
  * Preview material requirements for a batch (non-destructive)
  */
 export async function previewProductionConsumption(
-  batchId: string
+  batchId: string,
 ): Promise<ConsumptionPreview> {
   const batch = await prisma.productionBatch.findUnique({
     where: { id: batchId },
@@ -283,19 +295,26 @@ export async function previewProductionConsumption(
   });
 
   if (!batch) {
-    throw new Error('Lot non trouvé');
+    throw new Error("Lot non trouvé");
   }
 
-  if (batch.status !== 'PLANNED') {
+  if (batch.status !== "PLANNED") {
     throw new Error(`Lot en statut ${batch.status}, preview non disponible`);
   }
 
-  const requirements = calculateBOMRequirements(batch.model.bom, batch.plannedQty);
+  const requirements = calculateBOMRequirements(
+    batch.model.bom,
+    batch.plannedQty,
+  );
   const hasShortage = requirements.some((r) => r.shortage > 0);
-  const totalMaterialsCost = requirements.reduce((sum, r) => sum + r.totalCost, 0);
-  const estimatedCostPerUnit = batch.plannedQty > 0 
-    ? Math.round((totalMaterialsCost / batch.plannedQty) * 100) / 100 
-    : 0;
+  const totalMaterialsCost = requirements.reduce(
+    (sum, r) => sum + r.totalCost,
+    0,
+  );
+  const estimatedCostPerUnit =
+    batch.plannedQty > 0
+      ? Math.round((totalMaterialsCost / batch.plannedQty) * 100) / 100
+      : 0;
 
   return {
     batchId: batch.id,
@@ -340,7 +359,7 @@ interface ConsumeResult {
  */
 export async function consumeProductionMaterials(
   batchId: string,
-  userId?: string
+  userId?: string,
 ): Promise<ConsumeResult> {
   return prisma.$transaction(async (tx) => {
     // Get batch with BOM
@@ -356,20 +375,25 @@ export async function consumeProductionMaterials(
     });
 
     if (!batch) {
-      throw new Error('Lot non trouvé');
+      throw new Error("Lot non trouvé");
     }
 
-    if (batch.status !== 'PLANNED') {
+    if (batch.status !== "PLANNED") {
       throw new Error(`Impossible de démarrer: lot en statut ${batch.status}`);
     }
 
     // Calculate requirements
-    const requirements = calculateBOMRequirements(batch.model.bom, batch.plannedQty);
+    const requirements = calculateBOMRequirements(
+      batch.model.bom,
+      batch.plannedQty,
+    );
 
     // Validate all stock available
     const shortages = requirements.filter((r) => r.shortage > 0);
     if (shortages.length > 0) {
-      const shortageList = shortages.map((s) => `${s.sku}: manque ${s.shortage}`).join(', ');
+      const shortageList = shortages
+        .map((s) => `${s.sku}: manque ${s.shortage}`)
+        .join(", ");
       throw new Error(`Stock insuffisant: ${shortageList}`);
     }
 
@@ -423,8 +447,8 @@ export async function consumeProductionMaterials(
       await tx.inventoryTransaction.create({
         data: {
           inventoryItemId: req.inventoryItemId,
-          direction: 'OUT',
-          type: 'PRODUCTION',
+          direction: "OUT",
+          type: "PRODUCTION",
           quantity: req.required,
           unitCost: req.unitCost,
           balanceBefore: Number(invItem.quantity),
@@ -433,7 +457,7 @@ export async function consumeProductionMaterials(
           valueAfter: newTotalValue,
           avgCostBefore: Number(invItem.averageCost),
           avgCostAfter: Number(invItem.averageCost),
-          referenceType: 'BATCH',
+          referenceType: "BATCH",
           referenceId: batchId,
           createdBy: userId,
         },
@@ -449,11 +473,12 @@ export async function consumeProductionMaterials(
     }
 
     // Update batch
-    const totalCost = totalMaterialsCost + Number(batch.laborCost) + Number(batch.overheadCost);
+    const totalCost =
+      totalMaterialsCost + Number(batch.laborCost) + Number(batch.overheadCost);
     await tx.productionBatch.update({
       where: { id: batchId },
       data: {
-        status: 'IN_PROGRESS',
+        status: "IN_PROGRESS",
         startedAt: new Date(),
         materialsCost: totalMaterialsCost,
         totalCost,
@@ -463,13 +488,13 @@ export async function consumeProductionMaterials(
     // Create audit log
     await tx.auditLog.create({
       data: {
-        action: 'CONSUME',
-        entity: 'ProductionBatch',
+        action: "CONSUME",
+        entity: "ProductionBatch",
         entityId: batchId,
         userId,
-        before: JSON.stringify({ status: 'PLANNED' }),
+        before: JSON.stringify({ status: "PLANNED" }),
         after: JSON.stringify({
-          status: 'IN_PROGRESS',
+          status: "IN_PROGRESS",
           materialsCost: totalMaterialsCost,
           consumptions: consumptionRecords.length,
         }),
@@ -519,7 +544,7 @@ interface CompleteResult {
 export async function completeProductionBatch(
   batchId: string,
   data: CompleteBatchInput,
-  userId?: string
+  userId?: string,
 ): Promise<CompleteResult> {
   return prisma.$transaction(async (tx) => {
     const batch = await tx.productionBatch.findUnique({
@@ -531,19 +556,21 @@ export async function completeProductionBatch(
     });
 
     if (!batch) {
-      throw new Error('Lot non trouvé');
+      throw new Error("Lot non trouvé");
     }
 
-    if (batch.status !== 'IN_PROGRESS') {
+    if (batch.status !== "IN_PROGRESS") {
       throw new Error(`Impossible de terminer: lot en statut ${batch.status}`);
     }
 
     if (data.producedQty <= 0) {
-      throw new Error('La quantité produite doit être supérieure à 0');
+      throw new Error("La quantité produite doit être supérieure à 0");
     }
 
     if (data.producedQty + data.wasteQty > batch.plannedQty * 1.1) {
-      throw new Error('Quantité produite + déchets dépasse la quantité planifiée (+ 10% tolérance)');
+      throw new Error(
+        "Quantité produite + déchets dépasse la quantité planifiée (+ 10% tolérance)",
+      );
     }
 
     // Calculate final costs
@@ -554,20 +581,22 @@ export async function completeProductionBatch(
         overheadCost: Number(batch.overheadCost),
       },
       { otherCost: Number(batch.model.otherCost) },
-      data.producedQty
+      data.producedQty,
     );
 
     // Update batch
     await tx.productionBatch.update({
       where: { id: batchId },
       data: {
-        status: 'COMPLETED',
+        status: "COMPLETED",
         completedAt: new Date(),
         producedQty: data.producedQty,
         wasteQty: data.wasteQty,
         totalCost: costs.totalCost,
         costPerUnit: costs.costPerUnit,
-        notes: data.notes ? `${batch.notes || ''}\n${data.notes}`.trim() : batch.notes,
+        notes: data.notes
+          ? `${batch.notes || ""}\n${data.notes}`.trim()
+          : batch.notes,
       },
     });
 
@@ -610,8 +639,8 @@ export async function completeProductionBatch(
         await tx.inventoryTransaction.create({
           data: {
             inventoryItemId: batch.model.inventoryItemId,
-            direction: 'IN',
-            type: 'PRODUCTION',
+            direction: "IN",
+            type: "PRODUCTION",
             quantity: addedQty,
             unitCost: costs.costPerUnit,
             balanceBefore: oldQty,
@@ -620,7 +649,7 @@ export async function completeProductionBatch(
             valueAfter: newValue,
             avgCostBefore: finishedItem.averageCost,
             avgCostAfter: Math.round(newCUMP * 100) / 100,
-            referenceType: 'BATCH',
+            referenceType: "BATCH",
             referenceId: batchId,
             createdBy: userId,
           },
@@ -631,16 +660,16 @@ export async function completeProductionBatch(
     // Create audit log
     await tx.auditLog.create({
       data: {
-        action: 'COMPLETE',
-        entity: 'ProductionBatch',
+        action: "COMPLETE",
+        entity: "ProductionBatch",
         entityId: batchId,
         userId,
         before: JSON.stringify({
-          status: 'IN_PROGRESS',
+          status: "IN_PROGRESS",
           producedQty: 0,
         }),
         after: JSON.stringify({
-          status: 'COMPLETED',
+          status: "COMPLETED",
           producedQty: data.producedQty,
           wasteQty: data.wasteQty,
           totalCost: costs.totalCost,
@@ -680,7 +709,7 @@ export async function completeProductionBatch(
 export async function cancelProductionBatch(
   batchId: string,
   reason?: string,
-  userId?: string
+  userId?: string,
 ): Promise<{ success: true }> {
   return prisma.$transaction(async (tx) => {
     const batch = await tx.productionBatch.findUnique({
@@ -688,29 +717,31 @@ export async function cancelProductionBatch(
     });
 
     if (!batch) {
-      throw new Error('Lot non trouvé');
+      throw new Error("Lot non trouvé");
     }
 
-    if (batch.status !== 'PLANNED') {
-      throw new Error('Seuls les lots planifiés peuvent être annulés');
+    if (batch.status !== "PLANNED") {
+      throw new Error("Seuls les lots planifiés peuvent être annulés");
     }
 
     await tx.productionBatch.update({
       where: { id: batchId },
       data: {
-        status: 'CANCELLED',
-        notes: reason ? `${batch.notes || ''}\nAnnulé: ${reason}`.trim() : batch.notes,
+        status: "CANCELLED",
+        notes: reason
+          ? `${batch.notes || ""}\nAnnulé: ${reason}`.trim()
+          : batch.notes,
       },
     });
 
     await tx.auditLog.create({
       data: {
-        action: 'CANCEL',
-        entity: 'ProductionBatch',
+        action: "CANCEL",
+        entity: "ProductionBatch",
         entityId: batchId,
         userId,
-        before: JSON.stringify({ status: 'PLANNED' }),
-        after: JSON.stringify({ status: 'CANCELLED', reason }),
+        before: JSON.stringify({ status: "PLANNED" }),
+        after: JSON.stringify({ status: "CANCELLED", reason }),
       },
     });
 
diff --git a/src/lib/compta/services/purchases-service.ts b/src/lib/compta/services/purchases-service.ts
index 5609e02..afa9b00 100644
--- a/src/lib/compta/services/purchases-service.ts
+++ b/src/lib/compta/services/purchases-service.ts
@@ -3,10 +3,14 @@
  * Handles purchase operations: create, preview receive, receive (transactional)
  */
 
-import { prisma } from '@/lib/prisma';
-import { Prisma } from '@prisma/client';
-import { calculateCUMP, calculateTotalValue, determinePurchaseStatus } from '../accounting';
-import { createInventoryTransaction } from './inventory-service';
+import { prisma } from "@/lib/prisma";
+import { Prisma } from "@prisma/client";
+import {
+  calculateCUMP,
+  calculateTotalValue,
+  determinePurchaseStatus,
+} from "../accounting";
+import { createInventoryTransaction } from "./inventory-service";
 import type {
   PurchaseCreateInput,
   ReceivePurchaseInput,
@@ -14,7 +18,7 @@ import type {
   PaginatedResponse,
   StockUpdate,
   ReceivePreviewResult,
-} from '../schemas/purchase.schemas';
+} from "../schemas/purchase.schemas";
 
 // =============================================================================
 // TYPES
@@ -53,17 +57,17 @@ async function generatePurchaseNumber(): Promise<string> {
 
   const lastPurchase = await prisma.purchase.findFirst({
     where: { purchaseNumber: { startsWith: prefix } },
-    orderBy: { purchaseNumber: 'desc' },
+    orderBy: { purchaseNumber: "desc" },
     select: { purchaseNumber: true },
   });
 
   let nextNumber = 1;
   if (lastPurchase) {
-    const lastNum = parseInt(lastPurchase.purchaseNumber.split('-')[2], 10);
+    const lastNum = parseInt(lastPurchase.purchaseNumber.split("-")[2], 10);
     nextNumber = lastNum + 1;
   }
 
-  return `${prefix}${nextNumber.toString().padStart(3, '0')}`;
+  return `${prefix}${nextNumber.toString().padStart(3, "0")}`;
 }
 
 // =============================================================================
@@ -75,7 +79,7 @@ async function generatePurchaseNumber(): Promise<string> {
  */
 export async function getPurchaseList(
   { page = 1, pageSize = 20 }: { page?: number; pageSize?: number } = {},
-  filters: PurchaseListFilters = {}
+  filters: PurchaseListFilters = {},
 ): Promise<PaginatedResponse<PurchaseListItem>> {
   const skip = (page - 1) * pageSize;
 
@@ -106,7 +110,7 @@ export async function getPurchaseList(
       },
       take: pageSize,
       skip,
-      orderBy: { createdAt: 'desc' },
+      orderBy: { createdAt: "desc" },
     }),
     prisma.purchase.count({ where }),
   ]);
@@ -146,13 +150,15 @@ export async function getPurchaseDetail(id: string): Promise<Purchase | null> {
 /**
  * Create a new purchase in DRAFT status
  */
-export async function createPurchase(data: PurchaseCreateInput): Promise<Purchase> {
+export async function createPurchase(
+  data: PurchaseCreateInput,
+): Promise<Purchase> {
   const purchaseNumber = await generatePurchaseNumber();
 
   // Calculate totals
   const subtotal = data.items.reduce(
     (sum, item) => sum + item.quantityOrdered * item.unitPrice,
-    0
+    0,
   );
 
   return prisma.purchase.create({
@@ -166,13 +172,13 @@ export async function createPurchase(data: PurchaseCreateInput): Promise<Purchas
       subtotal,
       totalAmount: subtotal,
       amountDue: subtotal,
-      status: 'DRAFT',
+      status: "DRAFT",
       items: {
         create: data.items.map((item) => ({
           inventoryItemId: item.inventoryItemId,
           quantityOrdered: item.quantityOrdered,
           quantityReceived: 0,
-          unit: 'PIECE', // Will be updated from inventory item
+          unit: "PIECE", // Will be updated from inventory item
           unitPrice: item.unitPrice,
           totalPrice: item.quantityOrdered * item.unitPrice,
         })),
@@ -199,7 +205,7 @@ export async function createPurchase(data: PurchaseCreateInput): Promise<Purchas
  */
 export async function previewReceivePurchase(
   purchaseId: string,
-  data: PreviewReceiveInput
+  data: PreviewReceiveInput,
 ): Promise<ReceivePreviewResult> {
   // Get purchase with items
   const purchase = await prisma.purchase.findUnique({
@@ -214,22 +220,24 @@ export async function previewReceivePurchase(
   });
 
   if (!purchase) {
-    throw new Error('Achat non trouvé');
+    throw new Error("Achat non trouvé");
   }
 
-  if (purchase.status === 'RECEIVED') {
-    throw new Error('Cet achat a déjà été entièrement reçu');
+  if (purchase.status === "RECEIVED") {
+    throw new Error("Cet achat a déjà été entièrement reçu");
   }
 
-  if (purchase.status === 'CANCELLED') {
-    throw new Error('Cet achat est annulé');
+  if (purchase.status === "CANCELLED") {
+    throw new Error("Cet achat est annulé");
   }
 
   const stockUpdates: StockUpdate[] = [];
   let totalValueIncrease = 0;
 
   for (const receiveItem of data.items) {
-    const purchaseItem = purchase.items.find((pi) => pi.id === receiveItem.purchaseItemId);
+    const purchaseItem = purchase.items.find(
+      (pi) => pi.id === receiveItem.purchaseItemId,
+    );
 
     if (!purchaseItem) {
       throw new Error(`Article achat ${receiveItem.purchaseItemId} non trouvé`);
@@ -241,10 +249,12 @@ export async function previewReceivePurchase(
     }
 
     // Check remaining quantity
-    const remaining = Number(purchaseItem.quantityOrdered) - Number(purchaseItem.quantityReceived);
+    const remaining =
+      Number(purchaseItem.quantityOrdered) -
+      Number(purchaseItem.quantityReceived);
     if (receiveItem.quantityReceived > remaining) {
       throw new Error(
-        `Quantité reçue (${receiveItem.quantityReceived}) dépasse le restant (${remaining}) pour ${purchaseItem.inventoryItem.name}`
+        `Quantité reçue (${receiveItem.quantityReceived}) dépasse le restant (${remaining}) pour ${purchaseItem.inventoryItem.name}`,
       );
     }
 
@@ -255,7 +265,7 @@ export async function previewReceivePurchase(
       Number(item.quantity),
       Number(item.averageCost),
       receiveItem.quantityReceived,
-      Number(purchaseItem.unitPrice)
+      Number(purchaseItem.unitPrice),
     );
 
     const newQty = Number(item.quantity) + receiveItem.quantityReceived;
@@ -309,7 +319,7 @@ interface ReceivePurchaseResult {
 export async function receivePurchase(
   purchaseId: string,
   data: ReceivePurchaseInput,
-  userId?: string
+  userId?: string,
 ): Promise<ReceivePurchaseResult> {
   return prisma.$transaction(async (tx) => {
     // Get purchase with items
@@ -326,15 +336,15 @@ export async function receivePurchase(
     });
 
     if (!purchase) {
-      throw new Error('Achat non trouvé');
+      throw new Error("Achat non trouvé");
     }
 
-    if (purchase.status === 'RECEIVED') {
-      throw new Error('Cet achat a déjà été entièrement reçu');
+    if (purchase.status === "RECEIVED") {
+      throw new Error("Cet achat a déjà été entièrement reçu");
     }
 
-    if (purchase.status === 'CANCELLED') {
-      throw new Error('Cet achat est annulé');
+    if (purchase.status === "CANCELLED") {
+      throw new Error("Cet achat est annulé");
     }
 
     const stockUpdates: StockUpdate[] = [];
@@ -348,10 +358,14 @@ export async function receivePurchase(
 
     // Process each item to receive
     for (const receiveItem of data.items) {
-      const purchaseItem = purchase.items.find((pi) => pi.id === receiveItem.purchaseItemId);
+      const purchaseItem = purchase.items.find(
+        (pi) => pi.id === receiveItem.purchaseItemId,
+      );
 
       if (!purchaseItem) {
-        throw new Error(`Article achat ${receiveItem.purchaseItemId} non trouvé`);
+        throw new Error(
+          `Article achat ${receiveItem.purchaseItemId} non trouvé`,
+        );
       }
 
       // Skip if no quantity to receive
@@ -360,10 +374,12 @@ export async function receivePurchase(
       }
 
       // Validate remaining quantity
-      const remaining = Number(purchaseItem.quantityOrdered) - Number(purchaseItem.quantityReceived);
+      const remaining =
+        Number(purchaseItem.quantityOrdered) -
+        Number(purchaseItem.quantityReceived);
       if (receiveItem.quantityReceived > remaining) {
         throw new Error(
-          `Quantité reçue (${receiveItem.quantityReceived}) dépasse le restant (${remaining}) pour ${purchaseItem.inventoryItem.name}`
+          `Quantité reçue (${receiveItem.quantityReceived}) dépasse le restant (${remaining}) pour ${purchaseItem.inventoryItem.name}`,
         );
       }
 
@@ -374,7 +390,7 @@ export async function receivePurchase(
         Number(item.quantity),
         Number(item.averageCost),
         receiveItem.quantityReceived,
-        Number(purchaseItem.unitPrice)
+        Number(purchaseItem.unitPrice),
       );
 
       const newQty = Number(item.quantity) + receiveItem.quantityReceived;
@@ -398,8 +414,8 @@ export async function receivePurchase(
       await tx.inventoryTransaction.create({
         data: {
           inventoryItemId: item.id,
-          direction: 'IN',
-          type: 'PURCHASE',
+          direction: "IN",
+          type: "PURCHASE",
           quantity: receiveItem.quantityReceived,
           unitCost: Number(purchaseItem.unitPrice),
           balanceBefore: Number(item.quantity),
@@ -408,7 +424,7 @@ export async function receivePurchase(
           valueAfter: newValue,
           avgCostBefore: Number(item.averageCost),
           avgCostAfter: newCUMP,
-          referenceType: 'PURCHASE',
+          referenceType: "PURCHASE",
           referenceId: purchase.id,
           createdBy: userId,
         },
@@ -418,7 +434,9 @@ export async function receivePurchase(
       await tx.purchaseItem.update({
         where: { id: purchaseItem.id },
         data: {
-          quantityReceived: Number(purchaseItem.quantityReceived) + receiveItem.quantityReceived,
+          quantityReceived:
+            Number(purchaseItem.quantityReceived) +
+            receiveItem.quantityReceived,
         },
       });
 
@@ -443,7 +461,7 @@ export async function receivePurchase(
     });
 
     const newStatus = determinePurchaseStatus(updatedItems);
-    const receivedDate = newStatus === 'RECEIVED' ? new Date() : null;
+    const receivedDate = newStatus === "RECEIVED" ? new Date() : null;
 
     // Update purchase status
     const updatedPurchase = await tx.purchase.update({
@@ -466,8 +484,8 @@ export async function receivePurchase(
     // Create audit log
     await tx.auditLog.create({
       data: {
-        action: 'RECEIVE',
-        entity: 'Purchase',
+        action: "RECEIVE",
+        entity: "Purchase",
         entityId: purchase.id,
         userId,
         before: JSON.stringify(beforeSnapshot),
diff --git a/src/lib/config.ts b/src/lib/config.ts
index 982d71c..83f0848 100644
--- a/src/lib/config.ts
+++ b/src/lib/config.ts
@@ -2,39 +2,39 @@
 // Change these values to customize your site
 
 export const siteConfig = {
-    // Brand
-    name: "Harp",
-    tagline: "Une élégance qui résonne",
-    
-    // Contact - UPDATE THESE VALUES
-    whatsapp: {
-        number: "213561777397", // Format: country code + number without +
-        display: "0561 77 73 97", // Display format
-    },
-    email: "contact@harpalgeria.com",
-    
-    // Social Media
-    social: {
-        instagram: "https://www.instagram.com/harp_algeria",
-        facebook: "https://www.facebook.com/profile.php?id=61566880453440",
-        tiktok: "https://www.tiktok.com/@harp.algeria",
-    },
-    
-    // Location
-    location: {
-        city: "Alger",
-        country: "Algérie",
-    },
-    
-    // Business Hours
-    hours: {
-        days: "Dimanche - Jeudi",
-        time: "9h - 18h",
-    },
+  // Brand
+  name: "Harp",
+  tagline: "Une élégance qui résonne",
+
+  // Contact - UPDATE THESE VALUES
+  whatsapp: {
+    number: "213561777397", // Format: country code + number without +
+    display: "0561 77 73 97", // Display format
+  },
+  email: "contact@harpalgeria.com",
+
+  // Social Media
+  social: {
+    instagram: "https://www.instagram.com/harp_algeria",
+    facebook: "https://www.facebook.com/profile.php?id=61566880453440",
+    tiktok: "https://www.tiktok.com/@harp.algeria",
+  },
+
+  // Location
+  location: {
+    city: "Alger",
+    country: "Algérie",
+  },
+
+  // Business Hours
+  hours: {
+    days: "Dimanche - Jeudi",
+    time: "9h - 18h",
+  },
 };
 
 // Helper to get WhatsApp link
 export const getWhatsAppLink = (message?: string) => {
-    const base = `https://wa.me/${siteConfig.whatsapp.number}`;
-    return message ? `${base}?text=${encodeURIComponent(message)}` : base;
+  const base = `https://wa.me/${siteConfig.whatsapp.number}`;
+  return message ? `${base}?text=${encodeURIComponent(message)}` : base;
 };
diff --git a/src/lib/delivery-data.ts b/src/lib/delivery-data.ts
index 71980d6..5ba7837 100644
--- a/src/lib/delivery-data.ts
+++ b/src/lib/delivery-data.ts
@@ -2,90 +2,380 @@ export type DeliveryProvider = "ZR Express" | "Yalidine";
 export type DeliveryType = "HOME" | "DESK";
 
 interface DeliveryRate {
-    wilayaCode: number;
-    wilayaName: string;
-    zrExpress: {
-        home: number;
-        desk: number;
-    };
-    yalidine: {
-        home: number;
-        desk: number;
-    };
+  wilayaCode: number;
+  wilayaName: string;
+  zrExpress: {
+    home: number;
+    desk: number;
+  };
+  yalidine: {
+    home: number;
+    desk: number;
+  };
 }
 
 export const deliveryRates: DeliveryRate[] = [
-    { wilayaCode: 1, wilayaName: "Adrar", zrExpress: { home: 1400, desk: 970 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 2, wilayaName: "Chlef", zrExpress: { home: 850, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 3, wilayaName: "Laghouat", zrExpress: { home: 950, desk: 620 }, yalidine: { home: 1050, desk: 1000 } },
-    { wilayaCode: 4, wilayaName: "Oum El Bouaghi", zrExpress: { home: 850, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 5, wilayaName: "Batna", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 6, wilayaName: "Bejaia", zrExpress: { home: 800, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 7, wilayaName: "Biskra", zrExpress: { home: 950, desk: 620 }, yalidine: { home: 1050, desk: 1000 } },
-    { wilayaCode: 8, wilayaName: "Bechar", zrExpress: { home: 1100, desk: 720 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 9, wilayaName: "Blida", zrExpress: { home: 600, desk: 470 }, yalidine: { home: 700, desk: 650 } },
-    { wilayaCode: 10, wilayaName: "Bouira", zrExpress: { home: 700, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 11, wilayaName: "Tamanrasset", zrExpress: { home: 1600, desk: 1120 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 12, wilayaName: "Tebessa", zrExpress: { home: 900, desk: 570 }, yalidine: { home: 1050, desk: 1000 } },
-    { wilayaCode: 13, wilayaName: "Tlemcen", zrExpress: { home: 900, desk: 570 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 14, wilayaName: "Tiaret", zrExpress: { home: 850, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 15, wilayaName: "Tizi Ouzou", zrExpress: { home: 750, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 16, wilayaName: "Alger", zrExpress: { home: 500, desk: 370 }, yalidine: { home: 600, desk: 550 } },
-    { wilayaCode: 17, wilayaName: "Djelfa", zrExpress: { home: 950, desk: 570 }, yalidine: { home: 1050, desk: 1000 } },
-    { wilayaCode: 18, wilayaName: "Jijel", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 19, wilayaName: "Setif", zrExpress: { home: 800, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 20, wilayaName: "Saida", zrExpress: { home: 900, desk: 570 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 21, wilayaName: "Skikda", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 22, wilayaName: "Sidi Bel Abbes", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 23, wilayaName: "Annaba", zrExpress: { home: 850, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 24, wilayaName: "Guelma", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 25, wilayaName: "Constantine", zrExpress: { home: 800, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 26, wilayaName: "Medea", zrExpress: { home: 800, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 27, wilayaName: "Mostaganem", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 28, wilayaName: "M'Sila", zrExpress: { home: 850, desk: 570 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 29, wilayaName: "Mascara", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 30, wilayaName: "Ouargla", zrExpress: { home: 950, desk: 670 }, yalidine: { home: 1050, desk: 1000 } },
-    { wilayaCode: 31, wilayaName: "Oran", zrExpress: { home: 800, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 32, wilayaName: "El Bayadh", zrExpress: { home: 1100, desk: 670 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 33, wilayaName: "Illizi", zrExpress: { home: 0, desk: 0 }, yalidine: { home: 1850, desk: 1750 } }, // ZR not available?
-    { wilayaCode: 34, wilayaName: "Bordj Bou Arreridj", zrExpress: { home: 800, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 35, wilayaName: "Boumerdes", zrExpress: { home: 700, desk: 520 }, yalidine: { home: 700, desk: 650 } },
-    { wilayaCode: 36, wilayaName: "El Tarf", zrExpress: { home: 850, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 37, wilayaName: "Tindouf", zrExpress: { home: 0, desk: 0 }, yalidine: { home: 1850, desk: 1750 } }, // ZR not available?
-    { wilayaCode: 38, wilayaName: "Tissemsilt", zrExpress: { home: 900, desk: 0 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 39, wilayaName: "El Oued", zrExpress: { home: 950, desk: 670 }, yalidine: { home: 1050, desk: 1000 } },
-    { wilayaCode: 40, wilayaName: "Khenchela", zrExpress: { home: 900, desk: 0 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 41, wilayaName: "Souk Ahras", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 42, wilayaName: "Tipaza", zrExpress: { home: 700, desk: 520 }, yalidine: { home: 700, desk: 650 } },
-    { wilayaCode: 43, wilayaName: "Mila", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 44, wilayaName: "Ain Defla", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 45, wilayaName: "Naama", zrExpress: { home: 1100, desk: 670 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 46, wilayaName: "Ain Temouchent", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 47, wilayaName: "Ghardaia", zrExpress: { home: 950, desk: 620 }, yalidine: { home: 1050, desk: 1000 } },
-    { wilayaCode: 48, wilayaName: "Relizane", zrExpress: { home: 900, desk: 520 }, yalidine: { home: 900, desk: 850 } },
-    { wilayaCode: 49, wilayaName: "Timimoun", zrExpress: { home: 1400, desk: 0 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 50, wilayaName: "Bordj Badji Mokhtar", zrExpress: { home: 0, desk: 0 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 51, wilayaName: "Ouled Djellal", zrExpress: { home: 950, desk: 620 }, yalidine: { home: 1050, desk: 1000 } },
-    { wilayaCode: 52, wilayaName: "Beni Abbes", zrExpress: { home: 1100, desk: 970 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 53, wilayaName: "In Salah", zrExpress: { home: 1600, desk: 0 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 54, wilayaName: "In Guezzam", zrExpress: { home: 1600, desk: 0 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 55, wilayaName: "Touggourt", zrExpress: { home: 950, desk: 670 }, yalidine: { home: 1050, desk: 1000 } },
-    { wilayaCode: 56, wilayaName: "Djanet", zrExpress: { home: 0, desk: 0 }, yalidine: { home: 1850, desk: 1750 } },
-    { wilayaCode: 57, wilayaName: "M'Ghair", zrExpress: { home: 950, desk: 0 }, yalidine: { home: 1050, desk: 1000 } },
-    { wilayaCode: 58, wilayaName: "El Menia", zrExpress: { home: 1000, desk: 0 }, yalidine: { home: 1050, desk: 1000 } },
+  {
+    wilayaCode: 1,
+    wilayaName: "Adrar",
+    zrExpress: { home: 1400, desk: 970 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 2,
+    wilayaName: "Chlef",
+    zrExpress: { home: 850, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 3,
+    wilayaName: "Laghouat",
+    zrExpress: { home: 950, desk: 620 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
+  {
+    wilayaCode: 4,
+    wilayaName: "Oum El Bouaghi",
+    zrExpress: { home: 850, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 5,
+    wilayaName: "Batna",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 6,
+    wilayaName: "Bejaia",
+    zrExpress: { home: 800, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 7,
+    wilayaName: "Biskra",
+    zrExpress: { home: 950, desk: 620 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
+  {
+    wilayaCode: 8,
+    wilayaName: "Bechar",
+    zrExpress: { home: 1100, desk: 720 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 9,
+    wilayaName: "Blida",
+    zrExpress: { home: 600, desk: 470 },
+    yalidine: { home: 700, desk: 650 },
+  },
+  {
+    wilayaCode: 10,
+    wilayaName: "Bouira",
+    zrExpress: { home: 700, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 11,
+    wilayaName: "Tamanrasset",
+    zrExpress: { home: 1600, desk: 1120 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 12,
+    wilayaName: "Tebessa",
+    zrExpress: { home: 900, desk: 570 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
+  {
+    wilayaCode: 13,
+    wilayaName: "Tlemcen",
+    zrExpress: { home: 900, desk: 570 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 14,
+    wilayaName: "Tiaret",
+    zrExpress: { home: 850, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 15,
+    wilayaName: "Tizi Ouzou",
+    zrExpress: { home: 750, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 16,
+    wilayaName: "Alger",
+    zrExpress: { home: 500, desk: 370 },
+    yalidine: { home: 600, desk: 550 },
+  },
+  {
+    wilayaCode: 17,
+    wilayaName: "Djelfa",
+    zrExpress: { home: 950, desk: 570 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
+  {
+    wilayaCode: 18,
+    wilayaName: "Jijel",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 19,
+    wilayaName: "Setif",
+    zrExpress: { home: 800, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 20,
+    wilayaName: "Saida",
+    zrExpress: { home: 900, desk: 570 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 21,
+    wilayaName: "Skikda",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 22,
+    wilayaName: "Sidi Bel Abbes",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 23,
+    wilayaName: "Annaba",
+    zrExpress: { home: 850, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 24,
+    wilayaName: "Guelma",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 25,
+    wilayaName: "Constantine",
+    zrExpress: { home: 800, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 26,
+    wilayaName: "Medea",
+    zrExpress: { home: 800, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 27,
+    wilayaName: "Mostaganem",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 28,
+    wilayaName: "M'Sila",
+    zrExpress: { home: 850, desk: 570 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 29,
+    wilayaName: "Mascara",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 30,
+    wilayaName: "Ouargla",
+    zrExpress: { home: 950, desk: 670 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
+  {
+    wilayaCode: 31,
+    wilayaName: "Oran",
+    zrExpress: { home: 800, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 32,
+    wilayaName: "El Bayadh",
+    zrExpress: { home: 1100, desk: 670 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 33,
+    wilayaName: "Illizi",
+    zrExpress: { home: 0, desk: 0 },
+    yalidine: { home: 1850, desk: 1750 },
+  }, // ZR not available?
+  {
+    wilayaCode: 34,
+    wilayaName: "Bordj Bou Arreridj",
+    zrExpress: { home: 800, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 35,
+    wilayaName: "Boumerdes",
+    zrExpress: { home: 700, desk: 520 },
+    yalidine: { home: 700, desk: 650 },
+  },
+  {
+    wilayaCode: 36,
+    wilayaName: "El Tarf",
+    zrExpress: { home: 850, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 37,
+    wilayaName: "Tindouf",
+    zrExpress: { home: 0, desk: 0 },
+    yalidine: { home: 1850, desk: 1750 },
+  }, // ZR not available?
+  {
+    wilayaCode: 38,
+    wilayaName: "Tissemsilt",
+    zrExpress: { home: 900, desk: 0 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 39,
+    wilayaName: "El Oued",
+    zrExpress: { home: 950, desk: 670 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
+  {
+    wilayaCode: 40,
+    wilayaName: "Khenchela",
+    zrExpress: { home: 900, desk: 0 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 41,
+    wilayaName: "Souk Ahras",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 42,
+    wilayaName: "Tipaza",
+    zrExpress: { home: 700, desk: 520 },
+    yalidine: { home: 700, desk: 650 },
+  },
+  {
+    wilayaCode: 43,
+    wilayaName: "Mila",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 44,
+    wilayaName: "Ain Defla",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 45,
+    wilayaName: "Naama",
+    zrExpress: { home: 1100, desk: 670 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 46,
+    wilayaName: "Ain Temouchent",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 47,
+    wilayaName: "Ghardaia",
+    zrExpress: { home: 950, desk: 620 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
+  {
+    wilayaCode: 48,
+    wilayaName: "Relizane",
+    zrExpress: { home: 900, desk: 520 },
+    yalidine: { home: 900, desk: 850 },
+  },
+  {
+    wilayaCode: 49,
+    wilayaName: "Timimoun",
+    zrExpress: { home: 1400, desk: 0 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 50,
+    wilayaName: "Bordj Badji Mokhtar",
+    zrExpress: { home: 0, desk: 0 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 51,
+    wilayaName: "Ouled Djellal",
+    zrExpress: { home: 950, desk: 620 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
+  {
+    wilayaCode: 52,
+    wilayaName: "Beni Abbes",
+    zrExpress: { home: 1100, desk: 970 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 53,
+    wilayaName: "In Salah",
+    zrExpress: { home: 1600, desk: 0 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 54,
+    wilayaName: "In Guezzam",
+    zrExpress: { home: 1600, desk: 0 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 55,
+    wilayaName: "Touggourt",
+    zrExpress: { home: 950, desk: 670 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
+  {
+    wilayaCode: 56,
+    wilayaName: "Djanet",
+    zrExpress: { home: 0, desk: 0 },
+    yalidine: { home: 1850, desk: 1750 },
+  },
+  {
+    wilayaCode: 57,
+    wilayaName: "M'Ghair",
+    zrExpress: { home: 950, desk: 0 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
+  {
+    wilayaCode: 58,
+    wilayaName: "El Menia",
+    zrExpress: { home: 1000, desk: 0 },
+    yalidine: { home: 1050, desk: 1000 },
+  },
 ];
 
 export function getDeliveryPrice(
-    wilayaCode: number,
-    provider: DeliveryProvider,
-    type: DeliveryType
+  wilayaCode: number,
+  provider: DeliveryProvider,
+  type: DeliveryType,
 ): number {
-    const rate = deliveryRates.find((r) => r.wilayaCode === wilayaCode);
-    if (!rate) return 0;
+  const rate = deliveryRates.find((r) => r.wilayaCode === wilayaCode);
+  if (!rate) return 0;
 
-    if (provider === "ZR Express") {
-        return type === "HOME" ? rate.zrExpress.home : rate.zrExpress.desk;
-    } else {
-        return type === "HOME" ? rate.yalidine.home : rate.yalidine.desk;
-    }
+  if (provider === "ZR Express") {
+    return type === "HOME" ? rate.zrExpress.home : rate.zrExpress.desk;
+  } else {
+    return type === "HOME" ? rate.yalidine.home : rate.yalidine.desk;
+  }
 }
diff --git a/src/lib/email/magic-link.ts b/src/lib/email/magic-link.ts
index 7f464e7..b519754 100644
--- a/src/lib/email/magic-link.ts
+++ b/src/lib/email/magic-link.ts
@@ -1,28 +1,35 @@
-import nodemailer from 'nodemailer';
+import nodemailer from "nodemailer";
 
-export async function sendMagicLinkEmail(email: string, link: string, guestKey?: string) {
+export async function sendMagicLinkEmail(
+  email: string,
+  link: string,
+  guestKey?: string,
+) {
   console.log(`[Email Service] Sending Magic Link to ${email}`);
   console.log(`[Email Service] Link: ${link}`);
-  
-  if (process.env.EMAIL_PROVIDER === 'nodemailer' || process.env.NODE_ENV === 'development') {
+
+  if (
+    process.env.EMAIL_PROVIDER === "nodemailer" ||
+    process.env.NODE_ENV === "development"
+  ) {
     // In dev, we might just log it, or use a real SMTP if configured
     if (process.env.SMTP_HOST) {
-        const transporter = nodemailer.createTransport({
-            host: process.env.SMTP_HOST,
-            port: parseInt(process.env.SMTP_PORT || "587"),
-            auth: {
-                user: process.env.SMTP_USER,
-                pass: process.env.SMTP_PASS,
-            },
-        });
+      const transporter = nodemailer.createTransport({
+        host: process.env.SMTP_HOST,
+        port: parseInt(process.env.SMTP_PORT || "587"),
+        auth: {
+          user: process.env.SMTP_USER,
+          pass: process.env.SMTP_PASS,
+        },
+      });
 
-        const expMin = process.env.MAGIC_LINK_EXP_MIN || "15";
+      const expMin = process.env.MAGIC_LINK_EXP_MIN || "15";
 
-        await transporter.sendMail({
-            from: '"Harp" <contact@harpalgeria.com>',
-            to: email,
-            subject: 'Voici votre lien de connexion HARP',
-            text: `
+      await transporter.sendMail({
+        from: '"Harp" <contact@harpalgeria.com>',
+        to: email,
+        subject: "Voici votre lien de connexion HARP",
+        text: `
 Objet: Voici votre lien de connexion HARP
 
 Bonjour,
@@ -35,7 +42,7 @@ Si vous n'avez pas demandé ce lien, ignorez cet email.
 À bientôt,
 L'équipe Harp
             `,
-            html: `
+        html: `
 <!doctype html>
 <html>
   <body style="font-family:Inter,Arial,sans-serif;color:#333;">
@@ -62,8 +69,8 @@ L'équipe Harp
     </table>
   </body>
 </html>
-            `
-        });
+            `,
+      });
     }
   }
 }
diff --git a/src/lib/inventory-service.ts b/src/lib/inventory-service.ts
index 582473d..2564811 100644
--- a/src/lib/inventory-service.ts
+++ b/src/lib/inventory-service.ts
@@ -32,8 +32,8 @@ export const ProductionBatchStatus = {
   CANCELLED: "CANCELLED",
 } as const;
 
-export type TxDirectionType = typeof TxDirection[keyof typeof TxDirection];
-export type TxTypeType = typeof TxType[keyof typeof TxType];
+export type TxDirectionType = (typeof TxDirection)[keyof typeof TxDirection];
+export type TxTypeType = (typeof TxType)[keyof typeof TxType];
 
 // ============================================================================
 // AUDIT LOGGING
@@ -48,7 +48,7 @@ export async function createAuditLog(
   entityId: string,
   changes?: { before?: unknown; after?: unknown },
   userId?: string,
-  userEmail?: string
+  userEmail?: string,
 ) {
   return prisma.auditLog.create({
     data: {
@@ -59,7 +59,7 @@ export async function createAuditLog(
       userEmail,
       before: changes?.before ? JSON.stringify(changes.before) : null,
       after: changes?.after ? JSON.stringify(changes.after) : null,
-    }
+    },
   });
 }
 
@@ -72,9 +72,11 @@ export async function createAuditLog(
  */
 export async function getLowStockItems() {
   const items = await prisma.inventoryItem.findMany({
-    where: { threshold: { not: null } }
+    where: { threshold: { not: null } },
   });
-  return items.filter(item => item.threshold !== null && item.quantity <= item.threshold);
+  return items.filter(
+    (item) => item.threshold !== null && item.quantity <= item.threshold,
+  );
 }
 
 /**
@@ -82,7 +84,10 @@ export async function getLowStockItems() {
  */
 export async function getInventoryValuation() {
   const items = await prisma.inventoryItem.findMany();
-  return items.reduce((total, item) => total + (Number(item.quantity) * Number(item.averageCost)), 0);
+  return items.reduce(
+    (total, item) => total + Number(item.quantity) * Number(item.averageCost),
+    0,
+  );
 }
 
 /**
@@ -96,10 +101,10 @@ export async function createInventoryTransaction(
   unitCost: number,
   referenceType: string,
   referenceId: string,
-  notes?: string
+  notes?: string,
 ) {
   const item = await prisma.inventoryItem.findUnique({
-    where: { id: inventoryItemId }
+    where: { id: inventoryItemId },
   });
 
   if (!item) {
@@ -107,9 +112,10 @@ export async function createInventoryTransaction(
   }
 
   const balanceBefore = Number(item.quantity);
-  const balanceAfter = direction === TxDirection.IN 
-    ? balanceBefore + quantity 
-    : balanceBefore - quantity;
+  const balanceAfter =
+    direction === TxDirection.IN
+      ? balanceBefore + quantity
+      : balanceBefore - quantity;
 
   const valueBefore = Number(item.totalValue);
   const valueAfter = balanceAfter * Number(item.averageCost);
@@ -130,6 +136,6 @@ export async function createInventoryTransaction(
       referenceType,
       referenceId,
       notes,
-    }
+    },
   });
 }
diff --git a/src/lib/logger.ts b/src/lib/logger.ts
index 9d57cd1..ce3a4e5 100644
--- a/src/lib/logger.ts
+++ b/src/lib/logger.ts
@@ -13,7 +13,11 @@ interface LoggerOptions {
   forceLog?: boolean;
 }
 
-function formatMessage(level: LogLevel, prefix: string, args: unknown[]): string {
+function formatMessage(
+  level: LogLevel,
+  prefix: string,
+  args: unknown[],
+): string {
   const timestamp = new Date().toISOString();
   const prefixStr = prefix ? `[${prefix}]` : "";
   return `${timestamp} ${level.toUpperCase()} ${prefixStr}`;
diff --git a/src/lib/loyalty/services/loyalty.service.ts b/src/lib/loyalty/services/loyalty.service.ts
index cda282e..b6c1470 100644
--- a/src/lib/loyalty/services/loyalty.service.ts
+++ b/src/lib/loyalty/services/loyalty.service.ts
@@ -15,16 +15,28 @@ export const LOYALTY_RULES = {
 
 export const VIP_LEVELS = {
   SILVER: { threshold: 0, multiplier: 1, benefits: ["Accès standard"] },
-  GOLD: { threshold: 50000, multiplier: 1.2, benefits: ["Livraison gratuite > 5000 DA", "Accès ventes privées"] },
-  BLACK: { threshold: 150000, multiplier: 1.5, benefits: ["Livraison gratuite sans minimum", "Service conciergerie", "Cadeau surprise"] },
+  GOLD: {
+    threshold: 50000,
+    multiplier: 1.2,
+    benefits: ["Livraison gratuite > 5000 DA", "Accès ventes privées"],
+  },
+  BLACK: {
+    threshold: 150000,
+    multiplier: 1.5,
+    benefits: [
+      "Livraison gratuite sans minimum",
+      "Service conciergerie",
+      "Cadeau surprise",
+    ],
+  },
 };
 
-export type LoyaltyAction = 
-  | "PURCHASE" 
-  | "SIGNUP" 
-  | "BIRTHDAY" 
-  | "REFERRAL" 
-  | "REVIEW" 
+export type LoyaltyAction =
+  | "PURCHASE"
+  | "SIGNUP"
+  | "BIRTHDAY"
+  | "REFERRAL"
+  | "REVIEW"
   | "ABANDONED_CART_RECOVERY"
   | "NEWSLETTER"
   | "WHATSAPP_SHARE"
@@ -34,7 +46,9 @@ export type LoyaltyAction =
 /**
  * Calculate VIP level based on total lifetime points
  */
-export function calculateVipLevel(totalPoints: number): "SILVER" | "GOLD" | "BLACK" {
+export function calculateVipLevel(
+  totalPoints: number,
+): "SILVER" | "GOLD" | "BLACK" {
   if (totalPoints >= VIP_LEVELS.BLACK.threshold) return "BLACK";
   if (totalPoints >= VIP_LEVELS.GOLD.threshold) return "GOLD";
   return "SILVER";
@@ -44,15 +58,15 @@ export function calculateVipLevel(totalPoints: number): "SILVER" | "GOLD" | "BLA
  * Add loyalty points to a user
  */
 export async function earnPoints(
-  userId: string, 
-  amount: number, 
-  reason: LoyaltyAction, 
-  referenceId?: string
+  userId: string,
+  amount: number,
+  reason: LoyaltyAction,
+  referenceId?: string,
 ) {
   // Check for idempotency first to avoid transaction overhead if already processed
   if (referenceId) {
     const existing = await prisma.loyaltyPoint.findUnique({
-      where: { referenceId }
+      where: { referenceId },
     });
     if (existing) {
       console.log(`[Loyalty] Skipped duplicate event: ${referenceId}`);
@@ -68,8 +82,8 @@ export async function earnPoints(
           userId,
           amount,
           reason,
-          referenceId
-        }
+          referenceId,
+        },
       });
 
       // 2. Update user balance and calculate new VIP level
@@ -78,33 +92,35 @@ export async function earnPoints(
 
       // Calculate lifetime points
       const newBalance = (user.loyaltyPoints || 0) + amount;
-      
+
       // Re-evaluate VIP level based on historical points
       const history = await tx.loyaltyPoint.aggregate({
         where: { userId, amount: { gt: 0 } },
-        _sum: { amount: true }
+        _sum: { amount: true },
       });
-      
+
       // Note: aggregated sum includes the point we just created inside this transaction context
-      const totalLifetimePoints = (history._sum.amount || 0); 
+      const totalLifetimePoints = history._sum.amount || 0;
       const newVipLevel = calculateVipLevel(totalLifetimePoints);
 
       await tx.user.update({
         where: { id: userId },
         data: {
           loyaltyPoints: newBalance,
-          vipLevel: newVipLevel
-        }
+          vipLevel: newVipLevel,
+        },
       });
 
       return pointRecord;
     });
   } catch (error: any) {
     // Handle race condition where simultaneous requests pass the initial check
-    if (error.code === 'P2002') {
-       console.log(`[Loyalty] Race condition duplicate caught: ${referenceId}`);
-       const existing = await prisma.loyaltyPoint.findUnique({ where: { referenceId } });
-       return existing;
+    if (error.code === "P2002") {
+      console.log(`[Loyalty] Race condition duplicate caught: ${referenceId}`);
+      const existing = await prisma.loyaltyPoint.findUnique({
+        where: { referenceId },
+      });
+      return existing;
     }
     throw error;
   }
@@ -116,35 +132,41 @@ export async function earnPoints(
 export async function getLoyaltySummary(userId: string) {
   const user = await prisma.user.findUnique({
     where: { id: userId },
-    select: { 
-      loyaltyPoints: true, 
+    select: {
+      loyaltyPoints: true,
       vipLevel: true,
       pointHistory: {
-        orderBy: { createdAt: 'desc' },
-        take: 20
-      }
-    }
+        orderBy: { createdAt: "desc" },
+        take: 20,
+      },
+    },
   });
 
   if (!user) throw new Error("User not found");
-  
+
   // Calculate progress to next level
   let nextLevel = null;
   let progress = 0;
-  
+
   // Need total lifetime points for accurate progress
   const history = await prisma.loyaltyPoint.aggregate({
-      where: { userId, amount: { gt: 0 } },
-      _sum: { amount: true }
+    where: { userId, amount: { gt: 0 } },
+    _sum: { amount: true },
   });
   const totalLifetimePoints = history._sum.amount || 0;
 
   if (user.vipLevel === "SILVER") {
     nextLevel = { name: "GOLD", threshold: VIP_LEVELS.GOLD.threshold };
-    progress = Math.min(100, (totalLifetimePoints / VIP_LEVELS.GOLD.threshold) * 100);
+    progress = Math.min(
+      100,
+      (totalLifetimePoints / VIP_LEVELS.GOLD.threshold) * 100,
+    );
   } else if (user.vipLevel === "GOLD") {
     nextLevel = { name: "BLACK", threshold: VIP_LEVELS.BLACK.threshold };
-    progress = Math.min(100, (totalLifetimePoints / VIP_LEVELS.BLACK.threshold) * 100);
+    progress = Math.min(
+      100,
+      (totalLifetimePoints / VIP_LEVELS.BLACK.threshold) * 100,
+    );
   }
 
   return {
@@ -153,7 +175,7 @@ export async function getLoyaltySummary(userId: string) {
     benefits: VIP_LEVELS[user.vipLevel as keyof typeof VIP_LEVELS].benefits,
     nextLevel,
     progress,
-    history: user.pointHistory
+    history: user.pointHistory,
   };
 }
 
@@ -162,7 +184,9 @@ export async function getLoyaltySummary(userId: string) {
  */
 export async function redeemReward(userId: string, rewardId: string) {
   return prisma.$transaction(async (tx) => {
-    const reward = await tx.loyaltyReward.findUnique({ where: { id: rewardId } });
+    const reward = await tx.loyaltyReward.findUnique({
+      where: { id: rewardId },
+    });
     if (!reward) throw new Error("Reward not found");
     if (!reward.isActive) throw new Error("Reward is inactive");
 
@@ -176,7 +200,7 @@ export async function redeemReward(userId: string, rewardId: string) {
     // Deduct points
     await tx.user.update({
       where: { id: userId },
-      data: { loyaltyPoints: { decrement: reward.cost } }
+      data: { loyaltyPoints: { decrement: reward.cost } },
     });
 
     // Record transaction
@@ -185,8 +209,8 @@ export async function redeemReward(userId: string, rewardId: string) {
         userId,
         amount: -reward.cost,
         reason: "REWARD_REDEMPTION",
-        referenceId: rewardId
-      }
+        referenceId: rewardId,
+      },
     });
 
     return { success: true, reward };
@@ -205,9 +229,12 @@ export async function grantBirthdayPointsToUser(userId: string) {
 
     const dob = new Date(user.birthDate);
     const today = new Date();
-    
+
     // Check if today is user's birthday (compare month & day)
-    if (dob.getUTCDate() !== today.getUTCDate() || dob.getUTCMonth() !== today.getUTCMonth()) {
+    if (
+      dob.getUTCDate() !== today.getUTCDate() ||
+      dob.getUTCMonth() !== today.getUTCMonth()
+    ) {
       throw new Error("Aujourd'hui n'est pas l'anniversaire de l'utilisateur");
     }
 
@@ -222,8 +249,8 @@ export async function grantBirthdayPointsToUser(userId: string) {
         userId: user.id,
         amount: LOYALTY_RULES.BIRTHDAY_BONUS,
         reason: "BIRTHDAY",
-        referenceId: `birthday-${currentYear}`
-      }
+        referenceId: `birthday-${currentYear}`,
+      },
     });
 
     // 2) Update user balance and lastBirthdayGrantYear
@@ -231,11 +258,15 @@ export async function grantBirthdayPointsToUser(userId: string) {
       where: { id: user.id },
       data: {
         loyaltyPoints: { increment: LOYALTY_RULES.BIRTHDAY_BONUS },
-        lastBirthdayGrantYear: currentYear
-      }
+        lastBirthdayGrantYear: currentYear,
+      },
     });
 
-    return { success: true, txId: pointRecord.id, points: LOYALTY_RULES.BIRTHDAY_BONUS };
+    return {
+      success: true,
+      txId: pointRecord.id,
+      points: LOYALTY_RULES.BIRTHDAY_BONUS,
+    };
   });
 }
 
@@ -251,24 +282,26 @@ export async function runDailyBirthdayGrant() {
   // Get all users with birthDate set
   const users = await prisma.user.findMany({
     where: {
-      birthDate: { not: null }
+      birthDate: { not: null },
     },
     select: {
       id: true,
       email: true,
       name: true,
       birthDate: true,
-      lastBirthdayGrantYear: true
-    }
+      lastBirthdayGrantYear: true,
+    },
   });
 
   // Filter users whose birthday is today and haven't received points this year
-  const candidates = users.filter(u => {
+  const candidates = users.filter((u) => {
     if (!u.birthDate) return false;
     const d = new Date(u.birthDate);
-    return d.getUTCMonth() === month && 
-           d.getUTCDate() === day && 
-           (u.lastBirthdayGrantYear ?? 0) < currentYear;
+    return (
+      d.getUTCMonth() === month &&
+      d.getUTCDate() === day &&
+      (u.lastBirthdayGrantYear ?? 0) < currentYear
+    );
   });
 
   const results = [];
@@ -276,7 +309,9 @@ export async function runDailyBirthdayGrant() {
     try {
       await grantBirthdayPointsToUser(u.id);
       results.push({ email: u.email, success: true });
-      console.log(`[Birthday] Granted ${LOYALTY_RULES.BIRTHDAY_BONUS} points to ${u.email}`);
+      console.log(
+        `[Birthday] Granted ${LOYALTY_RULES.BIRTHDAY_BONUS} points to ${u.email}`,
+      );
     } catch (err: any) {
       results.push({ email: u.email, success: false, error: err.message });
       console.error(`[Birthday] Failed for ${u.email}:`, err.message);
diff --git a/src/lib/loyalty/services/wishlist.service.ts b/src/lib/loyalty/services/wishlist.service.ts
index 8abd0a4..8b567ec 100644
--- a/src/lib/loyalty/services/wishlist.service.ts
+++ b/src/lib/loyalty/services/wishlist.service.ts
@@ -16,20 +16,20 @@ export async function getUserWishlist(userId: string) {
           price: true,
           images: true,
           stock: true,
-        }
-      }
+        },
+      },
     },
-    orderBy: { createdAt: "desc" }
+    orderBy: { createdAt: "desc" },
   });
 
   return {
-    items: items.map(item => ({
+    items: items.map((item) => ({
       id: item.id,
       productId: item.productId,
       product: item.product,
-      addedAt: item.createdAt
+      addedAt: item.createdAt,
     })),
-    count: items.length
+    count: items.length,
   };
 }
 
@@ -39,18 +39,18 @@ export async function getUserWishlist(userId: string) {
 export async function toggleWishlist(userId: string, productId: string) {
   const existing = await prisma.wishlistItem.findUnique({
     where: {
-      userId_productId: { userId, productId }
-    }
+      userId_productId: { userId, productId },
+    },
   });
 
   if (existing) {
     await prisma.wishlistItem.delete({
-      where: { id: existing.id }
+      where: { id: existing.id },
     });
     return { added: false, productId };
   } else {
     await prisma.wishlistItem.create({
-      data: { userId, productId }
+      data: { userId, productId },
     });
     return { added: true, productId };
   }
@@ -62,7 +62,7 @@ export async function toggleWishlist(userId: string, productId: string) {
 export async function addToWishlist(userId: string, productId: string) {
   try {
     await prisma.wishlistItem.create({
-      data: { userId, productId }
+      data: { userId, productId },
     });
     return { added: true, productId };
   } catch (e: any) {
@@ -81,8 +81,8 @@ export async function removeFromWishlist(userId: string, productId: string) {
   try {
     await prisma.wishlistItem.delete({
       where: {
-        userId_productId: { userId, productId }
-      }
+        userId_productId: { userId, productId },
+      },
     });
     return { removed: true, productId };
   } catch (e: any) {
@@ -104,7 +104,7 @@ export async function syncLocalWishlist(userId: string, productIds: string[]) {
   for (const productId of productIds) {
     try {
       await prisma.wishlistItem.create({
-        data: { userId, productId }
+        data: { userId, productId },
       });
       addedCount++;
     } catch (e: any) {
@@ -117,18 +117,21 @@ export async function syncLocalWishlist(userId: string, productIds: string[]) {
     success: true,
     added: addedCount,
     skipped: skippedCount,
-    total: productIds.length
+    total: productIds.length,
   };
 }
 
 /**
  * Check if a product is in user's wishlist
  */
-export async function isInWishlist(userId: string, productId: string): Promise<boolean> {
+export async function isInWishlist(
+  userId: string,
+  productId: string,
+): Promise<boolean> {
   const item = await prisma.wishlistItem.findUnique({
     where: {
-      userId_productId: { userId, productId }
-    }
+      userId_productId: { userId, productId },
+    },
   });
   return !!item;
 }
@@ -138,6 +141,6 @@ export async function isInWishlist(userId: string, productId: string): Promise<b
  */
 export async function getWishlistCount(userId: string): Promise<number> {
   return prisma.wishlistItem.count({
-    where: { userId }
+    where: { userId },
   });
 }
diff --git a/src/lib/pagination.ts b/src/lib/pagination.ts
index dbc725e..b5be4da 100644
--- a/src/lib/pagination.ts
+++ b/src/lib/pagination.ts
@@ -26,13 +26,15 @@ export interface PaginationMeta {
 export function parsePagination(
   params: URLSearchParams,
   defaultPageSize: number = 20,
-  maxPageSize: number = 100
+  maxPageSize: number = 100,
 ): PaginationParams {
   const page = Math.max(1, Number(params.get("page") ?? 1));
-  const requestedPageSize = Number(params.get("pageSize") ?? params.get("limit") ?? defaultPageSize);
+  const requestedPageSize = Number(
+    params.get("pageSize") ?? params.get("limit") ?? defaultPageSize,
+  );
   const pageSize = Math.min(maxPageSize, Math.max(1, requestedPageSize));
   const skip = (page - 1) * pageSize;
-  
+
   return { page, pageSize, skip };
 }
 
@@ -42,10 +44,10 @@ export function parsePagination(
 export function createPaginationMeta(
   page: number,
   pageSize: number,
-  total: number
+  total: number,
 ): PaginationMeta {
   const totalPages = Math.ceil(total / pageSize);
-  
+
   return {
     page,
     pageSize,
@@ -63,7 +65,7 @@ export function paginatedResponse<T>(
   items: T[],
   page: number,
   pageSize: number,
-  total: number
+  total: number,
 ) {
   return {
     items,
diff --git a/src/lib/prisma.ts b/src/lib/prisma.ts
index 07815cd..7c8f74c 100644
--- a/src/lib/prisma.ts
+++ b/src/lib/prisma.ts
@@ -1,16 +1,16 @@
-import { PrismaClient } from '@prisma/client'
+import { PrismaClient } from "@prisma/client";
 
-const globalForPrisma = global as unknown as { prisma: PrismaClient }
+const globalForPrisma = global as unknown as { prisma: PrismaClient };
 
 // Force disconnect old instance if it exists during hot-reload to switch providers
-if (process.env.NODE_ENV !== 'production' && globalForPrisma.prisma) {
+if (process.env.NODE_ENV !== "production" && globalForPrisma.prisma) {
   globalForPrisma.prisma.$disconnect();
 }
 
 export const prisma =
   globalForPrisma.prisma ||
   new PrismaClient({
-    log: ['query', 'error', 'warn'],
-  })
+    log: ["query", "error", "warn"],
+  });
 
-if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma
+if (process.env.NODE_ENV !== "production") globalForPrisma.prisma = prisma;
diff --git a/src/lib/rate-limit.ts b/src/lib/rate-limit.ts
index f890b55..df0ef3e 100644
--- a/src/lib/rate-limit.ts
+++ b/src/lib/rate-limit.ts
@@ -26,22 +26,26 @@ function cleanup() {
  * @param windowMs - Time window in milliseconds
  * @returns true if allowed, false if rate limited
  */
-export function checkRateLimit(key: string, limit: number, windowMs: number): boolean {
+export function checkRateLimit(
+  key: string,
+  limit: number,
+  windowMs: number,
+): boolean {
   cleanup();
-  
+
   const now = Date.now();
   const data = trackers.get(key);
-  
+
   if (!data || data.resetTime < now) {
     // New window
     trackers.set(key, { count: 1, resetTime: now + windowMs });
     return true;
   }
-  
+
   if (data.count >= limit) {
     return false;
   }
-  
+
   data.count++;
   return true;
 }
@@ -49,20 +53,24 @@ export function checkRateLimit(key: string, limit: number, windowMs: number): bo
 /**
  * Get remaining requests and reset time
  */
-export function getRateLimitInfo(key: string, limit: number, windowMs: number): {
+export function getRateLimitInfo(
+  key: string,
+  limit: number,
+  windowMs: number,
+): {
   remaining: number;
   resetTime: number;
 } {
   const data = trackers.get(key);
   const now = Date.now();
-  
+
   if (!data || data.resetTime < now) {
     return { remaining: limit, resetTime: now + windowMs };
   }
-  
+
   return {
     remaining: Math.max(0, limit - data.count),
-    resetTime: data.resetTime
+    resetTime: data.resetTime,
   };
 }
 
@@ -72,13 +80,13 @@ export function getRateLimitInfo(key: string, limit: number, windowMs: number):
 export const RATE_LIMITS = {
   // Strict: Login, password reset
   AUTH: { limit: 5, windowMs: 15 * 60 * 1000 }, // 5 per 15 min
-  
+
   // Medium: Order creation, form submissions
   SUBMIT: { limit: 10, windowMs: 60 * 1000 }, // 10 per minute
-  
+
   // Relaxed: API reads
   API: { limit: 100, windowMs: 60 * 1000 }, // 100 per minute
-  
+
   // Very strict: Magic link requests
   MAGIC_LINK: { limit: 3, windowMs: 60 * 60 * 1000 }, // 3 per hour
 };
@@ -101,26 +109,28 @@ export function getClientIP(req: NextRequest): string {
 export function withRateLimit(
   req: NextRequest,
   limitConfig: { limit: number; windowMs: number },
-  keyPrefix: string = ""
+  keyPrefix: string = "",
 ): NextResponse | null {
   const ip = getClientIP(req);
   const key = `${keyPrefix}:${ip}`;
-  
+
   if (!checkRateLimit(key, limitConfig.limit, limitConfig.windowMs)) {
     const info = getRateLimitInfo(key, limitConfig.limit, limitConfig.windowMs);
     return NextResponse.json(
       { error: "Too many requests. Please try again later." },
-      { 
+      {
         status: 429,
         headers: {
           "X-RateLimit-Limit": limitConfig.limit.toString(),
           "X-RateLimit-Remaining": info.remaining.toString(),
           "X-RateLimit-Reset": Math.ceil(info.resetTime / 1000).toString(),
-          "Retry-After": Math.ceil((info.resetTime - Date.now()) / 1000).toString()
-        }
-      }
+          "Retry-After": Math.ceil(
+            (info.resetTime - Date.now()) / 1000,
+          ).toString(),
+        },
+      },
     );
   }
-  
+
   return null;
 }
diff --git a/src/lib/schemas/admin.schemas.ts b/src/lib/schemas/admin.schemas.ts
index f72ea9f..35f3dcf 100644
--- a/src/lib/schemas/admin.schemas.ts
+++ b/src/lib/schemas/admin.schemas.ts
@@ -4,14 +4,23 @@ export const clientsQuerySchema = z.object({
   page: z.coerce.number().int().min(1).optional().default(1),
   pageSize: z.coerce.number().int().min(1).max(100).optional().default(20),
   search: z.string().optional(),
-  vipLevel: z.enum(["ALL", "SILVER", "GOLD", "BLACK"]).optional().default("ALL"),
-  sortBy: z.enum(["createdAt", "email", "loyaltyPoints"]).optional().default("createdAt"),
+  vipLevel: z
+    .enum(["ALL", "SILVER", "GOLD", "BLACK"])
+    .optional()
+    .default("ALL"),
+  sortBy: z
+    .enum(["createdAt", "email", "loyaltyPoints"])
+    .optional()
+    .default("createdAt"),
   sortOrder: z.enum(["asc", "desc"]).optional().default("desc"),
 });
 
 export const clientExportSchema = z.object({
   format: z.enum(["json", "csv"]).optional().default("csv"),
-  vipLevel: z.enum(["ALL", "SILVER", "GOLD", "BLACK"]).optional().default("ALL"),
+  vipLevel: z
+    .enum(["ALL", "SILVER", "GOLD", "BLACK"])
+    .optional()
+    .default("ALL"),
   search: z.string().optional(),
 });
 
diff --git a/src/lib/site/settings.service.ts b/src/lib/site/settings.service.ts
index f824753..4505aa7 100644
--- a/src/lib/site/settings.service.ts
+++ b/src/lib/site/settings.service.ts
@@ -26,7 +26,7 @@ export interface HeroSettings {
  */
 export async function getSiteSettings() {
   let settings = await prisma.siteSetting.findUnique({
-    where: { id: "default" }
+    where: { id: "default" },
   });
 
   // Create default settings if not exists
@@ -37,8 +37,8 @@ export async function getSiteSettings() {
         heroActive: true,
         heroOverlayOpacity: 0.35,
         heroPreset: "classic",
-        heroVariant: "image"
-      }
+        heroVariant: "image",
+      },
     });
   }
 
@@ -56,7 +56,7 @@ export async function updateHeroSettings(data: HeroSettings, userId?: string) {
     // Ensure settings exist
     if (!prev) {
       await tx.siteSetting.create({
-        data: { id: "default" }
+        data: { id: "default" },
       });
     }
 
@@ -66,8 +66,8 @@ export async function updateHeroSettings(data: HeroSettings, userId?: string) {
         data: {
           settingId: "default",
           snapshot: JSON.stringify(prev),
-          userId
-        }
+          userId,
+        },
       });
     }
 
@@ -76,8 +76,8 @@ export async function updateHeroSettings(data: HeroSettings, userId?: string) {
       where: { id: "default" },
       data: {
         ...data,
-        lastUpdatedById: userId || null
-      }
+        lastUpdatedById: userId || null,
+      },
     });
 
     // Create audit log
@@ -88,8 +88,8 @@ export async function updateHeroSettings(data: HeroSettings, userId?: string) {
         entityId: "default",
         userId: userId || null,
         before: prev ? JSON.stringify(prev) : null,
-        after: JSON.stringify(updated)
-      }
+        after: JSON.stringify(updated),
+      },
     });
 
     return { prev, updated };
@@ -103,7 +103,7 @@ export async function getSettingsHistory(limit = 10) {
   return prisma.siteSettingHistory.findMany({
     where: { settingId: "default" },
     orderBy: { createdAt: "desc" },
-    take: limit
+    take: limit,
   });
 }
 
@@ -112,7 +112,7 @@ export async function getSettingsHistory(limit = 10) {
  */
 export async function rollbackSettings(historyId: string, userId?: string) {
   const history = await prisma.siteSettingHistory.findUnique({
-    where: { id: historyId }
+    where: { id: historyId },
   });
 
   if (!history) {
@@ -120,7 +120,7 @@ export async function rollbackSettings(historyId: string, userId?: string) {
   }
 
   const snapshot = JSON.parse(history.snapshot);
-  
+
   // Remove fields that shouldn't be restored
   delete snapshot.id;
   delete snapshot.createdAt;
@@ -137,11 +137,14 @@ export function isHeroActive(settings: any): boolean {
   if (!settings?.heroActive) return false;
 
   const now = new Date();
-  
-  if (settings.heroScheduleStart && new Date(settings.heroScheduleStart) > now) {
+
+  if (
+    settings.heroScheduleStart &&
+    new Date(settings.heroScheduleStart) > now
+  ) {
     return false;
   }
-  
+
   if (settings.heroScheduleEnd && new Date(settings.heroScheduleEnd) < now) {
     return false;
   }
@@ -162,19 +165,22 @@ export function generateCloudinarySignature(folder: string = "harp/hero") {
   }
 
   const timestamp = Math.floor(Date.now() / 1000);
-  
+
   // Create signature string
   const signatureString = `folder=${folder}&timestamp=${timestamp}${apiSecret}`;
-  
+
   // Create SHA1 hash
   const crypto = require("crypto");
-  const signature = crypto.createHash("sha1").update(signatureString).digest("hex");
+  const signature = crypto
+    .createHash("sha1")
+    .update(signatureString)
+    .digest("hex");
 
   return {
     signature,
     timestamp,
     apiKey,
     cloudName,
-    folder
+    folder,
   };
 }
diff --git a/src/lib/translations.ts b/src/lib/translations.ts
index 8b06d04..8b6a3a7 100644
--- a/src/lib/translations.ts
+++ b/src/lib/translations.ts
@@ -1,394 +1,421 @@
 export const translations = {
-    fr: {
-        "nav.home": "Accueil",
-        "nav.shop": "Collection",
-        "nav.about": "À propos",
-        "nav.contact": "Contact",
-        "nav.language": "Langue :",
-        "hero.title": "Une élégance qui résonne",
-        "hero.subtitle": "Des pièces élégantes, couvrantes et uniques, pensées pour la femme moderne.",
-        "hero.cta": "Découvrir la collection",
-        "values.elegance": "Élégance intemporelle",
-        "values.authenticity": "Authenticité",
-        "values.modest": "Modest fashion moderne",
-        "values.quality": "Qualité des matières",
-        "values.warmth": "Chaleur & confort",
-        "values.quantity": "Petites quantités",
-        "values.respect": "Respect de la femme",
-        "footer.copyright": "Harp 2025. Tous droits réservés.",
-        "product.addToCart": "Ajouter au panier",
-        "product.buyWhatsapp": "Commander via WhatsApp",
-        "cart.title": "Votre Panier",
-        "cart.empty": "Votre panier est vide.",
-        "cart.total": "Total",
-        "cart.checkout": "Valider la commande",
-        "cart.items": "article(s)",
-        "cart.freeShipping.congrats": "🎉 Félicitations ! Livraison GRATUITE",
-        "cart.freeShipping.title": "Livraison gratuite",
-        "cart.freeShipping.remaining": "Plus que",
-        "cart.discoverCollection": "Découvrir la collection",
-        "cart.completeLook": "Complétez votre look",
-        "cart.subtotal": "Sous-total",
-        "cart.shipping": "Livraison",
-        "cart.free": "GRATUITE",
-        "cart.calculatedAtCheckout": "Calculée au checkout",
-        "cart.badges.delivery": "24-72h",
-        "cart.badges.cod": "Paiement à la livraison",
-        "cart.badges.tracking": "Suivi en temps réel",
+  fr: {
+    "nav.home": "Accueil",
+    "nav.shop": "Collection",
+    "nav.about": "À propos",
+    "nav.contact": "Contact",
+    "nav.language": "Langue :",
+    "hero.title": "Une élégance qui résonne",
+    "hero.subtitle":
+      "Des pièces élégantes, couvrantes et uniques, pensées pour la femme moderne.",
+    "hero.cta": "Découvrir la collection",
+    "values.elegance": "Élégance intemporelle",
+    "values.authenticity": "Authenticité",
+    "values.modest": "Modest fashion moderne",
+    "values.quality": "Qualité des matières",
+    "values.warmth": "Chaleur & confort",
+    "values.quantity": "Petites quantités",
+    "values.respect": "Respect de la femme",
+    "footer.copyright": "Harp 2025. Tous droits réservés.",
+    "product.addToCart": "Ajouter au panier",
+    "product.buyWhatsapp": "Commander via WhatsApp",
+    "cart.title": "Votre Panier",
+    "cart.empty": "Votre panier est vide.",
+    "cart.total": "Total",
+    "cart.checkout": "Valider la commande",
+    "cart.items": "article(s)",
+    "cart.freeShipping.congrats": "🎉 Félicitations ! Livraison GRATUITE",
+    "cart.freeShipping.title": "Livraison gratuite",
+    "cart.freeShipping.remaining": "Plus que",
+    "cart.discoverCollection": "Découvrir la collection",
+    "cart.completeLook": "Complétez votre look",
+    "cart.subtotal": "Sous-total",
+    "cart.shipping": "Livraison",
+    "cart.free": "GRATUITE",
+    "cart.calculatedAtCheckout": "Calculée au checkout",
+    "cart.badges.delivery": "24-72h",
+    "cart.badges.cod": "Paiement à la livraison",
+    "cart.badges.tracking": "Suivi en temps réel",
 
-        // Footer
-        "footer.newsletter.title": "Rejoignez la famille Harp",
-        "footer.newsletter.desc": "Inscrivez-vous pour recevoir en avant-première nos nouvelles collections et offres exclusives.",
-        "footer.newsletter.placeholder": "Votre email",
-        "footer.newsletter.button": "S'inscrire",
-        "footer.newsletter.subscribed": "Inscrit !",
-        "footer.newsletter.success": "Merci !",
-        "footer.newsletter.thanks": "Merci pour votre inscription !",
-        "footer.nav.title": "Navigation",
-        "footer.service.title": "Service Client",
-        "footer.service.delivery": "Livraison 58 wilayas",
-        "footer.service.payment": "Paiement à la livraison",
-        "footer.service.exchange": "Échange sous 2 jours",
-        "footer.service.support": "Support WhatsApp",
-        "footer.contact.title": "Contact",
-        "footer.contact.whatsapp": "WhatsApp",
-        "footer.contact.email": "Email",
-        "footer.contact.workshop": "Atelier",
-        "footer.contact.location": "Alger, Algérie",
-        "footer.legal.privacy": "Politique de confidentialité",
-        "footer.legal.terms": "CGV",
+    // Footer
+    "footer.newsletter.title": "Rejoignez la famille Harp",
+    "footer.newsletter.desc":
+      "Inscrivez-vous pour recevoir en avant-première nos nouvelles collections et offres exclusives.",
+    "footer.newsletter.placeholder": "Votre email",
+    "footer.newsletter.button": "S'inscrire",
+    "footer.newsletter.subscribed": "Inscrit !",
+    "footer.newsletter.success": "Merci !",
+    "footer.newsletter.thanks": "Merci pour votre inscription !",
+    "footer.nav.title": "Navigation",
+    "footer.service.title": "Service Client",
+    "footer.service.delivery": "Livraison 58 wilayas",
+    "footer.service.payment": "Paiement à la livraison",
+    "footer.service.exchange": "Échange sous 2 jours",
+    "footer.service.support": "Support WhatsApp",
+    "footer.contact.title": "Contact",
+    "footer.contact.whatsapp": "WhatsApp",
+    "footer.contact.email": "Email",
+    "footer.contact.workshop": "Atelier",
+    "footer.contact.location": "Alger, Algérie",
+    "footer.legal.privacy": "Politique de confidentialité",
+    "footer.legal.terms": "CGV",
 
-        // Home
-        "home.newCollection": "Nouvelle Collection 2025",
-        "home.section.new": "Nouveautés",
-        "home.latestArrivals": "Derniers Arrivages",
-        "home.featured.badge": "La Pièce du Moment",
-        "home.featured.title": "L'Ensemble Signature",
-        "home.featured.desc": "Une coupe fluide, un tissu respirant et une élégance naturelle. Cet ensemble a été pensé pour vous accompagner du matin au soir.",
-        "home.values.quality.title": "Qualité Premium",
-        "home.values.quality.desc": "Des tissus sélectionnés avec soin pour leur durabilité et leur confort exceptionnel.",
-        "home.values.delivery.title": "Livraison 58 Wilayas",
-        "home.values.delivery.desc": "Une expédition rapide et sécurisée partout en Algérie, avec suivi en temps réel.",
-        "home.values.service.title": "Service Client",
-        "home.values.service.desc": "Une équipe à votre écoute pour vous accompagner à chaque étape de votre commande.",
-        "home.collections.title": "Collections",
-        "home.join.title": "Rejoignez l'univers Harp",
-        "home.join.cta": "Explorer la boutique",
-        "home.reviews.1.text": "J'adore vraiment ! Top qualité et finitions impeccables. Merci beaucoup.",
-        "home.reviews.2.text": "Ma shaa Allah ! La qualité est magnifique, la coupe est parfaite.",
-        "home.reviews.3.text": "C'est une pépite, vraiment ! Elle me va parfaitement.",
-        "home.ourStory": "Notre Histoire",
-        "home.discover": "Découvrir",
-        "home.whyHarp": "Pourquoi Harp",
-        "home.values": "Nos Valeurs",
-        "home.discoverCollection": "Découvrez",
-        "home.newArrivals": "Nouvelle Collection",
-        "home.seeAll": "Voir tout",
-        "home.noProducts": "Aucun produit pour le moment.",
-        "home.addProducts": "Ajouter des produits",
-        "home.promise.badge": "Notre Promesse",
-        "home.promise.title": "L'élégance qui vous ressemble",
-        "home.promise.desc1": "Chez Harp, nous croyons que la mode doit respecter et sublimer. Nos créations allient pudeur et modernité, pour une femme qui assume son style avec grâce et confiance.",
-        "home.promise.desc2": "Chaque pièce est conçue avec soin, dans des tissus nobles, pour traverser les saisons et les années. Car l'élégance n'a pas d'âge.",
-        "home.promise.list1": "Tissus premium sélectionnés avec soin",
-        "home.promise.list2": "Coupes étudiées pour un tombé parfait",
-        "home.promise.list3": "Éditions limitées, pièces exclusives",
-        "home.promise.list4": "Fabrication locale en Algérie",
-        "home.promise.more": "En savoir plus sur Harp",
-        "home.testimonials.badge": "Témoignages",
-        "home.testimonials.title": "Ce que disent nos clientes",
-        "home.cta.title": "Prête à découvrir votre style ?",
-        "home.cta.desc": "Explorez notre collection et trouvez la pièce qui vous accompagnera au quotidien.",
-        "home.cta.button": "Découvrir la boutique",
+    // Home
+    "home.newCollection": "Nouvelle Collection 2025",
+    "home.section.new": "Nouveautés",
+    "home.latestArrivals": "Derniers Arrivages",
+    "home.featured.badge": "La Pièce du Moment",
+    "home.featured.title": "L'Ensemble Signature",
+    "home.featured.desc":
+      "Une coupe fluide, un tissu respirant et une élégance naturelle. Cet ensemble a été pensé pour vous accompagner du matin au soir.",
+    "home.values.quality.title": "Qualité Premium",
+    "home.values.quality.desc":
+      "Des tissus sélectionnés avec soin pour leur durabilité et leur confort exceptionnel.",
+    "home.values.delivery.title": "Livraison 58 Wilayas",
+    "home.values.delivery.desc":
+      "Une expédition rapide et sécurisée partout en Algérie, avec suivi en temps réel.",
+    "home.values.service.title": "Service Client",
+    "home.values.service.desc":
+      "Une équipe à votre écoute pour vous accompagner à chaque étape de votre commande.",
+    "home.collections.title": "Collections",
+    "home.join.title": "Rejoignez l'univers Harp",
+    "home.join.cta": "Explorer la boutique",
+    "home.reviews.1.text":
+      "J'adore vraiment ! Top qualité et finitions impeccables. Merci beaucoup.",
+    "home.reviews.2.text":
+      "Ma shaa Allah ! La qualité est magnifique, la coupe est parfaite.",
+    "home.reviews.3.text":
+      "C'est une pépite, vraiment ! Elle me va parfaitement.",
+    "home.ourStory": "Notre Histoire",
+    "home.discover": "Découvrir",
+    "home.whyHarp": "Pourquoi Harp",
+    "home.values": "Nos Valeurs",
+    "home.discoverCollection": "Découvrez",
+    "home.newArrivals": "Nouvelle Collection",
+    "home.seeAll": "Voir tout",
+    "home.noProducts": "Aucun produit pour le moment.",
+    "home.addProducts": "Ajouter des produits",
+    "home.promise.badge": "Notre Promesse",
+    "home.promise.title": "L'élégance qui vous ressemble",
+    "home.promise.desc1":
+      "Chez Harp, nous croyons que la mode doit respecter et sublimer. Nos créations allient pudeur et modernité, pour une femme qui assume son style avec grâce et confiance.",
+    "home.promise.desc2":
+      "Chaque pièce est conçue avec soin, dans des tissus nobles, pour traverser les saisons et les années. Car l'élégance n'a pas d'âge.",
+    "home.promise.list1": "Tissus premium sélectionnés avec soin",
+    "home.promise.list2": "Coupes étudiées pour un tombé parfait",
+    "home.promise.list3": "Éditions limitées, pièces exclusives",
+    "home.promise.list4": "Fabrication locale en Algérie",
+    "home.promise.more": "En savoir plus sur Harp",
+    "home.testimonials.badge": "Témoignages",
+    "home.testimonials.title": "Ce que disent nos clientes",
+    "home.cta.title": "Prête à découvrir votre style ?",
+    "home.cta.desc":
+      "Explorez notre collection et trouvez la pièce qui vous accompagnera au quotidien.",
+    "home.cta.button": "Découvrir la boutique",
 
-        // Shop
-        "shop.hero.subtitle": "Découvrez nos pièces élégantes et intemporelles",
-        "shop.filters.all": "Tous",
-        "shop.filters.filteredBy": "Filtré par :",
-        "shop.sort.newest": "Plus récents",
-        "shop.sort.priceAsc": "Prix croissant",
-        "shop.sort.priceDesc": "Prix décroissant",
-        "shop.sort.name": "Nom A-Z",
-        "shop.products.count": "produit(s)",
-        "shop.empty.title": "Aucun produit trouvé",
-        "shop.empty.desc": "Revenez bientôt pour découvrir nos nouveautés !",
-        "shop.empty.collection": "Aucun produit dans cette collection pour le moment.",
-        "shop.empty.button": "Voir tous les produits",
-        "shop.badge.new": "Nouveau",
-        "shop.badge.preview": "Aperçu",
+    // Shop
+    "shop.hero.subtitle": "Découvrez nos pièces élégantes et intemporelles",
+    "shop.filters.all": "Tous",
+    "shop.filters.filteredBy": "Filtré par :",
+    "shop.sort.newest": "Plus récents",
+    "shop.sort.priceAsc": "Prix croissant",
+    "shop.sort.priceDesc": "Prix décroissant",
+    "shop.sort.name": "Nom A-Z",
+    "shop.products.count": "produit(s)",
+    "shop.empty.title": "Aucun produit trouvé",
+    "shop.empty.desc": "Revenez bientôt pour découvrir nos nouveautés !",
+    "shop.empty.collection":
+      "Aucun produit dans cette collection pour le moment.",
+    "shop.empty.button": "Voir tous les produits",
+    "shop.badge.new": "Nouveau",
+    "shop.badge.preview": "Aperçu",
 
-        // Contact
-        "contact.hero.subtitle": "Une question ? Nous sommes là pour vous aider.",
-        "contact.methods.whatsapp.desc": "Réponse rapide",
-        "contact.methods.email.desc": "Pour les demandes détaillées",
-        "contact.methods.instagram.desc": "Suivez nos nouveautés",
-        "contact.methods.facebook.desc": "Rejoignez la communauté",
-        "contact.methods.tiktok.desc": "Découvrez nos vidéos",
-        "contact.methods.workshop.desc": "Sur rendez-vous uniquement",
-        "contact.form.badge": "Parlons ensemble",
-        "contact.form.title": "Comment pouvons-nous vous aider ?",
-        "contact.form.desc": "Que vous ayez une question sur nos produits, une demande spéciale ou simplement envie de partager votre expérience avec Harp, nous serions ravis de vous entendre.",
-        "contact.info.hours.title": "Horaires de réponse",
-        "contact.info.hours.desc": "Du dimanche au jeudi, de 9h à 18h.\nRéponse sous 24h maximum.",
-        "contact.info.whatsapp.title": "WhatsApp préféré",
-        "contact.info.whatsapp.desc": "Pour une réponse plus rapide, contactez-nous\ndirectement sur WhatsApp.",
-        "contact.cta.whatsapp": "Écrire sur WhatsApp",
-        "contact.cta.response": "Réponse en quelques minutes",
-        "contact.form.header": "Envoyez-nous un message",
-        "contact.form.success.title": "Message envoyé !",
-        "contact.form.success.desc": "Merci de nous avoir contactés. Nous vous répondrons très bientôt.",
-        "contact.form.name": "Nom complet *",
-        "contact.form.phone": "Téléphone",
-        "contact.form.email": "Email *",
-        "contact.form.subject": "Sujet",
-        "contact.form.subject.placeholder": "Sélectionnez un sujet",
-        "contact.form.subject.question": "Question sur un produit",
-        "contact.form.subject.order": "Suivi de commande",
-        "contact.form.subject.return": "Échange / Retour",
-        "contact.form.subject.collab": "Collaboration",
-        "contact.form.subject.other": "Autre",
-        "contact.form.message": "Message *",
-        "contact.form.message.placeholder": "Comment pouvons-nous vous aider ?",
-        "contact.form.submit": "Envoyer le message",
-        "contact.form.sending": "Envoi en cours...",
+    // Contact
+    "contact.hero.subtitle": "Une question ? Nous sommes là pour vous aider.",
+    "contact.methods.whatsapp.desc": "Réponse rapide",
+    "contact.methods.email.desc": "Pour les demandes détaillées",
+    "contact.methods.instagram.desc": "Suivez nos nouveautés",
+    "contact.methods.facebook.desc": "Rejoignez la communauté",
+    "contact.methods.tiktok.desc": "Découvrez nos vidéos",
+    "contact.methods.workshop.desc": "Sur rendez-vous uniquement",
+    "contact.form.badge": "Parlons ensemble",
+    "contact.form.title": "Comment pouvons-nous vous aider ?",
+    "contact.form.desc":
+      "Que vous ayez une question sur nos produits, une demande spéciale ou simplement envie de partager votre expérience avec Harp, nous serions ravis de vous entendre.",
+    "contact.info.hours.title": "Horaires de réponse",
+    "contact.info.hours.desc":
+      "Du dimanche au jeudi, de 9h à 18h.\nRéponse sous 24h maximum.",
+    "contact.info.whatsapp.title": "WhatsApp préféré",
+    "contact.info.whatsapp.desc":
+      "Pour une réponse plus rapide, contactez-nous\ndirectement sur WhatsApp.",
+    "contact.cta.whatsapp": "Écrire sur WhatsApp",
+    "contact.cta.response": "Réponse en quelques minutes",
+    "contact.form.header": "Envoyez-nous un message",
+    "contact.form.success.title": "Message envoyé !",
+    "contact.form.success.desc":
+      "Merci de nous avoir contactés. Nous vous répondrons très bientôt.",
+    "contact.form.name": "Nom complet *",
+    "contact.form.phone": "Téléphone",
+    "contact.form.email": "Email *",
+    "contact.form.subject": "Sujet",
+    "contact.form.subject.placeholder": "Sélectionnez un sujet",
+    "contact.form.subject.question": "Question sur un produit",
+    "contact.form.subject.order": "Suivi de commande",
+    "contact.form.subject.return": "Échange / Retour",
+    "contact.form.subject.collab": "Collaboration",
+    "contact.form.subject.other": "Autre",
+    "contact.form.message": "Message *",
+    "contact.form.message.placeholder": "Comment pouvons-nous vous aider ?",
+    "contact.form.submit": "Envoyer le message",
+    "contact.form.sending": "Envoi en cours...",
 
-        // Checkout
-        "checkout.title": "Validation de la commande",
-        "checkout.deliveryInfo": "Informations de livraison",
-        "checkout.firstName": "Prénom",
-        "checkout.lastName": "Nom",
-        "checkout.phone": "Téléphone",
-        "checkout.address": "Adresse",
-        "checkout.city": "Ville",
-        "checkout.wilaya": "Wilaya",
-        "checkout.wilayaSelect": "Sélectionner...",
-        "checkout.deliveryMode": "Mode de livraison",
-        "checkout.provider": "Prestataire",
-        "checkout.deliveryType": "Type de livraison",
-        "checkout.home": "À domicile",
-        "checkout.desk": "Stop Desk (Bureau)",
-        "checkout.summary": "Récapitulatif",
-        "checkout.subtotal": "Sous-total",
-        "checkout.shipping": "Livraison",
-        "checkout.selectWilaya": "Sélectionnez une wilaya",
-        "checkout.total": "Total",
-        "checkout.confirm": "Confirmer la commande",
-        "checkout.confirming": "Validation...",
-        "checkout.cod": "Paiement à la livraison (Cash on Delivery)",
-        "checkout.backToShop": "Retour à la boutique",
+    // Checkout
+    "checkout.title": "Validation de la commande",
+    "checkout.deliveryInfo": "Informations de livraison",
+    "checkout.firstName": "Prénom",
+    "checkout.lastName": "Nom",
+    "checkout.phone": "Téléphone",
+    "checkout.address": "Adresse",
+    "checkout.city": "Ville",
+    "checkout.wilaya": "Wilaya",
+    "checkout.wilayaSelect": "Sélectionner...",
+    "checkout.deliveryMode": "Mode de livraison",
+    "checkout.provider": "Prestataire",
+    "checkout.deliveryType": "Type de livraison",
+    "checkout.home": "À domicile",
+    "checkout.desk": "Stop Desk (Bureau)",
+    "checkout.summary": "Récapitulatif",
+    "checkout.subtotal": "Sous-total",
+    "checkout.shipping": "Livraison",
+    "checkout.selectWilaya": "Sélectionnez une wilaya",
+    "checkout.total": "Total",
+    "checkout.confirm": "Confirmer la commande",
+    "checkout.confirming": "Validation...",
+    "checkout.cod": "Paiement à la livraison (Cash on Delivery)",
+    "checkout.backToShop": "Retour à la boutique",
 
-        // Product
-        "product.color": "Couleur",
-        "product.size": "Taille",
-        "product.quantity": "Quantité",
-        "product.delivery": "Livraison 58 wilayas - Paiement à la livraison",
-        "product.guarantee": "Qualité garantie - Échange possible",
-        "product.loading": "Chargement...",
-        "product.notFound": "Produit non trouvé",
-        "product.selectOptions": "Veuillez sélectionner une taille et une couleur",
-        "product.card.view": "Voir le produit",
-        "product.card.wishlist.add": "Ajouter aux favoris",
-        "product.card.wishlist.remove": "Retirer des favoris",
+    // Product
+    "product.color": "Couleur",
+    "product.size": "Taille",
+    "product.quantity": "Quantité",
+    "product.delivery": "Livraison 58 wilayas - Paiement à la livraison",
+    "product.guarantee": "Qualité garantie - Échange possible",
+    "product.loading": "Chargement...",
+    "product.notFound": "Produit non trouvé",
+    "product.selectOptions": "Veuillez sélectionner une taille et une couleur",
+    "product.card.view": "Voir le produit",
+    "product.card.wishlist.add": "Ajouter aux favoris",
+    "product.card.wishlist.remove": "Retirer des favoris",
 
-        // Order Confirmation
-        "order.success": "Commande confirmée !",
-        "order.thankYou": "Merci pour votre commande. Vous recevrez un appel de confirmation sous peu.",
-        "order.backHome": "Retour à l'accueil",
-    },
-    ar: {
-        "nav.home": "الرئيسية",
-        "nav.shop": "المجموعة",
-        "nav.about": "من نحن",
-        "nav.contact": "اتصل بنا",
-        "nav.language": "اللغة :",
-        "hero.title": "هــارب – أناقة تلامسك",
-        "hero.subtitle": "قطع راقية، دافئة ومحتشمة، مصمّمة للمرأة العصرية.",
-        "hero.cta": "اكتشفي المجموعة",
-        "values.elegance": "أناقة خالدة",
-        "values.authenticity": "أصالة",
-        "values.modest": "احتشام عصري",
-        "values.quality": "جودة الخامة",
-        "values.warmth": "دفء وراحة",
-        "values.quantity": "كميات محدودة",
-        "values.respect": "احترام المرأة",
-        "footer.copyright": "هــارب 2025. جميع الحقوق محفوظة.",
-        "product.addToCart": "أضف إلى السلة",
-        "product.buyWhatsapp": "اطلب عبر واتساب",
-        "cart.title": "سلتك",
-        "cart.empty": "سلتك فارغة.",
-        "cart.total": "المجموع",
-        "cart.checkout": "تأكيد الطلب",
-        "cart.items": "قطع",
-        "cart.freeShipping.congrats": "🎉 مبروك ! التوصيل مجاني",
-        "cart.freeShipping.title": "توصيل مجاني",
-        "cart.freeShipping.remaining": "بقي",
-        "cart.discoverCollection": "اكتشفي المجموعة",
-        "cart.completeLook": "أكملي إطلالتك",
-        "cart.subtotal": "المجموع الفرعي",
-        "cart.shipping": "التوصيل",
-        "cart.free": "مجاني",
-        "cart.calculatedAtCheckout": "يحدد عند الدفع",
-        "cart.badges.delivery": "24-72 سا",
-        "cart.badges.cod": "الدفع عند الاستلام",
-        "cart.badges.tracking": "تتبع فوري",
+    // Order Confirmation
+    "order.success": "Commande confirmée !",
+    "order.thankYou":
+      "Merci pour votre commande. Vous recevrez un appel de confirmation sous peu.",
+    "order.backHome": "Retour à l'accueil",
+  },
+  ar: {
+    "nav.home": "الرئيسية",
+    "nav.shop": "المجموعة",
+    "nav.about": "من نحن",
+    "nav.contact": "اتصل بنا",
+    "nav.language": "اللغة :",
+    "hero.title": "هــارب – أناقة تلامسك",
+    "hero.subtitle": "قطع راقية، دافئة ومحتشمة، مصمّمة للمرأة العصرية.",
+    "hero.cta": "اكتشفي المجموعة",
+    "values.elegance": "أناقة خالدة",
+    "values.authenticity": "أصالة",
+    "values.modest": "احتشام عصري",
+    "values.quality": "جودة الخامة",
+    "values.warmth": "دفء وراحة",
+    "values.quantity": "كميات محدودة",
+    "values.respect": "احترام المرأة",
+    "footer.copyright": "هــارب 2025. جميع الحقوق محفوظة.",
+    "product.addToCart": "أضف إلى السلة",
+    "product.buyWhatsapp": "اطلب عبر واتساب",
+    "cart.title": "سلتك",
+    "cart.empty": "سلتك فارغة.",
+    "cart.total": "المجموع",
+    "cart.checkout": "تأكيد الطلب",
+    "cart.items": "قطع",
+    "cart.freeShipping.congrats": "🎉 مبروك ! التوصيل مجاني",
+    "cart.freeShipping.title": "توصيل مجاني",
+    "cart.freeShipping.remaining": "بقي",
+    "cart.discoverCollection": "اكتشفي المجموعة",
+    "cart.completeLook": "أكملي إطلالتك",
+    "cart.subtotal": "المجموع الفرعي",
+    "cart.shipping": "التوصيل",
+    "cart.free": "مجاني",
+    "cart.calculatedAtCheckout": "يحدد عند الدفع",
+    "cart.badges.delivery": "24-72 سا",
+    "cart.badges.cod": "الدفع عند الاستلام",
+    "cart.badges.tracking": "تتبع فوري",
 
-        // Footer
-        "footer.newsletter.title": "انضمي لعائلة هارب",
-        "footer.newsletter.desc": "سجلي لتصلك أحدث تشكيلاتنا وعروضنا الحصرية.",
-        "footer.newsletter.placeholder": "بريدك الإلكتروني",
-        "footer.newsletter.button": "اشتراك",
-        "footer.newsletter.subscribed": "تم الاشتراك !",
-        "footer.newsletter.success": "شكراً !",
-        "footer.newsletter.thanks": "شكراً لاشتراكك !",
-        "footer.nav.title": "تصفح",
-        "footer.service.title": "خدمة الزبائن",
-        "footer.service.delivery": "توصيل لـ 58 ولاية",
-        "footer.service.payment": "الدفع عند الاستلام",
-        "footer.service.exchange": "استبدال خلال يومين",
-        "footer.service.support": "دعم عبر واتساب",
-        "footer.contact.title": "اتصل بنا",
-        "footer.contact.whatsapp": "واتساب",
-        "footer.contact.email": "البريد الإلكتروني",
-        "footer.contact.workshop": "الورشة",
-        "footer.contact.location": "الجزائر العاصمة",
-        "footer.legal.privacy": "سياسة الخصوصية",
-        "footer.legal.terms": "الشروط والأحكام",
+    // Footer
+    "footer.newsletter.title": "انضمي لعائلة هارب",
+    "footer.newsletter.desc": "سجلي لتصلك أحدث تشكيلاتنا وعروضنا الحصرية.",
+    "footer.newsletter.placeholder": "بريدك الإلكتروني",
+    "footer.newsletter.button": "اشتراك",
+    "footer.newsletter.subscribed": "تم الاشتراك !",
+    "footer.newsletter.success": "شكراً !",
+    "footer.newsletter.thanks": "شكراً لاشتراكك !",
+    "footer.nav.title": "تصفح",
+    "footer.service.title": "خدمة الزبائن",
+    "footer.service.delivery": "توصيل لـ 58 ولاية",
+    "footer.service.payment": "الدفع عند الاستلام",
+    "footer.service.exchange": "استبدال خلال يومين",
+    "footer.service.support": "دعم عبر واتساب",
+    "footer.contact.title": "اتصل بنا",
+    "footer.contact.whatsapp": "واتساب",
+    "footer.contact.email": "البريد الإلكتروني",
+    "footer.contact.workshop": "الورشة",
+    "footer.contact.location": "الجزائر العاصمة",
+    "footer.legal.privacy": "سياسة الخصوصية",
+    "footer.legal.terms": "الشروط والأحكام",
 
-        // Home
-        "home.newCollection": "تشكيلة جديدة 2025",
-        "home.section.new": "جديدنا",
-        "home.latestArrivals": "أحدث الوصولات",
-        "home.featured.badge": "قطعة الموسم",
-        "home.featured.title": "الطقم المميز",
-        "home.featured.desc": "قصة انسيابية، قماش يتنفس وأناقة طبيعية. صمم هذا الطقم ليرافقك من الصباح حتى المساء.",
-        "home.values.quality.title": "جودة فاخرة",
-        "home.values.quality.desc": "أقمشة مختارة بعناية لمتانتها وراحتها الاستثنائية.",
-        "home.values.delivery.title": "توصيل 58 ولاية",
-        "home.values.delivery.desc": "شحن سريع وآمن لجميع أنحاء الجزائر، مع تتبع فوري.",
-        "home.values.service.title": "خدمة الزبائن",
-        "home.values.service.desc": "فريقنا في خدمتكم لمرافقتكم في كل خطوة من طلبكم.",
-        "home.collections.title": "المجموعات",
-        "home.join.title": "انضمي لعالم هارب",
-        "home.join.cta": "تصفح المتجر",
-        "home.reviews.1.text": "أحببتها حقاً! جودة عالية وتشطيبات متقنة. شكراً جزيلاً.",
-        "home.reviews.2.text": "ما شاء الله! الجودة رائعة والقصة مثالية.",
-        "home.reviews.3.text": "إنها تحفة حقاً! تناسبني تماماً.",
-        "home.ourStory": "قصتنا",
-        "home.discover": "اكتشف",
-        "home.whyHarp": "لماذا هارب",
-        "home.values": "قيمنا",
-        "home.discoverCollection": "اكتشفي",
-        "home.newArrivals": "وصل حديثاً",
-        "home.seeAll": "عرض الكل",
-        "home.noProducts": "لا توجد منتجات حالياً.",
-        "home.addProducts": "إضافة منتجات",
-        "home.promise.badge": "وعدنا",
-        "home.promise.title": "أناقة تشبهك",
-        "home.promise.desc1": "في هارب، نؤمن أن الموضة يجب أن تحترم وتجمّل. إبداعاتنا تجمع بين الاحتشام والعصرية، لامرأة تفرض أسلوبها برقي وثقة.",
-        "home.promise.desc2": "كل قطعة مصممة بعناية، من أقمشة فاخرة، لتدوم مواسم وسنوات. لأن الأناقة لا عمر لها.",
-        "home.promise.list1": "أقمشة فاخرة مختارة بعناية",
-        "home.promise.list2": "قصات مدروسة لإطلالة مثالية",
-        "home.promise.list3": "إصدارات محدودة، قطع حصرية",
-        "home.promise.list4": "صناعة محلية جزائرية",
-        "home.promise.more": "المزيد عن هارب",
-        "home.testimonials.badge": "آراء العملاء",
-        "home.testimonials.title": "ماذا تقول عميلاتنا",
-        "home.cta.title": "مستعدة لاكتشاف أسلوبك؟",
-        "home.cta.desc": "تصفحي مجموعتنا واجدي القطعة التي سترافقك يومياً.",
-        "home.cta.button": "تصفح المتجر",
+    // Home
+    "home.newCollection": "تشكيلة جديدة 2025",
+    "home.section.new": "جديدنا",
+    "home.latestArrivals": "أحدث الوصولات",
+    "home.featured.badge": "قطعة الموسم",
+    "home.featured.title": "الطقم المميز",
+    "home.featured.desc":
+      "قصة انسيابية، قماش يتنفس وأناقة طبيعية. صمم هذا الطقم ليرافقك من الصباح حتى المساء.",
+    "home.values.quality.title": "جودة فاخرة",
+    "home.values.quality.desc":
+      "أقمشة مختارة بعناية لمتانتها وراحتها الاستثنائية.",
+    "home.values.delivery.title": "توصيل 58 ولاية",
+    "home.values.delivery.desc":
+      "شحن سريع وآمن لجميع أنحاء الجزائر، مع تتبع فوري.",
+    "home.values.service.title": "خدمة الزبائن",
+    "home.values.service.desc":
+      "فريقنا في خدمتكم لمرافقتكم في كل خطوة من طلبكم.",
+    "home.collections.title": "المجموعات",
+    "home.join.title": "انضمي لعالم هارب",
+    "home.join.cta": "تصفح المتجر",
+    "home.reviews.1.text":
+      "أحببتها حقاً! جودة عالية وتشطيبات متقنة. شكراً جزيلاً.",
+    "home.reviews.2.text": "ما شاء الله! الجودة رائعة والقصة مثالية.",
+    "home.reviews.3.text": "إنها تحفة حقاً! تناسبني تماماً.",
+    "home.ourStory": "قصتنا",
+    "home.discover": "اكتشف",
+    "home.whyHarp": "لماذا هارب",
+    "home.values": "قيمنا",
+    "home.discoverCollection": "اكتشفي",
+    "home.newArrivals": "وصل حديثاً",
+    "home.seeAll": "عرض الكل",
+    "home.noProducts": "لا توجد منتجات حالياً.",
+    "home.addProducts": "إضافة منتجات",
+    "home.promise.badge": "وعدنا",
+    "home.promise.title": "أناقة تشبهك",
+    "home.promise.desc1":
+      "في هارب، نؤمن أن الموضة يجب أن تحترم وتجمّل. إبداعاتنا تجمع بين الاحتشام والعصرية، لامرأة تفرض أسلوبها برقي وثقة.",
+    "home.promise.desc2":
+      "كل قطعة مصممة بعناية، من أقمشة فاخرة، لتدوم مواسم وسنوات. لأن الأناقة لا عمر لها.",
+    "home.promise.list1": "أقمشة فاخرة مختارة بعناية",
+    "home.promise.list2": "قصات مدروسة لإطلالة مثالية",
+    "home.promise.list3": "إصدارات محدودة، قطع حصرية",
+    "home.promise.list4": "صناعة محلية جزائرية",
+    "home.promise.more": "المزيد عن هارب",
+    "home.testimonials.badge": "آراء العملاء",
+    "home.testimonials.title": "ماذا تقول عميلاتنا",
+    "home.cta.title": "مستعدة لاكتشاف أسلوبك؟",
+    "home.cta.desc": "تصفحي مجموعتنا واجدي القطعة التي سترافقك يومياً.",
+    "home.cta.button": "تصفح المتجر",
 
-        // Shop
-        "shop.hero.subtitle": "اكتشفي قطعنا الأنيقة والخالدة",
-        "shop.filters.all": "الكل",
-        "shop.filters.filteredBy": "تصفية حسب :",
-        "shop.sort.newest": "الأحدث",
-        "shop.sort.priceAsc": "السعر: من الأقل للأكثر",
-        "shop.sort.priceDesc": "السعر: من الأكثر للأقل",
-        "shop.sort.name": "الاسم",
-        "shop.products.count": "منتج",
-        "shop.empty.title": "لم يتم العثور على منتجات",
-        "shop.empty.desc": "عودي قريباً لاكتشاف جديدنا !",
-        "shop.empty.collection": "لا توجد منتجات في هذه المجموعة حالياً.",
-        "shop.empty.button": "عرض كل المنتجات",
-        "shop.badge.new": "جديد",
-        "shop.badge.preview": "نظرة سريعة",
+    // Shop
+    "shop.hero.subtitle": "اكتشفي قطعنا الأنيقة والخالدة",
+    "shop.filters.all": "الكل",
+    "shop.filters.filteredBy": "تصفية حسب :",
+    "shop.sort.newest": "الأحدث",
+    "shop.sort.priceAsc": "السعر: من الأقل للأكثر",
+    "shop.sort.priceDesc": "السعر: من الأكثر للأقل",
+    "shop.sort.name": "الاسم",
+    "shop.products.count": "منتج",
+    "shop.empty.title": "لم يتم العثور على منتجات",
+    "shop.empty.desc": "عودي قريباً لاكتشاف جديدنا !",
+    "shop.empty.collection": "لا توجد منتجات في هذه المجموعة حالياً.",
+    "shop.empty.button": "عرض كل المنتجات",
+    "shop.badge.new": "جديد",
+    "shop.badge.preview": "نظرة سريعة",
 
-        // Contact
-        "contact.hero.subtitle": "لديك سؤال؟ نحن هنا للمساعدة.",
-        "contact.methods.whatsapp.desc": "رد سريع",
-        "contact.methods.email.desc": "للطلبات المفصلة",
-        "contact.methods.instagram.desc": "تابعي جديدنا",
-        "contact.methods.facebook.desc": "انضمي لمجتمعنا",
-        "contact.methods.tiktok.desc": "اكتشفي فيديوهاتنا",
-        "contact.methods.workshop.desc": "بموعد مسبق فقط",
-        "contact.form.badge": "لنتحدث",
-        "contact.form.title": "كيف يمكننا مساعدتك؟",
-        "contact.form.desc": "سواء كان لديك سؤال عن منتجاتنا، طلب خاص أو مجرد رغبة في مشاركة تجربتك مع هارب، يسعدنا سماعك.",
-        "contact.info.hours.title": "ساعات العمل",
-        "contact.info.hours.desc": "من الأحد إلى الخميس، من 9 صباحاً إلى 6 مساءً.\nالرد خلال 24 ساعة كحد أقصى.",
-        "contact.info.whatsapp.title": "نفضل الواتساب",
-        "contact.info.whatsapp.desc": "لرد أسرع، راسلينا مباشرة على واتساب.",
-        "contact.cta.whatsapp": "مراسلة عبر واتساب",
-        "contact.cta.response": "الرد في دقائق",
-        "contact.form.header": "أرسلي لنا رسالة",
-        "contact.form.success.title": "تم إرسال الرسالة !",
-        "contact.form.success.desc": "شكراً لتواصلك معنا. سنرد عليك قريباً جداً.",
-        "contact.form.name": "الاسم الكامل *",
-        "contact.form.phone": "الهاتف",
-        "contact.form.email": "البريد الإلكتروني *",
-        "contact.form.subject": "الموضوع",
-        "contact.form.subject.placeholder": "اختر موضوعاً",
-        "contact.form.subject.question": "سؤال عن منتج",
-        "contact.form.subject.order": "متابعة الطلب",
-        "contact.form.subject.return": "استبدال / إرجاع",
-        "contact.form.subject.collab": "تعاون",
-        "contact.form.subject.other": "آخر",
-        "contact.form.message": "الرسالة *",
-        "contact.form.message.placeholder": "كيف يمكننا مساعدتك؟",
-        "contact.form.submit": "إرسال الرسالة",
-        "contact.form.sending": "جاري الإرسال...",
+    // Contact
+    "contact.hero.subtitle": "لديك سؤال؟ نحن هنا للمساعدة.",
+    "contact.methods.whatsapp.desc": "رد سريع",
+    "contact.methods.email.desc": "للطلبات المفصلة",
+    "contact.methods.instagram.desc": "تابعي جديدنا",
+    "contact.methods.facebook.desc": "انضمي لمجتمعنا",
+    "contact.methods.tiktok.desc": "اكتشفي فيديوهاتنا",
+    "contact.methods.workshop.desc": "بموعد مسبق فقط",
+    "contact.form.badge": "لنتحدث",
+    "contact.form.title": "كيف يمكننا مساعدتك؟",
+    "contact.form.desc":
+      "سواء كان لديك سؤال عن منتجاتنا، طلب خاص أو مجرد رغبة في مشاركة تجربتك مع هارب، يسعدنا سماعك.",
+    "contact.info.hours.title": "ساعات العمل",
+    "contact.info.hours.desc":
+      "من الأحد إلى الخميس، من 9 صباحاً إلى 6 مساءً.\nالرد خلال 24 ساعة كحد أقصى.",
+    "contact.info.whatsapp.title": "نفضل الواتساب",
+    "contact.info.whatsapp.desc": "لرد أسرع، راسلينا مباشرة على واتساب.",
+    "contact.cta.whatsapp": "مراسلة عبر واتساب",
+    "contact.cta.response": "الرد في دقائق",
+    "contact.form.header": "أرسلي لنا رسالة",
+    "contact.form.success.title": "تم إرسال الرسالة !",
+    "contact.form.success.desc": "شكراً لتواصلك معنا. سنرد عليك قريباً جداً.",
+    "contact.form.name": "الاسم الكامل *",
+    "contact.form.phone": "الهاتف",
+    "contact.form.email": "البريد الإلكتروني *",
+    "contact.form.subject": "الموضوع",
+    "contact.form.subject.placeholder": "اختر موضوعاً",
+    "contact.form.subject.question": "سؤال عن منتج",
+    "contact.form.subject.order": "متابعة الطلب",
+    "contact.form.subject.return": "استبدال / إرجاع",
+    "contact.form.subject.collab": "تعاون",
+    "contact.form.subject.other": "آخر",
+    "contact.form.message": "الرسالة *",
+    "contact.form.message.placeholder": "كيف يمكننا مساعدتك؟",
+    "contact.form.submit": "إرسال الرسالة",
+    "contact.form.sending": "جاري الإرسال...",
 
-        // Checkout
-        "checkout.title": "تأكيد الطلب",
-        "checkout.deliveryInfo": "معلومات التوصيل",
-        "checkout.firstName": "الاسم الأول",
-        "checkout.lastName": "اللقب",
-        "checkout.phone": "الهاتف",
-        "checkout.address": "العنوان",
-        "checkout.city": "المدينة",
-        "checkout.wilaya": "الولاية",
-        "checkout.wilayaSelect": "اختر...",
-        "checkout.deliveryMode": "طريقة التوصيل",
-        "checkout.provider": "مزود الخدمة",
-        "checkout.deliveryType": "نوع التوصيل",
-        "checkout.home": "للمنزل",
-        "checkout.desk": "ستوب ديسك (مكتب)",
-        "checkout.summary": "الملخص",
-        "checkout.subtotal": "المجموع الفرعي",
-        "checkout.shipping": "التوصيل",
-        "checkout.selectWilaya": "اختر ولاية",
-        "checkout.total": "المجموع",
-        "checkout.confirm": "تأكيد الطلب",
-        "checkout.confirming": "جاري التأكيد...",
-        "checkout.cod": "الدفع عند الاستلام",
-        "checkout.backToShop": "العودة للمتجر",
+    // Checkout
+    "checkout.title": "تأكيد الطلب",
+    "checkout.deliveryInfo": "معلومات التوصيل",
+    "checkout.firstName": "الاسم الأول",
+    "checkout.lastName": "اللقب",
+    "checkout.phone": "الهاتف",
+    "checkout.address": "العنوان",
+    "checkout.city": "المدينة",
+    "checkout.wilaya": "الولاية",
+    "checkout.wilayaSelect": "اختر...",
+    "checkout.deliveryMode": "طريقة التوصيل",
+    "checkout.provider": "مزود الخدمة",
+    "checkout.deliveryType": "نوع التوصيل",
+    "checkout.home": "للمنزل",
+    "checkout.desk": "ستوب ديسك (مكتب)",
+    "checkout.summary": "الملخص",
+    "checkout.subtotal": "المجموع الفرعي",
+    "checkout.shipping": "التوصيل",
+    "checkout.selectWilaya": "اختر ولاية",
+    "checkout.total": "المجموع",
+    "checkout.confirm": "تأكيد الطلب",
+    "checkout.confirming": "جاري التأكيد...",
+    "checkout.cod": "الدفع عند الاستلام",
+    "checkout.backToShop": "العودة للمتجر",
 
-        // Product
-        "product.color": "اللون",
-        "product.size": "المقاس",
-        "product.quantity": "الكمية",
-        "product.delivery": "توصيل لـ 58 ولاية - الدفع عند الاستلام",
-        "product.guarantee": "جودة مضمونة - إمكانية الاستبدال",
-        "product.loading": "جاري التحميل...",
-        "product.notFound": "المنتج غير موجود",
-        "product.selectOptions": "الرجاء اختيار المقاس واللون",
-        "product.card.view": "مشاهدة المنتج",
-        "product.card.wishlist.add": "إضافة للمفضلة",
-        "product.card.wishlist.remove": "إزالة من المفضلة",
+    // Product
+    "product.color": "اللون",
+    "product.size": "المقاس",
+    "product.quantity": "الكمية",
+    "product.delivery": "توصيل لـ 58 ولاية - الدفع عند الاستلام",
+    "product.guarantee": "جودة مضمونة - إمكانية الاستبدال",
+    "product.loading": "جاري التحميل...",
+    "product.notFound": "المنتج غير موجود",
+    "product.selectOptions": "الرجاء اختيار المقاس واللون",
+    "product.card.view": "مشاهدة المنتج",
+    "product.card.wishlist.add": "إضافة للمفضلة",
+    "product.card.wishlist.remove": "إزالة من المفضلة",
 
-        // Order Confirmation
-        "order.success": "تم تأكيد الطلب !",
-        "order.thankYou": "شكراً لطلبك. ستتلقين اتصالاً للتأكيد قريباً.",
-        "order.backHome": "العودة للرئيسية",
-    },
+    // Order Confirmation
+    "order.success": "تم تأكيد الطلب !",
+    "order.thankYou": "شكراً لطلبك. ستتلقين اتصالاً للتأكيد قريباً.",
+    "order.backHome": "العودة للرئيسية",
+  },
 };
diff --git a/src/lib/utils.ts b/src/lib/utils.ts
index 27c7895..63c5102 100644
--- a/src/lib/utils.ts
+++ b/src/lib/utils.ts
@@ -1,8 +1,8 @@
-import { type ClassValue, clsx } from "clsx"
-import { twMerge } from "tailwind-merge"
+import { type ClassValue, clsx } from "clsx";
+import { twMerge } from "tailwind-merge";
 
 export function cn(...inputs: ClassValue[]) {
-    return twMerge(clsx(inputs))
+  return twMerge(clsx(inputs));
 }
 
 /**
@@ -10,17 +10,20 @@ export function cn(...inputs: ClassValue[]) {
  * Handles Prisma Decimal types which might be passed as objects or strings.
  */
 export function formatPrice(amount: number | string | any): string {
-    if (amount === null || amount === undefined) return "0 DZD";
-    
-    const value = typeof amount === 'object' && 'toNumber' in amount 
-        ? amount.toNumber() 
-        : Number(amount);
+  if (amount === null || amount === undefined) return "0 DZD";
 
-    if (isNaN(value)) return "0 DZD";
+  const value =
+    typeof amount === "object" && "toNumber" in amount
+      ? amount.toNumber()
+      : Number(amount);
 
-    return new Intl.NumberFormat('fr-DZ', {
-        style: 'decimal',
-        minimumFractionDigits: 0,
-        maximumFractionDigits: 2,
-    }).format(value) + " DZD";
+  if (isNaN(value)) return "0 DZD";
+
+  return (
+    new Intl.NumberFormat("fr-DZ", {
+      style: "decimal",
+      minimumFractionDigits: 0,
+      maximumFractionDigits: 2,
+    }).format(value) + " DZD"
+  );
 }
diff --git a/src/lib/utils/csv.ts b/src/lib/utils/csv.ts
index 35e0b00..34c6077 100644
--- a/src/lib/utils/csv.ts
+++ b/src/lib/utils/csv.ts
@@ -9,7 +9,7 @@ type CSVField<T> = {
 
 export function generateCSV<T extends Record<string, any>>(
   data: T[],
-  fields: CSVField<T>[]
+  fields: CSVField<T>[],
 ): string {
   // Header row
   const header = fields.map((f) => escapeCSV(f.label)).join(",");
diff --git a/src/lib/validations.ts b/src/lib/validations.ts
index 489d382..088db46 100644
--- a/src/lib/validations.ts
+++ b/src/lib/validations.ts
@@ -1,188 +1,229 @@
 // Validation utilities for API routes
 
 export interface ProductInput {
-    nameFr: string;
-    nameAr: string;
-    descriptionFr: string;
-    descriptionAr: string;
-    price: number;
-    images: string[];
-    sizes: string[];
-    colors: string[];
-    collectionId?: string | null;
-    stock?: number;
+  nameFr: string;
+  nameAr: string;
+  descriptionFr: string;
+  descriptionAr: string;
+  price: number;
+  images: string[];
+  sizes: string[];
+  colors: string[];
+  collectionId?: string | null;
+  stock?: number;
 }
 
 export interface CollectionInput {
-    nameFr: string;
-    nameAr: string;
-    image?: string | null;
+  nameFr: string;
+  nameAr: string;
+  image?: string | null;
 }
 
 export interface OrderInput {
-    customerName: string;
-    customerPhone: string;
-    customerAddress: string;
-    customerCity: string;
-    customerWilaya: string;
-    deliveryProvider?: string;
-    deliveryType?: string;
-    shippingPrice?: number;
-    total: number;
-    items: {
-        productId?: string;
-        productName: string;
-        size: string;
-        color: string;
-        quantity: number;
-        price: number;
-    }[];
+  customerName: string;
+  customerPhone: string;
+  customerAddress: string;
+  customerCity: string;
+  customerWilaya: string;
+  deliveryProvider?: string;
+  deliveryType?: string;
+  shippingPrice?: number;
+  total: number;
+  items: {
+    productId?: string;
+    productName: string;
+    size: string;
+    color: string;
+    quantity: number;
+    price: number;
+  }[];
 }
 
 export interface ValidationResult {
-    valid: boolean;
-    errors: string[];
+  valid: boolean;
+  errors: string[];
 }
 
 // Product validation
 export function validateProduct(data: any): ValidationResult {
-    const errors: string[] = [];
-
-    if (!data.nameFr || typeof data.nameFr !== 'string' || data.nameFr.trim().length < 2) {
-        errors.push("Le nom français est requis (min 2 caractères)");
-    }
-
-    if (!data.nameAr || typeof data.nameAr !== 'string' || data.nameAr.trim().length < 2) {
-        errors.push("Le nom arabe est requis (min 2 caractères)");
-    }
-
-    if (!data.descriptionFr || typeof data.descriptionFr !== 'string') {
-        errors.push("La description française est requise");
-    }
-
-    if (!data.descriptionAr || typeof data.descriptionAr !== 'string') {
-        errors.push("La description arabe est requise");
-    }
-
-    const price = parseFloat(data.price);
-    if (isNaN(price) || price <= 0) {
-        errors.push("Le prix doit être un nombre positif");
-    }
-
-    if (!Array.isArray(data.images) || data.images.length === 0) {
-        errors.push("Au moins une image est requise");
-    } else {
-        for (const img of data.images) {
-            if (typeof img !== 'string' || !isValidUrl(img)) {
-                errors.push("Les URLs des images doivent être valides");
-                break;
-            }
-        }
-    }
-
-    if (!Array.isArray(data.sizes) || data.sizes.length === 0) {
-        errors.push("Au moins une taille est requise");
-    }
-
-    if (!Array.isArray(data.colors) || data.colors.length === 0) {
-        errors.push("Au moins une couleur est requise");
-    }
-
-    if (data.stock !== undefined && (typeof data.stock !== 'number' || data.stock < 0)) {
-        errors.push("Le stock doit être un nombre positif ou zéro");
-    }
-
-    return { valid: errors.length === 0, errors };
+  const errors: string[] = [];
+
+  if (
+    !data.nameFr ||
+    typeof data.nameFr !== "string" ||
+    data.nameFr.trim().length < 2
+  ) {
+    errors.push("Le nom français est requis (min 2 caractères)");
+  }
+
+  if (
+    !data.nameAr ||
+    typeof data.nameAr !== "string" ||
+    data.nameAr.trim().length < 2
+  ) {
+    errors.push("Le nom arabe est requis (min 2 caractères)");
+  }
+
+  if (!data.descriptionFr || typeof data.descriptionFr !== "string") {
+    errors.push("La description française est requise");
+  }
+
+  if (!data.descriptionAr || typeof data.descriptionAr !== "string") {
+    errors.push("La description arabe est requise");
+  }
+
+  const price = parseFloat(data.price);
+  if (isNaN(price) || price <= 0) {
+    errors.push("Le prix doit être un nombre positif");
+  }
+
+  if (!Array.isArray(data.images) || data.images.length === 0) {
+    errors.push("Au moins une image est requise");
+  } else {
+    for (const img of data.images) {
+      if (typeof img !== "string" || !isValidUrl(img)) {
+        errors.push("Les URLs des images doivent être valides");
+        break;
+      }
+    }
+  }
+
+  if (!Array.isArray(data.sizes) || data.sizes.length === 0) {
+    errors.push("Au moins une taille est requise");
+  }
+
+  if (!Array.isArray(data.colors) || data.colors.length === 0) {
+    errors.push("Au moins une couleur est requise");
+  }
+
+  if (
+    data.stock !== undefined &&
+    (typeof data.stock !== "number" || data.stock < 0)
+  ) {
+    errors.push("Le stock doit être un nombre positif ou zéro");
+  }
+
+  return { valid: errors.length === 0, errors };
 }
 
 // Collection validation
 export function validateCollection(data: any): ValidationResult {
-    const errors: string[] = [];
-
-    if (!data.nameFr || typeof data.nameFr !== 'string' || data.nameFr.trim().length < 2) {
-        errors.push("Le nom français est requis (min 2 caractères)");
-    }
-
-    if (!data.nameAr || typeof data.nameAr !== 'string' || data.nameAr.trim().length < 2) {
-        errors.push("Le nom arabe est requis (min 2 caractères)");
-    }
-
-    if (data.image && typeof data.image === 'string' && !isValidUrl(data.image)) {
-        errors.push("L'URL de l'image doit être valide");
-    }
-
-    return { valid: errors.length === 0, errors };
+  const errors: string[] = [];
+
+  if (
+    !data.nameFr ||
+    typeof data.nameFr !== "string" ||
+    data.nameFr.trim().length < 2
+  ) {
+    errors.push("Le nom français est requis (min 2 caractères)");
+  }
+
+  if (
+    !data.nameAr ||
+    typeof data.nameAr !== "string" ||
+    data.nameAr.trim().length < 2
+  ) {
+    errors.push("Le nom arabe est requis (min 2 caractères)");
+  }
+
+  if (data.image && typeof data.image === "string" && !isValidUrl(data.image)) {
+    errors.push("L'URL de l'image doit être valide");
+  }
+
+  return { valid: errors.length === 0, errors };
 }
 
 // Order validation
 export function validateOrder(data: any): ValidationResult {
-    const errors: string[] = [];
-
-    if (!data.customerName || typeof data.customerName !== 'string' || data.customerName.trim().length < 2) {
-        errors.push("Le nom du client est requis");
-    }
-
-    if (!data.customerPhone || !isValidPhone(data.customerPhone)) {
-        errors.push("Un numéro de téléphone valide est requis");
-    }
-
-    if (!data.customerAddress || typeof data.customerAddress !== 'string' || data.customerAddress.trim().length < 5) {
-        errors.push("L'adresse est requise (min 5 caractères)");
-    }
-
-    if (!data.customerCity || typeof data.customerCity !== 'string') {
-        errors.push("La ville est requise");
-    }
-
-    if (!data.customerWilaya || typeof data.customerWilaya !== 'string') {
-        errors.push("La wilaya est requise");
-    }
-
-    const total = parseFloat(data.total);
-    if (isNaN(total) || total <= 0) {
-        errors.push("Le total doit être un nombre positif");
-    }
-
-    if (!Array.isArray(data.items) || data.items.length === 0) {
-        errors.push("Au moins un article est requis");
-    } else {
-        for (const item of data.items) {
-            if (!item.productName || !item.size || !item.color || !item.quantity || !item.price) {
-                errors.push("Tous les articles doivent avoir un nom, taille, couleur, quantité et prix");
-                break;
-            }
-        }
-    }
-
-    return { valid: errors.length === 0, errors };
+  const errors: string[] = [];
+
+  if (
+    !data.customerName ||
+    typeof data.customerName !== "string" ||
+    data.customerName.trim().length < 2
+  ) {
+    errors.push("Le nom du client est requis");
+  }
+
+  if (!data.customerPhone || !isValidPhone(data.customerPhone)) {
+    errors.push("Un numéro de téléphone valide est requis");
+  }
+
+  if (
+    !data.customerAddress ||
+    typeof data.customerAddress !== "string" ||
+    data.customerAddress.trim().length < 5
+  ) {
+    errors.push("L'adresse est requise (min 5 caractères)");
+  }
+
+  if (!data.customerCity || typeof data.customerCity !== "string") {
+    errors.push("La ville est requise");
+  }
+
+  if (!data.customerWilaya || typeof data.customerWilaya !== "string") {
+    errors.push("La wilaya est requise");
+  }
+
+  const total = parseFloat(data.total);
+  if (isNaN(total) || total <= 0) {
+    errors.push("Le total doit être un nombre positif");
+  }
+
+  if (!Array.isArray(data.items) || data.items.length === 0) {
+    errors.push("Au moins un article est requis");
+  } else {
+    for (const item of data.items) {
+      if (
+        !item.productName ||
+        !item.size ||
+        !item.color ||
+        !item.quantity ||
+        !item.price
+      ) {
+        errors.push(
+          "Tous les articles doivent avoir un nom, taille, couleur, quantité et prix",
+        );
+        break;
+      }
+    }
+  }
+
+  return { valid: errors.length === 0, errors };
 }
 
 // Order status validation
 export function validateOrderStatus(status: string): boolean {
-    const validStatuses = ['PENDING', 'CONFIRMED', 'SHIPPED', 'DELIVERED', 'CANCELLED'];
-    return validStatuses.includes(status);
+  const validStatuses = [
+    "PENDING",
+    "CONFIRMED",
+    "SHIPPED",
+    "DELIVERED",
+    "CANCELLED",
+  ];
+  return validStatuses.includes(status);
 }
 
 // Helper functions
 function isValidUrl(string: string): boolean {
-    // Allow relative URLs starting with /
-    if (string.startsWith('/')) return true;
-    
-    try {
-        new URL(string);
-        return true;
-    } catch {
-        return false;
-    }
+  // Allow relative URLs starting with /
+  if (string.startsWith("/")) return true;
+
+  try {
+    new URL(string);
+    return true;
+  } catch {
+    return false;
+  }
 }
 
 function isValidPhone(phone: string): boolean {
-    // Allow various phone formats (Algeria)
-    const cleaned = phone.replace(/[\s\-\.\(\)]/g, '');
-    return /^(\+?213|0)?[5-7]\d{8}$/.test(cleaned);
+  // Allow various phone formats (Algeria)
+  const cleaned = phone.replace(/[\s\-\.\(\)]/g, "");
+  return /^(\+?213|0)?[5-7]\d{8}$/.test(cleaned);
 }
 
 // Sanitize string input
 export function sanitizeString(str: string): string {
-    return str.trim().replace(/<[^>]*>/g, '');
+  return str.trim().replace(/<[^>]*>/g, "");
 }
diff --git a/src/lib/validations/profile.ts b/src/lib/validations/profile.ts
index 4b39a12..82dd409 100644
--- a/src/lib/validations/profile.ts
+++ b/src/lib/validations/profile.ts
@@ -17,14 +17,17 @@ export const UpdateProfileSchema = z.object({
     .max(100, "Le nom ne peut pas dépasser 100 caractères")
     .optional()
     .nullable(),
-  
+
   phone: z
     .string()
-    .regex(algerianPhoneRegex, "Le numéro doit contenir 10 chiffres (ex: 0551234567)")
+    .regex(
+      algerianPhoneRegex,
+      "Le numéro doit contenir 10 chiffres (ex: 0551234567)",
+    )
     .optional()
     .nullable()
     .or(z.literal("")),
-  
+
   birthDate: z
     .string()
     .regex(/^\d{4}-\d{2}-\d{2}$/, "Format date invalide (AAAA-MM-JJ)")
@@ -44,7 +47,10 @@ export const SignupSchema = z.object({
     .optional(),
   phone: z
     .string()
-    .regex(algerianPhoneRegex, "Le numéro doit contenir 10 chiffres (ex: 0551234567)")
+    .regex(
+      algerianPhoneRegex,
+      "Le numéro doit contenir 10 chiffres (ex: 0551234567)",
+    )
     .optional(),
 });
 
diff --git a/src/lib/yalidine-stopdesks.ts b/src/lib/yalidine-stopdesks.ts
index 451aad1..5a12d36 100644
--- a/src/lib/yalidine-stopdesks.ts
+++ b/src/lib/yalidine-stopdesks.ts
@@ -10,66 +10,68 @@ export interface YalidineStopDesk {
 }
 
 export const YALIDINE_STOPDESKS: YalidineStopDesk[] = [
-  { wilayaId: 1, wilayaName: 'Adrar', centersCount: 1 },
-  { wilayaId: 2, wilayaName: 'Chlef', centersCount: 3 },
-  { wilayaId: 3, wilayaName: 'Laghouat', centersCount: 2 },
-  { wilayaId: 4, wilayaName: 'Oum El Bouaghi', centersCount: 2 },
-  { wilayaId: 5, wilayaName: 'Batna', centersCount: 3 },
-  { wilayaId: 6, wilayaName: 'Béjaïa', centersCount: 4 },
-  { wilayaId: 7, wilayaName: 'Biskra', centersCount: 2 },
-  { wilayaId: 8, wilayaName: 'Béchar', centersCount: 2 },
-  { wilayaId: 9, wilayaName: 'Blida', centersCount: 6 },
-  { wilayaId: 10, wilayaName: 'Bouira', centersCount: 3 },
-  { wilayaId: 11, wilayaName: 'Tamanrasset', centersCount: 3 },
-  { wilayaId: 12, wilayaName: 'Tébessa', centersCount: 3 },
-  { wilayaId: 13, wilayaName: 'Tlemcen', centersCount: 5 },
-  { wilayaId: 14, wilayaName: 'Tiaret', centersCount: 1 },
-  { wilayaId: 15, wilayaName: 'Tizi Ouzou', centersCount: 5 },
-  { wilayaId: 16, wilayaName: 'Alger', centersCount: 23 },
-  { wilayaId: 17, wilayaName: 'Djelfa', centersCount: 2 },
-  { wilayaId: 18, wilayaName: 'Jijel', centersCount: 4 },
-  { wilayaId: 19, wilayaName: 'Sétif', centersCount: 7 },
-  { wilayaId: 20, wilayaName: 'Saïda', centersCount: 1 },
-  { wilayaId: 21, wilayaName: 'Skikda', centersCount: 5 },
-  { wilayaId: 22, wilayaName: 'Sidi Bel Abbès', centersCount: 2 },
-  { wilayaId: 23, wilayaName: 'Annaba', centersCount: 4 },
-  { wilayaId: 24, wilayaName: 'Guelma', centersCount: 2 },
-  { wilayaId: 25, wilayaName: 'Constantine', centersCount: 7 },
-  { wilayaId: 26, wilayaName: 'Médéa', centersCount: 4 },
-  { wilayaId: 27, wilayaName: 'Mostaganem', centersCount: 2 },
+  { wilayaId: 1, wilayaName: "Adrar", centersCount: 1 },
+  { wilayaId: 2, wilayaName: "Chlef", centersCount: 3 },
+  { wilayaId: 3, wilayaName: "Laghouat", centersCount: 2 },
+  { wilayaId: 4, wilayaName: "Oum El Bouaghi", centersCount: 2 },
+  { wilayaId: 5, wilayaName: "Batna", centersCount: 3 },
+  { wilayaId: 6, wilayaName: "Béjaïa", centersCount: 4 },
+  { wilayaId: 7, wilayaName: "Biskra", centersCount: 2 },
+  { wilayaId: 8, wilayaName: "Béchar", centersCount: 2 },
+  { wilayaId: 9, wilayaName: "Blida", centersCount: 6 },
+  { wilayaId: 10, wilayaName: "Bouira", centersCount: 3 },
+  { wilayaId: 11, wilayaName: "Tamanrasset", centersCount: 3 },
+  { wilayaId: 12, wilayaName: "Tébessa", centersCount: 3 },
+  { wilayaId: 13, wilayaName: "Tlemcen", centersCount: 5 },
+  { wilayaId: 14, wilayaName: "Tiaret", centersCount: 1 },
+  { wilayaId: 15, wilayaName: "Tizi Ouzou", centersCount: 5 },
+  { wilayaId: 16, wilayaName: "Alger", centersCount: 23 },
+  { wilayaId: 17, wilayaName: "Djelfa", centersCount: 2 },
+  { wilayaId: 18, wilayaName: "Jijel", centersCount: 4 },
+  { wilayaId: 19, wilayaName: "Sétif", centersCount: 7 },
+  { wilayaId: 20, wilayaName: "Saïda", centersCount: 1 },
+  { wilayaId: 21, wilayaName: "Skikda", centersCount: 5 },
+  { wilayaId: 22, wilayaName: "Sidi Bel Abbès", centersCount: 2 },
+  { wilayaId: 23, wilayaName: "Annaba", centersCount: 4 },
+  { wilayaId: 24, wilayaName: "Guelma", centersCount: 2 },
+  { wilayaId: 25, wilayaName: "Constantine", centersCount: 7 },
+  { wilayaId: 26, wilayaName: "Médéa", centersCount: 4 },
+  { wilayaId: 27, wilayaName: "Mostaganem", centersCount: 2 },
   { wilayaId: 28, wilayaName: "M'Sila", centersCount: 4 },
-  { wilayaId: 29, wilayaName: 'Mascara', centersCount: 1 },
-  { wilayaId: 30, wilayaName: 'Ouargla', centersCount: 3 },
-  { wilayaId: 31, wilayaName: 'Oran', centersCount: 7 },
-  { wilayaId: 32, wilayaName: 'El Bayadh', centersCount: 1 },
-  { wilayaId: 33, wilayaName: 'Illizi', centersCount: 2 },
-  { wilayaId: 34, wilayaName: 'Bordj Bou Arreridj', centersCount: 2 },
-  { wilayaId: 35, wilayaName: 'Boumerdès', centersCount: 4 },
-  { wilayaId: 36, wilayaName: 'El Tarf', centersCount: 2 },
-  { wilayaId: 37, wilayaName: 'Tindouf', centersCount: 1 },
-  { wilayaId: 38, wilayaName: 'Tissemsilt', centersCount: 1 },
-  { wilayaId: 39, wilayaName: 'El Oued', centersCount: 1 },
-  { wilayaId: 40, wilayaName: 'Khenchela', centersCount: 1 },
-  { wilayaId: 41, wilayaName: 'Souk Ahras', centersCount: 1 },
-  { wilayaId: 42, wilayaName: 'Tipaza', centersCount: 4 },
-  { wilayaId: 43, wilayaName: 'Mila', centersCount: 2 },
-  { wilayaId: 44, wilayaName: 'Aïn Defla', centersCount: 2 },
-  { wilayaId: 45, wilayaName: 'Naâma', centersCount: 1 },
-  { wilayaId: 46, wilayaName: 'Aïn Témouchent', centersCount: 2 },
-  { wilayaId: 47, wilayaName: 'Ghardaïa', centersCount: 2 },
-  { wilayaId: 48, wilayaName: 'Relizane', centersCount: 1 },
-  { wilayaId: 49, wilayaName: 'Timimoun', centersCount: 1 },
-  { wilayaId: 51, wilayaName: 'Ouled Djellal', centersCount: 1 },
-  { wilayaId: 53, wilayaName: 'In Salah', centersCount: 1 },
-  { wilayaId: 55, wilayaName: 'Touggourt', centersCount: 1 },
-  { wilayaId: 56, wilayaName: 'Djanet', centersCount: 1 },
+  { wilayaId: 29, wilayaName: "Mascara", centersCount: 1 },
+  { wilayaId: 30, wilayaName: "Ouargla", centersCount: 3 },
+  { wilayaId: 31, wilayaName: "Oran", centersCount: 7 },
+  { wilayaId: 32, wilayaName: "El Bayadh", centersCount: 1 },
+  { wilayaId: 33, wilayaName: "Illizi", centersCount: 2 },
+  { wilayaId: 34, wilayaName: "Bordj Bou Arreridj", centersCount: 2 },
+  { wilayaId: 35, wilayaName: "Boumerdès", centersCount: 4 },
+  { wilayaId: 36, wilayaName: "El Tarf", centersCount: 2 },
+  { wilayaId: 37, wilayaName: "Tindouf", centersCount: 1 },
+  { wilayaId: 38, wilayaName: "Tissemsilt", centersCount: 1 },
+  { wilayaId: 39, wilayaName: "El Oued", centersCount: 1 },
+  { wilayaId: 40, wilayaName: "Khenchela", centersCount: 1 },
+  { wilayaId: 41, wilayaName: "Souk Ahras", centersCount: 1 },
+  { wilayaId: 42, wilayaName: "Tipaza", centersCount: 4 },
+  { wilayaId: 43, wilayaName: "Mila", centersCount: 2 },
+  { wilayaId: 44, wilayaName: "Aïn Defla", centersCount: 2 },
+  { wilayaId: 45, wilayaName: "Naâma", centersCount: 1 },
+  { wilayaId: 46, wilayaName: "Aïn Témouchent", centersCount: 2 },
+  { wilayaId: 47, wilayaName: "Ghardaïa", centersCount: 2 },
+  { wilayaId: 48, wilayaName: "Relizane", centersCount: 1 },
+  { wilayaId: 49, wilayaName: "Timimoun", centersCount: 1 },
+  { wilayaId: 51, wilayaName: "Ouled Djellal", centersCount: 1 },
+  { wilayaId: 53, wilayaName: "In Salah", centersCount: 1 },
+  { wilayaId: 55, wilayaName: "Touggourt", centersCount: 1 },
+  { wilayaId: 56, wilayaName: "Djanet", centersCount: 1 },
   { wilayaId: 57, wilayaName: "El M'Ghair", centersCount: 2 },
-  { wilayaId: 58, wilayaName: 'El Menia', centersCount: 1 },
+  { wilayaId: 58, wilayaName: "El Menia", centersCount: 1 },
 ];
 
 // Get stop desk info by wilaya ID
-export function getStopDeskInfo(wilayaId: number): YalidineStopDesk | undefined {
-  return YALIDINE_STOPDESKS.find(sd => sd.wilayaId === wilayaId);
+export function getStopDeskInfo(
+  wilayaId: number,
+): YalidineStopDesk | undefined {
+  return YALIDINE_STOPDESKS.find((sd) => sd.wilayaId === wilayaId);
 }
 
 // Check if wilaya has stop desk centers
@@ -86,6 +88,6 @@ export function getStopDeskCount(wilayaId: number): number {
 
 // Total stop desk centers
 export const TOTAL_STOPDESK_CENTERS = YALIDINE_STOPDESKS.reduce(
-  (sum, sd) => sum + sd.centersCount, 
-  0
+  (sum, sd) => sum + sd.centersCount,
+  0,
 );
diff --git a/src/lib/yalidine.ts b/src/lib/yalidine.ts
index 709ce10..28c4d04 100644
--- a/src/lib/yalidine.ts
+++ b/src/lib/yalidine.ts
@@ -6,376 +6,466 @@
 
 // Types Yalidine
 export interface YalidineParcel {
-    order_id: string;
-    from_wilaya_name: string;
-    firstname: string;
-    familyname: string;
-    contact_phone: string;
-    address: string;
-    to_commune_name: string;
-    to_wilaya_name: string;
-    product_list: string;
-    price: number;
-    do_insurance: boolean;
-    declared_value: number;
-    length: number;
-    width: number;
-    height: number;
-    weight: number;
-    freeshipping: boolean;
-    is_stopdesk: boolean;
-    stopdesk_id?: number;
-    has_exchange: boolean;
-    product_to_collect?: string;
+  order_id: string;
+  from_wilaya_name: string;
+  firstname: string;
+  familyname: string;
+  contact_phone: string;
+  address: string;
+  to_commune_name: string;
+  to_wilaya_name: string;
+  product_list: string;
+  price: number;
+  do_insurance: boolean;
+  declared_value: number;
+  length: number;
+  width: number;
+  height: number;
+  weight: number;
+  freeshipping: boolean;
+  is_stopdesk: boolean;
+  stopdesk_id?: number;
+  has_exchange: boolean;
+  product_to_collect?: string;
 }
 
 export interface YalidineParcelResponse {
-    success: boolean;
-    order_id: string;
-    tracking: string | null;
-    import_id: number | null;
-    label: string | null;
-    labels: string | null;
-    message: string;
+  success: boolean;
+  order_id: string;
+  tracking: string | null;
+  import_id: number | null;
+  label: string | null;
+  labels: string | null;
+  message: string;
 }
 
 export interface YalidineTrackingInfo {
-    tracking: string;
-    order_id: string;
-    firstname: string;
-    familyname: string;
-    contact_phone: string;
-    address: string;
-    is_stopdesk: number;
-    stopdesk_id: number;
-    stopdesk_name: string;
-    from_wilaya_id: number;
-    from_wilaya_name: string;
-    to_commune_id: number;
-    to_commune_name: string;
-    to_wilaya_id: number;
-    to_wilaya_name: string;
-    product_list: string;
-    price: number;
-    delivery_fee: number;
-    freeshipping: number;
-    date_creation: string;
-    date_expedition: string | null;
-    date_last_status: string;
-    last_status: string;
-    label: string;
-    current_center_name: string;
-    current_wilaya_name: string;
-    payment_status: string;
+  tracking: string;
+  order_id: string;
+  firstname: string;
+  familyname: string;
+  contact_phone: string;
+  address: string;
+  is_stopdesk: number;
+  stopdesk_id: number;
+  stopdesk_name: string;
+  from_wilaya_id: number;
+  from_wilaya_name: string;
+  to_commune_id: number;
+  to_commune_name: string;
+  to_wilaya_id: number;
+  to_wilaya_name: string;
+  product_list: string;
+  price: number;
+  delivery_fee: number;
+  freeshipping: number;
+  date_creation: string;
+  date_expedition: string | null;
+  date_last_status: string;
+  last_status: string;
+  label: string;
+  current_center_name: string;
+  current_wilaya_name: string;
+  payment_status: string;
 }
 
 export interface YalidineHistory {
-    date_status: string;
-    tracking: string;
-    status: string;
-    reason: string;
-    center_id: number;
-    center_name: string;
-    wilaya_id: number;
-    wilaya_name: string;
-    commune_id: number;
-    commune_name: string;
+  date_status: string;
+  tracking: string;
+  status: string;
+  reason: string;
+  center_id: number;
+  center_name: string;
+  wilaya_id: number;
+  wilaya_name: string;
+  commune_id: number;
+  commune_name: string;
 }
 
 export interface YalidineWilaya {
-    id: number;
-    name: string;
-    zone: number;
-    is_deliverable: boolean;
+  id: number;
+  name: string;
+  zone: number;
+  is_deliverable: boolean;
 }
 
 export interface YalidineCommune {
-    id: number;
-    name: string;
-    wilaya_id: number;
-    wilaya_name: string;
-    has_stop_desk: boolean;
-    is_deliverable: boolean;
-    delivery_time_parcel: number;
-    delivery_time_payment: number;
+  id: number;
+  name: string;
+  wilaya_id: number;
+  wilaya_name: string;
+  has_stop_desk: boolean;
+  is_deliverable: boolean;
+  delivery_time_parcel: number;
+  delivery_time_payment: number;
 }
 
 export interface YalidineCenter {
-    center_id: number;
-    name: string;
-    address: string;
-    gps: string;
-    commune_id: number;
-    commune_name: string;
-    wilaya_id: number;
-    wilaya_name: string;
+  center_id: number;
+  name: string;
+  address: string;
+  gps: string;
+  commune_id: number;
+  commune_name: string;
+  wilaya_id: number;
+  wilaya_name: string;
 }
 
 export interface YalidineFees {
-    from_wilaya_name: string;
-    to_wilaya_name: string;
-    zone: number;
-    retour_fee: number;
-    cod_percentage: number;
-    insurance_percentage: number;
-    oversize_fee: number;
-    per_commune: Record<string, {
-        commune_id: number;
-        commune_name: string;
-        express_home: number | null;
-        express_desk: number | null;
-        economic_home: number | null;
-        economic_desk: number | null;
-    }>;
+  from_wilaya_name: string;
+  to_wilaya_name: string;
+  zone: number;
+  retour_fee: number;
+  cod_percentage: number;
+  insurance_percentage: number;
+  oversize_fee: number;
+  per_commune: Record<
+    string,
+    {
+      commune_id: number;
+      commune_name: string;
+      express_home: number | null;
+      express_desk: number | null;
+      economic_home: number | null;
+      economic_desk: number | null;
+    }
+  >;
 }
 
 // Configuration
 const YALIDINE_CONFIG = {
-    baseUrl: process.env.YALIDINE_API_URL || 'https://api.yalidine.app/v1',
-    apiId: process.env.YALIDINE_API_ID || '',
-    apiToken: process.env.YALIDINE_API_TOKEN || '',
+  baseUrl: process.env.YALIDINE_API_URL || "https://api.yalidine.app/v1",
+  apiId: process.env.YALIDINE_API_ID || "",
+  apiToken: process.env.YALIDINE_API_TOKEN || "",
 };
 
 // Client API Yalidine
 class YalidineClient {
-    private apiId: string;
-    private apiToken: string;
-    private baseUrl: string;
-
-    constructor(apiId?: string, apiToken?: string) {
-        this.apiId = apiId || YALIDINE_CONFIG.apiId;
-        this.apiToken = apiToken || YALIDINE_CONFIG.apiToken;
-        this.baseUrl = YALIDINE_CONFIG.baseUrl;
-    }
-
-    private async request<T>(
-        endpoint: string,
-        method: 'GET' | 'POST' | 'PATCH' | 'DELETE' = 'GET',
-        body?: any
-    ): Promise<T> {
-        const url = `${this.baseUrl}${endpoint}`;
-
-        const headers: HeadersInit = {
-            'Content-Type': 'application/json',
-            'X-API-ID': this.apiId,
-            'X-API-TOKEN': this.apiToken,
-        };
-
-        try {
-            const response = await fetch(url, {
-                method,
-                headers,
-                body: body ? JSON.stringify(body) : undefined,
-            });
-
-            const data = await response.json();
-            return data;
-        } catch (error) {
-            console.error('Yalidine API Error:', error);
-            throw error;
-        }
-    }
-
-    /**
-     * Tester la connexion API
-     */
-    async testConnection(): Promise<{ success: boolean; message: string }> {
-        // Check if credentials are configured
-        if (!this.apiId || !this.apiToken) {
-            return { success: false, message: 'Identifiants API non configurés' };
-        }
-        
-        try {
-            const result = await this.request<{ has_more: boolean; total_data: number; data?: any[] }>('/wilayas/?page_size=1');
-            const hasData = result.total_data > 0 || (Array.isArray(result.data) && result.data.length > 0);
-            return { 
-                success: !!hasData, 
-                message: hasData ? 'Connexion réussie' : 'Échec - Aucune donnée' 
-            };
-        } catch (error) {
-            console.error('Yalidine connection test error:', error);
-            return { success: false, message: 'Échec de connexion' };
-        }
-    }
-
-    /**
-     * Récupérer la liste des wilayas
-     */
-    async getWilayas(): Promise<{ data: YalidineWilaya[] }> {
-        return this.request<{ data: YalidineWilaya[] }>('/wilayas/?page_size=100');
-    }
-
-    /**
-     * Récupérer les communes d'une wilaya
-     */
-    async getCommunes(wilayaId?: number): Promise<{ data: YalidineCommune[] }> {
-        const query = wilayaId ? `?wilaya_id=${wilayaId}&page_size=1000` : '?page_size=1000';
-        return this.request<{ data: YalidineCommune[] }>(`/communes/${query}`);
-    }
+  private apiId: string;
+  private apiToken: string;
+  private baseUrl: string;
+
+  constructor(apiId?: string, apiToken?: string) {
+    this.apiId = apiId || YALIDINE_CONFIG.apiId;
+    this.apiToken = apiToken || YALIDINE_CONFIG.apiToken;
+    this.baseUrl = YALIDINE_CONFIG.baseUrl;
+  }
+
+  private async request<T>(
+    endpoint: string,
+    method: "GET" | "POST" | "PATCH" | "DELETE" = "GET",
+    body?: any,
+  ): Promise<T> {
+    const url = `${this.baseUrl}${endpoint}`;
+
+    const headers: HeadersInit = {
+      "Content-Type": "application/json",
+      "X-API-ID": this.apiId,
+      "X-API-TOKEN": this.apiToken,
+    };
 
-    /**
-     * Récupérer les centres (stop desk)
-     */
-    async getCenters(wilayaId?: number): Promise<{ data: YalidineCenter[] }> {
-        const query = wilayaId ? `?wilaya_id=${wilayaId}&page_size=200` : '?page_size=200';
-        return this.request<{ data: YalidineCenter[] }>(`/centers/${query}`);
+    try {
+      const response = await fetch(url, {
+        method,
+        headers,
+        body: body ? JSON.stringify(body) : undefined,
+      });
+
+      const data = await response.json();
+      return data;
+    } catch (error) {
+      console.error("Yalidine API Error:", error);
+      throw error;
     }
-
-    /**
-     * Calculer les frais de livraison
-     */
-    async getFees(fromWilayaId: number, toWilayaId: number): Promise<YalidineFees> {
-        return this.request<YalidineFees>(`/fees/?from_wilaya_id=${fromWilayaId}&to_wilaya_id=${toWilayaId}`);
+  }
+
+  /**
+   * Tester la connexion API
+   */
+  async testConnection(): Promise<{ success: boolean; message: string }> {
+    // Check if credentials are configured
+    if (!this.apiId || !this.apiToken) {
+      return { success: false, message: "Identifiants API non configurés" };
     }
 
-    /**
-     * Créer un ou plusieurs colis
-     */
-    async createParcels(parcels: YalidineParcel[]): Promise<Record<string, YalidineParcelResponse>> {
-        return this.request<Record<string, YalidineParcelResponse>>('/parcels/', 'POST', parcels);
+    try {
+      const result = await this.request<{
+        has_more: boolean;
+        total_data: number;
+        data?: any[];
+      }>("/wilayas/?page_size=1");
+      const hasData =
+        result.total_data > 0 ||
+        (Array.isArray(result.data) && result.data.length > 0);
+      return {
+        success: !!hasData,
+        message: hasData ? "Connexion réussie" : "Échec - Aucune donnée",
+      };
+    } catch (error) {
+      console.error("Yalidine connection test error:", error);
+      return { success: false, message: "Échec de connexion" };
     }
-
-    /**
-     * Créer un seul colis (helper)
-     */
-    async createParcel(parcel: YalidineParcel): Promise<YalidineParcelResponse> {
-        try {
-            const result = await this.createParcels([parcel]);
-            
-            // Check if result exists and has the order_id
-            if (result && result[parcel.order_id]) {
-                return result[parcel.order_id];
-            }
-            
-            // If result is an object with error message
-            if (result && typeof result === 'object') {
-                const firstKey = Object.keys(result)[0];
-                if (firstKey && result[firstKey]) {
-                    return result[firstKey];
-                }
-            }
-            
-            // Return error response if no valid result
-            return {
-                success: false,
-                order_id: parcel.order_id,
-                tracking: null,
-                import_id: null,
-                label: null,
-                labels: null,
-                message: 'Réponse API invalide'
-            };
-        } catch (error: any) {
-            console.error('createParcel error:', error);
-            return {
-                success: false,
-                order_id: parcel.order_id,
-                tracking: null,
-                import_id: null,
-                label: null,
-                labels: null,
-                message: error?.message || 'Erreur création colis'
-            };
+  }
+
+  /**
+   * Récupérer la liste des wilayas
+   */
+  async getWilayas(): Promise<{ data: YalidineWilaya[] }> {
+    return this.request<{ data: YalidineWilaya[] }>("/wilayas/?page_size=100");
+  }
+
+  /**
+   * Récupérer les communes d'une wilaya
+   */
+  async getCommunes(wilayaId?: number): Promise<{ data: YalidineCommune[] }> {
+    const query = wilayaId
+      ? `?wilaya_id=${wilayaId}&page_size=1000`
+      : "?page_size=1000";
+    return this.request<{ data: YalidineCommune[] }>(`/communes/${query}`);
+  }
+
+  /**
+   * Récupérer les centres (stop desk)
+   */
+  async getCenters(wilayaId?: number): Promise<{ data: YalidineCenter[] }> {
+    const query = wilayaId
+      ? `?wilaya_id=${wilayaId}&page_size=200`
+      : "?page_size=200";
+    return this.request<{ data: YalidineCenter[] }>(`/centers/${query}`);
+  }
+
+  /**
+   * Calculer les frais de livraison
+   */
+  async getFees(
+    fromWilayaId: number,
+    toWilayaId: number,
+  ): Promise<YalidineFees> {
+    return this.request<YalidineFees>(
+      `/fees/?from_wilaya_id=${fromWilayaId}&to_wilaya_id=${toWilayaId}`,
+    );
+  }
+
+  /**
+   * Créer un ou plusieurs colis
+   */
+  async createParcels(
+    parcels: YalidineParcel[],
+  ): Promise<Record<string, YalidineParcelResponse>> {
+    return this.request<Record<string, YalidineParcelResponse>>(
+      "/parcels/",
+      "POST",
+      parcels,
+    );
+  }
+
+  /**
+   * Créer un seul colis (helper)
+   */
+  async createParcel(parcel: YalidineParcel): Promise<YalidineParcelResponse> {
+    try {
+      const result = await this.createParcels([parcel]);
+
+      // Check if result exists and has the order_id
+      if (result && result[parcel.order_id]) {
+        return result[parcel.order_id];
+      }
+
+      // If result is an object with error message
+      if (result && typeof result === "object") {
+        const firstKey = Object.keys(result)[0];
+        if (firstKey && result[firstKey]) {
+          return result[firstKey];
         }
+      }
+
+      // Return error response if no valid result
+      return {
+        success: false,
+        order_id: parcel.order_id,
+        tracking: null,
+        import_id: null,
+        label: null,
+        labels: null,
+        message: "Réponse API invalide",
+      };
+    } catch (error: any) {
+      console.error("createParcel error:", error);
+      return {
+        success: false,
+        order_id: parcel.order_id,
+        tracking: null,
+        import_id: null,
+        label: null,
+        labels: null,
+        message: error?.message || "Erreur création colis",
+      };
     }
-
-    /**
-     * Récupérer les détails d'un colis
-     */
-    async getParcel(tracking: string): Promise<{ data: YalidineTrackingInfo[] }> {
-        return this.request<{ data: YalidineTrackingInfo[] }>(`/parcels/${tracking}`);
-    }
-
-    /**
-     * Récupérer plusieurs colis
-     */
-    async getParcels(trackings?: string[]): Promise<{ data: YalidineTrackingInfo[]; has_more: boolean; total_data: number }> {
-        const query = trackings?.length ? `?tracking=${trackings.join(',')}` : '';
-        return this.request(`/parcels/${query}`);
-    }
-
-    /**
-     * Récupérer l'historique d'un colis
-     */
-    async getHistory(tracking: string): Promise<{ data: YalidineHistory[] }> {
-        return this.request<{ data: YalidineHistory[] }>(`/histories/${tracking}`);
-    }
-
-    /**
-     * Alias pour getHistory
-     */
-    async getTrackingHistory(tracking: string): Promise<{ data: YalidineHistory[] }> {
-        return this.getHistory(tracking);
-    }
-
-    /**
-     * Modifier un colis (uniquement si statut "En préparation")
-     */
-    async updateParcel(tracking: string, updates: Partial<YalidineParcel>): Promise<YalidineTrackingInfo> {
-        return this.request<YalidineTrackingInfo>(`/parcels/${tracking}`, 'PATCH', updates);
-    }
-
-    /**
-     * Supprimer un colis (uniquement si statut "En préparation")
-     */
-    async deleteParcel(tracking: string): Promise<{ tracking: string; deleted: boolean }> {
-        return this.request<{ tracking: string; deleted: boolean }>(`/parcels/${tracking}`, 'DELETE');
-    }
+  }
+
+  /**
+   * Récupérer les détails d'un colis
+   */
+  async getParcel(tracking: string): Promise<{ data: YalidineTrackingInfo[] }> {
+    return this.request<{ data: YalidineTrackingInfo[] }>(
+      `/parcels/${tracking}`,
+    );
+  }
+
+  /**
+   * Récupérer plusieurs colis
+   */
+  async getParcels(
+    trackings?: string[],
+  ): Promise<{
+    data: YalidineTrackingInfo[];
+    has_more: boolean;
+    total_data: number;
+  }> {
+    const query = trackings?.length ? `?tracking=${trackings.join(",")}` : "";
+    return this.request(`/parcels/${query}`);
+  }
+
+  /**
+   * Récupérer l'historique d'un colis
+   */
+  async getHistory(tracking: string): Promise<{ data: YalidineHistory[] }> {
+    return this.request<{ data: YalidineHistory[] }>(`/histories/${tracking}`);
+  }
+
+  /**
+   * Alias pour getHistory
+   */
+  async getTrackingHistory(
+    tracking: string,
+  ): Promise<{ data: YalidineHistory[] }> {
+    return this.getHistory(tracking);
+  }
+
+  /**
+   * Modifier un colis (uniquement si statut "En préparation")
+   */
+  async updateParcel(
+    tracking: string,
+    updates: Partial<YalidineParcel>,
+  ): Promise<YalidineTrackingInfo> {
+    return this.request<YalidineTrackingInfo>(
+      `/parcels/${tracking}`,
+      "PATCH",
+      updates,
+    );
+  }
+
+  /**
+   * Supprimer un colis (uniquement si statut "En préparation")
+   */
+  async deleteParcel(
+    tracking: string,
+  ): Promise<{ tracking: string; deleted: boolean }> {
+    return this.request<{ tracking: string; deleted: boolean }>(
+      `/parcels/${tracking}`,
+      "DELETE",
+    );
+  }
 }
 
 // Singleton instance
 let yalidineClient: YalidineClient | null = null;
 
 export function getYalidineClient(): YalidineClient {
-    if (!yalidineClient) {
-        yalidineClient = new YalidineClient();
-    }
-    return yalidineClient;
+  if (!yalidineClient) {
+    yalidineClient = new YalidineClient();
+  }
+  return yalidineClient;
 }
 
 // Mapping wilaya ID → nom (format Yalidine)
 export const WILAYA_ID_TO_NAME: Record<string, string> = {
-    '1': 'Adrar', '2': 'Chlef', '3': 'Laghouat', '4': 'Oum El Bouaghi',
-    '5': 'Batna', '6': 'Béjaïa', '7': 'Biskra', '8': 'Béchar',
-    '9': 'Blida', '10': 'Bouira', '11': 'Tamanrasset', '12': 'Tébessa',
-    '13': 'Tlemcen', '14': 'Tiaret', '15': 'Tizi Ouzou', '16': 'Alger',
-    '17': 'Djelfa', '18': 'Jijel', '19': 'Sétif', '20': 'Saïda',
-    '21': 'Skikda', '22': 'Sidi Bel Abbès', '23': 'Annaba', '24': 'Guelma',
-    '25': 'Constantine', '26': 'Médéa', '27': 'Mostaganem', '28': "M'Sila",
-    '29': 'Mascara', '30': 'Ouargla', '31': 'Oran', '32': 'El Bayadh',
-    '33': 'Illizi', '34': 'Bordj Bou Arreridj', '35': 'Boumerdès',
-    '36': 'El Tarf', '37': 'Tindouf', '38': 'Tissemsilt', '39': 'El Oued',
-    '40': 'Khenchela', '41': 'Souk Ahras', '42': 'Tipaza', '43': 'Mila',
-    '44': 'Aïn Defla', '45': 'Naâma', '46': 'Aïn Témouchent', '47': 'Ghardaïa',
-    '48': 'Relizane', '49': 'El MGhair', '50': 'El Meniaa', '51': 'Ouled Djellal',
-    '52': 'Bordj Badji Mokhtar', '53': 'Béni Abbès', '54': 'Timimoun',
-    '55': 'Touggourt', '56': 'Djanet', '57': 'In Salah', '58': 'In Guezzam',
+  "1": "Adrar",
+  "2": "Chlef",
+  "3": "Laghouat",
+  "4": "Oum El Bouaghi",
+  "5": "Batna",
+  "6": "Béjaïa",
+  "7": "Biskra",
+  "8": "Béchar",
+  "9": "Blida",
+  "10": "Bouira",
+  "11": "Tamanrasset",
+  "12": "Tébessa",
+  "13": "Tlemcen",
+  "14": "Tiaret",
+  "15": "Tizi Ouzou",
+  "16": "Alger",
+  "17": "Djelfa",
+  "18": "Jijel",
+  "19": "Sétif",
+  "20": "Saïda",
+  "21": "Skikda",
+  "22": "Sidi Bel Abbès",
+  "23": "Annaba",
+  "24": "Guelma",
+  "25": "Constantine",
+  "26": "Médéa",
+  "27": "Mostaganem",
+  "28": "M'Sila",
+  "29": "Mascara",
+  "30": "Ouargla",
+  "31": "Oran",
+  "32": "El Bayadh",
+  "33": "Illizi",
+  "34": "Bordj Bou Arreridj",
+  "35": "Boumerdès",
+  "36": "El Tarf",
+  "37": "Tindouf",
+  "38": "Tissemsilt",
+  "39": "El Oued",
+  "40": "Khenchela",
+  "41": "Souk Ahras",
+  "42": "Tipaza",
+  "43": "Mila",
+  "44": "Aïn Defla",
+  "45": "Naâma",
+  "46": "Aïn Témouchent",
+  "47": "Ghardaïa",
+  "48": "Relizane",
+  "49": "El MGhair",
+  "50": "El Meniaa",
+  "51": "Ouled Djellal",
+  "52": "Bordj Badji Mokhtar",
+  "53": "Béni Abbès",
+  "54": "Timimoun",
+  "55": "Touggourt",
+  "56": "Djanet",
+  "57": "In Salah",
+  "58": "In Guezzam",
 };
 
 // Fonction pour convertir ID ou nom en nom Yalidine
 export function getWilayaName(wilayaIdOrName: string): string {
-    // Si c'est déjà un nom connu, le retourner
-    const normalizedInput = wilayaIdOrName.trim();
-    
-    // Chercher par ID
-    if (WILAYA_ID_TO_NAME[normalizedInput]) {
-        return WILAYA_ID_TO_NAME[normalizedInput];
+  // Si c'est déjà un nom connu, le retourner
+  const normalizedInput = wilayaIdOrName.trim();
+
+  // Chercher par ID
+  if (WILAYA_ID_TO_NAME[normalizedInput]) {
+    return WILAYA_ID_TO_NAME[normalizedInput];
+  }
+
+  // Chercher par nom (insensible à la casse)
+  const lowerInput = normalizedInput.toLowerCase();
+  for (const [id, name] of Object.entries(WILAYA_ID_TO_NAME)) {
+    if (name.toLowerCase() === lowerInput) {
+      return name;
     }
-    
-    // Chercher par nom (insensible à la casse)
-    const lowerInput = normalizedInput.toLowerCase();
-    for (const [id, name] of Object.entries(WILAYA_ID_TO_NAME)) {
-        if (name.toLowerCase() === lowerInput) {
-            return name;
-        }
-    }
-    
-    // Retourner tel quel si non trouvé (l'API donnera une erreur plus explicite)
-    return normalizedInput;
+  }
+
+  // Retourner tel quel si non trouvé (l'API donnera une erreur plus explicite)
+  return normalizedInput;
 }
 
 // Helper: Convertir une commande Harp en colis Yalidine
-export function orderToYalidineParcel(order: {
+export function orderToYalidineParcel(
+  order: {
     id: string;
     customerName: string;
     customerPhone: string;
@@ -384,112 +474,117 @@ export function orderToYalidineParcel(order: {
     commune: string;
     total: number;
     items: any[];
-    deliveryType?: 'DOMICILE' | 'STOP_DESK';
+    deliveryType?: "DOMICILE" | "STOP_DESK";
     stopDeskId?: number;
     notes?: string;
-}, fromWilaya: string = 'Alger'): YalidineParcel {
-    // Séparer prénom/nom
-    const nameParts = order.customerName.trim().split(' ');
-    const firstname = nameParts[0] || order.customerName;
-    const familyname = nameParts.slice(1).join(' ') || '-';
-
-    // Description des produits
-    const productList = order.items
-        .map((item: any) => `${item.quantity}x ${item.nameFr || item.productName || item.name}`)
-        .join(', ');
-
-    // Convertir wilaya ID en nom
-    const toWilayaName = getWilayaName(order.wilaya);
-    const fromWilayaName = getWilayaName(fromWilaya);
-
-    return {
-        order_id: order.id,
-        from_wilaya_name: fromWilayaName,
-        firstname,
-        familyname,
-        contact_phone: order.customerPhone.replace(/\s/g, ''),
-        address: order.address,
-        to_commune_name: order.commune,
-        to_wilaya_name: toWilayaName,
-        product_list: productList || 'Articles Harp',
-        price: Math.round(order.total),
-        do_insurance: false,
-        declared_value: Math.round(order.total),
-        length: 30,
-        width: 20,
-        height: 10,
-        weight: 1,
-        freeshipping: false, // Client paie la livraison
-        is_stopdesk: order.deliveryType === 'STOP_DESK',
-        stopdesk_id: order.stopDeskId,
-        has_exchange: false,
-    };
+  },
+  fromWilaya: string = "Alger",
+): YalidineParcel {
+  // Séparer prénom/nom
+  const nameParts = order.customerName.trim().split(" ");
+  const firstname = nameParts[0] || order.customerName;
+  const familyname = nameParts.slice(1).join(" ") || "-";
+
+  // Description des produits
+  const productList = order.items
+    .map(
+      (item: any) =>
+        `${item.quantity}x ${item.nameFr || item.productName || item.name}`,
+    )
+    .join(", ");
+
+  // Convertir wilaya ID en nom
+  const toWilayaName = getWilayaName(order.wilaya);
+  const fromWilayaName = getWilayaName(fromWilaya);
+
+  return {
+    order_id: order.id,
+    from_wilaya_name: fromWilayaName,
+    firstname,
+    familyname,
+    contact_phone: order.customerPhone.replace(/\s/g, ""),
+    address: order.address,
+    to_commune_name: order.commune,
+    to_wilaya_name: toWilayaName,
+    product_list: productList || "Articles Harp",
+    price: Math.round(order.total),
+    do_insurance: false,
+    declared_value: Math.round(order.total),
+    length: 30,
+    width: 20,
+    height: 10,
+    weight: 1,
+    freeshipping: false, // Client paie la livraison
+    is_stopdesk: order.deliveryType === "STOP_DESK",
+    stopdesk_id: order.stopDeskId,
+    has_exchange: false,
+  };
 }
 
 // Mapper le statut Yalidine vers statut Harp
 export function mapYalidineStatusToHarpStatus(yalidineStatus: string): string {
-    const statusMap: Record<string, string> = {
-        'Pas encore expédié': 'CONFIRMED',
-        'A vérifier': 'CONFIRMED',
-        'En préparation': 'CONFIRMED',
-        'Pas encore ramassé': 'CONFIRMED',
-        'Prêt à expédier': 'CONFIRMED',
-        'En passation': 'CONFIRMED',
-        'Ramassé': 'SHIPPED',
-        'Transfert': 'SHIPPED',
-        'Expédié': 'SHIPPED',
-        'Centre': 'SHIPPED',
-        'En localisation': 'SHIPPED',
-        'Vers Wilaya': 'SHIPPED',
-        'Reçu à Wilaya': 'SHIPPED',
-        'En attente du client': 'SHIPPED',
-        'Prêt pour livreur': 'SHIPPED',
-        'Sorti en livraison': 'SHIPPED',
-        'En attente': 'SHIPPED',
-        'Tentative échouée': 'SHIPPED',
-        'Livré': 'DELIVERED',
-        'Echèc livraison': 'CANCELLED',
-        'Retour vers centre': 'CANCELLED',
-        'Retourné au centre': 'CANCELLED',
-        'Retour vers vendeur': 'CANCELLED',
-        'Retourné au vendeur': 'CANCELLED',
-    };
-    return statusMap[yalidineStatus] || 'PENDING';
+  const statusMap: Record<string, string> = {
+    "Pas encore expédié": "CONFIRMED",
+    "A vérifier": "CONFIRMED",
+    "En préparation": "CONFIRMED",
+    "Pas encore ramassé": "CONFIRMED",
+    "Prêt à expédier": "CONFIRMED",
+    "En passation": "CONFIRMED",
+    Ramassé: "SHIPPED",
+    Transfert: "SHIPPED",
+    Expédié: "SHIPPED",
+    Centre: "SHIPPED",
+    "En localisation": "SHIPPED",
+    "Vers Wilaya": "SHIPPED",
+    "Reçu à Wilaya": "SHIPPED",
+    "En attente du client": "SHIPPED",
+    "Prêt pour livreur": "SHIPPED",
+    "Sorti en livraison": "SHIPPED",
+    "En attente": "SHIPPED",
+    "Tentative échouée": "SHIPPED",
+    Livré: "DELIVERED",
+    "Echèc livraison": "CANCELLED",
+    "Retour vers centre": "CANCELLED",
+    "Retourné au centre": "CANCELLED",
+    "Retour vers vendeur": "CANCELLED",
+    "Retourné au vendeur": "CANCELLED",
+  };
+  return statusMap[yalidineStatus] || "PENDING";
 }
 
 // Liste des statuts Yalidine
 export const YALIDINE_STATUSES = [
-    'Pas encore expédié',
-    'A vérifier',
-    'En préparation',
-    'Pas encore ramassé',
-    'Prêt à expédier',
-    'En passation',
-    'Ramassé',
-    'Bloqué',
-    'Débloqué',
-    'Transfert',
-    'Expédié',
-    'Centre',
-    'En localisation',
-    'Vers Wilaya',
-    'Reçu à Wilaya',
-    'En attente du client',
-    'Prêt pour livreur',
-    'Sorti en livraison',
-    'En attente',
-    'En alerte',
-    'Tentative échouée',
-    'Livré',
-    'Echèc livraison',
-    'Retour vers centre',
-    'Retourné au centre',
-    'Retour transfert',
-    'Retour groupé',
-    'Retour à retirer',
-    'Retour vers vendeur',
-    'Retourné au vendeur',
-    'Echange échoué',
+  "Pas encore expédié",
+  "A vérifier",
+  "En préparation",
+  "Pas encore ramassé",
+  "Prêt à expédier",
+  "En passation",
+  "Ramassé",
+  "Bloqué",
+  "Débloqué",
+  "Transfert",
+  "Expédié",
+  "Centre",
+  "En localisation",
+  "Vers Wilaya",
+  "Reçu à Wilaya",
+  "En attente du client",
+  "Prêt pour livreur",
+  "Sorti en livraison",
+  "En attente",
+  "En alerte",
+  "Tentative échouée",
+  "Livré",
+  "Echèc livraison",
+  "Retour vers centre",
+  "Retourné au centre",
+  "Retour transfert",
+  "Retour groupé",
+  "Retour à retirer",
+  "Retour vers vendeur",
+  "Retourné au vendeur",
+  "Echange échoué",
 ];
 
 export default YalidineClient;
diff --git a/src/lib/zrexpress-stopdesks.ts b/src/lib/zrexpress-stopdesks.ts
index d14ad3e..bc156b8 100644
--- a/src/lib/zrexpress-stopdesks.ts
+++ b/src/lib/zrexpress-stopdesks.ts
@@ -14,190 +14,706 @@ export interface ZRStopDesk {
 
 export const ZR_EXPRESS_STOPDESKS: ZRStopDesk[] = [
   // 01 - ADRAR
-  { wilayaId: 1, wilayaName: 'Adrar', centerName: 'Adrar', address: 'À côté de lycée ELMOGHILI, derrière le conseil judiciaire', phone: '0661.41.11.00', stopDeskPhone: '0661.41.11.00' },
-  
+  {
+    wilayaId: 1,
+    wilayaName: "Adrar",
+    centerName: "Adrar",
+    address: "À côté de lycée ELMOGHILI, derrière le conseil judiciaire",
+    phone: "0661.41.11.00",
+    stopDeskPhone: "0661.41.11.00",
+  },
+
   // 02 - CHLEF
-  { wilayaId: 2, wilayaName: 'Chlef', centerName: 'Chlef', address: 'Hay aroudj, derrière ADE en face le musée', phone: '0770.99.45.28', stopDeskPhone: '0770.99.46.74' },
-  { wilayaId: 2, wilayaName: 'Chlef', centerName: 'Tenes', address: 'N°6 commune de Tenes A, Rue Boufadis, Lot 51 Bâtiments, à côté de la caserne militaire, Route Marina Bâtiments Mandil', phone: '0770.99.35.71', stopDeskPhone: '0770.99.35.72' },
-  
+  {
+    wilayaId: 2,
+    wilayaName: "Chlef",
+    centerName: "Chlef",
+    address: "Hay aroudj, derrière ADE en face le musée",
+    phone: "0770.99.45.28",
+    stopDeskPhone: "0770.99.46.74",
+  },
+  {
+    wilayaId: 2,
+    wilayaName: "Chlef",
+    centerName: "Tenes",
+    address:
+      "N°6 commune de Tenes A, Rue Boufadis, Lot 51 Bâtiments, à côté de la caserne militaire, Route Marina Bâtiments Mandil",
+    phone: "0770.99.35.71",
+    stopDeskPhone: "0770.99.35.72",
+  },
+
   // 03 - LAGHOUAT
-  { wilayaId: 3, wilayaName: 'Laghouat', centerName: 'Laghouat', address: 'Cité Mhafir, En face parking du département de biologie', phone: '0674.40.38.81', stopDeskPhone: '0670.30.03.97' },
-  
+  {
+    wilayaId: 3,
+    wilayaName: "Laghouat",
+    centerName: "Laghouat",
+    address: "Cité Mhafir, En face parking du département de biologie",
+    phone: "0674.40.38.81",
+    stopDeskPhone: "0670.30.03.97",
+  },
+
   // 04 - OUM EL BOUAGHI
-  { wilayaId: 4, wilayaName: 'Oum El Bouaghi', centerName: 'Ain El Beida', address: 'Tahsise El Amel, en face le collège Koshari, Ain El Bayda', phone: '0698.63.12.34', stopDeskPhone: '0660.73.74.78' },
-  { wilayaId: 4, wilayaName: 'Oum El Bouaghi', centerName: 'Centre-Ville', address: 'N°392 cité ennacer', phone: '0698.63.12.34', stopDeskPhone: '0770.07.29.11' },
-  
+  {
+    wilayaId: 4,
+    wilayaName: "Oum El Bouaghi",
+    centerName: "Ain El Beida",
+    address: "Tahsise El Amel, en face le collège Koshari, Ain El Bayda",
+    phone: "0698.63.12.34",
+    stopDeskPhone: "0660.73.74.78",
+  },
+  {
+    wilayaId: 4,
+    wilayaName: "Oum El Bouaghi",
+    centerName: "Centre-Ville",
+    address: "N°392 cité ennacer",
+    phone: "0698.63.12.34",
+    stopDeskPhone: "0770.07.29.11",
+  },
+
   // 05 - BATNA
-  { wilayaId: 5, wilayaName: 'Batna', centerName: 'Batna', address: 'Les allés jadida erriad, à côté supérette el bahja', phone: '0659.78.12.34', stopDeskPhone: '0770.55.80.86' },
-  
+  {
+    wilayaId: 5,
+    wilayaName: "Batna",
+    centerName: "Batna",
+    address: "Les allés jadida erriad, à côté supérette el bahja",
+    phone: "0659.78.12.34",
+    stopDeskPhone: "0770.55.80.86",
+  },
+
   // 06 - BEJAIA
-  { wilayaId: 6, wilayaName: 'Béjaïa', centerName: 'Béjaïa', address: 'Edimco, Cité somacob', phone: '0698.86.12.34', stopDeskPhone: '0770.96.82.04' },
-  { wilayaId: 6, wilayaName: 'Béjaïa', centerName: 'Akbou', address: 'Gare ferroviaire, à côté salle des fêtes HADAD', phone: '0770.10.46.84', stopDeskPhone: '0770.10.46.92' },
-  
+  {
+    wilayaId: 6,
+    wilayaName: "Béjaïa",
+    centerName: "Béjaïa",
+    address: "Edimco, Cité somacob",
+    phone: "0698.86.12.34",
+    stopDeskPhone: "0770.96.82.04",
+  },
+  {
+    wilayaId: 6,
+    wilayaName: "Béjaïa",
+    centerName: "Akbou",
+    address: "Gare ferroviaire, à côté salle des fêtes HADAD",
+    phone: "0770.10.46.84",
+    stopDeskPhone: "0770.10.46.92",
+  },
+
   // 07 - BISKRA
-  { wilayaId: 7, wilayaName: 'Biskra', centerName: 'Biskra', address: 'El koures, en face salle des fêtes soukara', phone: '0771.53.40.58', stopDeskPhone: '0770.72.87.34' },
-  
+  {
+    wilayaId: 7,
+    wilayaName: "Biskra",
+    centerName: "Biskra",
+    address: "El koures, en face salle des fêtes soukara",
+    phone: "0771.53.40.58",
+    stopDeskPhone: "0770.72.87.34",
+  },
+
   // 08 - BECHAR
-  { wilayaId: 8, wilayaName: 'Béchar', centerName: 'Béchar', address: 'Cité 220 log, À côté de la Direction de l\'Eau (ADE)', phone: '0770.05.94.98', stopDeskPhone: '0770.76.53.73' },
-  
+  {
+    wilayaId: 8,
+    wilayaName: "Béchar",
+    centerName: "Béchar",
+    address: "Cité 220 log, À côté de la Direction de l'Eau (ADE)",
+    phone: "0770.05.94.98",
+    stopDeskPhone: "0770.76.53.73",
+  },
+
   // 09 - BLIDA
-  { wilayaId: 9, wilayaName: 'Blida', centerName: 'Blida-Ville', address: 'Cité Ben Mokadem Mohammed N°276-Ramoul en face l\'agence', phone: '0562.29.42.14', stopDeskPhone: '0799.71.81.02' },
-  { wilayaId: 9, wilayaName: 'Blida', centerName: 'Bouguara', address: 'Rue Hamidouche Mouloud, Route d\'Alger, Bouguara', phone: '0771.92.80.94', stopDeskPhone: '0779.42.62.22' },
-  { wilayaId: 9, wilayaName: 'Blida', centerName: 'Mouzaia', address: 'Rue Ben Ahmed Ali Aslaoui, N° 45, Mouzaia', phone: '0774.53.19.22', stopDeskPhone: '0773.86.25.07' },
-  
+  {
+    wilayaId: 9,
+    wilayaName: "Blida",
+    centerName: "Blida-Ville",
+    address: "Cité Ben Mokadem Mohammed N°276-Ramoul en face l'agence",
+    phone: "0562.29.42.14",
+    stopDeskPhone: "0799.71.81.02",
+  },
+  {
+    wilayaId: 9,
+    wilayaName: "Blida",
+    centerName: "Bouguara",
+    address: "Rue Hamidouche Mouloud, Route d'Alger, Bouguara",
+    phone: "0771.92.80.94",
+    stopDeskPhone: "0779.42.62.22",
+  },
+  {
+    wilayaId: 9,
+    wilayaName: "Blida",
+    centerName: "Mouzaia",
+    address: "Rue Ben Ahmed Ali Aslaoui, N° 45, Mouzaia",
+    phone: "0774.53.19.22",
+    stopDeskPhone: "0773.86.25.07",
+  },
+
   // 10 - BOUIRA
-  { wilayaId: 10, wilayaName: 'Bouira', centerName: 'Bouira', address: '338 log, En face de l\'hôtel Sofy', phone: '06.57.70.05.64', stopDeskPhone: '0770.77.87.43' },
-  
+  {
+    wilayaId: 10,
+    wilayaName: "Bouira",
+    centerName: "Bouira",
+    address: "338 log, En face de l'hôtel Sofy",
+    phone: "06.57.70.05.64",
+    stopDeskPhone: "0770.77.87.43",
+  },
+
   // 11 - TAMANRASSET
-  { wilayaId: 11, wilayaName: 'Tamanrasset', centerName: 'Tamanrasset', address: 'Cité El Wiam, en face CASNOS', phone: '0770.99.42.57', stopDeskPhone: '0670.74.39.61' },
-  
+  {
+    wilayaId: 11,
+    wilayaName: "Tamanrasset",
+    centerName: "Tamanrasset",
+    address: "Cité El Wiam, en face CASNOS",
+    phone: "0770.99.42.57",
+    stopDeskPhone: "0670.74.39.61",
+  },
+
   // 12 - TEBESSA
-  { wilayaId: 12, wilayaName: 'Tébessa', centerName: 'Tébessa', address: 'Tahsis El arebi El Tebsi (Skanska) en face la Direction d\'Etat de la Poste d\'Algerie de Tebessa', phone: '0659.43.06.81', stopDeskPhone: '0779.87.30.36' },
-  
+  {
+    wilayaId: 12,
+    wilayaName: "Tébessa",
+    centerName: "Tébessa",
+    address:
+      "Tahsis El arebi El Tebsi (Skanska) en face la Direction d'Etat de la Poste d'Algerie de Tebessa",
+    phone: "0659.43.06.81",
+    stopDeskPhone: "0779.87.30.36",
+  },
+
   // 13 - TLEMCEN
-  { wilayaId: 13, wilayaName: 'Tlemcen', centerName: 'Tlemcen', address: 'En face Rondpoint cité des oliviers', phone: '0660.88.41.56', stopDeskPhone: '0671.44.6.27' },
-  
+  {
+    wilayaId: 13,
+    wilayaName: "Tlemcen",
+    centerName: "Tlemcen",
+    address: "En face Rondpoint cité des oliviers",
+    phone: "0660.88.41.56",
+    stopDeskPhone: "0671.44.6.27",
+  },
+
   // 14 - TIARET
-  { wilayaId: 14, wilayaName: 'Tiaret', centerName: 'Tiaret', address: 'Route l\'académié en face de l\'hopital du rein, à côté de la librairie Mimouni', phone: '0667.18.42.55', stopDeskPhone: '0770.38.32.20' },
-  
+  {
+    wilayaId: 14,
+    wilayaName: "Tiaret",
+    centerName: "Tiaret",
+    address:
+      "Route l'académié en face de l'hopital du rein, à côté de la librairie Mimouni",
+    phone: "0667.18.42.55",
+    stopDeskPhone: "0770.38.32.20",
+  },
+
   // 15 - TIZI OUZOU
-  { wilayaId: 15, wilayaName: 'Tizi Ouzou', centerName: 'Tizi Ouzou', address: 'Lot Sud-Ouest 314, à côté du Boulevard Stiti (anciennement Concorde), à proximité des Trois Roses et de la salle Omnisport Need for Gym', phone: '0770.18.06.02', stopDeskPhone: '0770.18.06.02' },
-  
+  {
+    wilayaId: 15,
+    wilayaName: "Tizi Ouzou",
+    centerName: "Tizi Ouzou",
+    address:
+      "Lot Sud-Ouest 314, à côté du Boulevard Stiti (anciennement Concorde), à proximité des Trois Roses et de la salle Omnisport Need for Gym",
+    phone: "0770.18.06.02",
+    stopDeskPhone: "0770.18.06.02",
+  },
+
   // 16 - ALGER
-  { wilayaId: 16, wilayaName: 'Alger', centerName: 'Birkhadem', address: 'Rue des Rosiers, El Malha Birkhadem', phone: '0770.70.50.07', stopDeskPhone: '0770.58.40.33' },
-  { wilayaId: 16, wilayaName: 'Alger', centerName: 'Ouled Fayet', address: 'Ouled Fayet rue Boualem Rasoul, pas loin de Société Générale', phone: '0770.07.27.03', stopDeskPhone: '0770.06.94.04' },
-  { wilayaId: 16, wilayaName: 'Alger', centerName: 'Reghaia', address: 'Cité Amirouche 692 (Batigec) Bt 03 Num A07', phone: '0799.57.57.15', stopDeskPhone: '0770.21.54.48' },
-  { wilayaId: 16, wilayaName: 'Alger', centerName: 'Bordj El Kiffan', address: 'Lido, Pas loin de stade de tennis', phone: '0770.36.39.02', stopDeskPhone: '0770.36.39.02' },
-  { wilayaId: 16, wilayaName: 'Alger', centerName: 'Birtouta', address: 'Cité de l\'anciens abatoire, derrière la salle des fetes bent sultan, Birtouta', phone: '0770.93.49.22', stopDeskPhone: '0776.06.31.54' },
-  { wilayaId: 16, wilayaName: 'Alger', centerName: 'Baraki', address: 'Baraki, Route de Larbaa Bougaraa, dans le meme immeuble que la selle de musculation OLYMPIC GYM', phone: '0770.18.38.44', stopDeskPhone: '0770.18.38.71' },
-  
+  {
+    wilayaId: 16,
+    wilayaName: "Alger",
+    centerName: "Birkhadem",
+    address: "Rue des Rosiers, El Malha Birkhadem",
+    phone: "0770.70.50.07",
+    stopDeskPhone: "0770.58.40.33",
+  },
+  {
+    wilayaId: 16,
+    wilayaName: "Alger",
+    centerName: "Ouled Fayet",
+    address: "Ouled Fayet rue Boualem Rasoul, pas loin de Société Générale",
+    phone: "0770.07.27.03",
+    stopDeskPhone: "0770.06.94.04",
+  },
+  {
+    wilayaId: 16,
+    wilayaName: "Alger",
+    centerName: "Reghaia",
+    address: "Cité Amirouche 692 (Batigec) Bt 03 Num A07",
+    phone: "0799.57.57.15",
+    stopDeskPhone: "0770.21.54.48",
+  },
+  {
+    wilayaId: 16,
+    wilayaName: "Alger",
+    centerName: "Bordj El Kiffan",
+    address: "Lido, Pas loin de stade de tennis",
+    phone: "0770.36.39.02",
+    stopDeskPhone: "0770.36.39.02",
+  },
+  {
+    wilayaId: 16,
+    wilayaName: "Alger",
+    centerName: "Birtouta",
+    address:
+      "Cité de l'anciens abatoire, derrière la salle des fetes bent sultan, Birtouta",
+    phone: "0770.93.49.22",
+    stopDeskPhone: "0776.06.31.54",
+  },
+  {
+    wilayaId: 16,
+    wilayaName: "Alger",
+    centerName: "Baraki",
+    address:
+      "Baraki, Route de Larbaa Bougaraa, dans le meme immeuble que la selle de musculation OLYMPIC GYM",
+    phone: "0770.18.38.44",
+    stopDeskPhone: "0770.18.38.71",
+  },
+
   // 17 - DJELFA
-  { wilayaId: 17, wilayaName: 'Djelfa', centerName: 'Djelfa', address: 'Cité berbih, à côté de la direction de l\'action sociale et de la solidarité LA DASS', phone: '0657.70.01.76', stopDeskPhone: '0770.28.29.35' },
-  
+  {
+    wilayaId: 17,
+    wilayaName: "Djelfa",
+    centerName: "Djelfa",
+    address:
+      "Cité berbih, à côté de la direction de l'action sociale et de la solidarité LA DASS",
+    phone: "0657.70.01.76",
+    stopDeskPhone: "0770.28.29.35",
+  },
+
   // 18 - JIJEL
-  { wilayaId: 18, wilayaName: 'Jijel', centerName: 'Jijel', address: 'Rue Kamal Ismail, en face de l\'entrée principale de l\'Université Jijel Ekiti', phone: '0657.64.62.84', stopDeskPhone: '0660.16.93.08' },
-  { wilayaId: 18, wilayaName: 'Jijel', centerName: 'Taher', address: 'Boukaabour, la route menant à la clinique d\'ophtalmologie Mahanan', phone: '0670.42.32.04', stopDeskPhone: '0670.42.32.05' },
-  
+  {
+    wilayaId: 18,
+    wilayaName: "Jijel",
+    centerName: "Jijel",
+    address:
+      "Rue Kamal Ismail, en face de l'entrée principale de l'Université Jijel Ekiti",
+    phone: "0657.64.62.84",
+    stopDeskPhone: "0660.16.93.08",
+  },
+  {
+    wilayaId: 18,
+    wilayaName: "Jijel",
+    centerName: "Taher",
+    address:
+      "Boukaabour, la route menant à la clinique d'ophtalmologie Mahanan",
+    phone: "0670.42.32.04",
+    stopDeskPhone: "0670.42.32.05",
+  },
+
   // 19 - SETIF
-  { wilayaId: 19, wilayaName: 'Sétif', centerName: 'Sétif-Ville', address: 'Cité Dalas 3ème tranche, à côté de la maison LG et IRIS', phone: '0770.78.80.97', stopDeskPhone: '0770.18.85.05' },
-  { wilayaId: 19, wilayaName: 'Sétif', centerName: 'El Eulma', address: 'Logement covalente, derrière hôtel Rif, à coté la mosquée Imam Shaafei', phone: '0770.78.80.97', stopDeskPhone: '0770.80.40.09' },
-  
+  {
+    wilayaId: 19,
+    wilayaName: "Sétif",
+    centerName: "Sétif-Ville",
+    address: "Cité Dalas 3ème tranche, à côté de la maison LG et IRIS",
+    phone: "0770.78.80.97",
+    stopDeskPhone: "0770.18.85.05",
+  },
+  {
+    wilayaId: 19,
+    wilayaName: "Sétif",
+    centerName: "El Eulma",
+    address:
+      "Logement covalente, derrière hôtel Rif, à coté la mosquée Imam Shaafei",
+    phone: "0770.78.80.97",
+    stopDeskPhone: "0770.80.40.09",
+  },
+
   // 20 - SAIDA
-  { wilayaId: 20, wilayaName: 'Saïda', centerName: 'Saïda', address: 'Cité 5 juillet, en face la pharmacie 5 juillet', phone: '0795.27.12.65', stopDeskPhone: '0770.39.16.95' },
-  
+  {
+    wilayaId: 20,
+    wilayaName: "Saïda",
+    centerName: "Saïda",
+    address: "Cité 5 juillet, en face la pharmacie 5 juillet",
+    phone: "0795.27.12.65",
+    stopDeskPhone: "0770.39.16.95",
+  },
+
   // 21 - SKIKDA
-  { wilayaId: 21, wilayaName: 'Skikda', centerName: 'Skikda', address: 'Cité Mohammed Namous N°02 Mag 02, pas loin de Hammam Derradji', phone: '0770.30.88.09', stopDeskPhone: '0773.85.06.22' },
-  
+  {
+    wilayaId: 21,
+    wilayaName: "Skikda",
+    centerName: "Skikda",
+    address: "Cité Mohammed Namous N°02 Mag 02, pas loin de Hammam Derradji",
+    phone: "0770.30.88.09",
+    stopDeskPhone: "0773.85.06.22",
+  },
+
   // 22 - SIDI BEL ABBES
-  { wilayaId: 22, wilayaName: 'Sidi Bel Abbès', centerName: 'Sidi Bel Abbès', address: 'Ben Hamouda, En face à la Station de Tramway AADL Ben Hamouda, à côté des magasins Bébé Luxe', phone: '0778.15.20.27', stopDeskPhone: '0770.57.93.68' },
-  
+  {
+    wilayaId: 22,
+    wilayaName: "Sidi Bel Abbès",
+    centerName: "Sidi Bel Abbès",
+    address:
+      "Ben Hamouda, En face à la Station de Tramway AADL Ben Hamouda, à côté des magasins Bébé Luxe",
+    phone: "0778.15.20.27",
+    stopDeskPhone: "0770.57.93.68",
+  },
+
   // 23 - ANNABA
-  { wilayaId: 23, wilayaName: 'Annaba', centerName: 'Annaba-Ville', address: 'Rue l\'avant-port, à côté de supérette Ben Amara', phone: '0770.35.07.90', stopDeskPhone: '0657.81.29.59' },
-  { wilayaId: 23, wilayaName: 'Annaba', centerName: 'El Bouni', address: 'EL-Bouni, En face Algérie Télécom', phone: '0797.40.57.33', stopDeskPhone: '0770.29.99.73' },
-  
+  {
+    wilayaId: 23,
+    wilayaName: "Annaba",
+    centerName: "Annaba-Ville",
+    address: "Rue l'avant-port, à côté de supérette Ben Amara",
+    phone: "0770.35.07.90",
+    stopDeskPhone: "0657.81.29.59",
+  },
+  {
+    wilayaId: 23,
+    wilayaName: "Annaba",
+    centerName: "El Bouni",
+    address: "EL-Bouni, En face Algérie Télécom",
+    phone: "0797.40.57.33",
+    stopDeskPhone: "0770.29.99.73",
+  },
+
   // 24 - GUELMA
-  { wilayaId: 24, wilayaName: 'Guelma', centerName: 'Guelma', address: 'À côté de cafétera de la fontaine - fontaine la', phone: '0791.48.22.66', stopDeskPhone: '0770.96.22.21' },
-  
+  {
+    wilayaId: 24,
+    wilayaName: "Guelma",
+    centerName: "Guelma",
+    address: "À côté de cafétera de la fontaine - fontaine la",
+    phone: "0791.48.22.66",
+    stopDeskPhone: "0770.96.22.21",
+  },
+
   // 25 - CONSTANTINE
-  { wilayaId: 25, wilayaName: 'Constantine', centerName: 'Zouaghi', address: 'Cité tlemcen, 72, Zouaghi Slimen', phone: '0770.77.71.59', stopDeskPhone: '0770.54.53.05' },
-  { wilayaId: 25, wilayaName: 'Constantine', centerName: 'Ali Mendjeli', address: 'Zone industrielle, Nouvelle ville Ali Mendjeli', phone: '0770.77.71.59', stopDeskPhone: '0770.14.49.99' },
-  { wilayaId: 25, wilayaName: 'Constantine', centerName: 'Belle Vue', address: 'Belle vue', phone: '0770.77.71.59', stopDeskPhone: '0770.79.60.44' },
-  
+  {
+    wilayaId: 25,
+    wilayaName: "Constantine",
+    centerName: "Zouaghi",
+    address: "Cité tlemcen, 72, Zouaghi Slimen",
+    phone: "0770.77.71.59",
+    stopDeskPhone: "0770.54.53.05",
+  },
+  {
+    wilayaId: 25,
+    wilayaName: "Constantine",
+    centerName: "Ali Mendjeli",
+    address: "Zone industrielle, Nouvelle ville Ali Mendjeli",
+    phone: "0770.77.71.59",
+    stopDeskPhone: "0770.14.49.99",
+  },
+  {
+    wilayaId: 25,
+    wilayaName: "Constantine",
+    centerName: "Belle Vue",
+    address: "Belle vue",
+    phone: "0770.77.71.59",
+    stopDeskPhone: "0770.79.60.44",
+  },
+
   // 26 - MEDEA
-  { wilayaId: 26, wilayaName: 'Médéa', centerName: 'Médéa', address: 'Beziwech rue takhabit, au-dessous du cabinet de gynécologie dr khelifi', phone: '0779.46.02.70', stopDeskPhone: '0660.65.10.15' },
-  
+  {
+    wilayaId: 26,
+    wilayaName: "Médéa",
+    centerName: "Médéa",
+    address:
+      "Beziwech rue takhabit, au-dessous du cabinet de gynécologie dr khelifi",
+    phone: "0779.46.02.70",
+    stopDeskPhone: "0660.65.10.15",
+  },
+
   // 27 - MOSTAGANEM
-  { wilayaId: 27, wilayaName: 'Mostaganem', centerName: 'Mostaganem', address: 'Cité colonel Amirouche, En face Tribunal', phone: '0670.26.92.10', stopDeskPhone: '0660.67.37.78' },
-  
+  {
+    wilayaId: 27,
+    wilayaName: "Mostaganem",
+    centerName: "Mostaganem",
+    address: "Cité colonel Amirouche, En face Tribunal",
+    phone: "0670.26.92.10",
+    stopDeskPhone: "0660.67.37.78",
+  },
+
   // 28 - M\'SILA
-  { wilayaId: 28, wilayaName: "M'Sila", centerName: "M'Sila", address: 'Cité cheikh Mokrani, à côté de la mosquée Aisha oum el mouminine', phone: '0770.64.16.63', stopDeskPhone: '0770.52.29.72' },
-  { wilayaId: 28, wilayaName: "M'Sila", centerName: 'Bousaada', address: 'City HADHABA Rute Mouhamed Atik N° 52/11 Bousaada, À Côté de Branche Municipale', phone: '0770.29.78.55', stopDeskPhone: '0770.29.78.57' },
-  
+  {
+    wilayaId: 28,
+    wilayaName: "M'Sila",
+    centerName: "M'Sila",
+    address: "Cité cheikh Mokrani, à côté de la mosquée Aisha oum el mouminine",
+    phone: "0770.64.16.63",
+    stopDeskPhone: "0770.52.29.72",
+  },
+  {
+    wilayaId: 28,
+    wilayaName: "M'Sila",
+    centerName: "Bousaada",
+    address:
+      "City HADHABA Rute Mouhamed Atik N° 52/11 Bousaada, À Côté de Branche Municipale",
+    phone: "0770.29.78.55",
+    stopDeskPhone: "0770.29.78.57",
+  },
+
   // 29 - MASCARA
-  { wilayaId: 29, wilayaName: 'Mascara', centerName: 'Mascara', address: 'Rue Mahour Mahie Eddine, en face les Pompiers', phone: '0668.05.25.17', stopDeskPhone: '0793.57.76.79' },
-  
+  {
+    wilayaId: 29,
+    wilayaName: "Mascara",
+    centerName: "Mascara",
+    address: "Rue Mahour Mahie Eddine, en face les Pompiers",
+    phone: "0668.05.25.17",
+    stopDeskPhone: "0793.57.76.79",
+  },
+
   // 30 - OUARGLA
-  { wilayaId: 30, wilayaName: 'Ouargla', centerName: 'Ouargla', address: 'Cité Tazegrar, à côté hôtel de police', phone: '0792.78.57.46', stopDeskPhone: '0654.73.52.53' },
-  { wilayaId: 30, wilayaName: 'Ouargla', centerName: 'Hassi Messaoud', address: 'Cité 1850 logement, en face Maison KIA', phone: '0770.55.88.88', stopDeskPhone: '0654.74.52.53' },
-  
+  {
+    wilayaId: 30,
+    wilayaName: "Ouargla",
+    centerName: "Ouargla",
+    address: "Cité Tazegrar, à côté hôtel de police",
+    phone: "0792.78.57.46",
+    stopDeskPhone: "0654.73.52.53",
+  },
+  {
+    wilayaId: 30,
+    wilayaName: "Ouargla",
+    centerName: "Hassi Messaoud",
+    address: "Cité 1850 logement, en face Maison KIA",
+    phone: "0770.55.88.88",
+    stopDeskPhone: "0654.74.52.53",
+  },
+
   // 31 - ORAN
-  { wilayaId: 31, wilayaName: 'Oran', centerName: 'El Morchid', address: 'El morchid, à côté des magasins d\'électroménagers', phone: '0770.39.52.00', stopDeskPhone: '0770.12.84.13' },
-  { wilayaId: 31, wilayaName: 'Oran', centerName: 'Canastel', address: 'Quartier chahid Heni Bachir, Canastel, Route de CASNOS, Commune de Bir El Djir', phone: '0770.60.13.17', stopDeskPhone: '0770.76.80.77' },
-  { wilayaId: 31, wilayaName: 'Oran', centerName: 'Maraval', address: 'Derrière le magasin Look de Maraval', phone: '0770.16.96.59', stopDeskPhone: '0770.16.99.93' },
-  
+  {
+    wilayaId: 31,
+    wilayaName: "Oran",
+    centerName: "El Morchid",
+    address: "El morchid, à côté des magasins d'électroménagers",
+    phone: "0770.39.52.00",
+    stopDeskPhone: "0770.12.84.13",
+  },
+  {
+    wilayaId: 31,
+    wilayaName: "Oran",
+    centerName: "Canastel",
+    address:
+      "Quartier chahid Heni Bachir, Canastel, Route de CASNOS, Commune de Bir El Djir",
+    phone: "0770.60.13.17",
+    stopDeskPhone: "0770.76.80.77",
+  },
+  {
+    wilayaId: 31,
+    wilayaName: "Oran",
+    centerName: "Maraval",
+    address: "Derrière le magasin Look de Maraval",
+    phone: "0770.16.96.59",
+    stopDeskPhone: "0770.16.99.93",
+  },
+
   // 32 - EL BAYADH
-  { wilayaId: 32, wilayaName: 'El Bayadh', centerName: 'El Bayadh', address: 'Cité ancien stade, à côté de l\'huissier de justice Djouadi Malika', phone: '0770.22.96.32', stopDeskPhone: '0770.22.96.32' },
-  
+  {
+    wilayaId: 32,
+    wilayaName: "El Bayadh",
+    centerName: "El Bayadh",
+    address:
+      "Cité ancien stade, à côté de l'huissier de justice Djouadi Malika",
+    phone: "0770.22.96.32",
+    stopDeskPhone: "0770.22.96.32",
+  },
+
   // 34 - BORDJ BOU ARRERIDJ
-  { wilayaId: 34, wilayaName: 'Bordj Bou Arréridj', centerName: 'Bordj Bou Arréridj', address: 'Rue chelbabi Messaoud, En face showroom AMIR AUTO', phone: '0770.70.91.66', stopDeskPhone: '0770.42.76.33' },
-  
+  {
+    wilayaId: 34,
+    wilayaName: "Bordj Bou Arréridj",
+    centerName: "Bordj Bou Arréridj",
+    address: "Rue chelbabi Messaoud, En face showroom AMIR AUTO",
+    phone: "0770.70.91.66",
+    stopDeskPhone: "0770.42.76.33",
+  },
+
   // 35 - BOUMERDES
-  { wilayaId: 35, wilayaName: 'Boumerdès', centerName: 'Boumerdès', address: 'Rue Mohamed El Mahdi, Sur le chemin de l\'hôtel les Lilas', phone: '0773.74.98.99', stopDeskPhone: '0775.43.54.33' },
-  { wilayaId: 35, wilayaName: 'Boumerdès', centerName: 'Bordj Menaiel', address: 'Cooperative Elghazali, cité 20 aout, BORDJ MENAIEL, en face DR. SADJI', phone: '0775.06.72.89', stopDeskPhone: '0553.05.92.69' },
-  
+  {
+    wilayaId: 35,
+    wilayaName: "Boumerdès",
+    centerName: "Boumerdès",
+    address: "Rue Mohamed El Mahdi, Sur le chemin de l'hôtel les Lilas",
+    phone: "0773.74.98.99",
+    stopDeskPhone: "0775.43.54.33",
+  },
+  {
+    wilayaId: 35,
+    wilayaName: "Boumerdès",
+    centerName: "Bordj Menaiel",
+    address:
+      "Cooperative Elghazali, cité 20 aout, BORDJ MENAIEL, en face DR. SADJI",
+    phone: "0775.06.72.89",
+    stopDeskPhone: "0553.05.92.69",
+  },
+
   // 36 - EL TARF
-  { wilayaId: 36, wilayaName: 'El Tarf', centerName: 'El Tarf', address: 'Rue khmiss tine, en face le premier arrondissement', phone: '0670.43.22.38', stopDeskPhone: '0670.02.51.05' },
-  
+  {
+    wilayaId: 36,
+    wilayaName: "El Tarf",
+    centerName: "El Tarf",
+    address: "Rue khmiss tine, en face le premier arrondissement",
+    phone: "0670.43.22.38",
+    stopDeskPhone: "0670.02.51.05",
+  },
+
   // 38 - TISSEMSILT
-  { wilayaId: 38, wilayaName: 'Tissemsilt', centerName: 'Tissemsilt', address: 'Quartier El-Marjha, à côté de la pharmacie Ben Moussa', phone: '0770.79.80.60', stopDeskPhone: '0770.79.80.48' },
-  
+  {
+    wilayaId: 38,
+    wilayaName: "Tissemsilt",
+    centerName: "Tissemsilt",
+    address: "Quartier El-Marjha, à côté de la pharmacie Ben Moussa",
+    phone: "0770.79.80.60",
+    stopDeskPhone: "0770.79.80.48",
+  },
+
   // 39 - EL OUED
-  { wilayaId: 39, wilayaName: 'El Oued', centerName: 'El Oued', address: 'Cité Sidi Abdellah, derrière la poste', phone: '0791.69.99.02', stopDeskPhone: '0698.90.15.50' },
-  
+  {
+    wilayaId: 39,
+    wilayaName: "El Oued",
+    centerName: "El Oued",
+    address: "Cité Sidi Abdellah, derrière la poste",
+    phone: "0791.69.99.02",
+    stopDeskPhone: "0698.90.15.50",
+  },
+
   // 40 - KHENCHELA
-  { wilayaId: 40, wilayaName: 'Khenchela', centerName: 'Khenchela', address: 'Route Babar 1, Bou Maaraf, Lablali, a côté de supérette Merah et de la clinique Al-Ihsan', phone: '0560.62.23.25', stopDeskPhone: '0657.98.93.65' },
-  
+  {
+    wilayaId: 40,
+    wilayaName: "Khenchela",
+    centerName: "Khenchela",
+    address:
+      "Route Babar 1, Bou Maaraf, Lablali, a côté de supérette Merah et de la clinique Al-Ihsan",
+    phone: "0560.62.23.25",
+    stopDeskPhone: "0657.98.93.65",
+  },
+
   // 41 - SOUK AHRAS
-  { wilayaId: 41, wilayaName: 'Souk Ahras', centerName: 'Souk Ahras', address: 'Route nationale N°16 les sapins', phone: '0792.27.06.61', stopDeskPhone: '0770.96.16.15' },
-  
+  {
+    wilayaId: 41,
+    wilayaName: "Souk Ahras",
+    centerName: "Souk Ahras",
+    address: "Route nationale N°16 les sapins",
+    phone: "0792.27.06.61",
+    stopDeskPhone: "0770.96.16.15",
+  },
+
   // 42 - TIPAZA
-  { wilayaId: 42, wilayaName: 'Tipaza', centerName: 'Tipaza', address: 'La nouvelle AADL 1700, en face l\'ONPS', phone: '0770.42.07.24', stopDeskPhone: '0770.92.31.37' },
-  { wilayaId: 42, wilayaName: 'Tipaza', centerName: 'Kolea', address: 'Route d\'Alger à côté du café de ver', phone: '0551.20.04.59', stopDeskPhone: '0551.21.06.91' },
-  
+  {
+    wilayaId: 42,
+    wilayaName: "Tipaza",
+    centerName: "Tipaza",
+    address: "La nouvelle AADL 1700, en face l'ONPS",
+    phone: "0770.42.07.24",
+    stopDeskPhone: "0770.92.31.37",
+  },
+  {
+    wilayaId: 42,
+    wilayaName: "Tipaza",
+    centerName: "Kolea",
+    address: "Route d'Alger à côté du café de ver",
+    phone: "0551.20.04.59",
+    stopDeskPhone: "0551.21.06.91",
+  },
+
   // 43 - MILA
-  { wilayaId: 43, wilayaName: 'Mila', centerName: 'Mila', address: 'Jamouaa Milkia N°34, à côté l\'agence Sonalgaz', phone: '0657.22.47.73', stopDeskPhone: '0660.90.94.48' },
-  
+  {
+    wilayaId: 43,
+    wilayaName: "Mila",
+    centerName: "Mila",
+    address: "Jamouaa Milkia N°34, à côté l'agence Sonalgaz",
+    phone: "0657.22.47.73",
+    stopDeskPhone: "0660.90.94.48",
+  },
+
   // 44 - AIN DEFLA
-  { wilayaId: 44, wilayaName: 'Aïn Defla', centerName: 'Aïn Defla', address: 'Rond-point cyliste, En face la daira', phone: '0770.99.42.68', stopDeskPhone: '0770.99.45.81' },
-  
+  {
+    wilayaId: 44,
+    wilayaName: "Aïn Defla",
+    centerName: "Aïn Defla",
+    address: "Rond-point cyliste, En face la daira",
+    phone: "0770.99.42.68",
+    stopDeskPhone: "0770.99.45.81",
+  },
+
   // 45 - NAAMA
-  { wilayaId: 45, wilayaName: 'Naâma', centerName: 'Naâma', address: 'Route nationale n°6, en face de l\'hôtel Al Amin', phone: '0699.29.60.40', stopDeskPhone: '0770.03.39.23' },
-  
+  {
+    wilayaId: 45,
+    wilayaName: "Naâma",
+    centerName: "Naâma",
+    address: "Route nationale n°6, en face de l'hôtel Al Amin",
+    phone: "0699.29.60.40",
+    stopDeskPhone: "0770.03.39.23",
+  },
+
   // 46 - AIN TEMOUCHENT
-  { wilayaId: 46, wilayaName: 'Aïn Témouchent', centerName: 'Aïn Témouchent', address: 'Hai Ezaitoun, à côté de la mosquée Oussama Abu Zaid (El Bechari)', phone: '0770.76.66.82', stopDeskPhone: '0770.76.66.90' },
-  
+  {
+    wilayaId: 46,
+    wilayaName: "Aïn Témouchent",
+    centerName: "Aïn Témouchent",
+    address: "Hai Ezaitoun, à côté de la mosquée Oussama Abu Zaid (El Bechari)",
+    phone: "0770.76.66.82",
+    stopDeskPhone: "0770.76.66.90",
+  },
+
   // 47 - GHARDAIA
-  { wilayaId: 47, wilayaName: 'Ghardaïa', centerName: 'Ghardaïa', address: 'Hadj Masoud, en face au commissariat de police et de protection civile', phone: '0770.50.50.18', stopDeskPhone: '0654.76.52.52' },
-  
+  {
+    wilayaId: 47,
+    wilayaName: "Ghardaïa",
+    centerName: "Ghardaïa",
+    address:
+      "Hadj Masoud, en face au commissariat de police et de protection civile",
+    phone: "0770.50.50.18",
+    stopDeskPhone: "0654.76.52.52",
+  },
+
   // 48 - RELIZANE
-  { wilayaId: 48, wilayaName: 'Relizane', centerName: 'Relizane', address: 'Îlot 183, Boulevard de la république N°45, Centre-ville', phone: '0770.96.40.17', stopDeskPhone: '0770.96.40.52' },
-  
+  {
+    wilayaId: 48,
+    wilayaName: "Relizane",
+    centerName: "Relizane",
+    address: "Îlot 183, Boulevard de la république N°45, Centre-ville",
+    phone: "0770.96.40.17",
+    stopDeskPhone: "0770.96.40.52",
+  },
+
   // 49 - TIMIMOUN
-  { wilayaId: 49, wilayaName: 'Timimoun', centerName: 'Timimoun', address: 'En face la station El Haj Mamo, à côté de la pharmacie arabe', phone: '0658.50.49.36', stopDeskPhone: '0655.52.86.16' },
-  
+  {
+    wilayaId: 49,
+    wilayaName: "Timimoun",
+    centerName: "Timimoun",
+    address: "En face la station El Haj Mamo, à côté de la pharmacie arabe",
+    phone: "0658.50.49.36",
+    stopDeskPhone: "0655.52.86.16",
+  },
+
   // 51 - OULED DJELLAL
-  { wilayaId: 51, wilayaName: 'Ouled Djellal', centerName: 'Ouled Djellal', address: 'Rue Mithana, à côté la maison de jeune', phone: '0770.76.49.05', stopDeskPhone: '0770.01.70.55' },
-  
+  {
+    wilayaId: 51,
+    wilayaName: "Ouled Djellal",
+    centerName: "Ouled Djellal",
+    address: "Rue Mithana, à côté la maison de jeune",
+    phone: "0770.76.49.05",
+    stopDeskPhone: "0770.01.70.55",
+  },
+
   // 52 - BENI ABBES
-  { wilayaId: 52, wilayaName: 'Béni Abbès', centerName: 'Béni Abbès', address: 'Cité el moustakbel, en face de la nouvelle annexe de l\'APC et du nouveau siège de la nouvelle banque d\'algérie', phone: '0662.56.67.02', stopDeskPhone: '0656.92.83.39' },
-  
+  {
+    wilayaId: 52,
+    wilayaName: "Béni Abbès",
+    centerName: "Béni Abbès",
+    address:
+      "Cité el moustakbel, en face de la nouvelle annexe de l'APC et du nouveau siège de la nouvelle banque d'algérie",
+    phone: "0662.56.67.02",
+    stopDeskPhone: "0656.92.83.39",
+  },
+
   // 55 - TOUGGOURT
-  { wilayaId: 55, wilayaName: 'Touggourt', centerName: 'Touggourt', address: 'Cité sidi abdessalem, Entre BEA et CPA', phone: '0791.69.99.02', stopDeskPhone: '0663.66.64.22' },
+  {
+    wilayaId: 55,
+    wilayaName: "Touggourt",
+    centerName: "Touggourt",
+    address: "Cité sidi abdessalem, Entre BEA et CPA",
+    phone: "0791.69.99.02",
+    stopDeskPhone: "0663.66.64.22",
+  },
 ];
 
 // Get stop desks by wilaya ID
 export function getZRStopDesks(wilayaId: number): ZRStopDesk[] {
-  return ZR_EXPRESS_STOPDESKS.filter(sd => sd.wilayaId === wilayaId);
+  return ZR_EXPRESS_STOPDESKS.filter((sd) => sd.wilayaId === wilayaId);
 }
 
 // Check if wilaya has ZR Express stop desk
 export function hasZRStopDesk(wilayaId: number): boolean {
-  return ZR_EXPRESS_STOPDESKS.some(sd => sd.wilayaId === wilayaId);
+  return ZR_EXPRESS_STOPDESKS.some((sd) => sd.wilayaId === wilayaId);
 }
 
 // Get all wilayas with stop desks
 export function getZRStopDeskWilayas(): number[] {
-  return [...new Set(ZR_EXPRESS_STOPDESKS.map(sd => sd.wilayaId))];
+  return [...new Set(ZR_EXPRESS_STOPDESKS.map((sd) => sd.wilayaId))];
 }
 
 // Total stop desk centers
diff --git a/src/lib/zrexpress.ts b/src/lib/zrexpress.ts
index 3aabee4..fefaf37 100644
--- a/src/lib/zrexpress.ts
+++ b/src/lib/zrexpress.ts
@@ -5,328 +5,335 @@
 
 // Types
 export interface ZRColis {
-    Tracking?: string;
-    TypeLivraison: '0' | '1'; // 0 = Domicile, 1 = Stop Desk
-    TypeColis: '0' | '1'; // 0 = Normal, 1 = Échange
-    Confrimee?: '1' | ''; // 1 = Prêt à expédier directement
-    Client: string;
-    MobileA: string;
-    MobileB?: string;
-    Adresse: string;
-    IDWilaya: string;
-    Commune: string;
-    Total: string;
-    Note?: string;
-    TProduit: string;
-    id_Externe?: string;
-    Source?: string;
+  Tracking?: string;
+  TypeLivraison: "0" | "1"; // 0 = Domicile, 1 = Stop Desk
+  TypeColis: "0" | "1"; // 0 = Normal, 1 = Échange
+  Confrimee?: "1" | ""; // 1 = Prêt à expédier directement
+  Client: string;
+  MobileA: string;
+  MobileB?: string;
+  Adresse: string;
+  IDWilaya: string;
+  Commune: string;
+  Total: string;
+  Note?: string;
+  TProduit: string;
+  id_Externe?: string;
+  Source?: string;
 }
 
 export interface ZRColisResponse {
-    success: boolean;
-    tracking?: string;
-    message?: string;
-    data?: any;
+  success: boolean;
+  tracking?: string;
+  message?: string;
+  data?: any;
 }
 
 export interface ZRTarif {
-    wilaya_id: string;
-    wilaya_name: string;
-    tarif_domicile: number;
-    tarif_stopdesk: number;
+  wilaya_id: string;
+  wilaya_name: string;
+  tarif_domicile: number;
+  tarif_stopdesk: number;
 }
 
 export interface ZRTrackingInfo {
-    Tracking: string;
-    Situation: string;
-    Client: string;
-    Wilaya: string;
-    Commune: string;
-    Total: string;
-    DateCreation: string;
-    DateMAJ: string;
+  Tracking: string;
+  Situation: string;
+  Client: string;
+  Wilaya: string;
+  Commune: string;
+  Total: string;
+  DateCreation: string;
+  DateMAJ: string;
 }
 
 // Configuration
 const ZR_CONFIG = {
-    baseUrl: process.env.ZR_EXPRESS_API_URL || 'https://procolis.com/api_v1',
-    token: process.env.ZR_EXPRESS_TOKEN || '',
-    key: process.env.ZR_EXPRESS_KEY || '',
+  baseUrl: process.env.ZR_EXPRESS_API_URL || "https://procolis.com/api_v1",
+  token: process.env.ZR_EXPRESS_TOKEN || "",
+  key: process.env.ZR_EXPRESS_KEY || "",
 };
 
 // Client API
 class ZRExpressClient {
-    private token: string;
-    private key: string;
-    private baseUrl: string;
+  private token: string;
+  private key: string;
+  private baseUrl: string;
 
-    constructor(token?: string, key?: string) {
-        this.token = token || ZR_CONFIG.token;
-        this.key = key || ZR_CONFIG.key;
-        this.baseUrl = ZR_CONFIG.baseUrl;
-    }
+  constructor(token?: string, key?: string) {
+    this.token = token || ZR_CONFIG.token;
+    this.key = key || ZR_CONFIG.key;
+    this.baseUrl = ZR_CONFIG.baseUrl;
+  }
 
-    private async request<T>(
-        endpoint: string,
-        method: 'GET' | 'POST' = 'GET',
-        body?: any
-    ): Promise<T> {
-        const url = `${this.baseUrl}${endpoint}`;
+  private async request<T>(
+    endpoint: string,
+    method: "GET" | "POST" = "GET",
+    body?: any,
+  ): Promise<T> {
+    const url = `${this.baseUrl}${endpoint}`;
 
-        const headers: HeadersInit = {
-            'Content-Type': 'application/json',
-            'token': this.token,
-            'key': this.key,
-        };
+    const headers: HeadersInit = {
+      "Content-Type": "application/json",
+      token: this.token,
+      key: this.key,
+    };
 
-        try {
-            const response = await fetch(url, {
-                method,
-                headers,
-                body: body ? JSON.stringify(body) : undefined,
-            });
+    try {
+      const response = await fetch(url, {
+        method,
+        headers,
+        body: body ? JSON.stringify(body) : undefined,
+      });
 
-            const data = await response.json();
-            return data;
-        } catch (error) {
-            console.error('ZR Express API Error:', error);
-            throw error;
-        }
+      const data = await response.json();
+      return data;
+    } catch (error) {
+      console.error("ZR Express API Error:", error);
+      throw error;
     }
+  }
 
-    /**
-     * Tester la connexion API
-     */
-    async testConnection(): Promise<{ success: boolean; message: string }> {
-        try {
-            await this.request('/token', 'GET');
-            return { success: true, message: 'Connexion réussie' };
-        } catch (error) {
-            return { success: false, message: 'Échec de connexion' };
-        }
+  /**
+   * Tester la connexion API
+   */
+  async testConnection(): Promise<{ success: boolean; message: string }> {
+    try {
+      await this.request("/token", "GET");
+      return { success: true, message: "Connexion réussie" };
+    } catch (error) {
+      return { success: false, message: "Échec de connexion" };
     }
+  }
 
-    /**
-     * Récupérer les tarifs par wilaya
-     */
-    async getTarification(): Promise<ZRTarif[]> {
-        return this.request<ZRTarif[]>('/tarification', 'POST');
-    }
+  /**
+   * Récupérer les tarifs par wilaya
+   */
+  async getTarification(): Promise<ZRTarif[]> {
+    return this.request<ZRTarif[]>("/tarification", "POST");
+  }
 
-    /**
-     * Ajouter un ou plusieurs colis
-     */
-    async addColis(colis: ZRColis[]): Promise<any> {
-        return this.request<any>('/add_colis', 'POST', { Colis: colis });
-    }
+  /**
+   * Ajouter un ou plusieurs colis
+   */
+  async addColis(colis: ZRColis[]): Promise<any> {
+    return this.request<any>("/add_colis", "POST", { Colis: colis });
+  }
 
-    /**
-     * Ajouter un seul colis (helper)
-     */
-    async createShipment(colis: ZRColis): Promise<ZRColisResponse> {
-        try {
-            const result = await this.addColis([colis]);
-            
-            // Handle different response formats
-            // Format 1: { success: true, tracking: "xxx" }
-            if (result?.success && result?.tracking) {
-                return result;
-            }
-            
-            // Format 2: { Colis: [{ Tracking: "xxx" }] }
-            if (result?.Colis && Array.isArray(result.Colis) && result.Colis[0]?.Tracking) {
-                return {
-                    success: true,
-                    tracking: result.Colis[0].Tracking,
-                    message: 'Colis créé'
-                };
-            }
-            
-            // Format 3: Array response [{ Tracking: "xxx" }]
-            if (Array.isArray(result) && result[0]?.Tracking) {
-                return {
-                    success: true,
-                    tracking: result[0].Tracking,
-                    message: 'Colis créé'
-                };
-            }
-            
-            // Format 4: Direct tracking in response
-            if (result?.Tracking) {
-                return {
-                    success: true,
-                    tracking: result.Tracking,
-                    message: 'Colis créé'
-                };
-            }
-            
-            // Error response
-            return {
-                success: false,
-                message: result?.message || result?.error || 'Format de réponse non reconnu'
-            };
-        } catch (error: any) {
-            console.error('ZR Express createShipment error:', error);
-            return {
-                success: false,
-                message: error?.message || 'Erreur création colis ZR Express'
-            };
-        }
-    }
+  /**
+   * Ajouter un seul colis (helper)
+   */
+  async createShipment(colis: ZRColis): Promise<ZRColisResponse> {
+    try {
+      const result = await this.addColis([colis]);
 
-    /**
-     * Lire les informations de tracking
-     */
-    async getTrackingInfo(trackingNumbers: string[]): Promise<ZRTrackingInfo[]> {
-        const colis = trackingNumbers.map(t => ({ Tracking: t }));
-        return this.request<ZRTrackingInfo[]>('/lire', 'POST', { Colis: colis });
-    }
+      // Handle different response formats
+      // Format 1: { success: true, tracking: "xxx" }
+      if (result?.success && result?.tracking) {
+        return result;
+      }
 
-    /**
-     * Marquer comme prêt à expédier
-     */
-    async markReadyToShip(trackingNumbers: string[]): Promise<any> {
-        const colis = trackingNumbers.map(t => ({ Tracking: t }));
-        return this.request('/pret', 'POST', { Colis: colis });
-    }
+      // Format 2: { Colis: [{ Tracking: "xxx" }] }
+      if (
+        result?.Colis &&
+        Array.isArray(result.Colis) &&
+        result.Colis[0]?.Tracking
+      ) {
+        return {
+          success: true,
+          tracking: result.Colis[0].Tracking,
+          message: "Colis créé",
+        };
+      }
 
-    /**
-     * Récupérer les derniers colis mis à jour
-     */
-    async getLastUpdated(): Promise<ZRTrackingInfo[]> {
-        return this.request<ZRTrackingInfo[]>('/tarification', 'GET');
+      // Format 3: Array response [{ Tracking: "xxx" }]
+      if (Array.isArray(result) && result[0]?.Tracking) {
+        return {
+          success: true,
+          tracking: result[0].Tracking,
+          message: "Colis créé",
+        };
+      }
+
+      // Format 4: Direct tracking in response
+      if (result?.Tracking) {
+        return {
+          success: true,
+          tracking: result.Tracking,
+          message: "Colis créé",
+        };
+      }
+
+      // Error response
+      return {
+        success: false,
+        message:
+          result?.message || result?.error || "Format de réponse non reconnu",
+      };
+    } catch (error: any) {
+      console.error("ZR Express createShipment error:", error);
+      return {
+        success: false,
+        message: error?.message || "Erreur création colis ZR Express",
+      };
     }
+  }
+
+  /**
+   * Lire les informations de tracking
+   */
+  async getTrackingInfo(trackingNumbers: string[]): Promise<ZRTrackingInfo[]> {
+    const colis = trackingNumbers.map((t) => ({ Tracking: t }));
+    return this.request<ZRTrackingInfo[]>("/lire", "POST", { Colis: colis });
+  }
+
+  /**
+   * Marquer comme prêt à expédier
+   */
+  async markReadyToShip(trackingNumbers: string[]): Promise<any> {
+    const colis = trackingNumbers.map((t) => ({ Tracking: t }));
+    return this.request("/pret", "POST", { Colis: colis });
+  }
+
+  /**
+   * Récupérer les derniers colis mis à jour
+   */
+  async getLastUpdated(): Promise<ZRTrackingInfo[]> {
+    return this.request<ZRTrackingInfo[]>("/tarification", "GET");
+  }
 }
 
 // Singleton instance
 let zrClient: ZRExpressClient | null = null;
 
 export function getZRClient(): ZRExpressClient {
-    if (!zrClient) {
-        zrClient = new ZRExpressClient();
-    }
-    return zrClient;
+  if (!zrClient) {
+    zrClient = new ZRExpressClient();
+  }
+  return zrClient;
 }
 
 // Helper: Convertir une commande Harp en colis ZR Express
 export function orderToZRColis(order: {
-    id: string;
-    customerName: string;
-    customerPhone: string;
-    address: string;
-    wilaya: string;
-    commune: string;
-    total: number;
-    items: any[];
-    deliveryType?: 'DOMICILE' | 'STOP_DESK';
-    notes?: string;
+  id: string;
+  customerName: string;
+  customerPhone: string;
+  address: string;
+  wilaya: string;
+  commune: string;
+  total: number;
+  items: any[];
+  deliveryType?: "DOMICILE" | "STOP_DESK";
+  notes?: string;
 }): ZRColis {
-    // Extraire le numéro de wilaya (ex: "16" pour Alger)
-    const wilayaId = WILAYAS.find(w => 
+  // Extraire le numéro de wilaya (ex: "16" pour Alger)
+  const wilayaId =
+    WILAYAS.find(
+      (w) =>
         w.name.toLowerCase() === order.wilaya.toLowerCase() ||
-        w.name_ar === order.wilaya
-    )?.id || '16';
+        w.name_ar === order.wilaya,
+    )?.id || "16";
 
-    // Description des produits
-    const productDescription = order.items
-        .map((item: any) => `${item.quantity}x ${item.nameFr || item.name}`)
-        .join(', ');
+  // Description des produits
+  const productDescription = order.items
+    .map((item: any) => `${item.quantity}x ${item.nameFr || item.name}`)
+    .join(", ");
 
-    return {
-        TypeLivraison: order.deliveryType === 'STOP_DESK' ? '1' : '0',
-        TypeColis: '0',
-        Confrimee: '1', // Prêt à expédier
-        Client: order.customerName,
-        MobileA: order.customerPhone.replace(/\s/g, ''),
-        Adresse: order.address,
-        IDWilaya: wilayaId,
-        Commune: order.commune,
-        Total: order.total.toString(),
-        Note: order.notes || '',
-        TProduit: productDescription,
-        id_Externe: order.id,
-    };
+  return {
+    TypeLivraison: order.deliveryType === "STOP_DESK" ? "1" : "0",
+    TypeColis: "0",
+    Confrimee: "1", // Prêt à expédier
+    Client: order.customerName,
+    MobileA: order.customerPhone.replace(/\s/g, ""),
+    Adresse: order.address,
+    IDWilaya: wilayaId,
+    Commune: order.commune,
+    Total: order.total.toString(),
+    Note: order.notes || "",
+    TProduit: productDescription,
+    id_Externe: order.id,
+  };
 }
 
 // Mapper le statut ZR Express vers statut Harp
 export function mapZRStatusToHarpStatus(zrStatus: string): string {
-    const statusMap: Record<string, string> = {
-        'En préparation': 'CONFIRMED',
-        'Prêt à expédier': 'CONFIRMED',
-        'En cours de ramassage': 'CONFIRMED',
-        'Ramassé': 'SHIPPED',
-        'Au hub': 'SHIPPED',
-        'En transit': 'SHIPPED',
-        'Reçu à destination': 'SHIPPED',
-        'En cours de livraison': 'SHIPPED',
-        'Livré': 'DELIVERED',
-        'Livré (payé)': 'DELIVERED',
-        'Retourné': 'CANCELLED',
-        'Annulé': 'CANCELLED',
-    };
-    return statusMap[zrStatus] || 'PENDING';
+  const statusMap: Record<string, string> = {
+    "En préparation": "CONFIRMED",
+    "Prêt à expédier": "CONFIRMED",
+    "En cours de ramassage": "CONFIRMED",
+    Ramassé: "SHIPPED",
+    "Au hub": "SHIPPED",
+    "En transit": "SHIPPED",
+    "Reçu à destination": "SHIPPED",
+    "En cours de livraison": "SHIPPED",
+    Livré: "DELIVERED",
+    "Livré (payé)": "DELIVERED",
+    Retourné: "CANCELLED",
+    Annulé: "CANCELLED",
+  };
+  return statusMap[zrStatus] || "PENDING";
 }
 
 // Liste des 58 wilayas d'Algérie
 export const WILAYAS = [
-    { id: '1', name: 'Adrar', name_ar: 'أدرار' },
-    { id: '2', name: 'Chlef', name_ar: 'الشلف' },
-    { id: '3', name: 'Laghouat', name_ar: 'الأغواط' },
-    { id: '4', name: 'Oum El Bouaghi', name_ar: 'أم البواقي' },
-    { id: '5', name: 'Batna', name_ar: 'باتنة' },
-    { id: '6', name: 'Béjaïa', name_ar: 'بجاية' },
-    { id: '7', name: 'Biskra', name_ar: 'بسكرة' },
-    { id: '8', name: 'Béchar', name_ar: 'بشار' },
-    { id: '9', name: 'Blida', name_ar: 'البليدة' },
-    { id: '10', name: 'Bouira', name_ar: 'البويرة' },
-    { id: '11', name: 'Tamanrasset', name_ar: 'تمنراست' },
-    { id: '12', name: 'Tébessa', name_ar: 'تبسة' },
-    { id: '13', name: 'Tlemcen', name_ar: 'تلمسان' },
-    { id: '14', name: 'Tiaret', name_ar: 'تيارت' },
-    { id: '15', name: 'Tizi Ouzou', name_ar: 'تيزي وزو' },
-    { id: '16', name: 'Alger', name_ar: 'الجزائر' },
-    { id: '17', name: 'Djelfa', name_ar: 'الجلفة' },
-    { id: '18', name: 'Jijel', name_ar: 'جيجل' },
-    { id: '19', name: 'Sétif', name_ar: 'سطيف' },
-    { id: '20', name: 'Saïda', name_ar: 'سعيدة' },
-    { id: '21', name: 'Skikda', name_ar: 'سكيكدة' },
-    { id: '22', name: 'Sidi Bel Abbès', name_ar: 'سيدي بلعباس' },
-    { id: '23', name: 'Annaba', name_ar: 'عنابة' },
-    { id: '24', name: 'Guelma', name_ar: 'قالمة' },
-    { id: '25', name: 'Constantine', name_ar: 'قسنطينة' },
-    { id: '26', name: 'Médéa', name_ar: 'المدية' },
-    { id: '27', name: 'Mostaganem', name_ar: 'مستغانم' },
-    { id: '28', name: "M'Sila", name_ar: 'المسيلة' },
-    { id: '29', name: 'Mascara', name_ar: 'معسكر' },
-    { id: '30', name: 'Ouargla', name_ar: 'ورقلة' },
-    { id: '31', name: 'Oran', name_ar: 'وهران' },
-    { id: '32', name: 'El Bayadh', name_ar: 'البيض' },
-    { id: '33', name: 'Illizi', name_ar: 'إليزي' },
-    { id: '34', name: 'Bordj Bou Arreridj', name_ar: 'برج بوعريريج' },
-    { id: '35', name: 'Boumerdès', name_ar: 'بومرداس' },
-    { id: '36', name: 'El Tarf', name_ar: 'الطارف' },
-    { id: '37', name: 'Tindouf', name_ar: 'تندوف' },
-    { id: '38', name: 'Tissemsilt', name_ar: 'تيسمسيلت' },
-    { id: '39', name: 'El Oued', name_ar: 'الوادي' },
-    { id: '40', name: 'Khenchela', name_ar: 'خنشلة' },
-    { id: '41', name: 'Souk Ahras', name_ar: 'سوق أهراس' },
-    { id: '42', name: 'Tipaza', name_ar: 'تيبازة' },
-    { id: '43', name: 'Mila', name_ar: 'ميلة' },
-    { id: '44', name: 'Aïn Defla', name_ar: 'عين الدفلى' },
-    { id: '45', name: 'Naâma', name_ar: 'النعامة' },
-    { id: '46', name: 'Aïn Témouchent', name_ar: 'عين تموشنت' },
-    { id: '47', name: 'Ghardaïa', name_ar: 'غرداية' },
-    { id: '48', name: 'Relizane', name_ar: 'غليزان' },
-    { id: '49', name: 'El M\'Ghair', name_ar: 'المغير' },
-    { id: '50', name: 'El Meniaa', name_ar: 'المنيعة' },
-    { id: '51', name: 'Ouled Djellal', name_ar: 'أولاد جلال' },
-    { id: '52', name: 'Bordj Baji Mokhtar', name_ar: 'برج باجي مختار' },
-    { id: '53', name: 'Béni Abbès', name_ar: 'بني عباس' },
-    { id: '54', name: 'Timimoun', name_ar: 'تيميمون' },
-    { id: '55', name: 'Touggourt', name_ar: 'تقرت' },
-    { id: '56', name: 'Djanet', name_ar: 'جانت' },
-    { id: '57', name: 'In Salah', name_ar: 'عين صالح' },
-    { id: '58', name: 'In Guezzam', name_ar: 'عين قزام' },
+  { id: "1", name: "Adrar", name_ar: "أدرار" },
+  { id: "2", name: "Chlef", name_ar: "الشلف" },
+  { id: "3", name: "Laghouat", name_ar: "الأغواط" },
+  { id: "4", name: "Oum El Bouaghi", name_ar: "أم البواقي" },
+  { id: "5", name: "Batna", name_ar: "باتنة" },
+  { id: "6", name: "Béjaïa", name_ar: "بجاية" },
+  { id: "7", name: "Biskra", name_ar: "بسكرة" },
+  { id: "8", name: "Béchar", name_ar: "بشار" },
+  { id: "9", name: "Blida", name_ar: "البليدة" },
+  { id: "10", name: "Bouira", name_ar: "البويرة" },
+  { id: "11", name: "Tamanrasset", name_ar: "تمنراست" },
+  { id: "12", name: "Tébessa", name_ar: "تبسة" },
+  { id: "13", name: "Tlemcen", name_ar: "تلمسان" },
+  { id: "14", name: "Tiaret", name_ar: "تيارت" },
+  { id: "15", name: "Tizi Ouzou", name_ar: "تيزي وزو" },
+  { id: "16", name: "Alger", name_ar: "الجزائر" },
+  { id: "17", name: "Djelfa", name_ar: "الجلفة" },
+  { id: "18", name: "Jijel", name_ar: "جيجل" },
+  { id: "19", name: "Sétif", name_ar: "سطيف" },
+  { id: "20", name: "Saïda", name_ar: "سعيدة" },
+  { id: "21", name: "Skikda", name_ar: "سكيكدة" },
+  { id: "22", name: "Sidi Bel Abbès", name_ar: "سيدي بلعباس" },
+  { id: "23", name: "Annaba", name_ar: "عنابة" },
+  { id: "24", name: "Guelma", name_ar: "قالمة" },
+  { id: "25", name: "Constantine", name_ar: "قسنطينة" },
+  { id: "26", name: "Médéa", name_ar: "المدية" },
+  { id: "27", name: "Mostaganem", name_ar: "مستغانم" },
+  { id: "28", name: "M'Sila", name_ar: "المسيلة" },
+  { id: "29", name: "Mascara", name_ar: "معسكر" },
+  { id: "30", name: "Ouargla", name_ar: "ورقلة" },
+  { id: "31", name: "Oran", name_ar: "وهران" },
+  { id: "32", name: "El Bayadh", name_ar: "البيض" },
+  { id: "33", name: "Illizi", name_ar: "إليزي" },
+  { id: "34", name: "Bordj Bou Arreridj", name_ar: "برج بوعريريج" },
+  { id: "35", name: "Boumerdès", name_ar: "بومرداس" },
+  { id: "36", name: "El Tarf", name_ar: "الطارف" },
+  { id: "37", name: "Tindouf", name_ar: "تندوف" },
+  { id: "38", name: "Tissemsilt", name_ar: "تيسمسيلت" },
+  { id: "39", name: "El Oued", name_ar: "الوادي" },
+  { id: "40", name: "Khenchela", name_ar: "خنشلة" },
+  { id: "41", name: "Souk Ahras", name_ar: "سوق أهراس" },
+  { id: "42", name: "Tipaza", name_ar: "تيبازة" },
+  { id: "43", name: "Mila", name_ar: "ميلة" },
+  { id: "44", name: "Aïn Defla", name_ar: "عين الدفلى" },
+  { id: "45", name: "Naâma", name_ar: "النعامة" },
+  { id: "46", name: "Aïn Témouchent", name_ar: "عين تموشنت" },
+  { id: "47", name: "Ghardaïa", name_ar: "غرداية" },
+  { id: "48", name: "Relizane", name_ar: "غليزان" },
+  { id: "49", name: "El M'Ghair", name_ar: "المغير" },
+  { id: "50", name: "El Meniaa", name_ar: "المنيعة" },
+  { id: "51", name: "Ouled Djellal", name_ar: "أولاد جلال" },
+  { id: "52", name: "Bordj Baji Mokhtar", name_ar: "برج باجي مختار" },
+  { id: "53", name: "Béni Abbès", name_ar: "بني عباس" },
+  { id: "54", name: "Timimoun", name_ar: "تيميمون" },
+  { id: "55", name: "Touggourt", name_ar: "تقرت" },
+  { id: "56", name: "Djanet", name_ar: "جانت" },
+  { id: "57", name: "In Salah", name_ar: "عين صالح" },
+  { id: "58", name: "In Guezzam", name_ar: "عين قزام" },
 ];
 
 export default ZRExpressClient;
diff --git a/src/middleware.ts b/src/middleware.ts
index 0e8c2b0..75ea391 100644
--- a/src/middleware.ts
+++ b/src/middleware.ts
@@ -6,18 +6,18 @@ export default withAuth(
     const token = req.nextauth.token;
     const isAdminRoute = req.nextUrl.pathname.startsWith("/admin");
     const isAdminLogin = req.nextUrl.pathname === "/admin/login";
-    
+
     // Allow access to admin login page without auth
     if (isAdminLogin) {
       return NextResponse.next();
     }
-    
+
     // For admin routes, check if user has admin role
     if (isAdminRoute && token?.role !== "admin") {
       // Redirect non-admin users to admin login
       return NextResponse.redirect(new URL("/admin/login", req.url));
     }
-    
+
     return NextResponse.next();
   },
   {
@@ -34,7 +34,7 @@ export default withAuth(
     pages: {
       signIn: "/admin/login", // Redirect to admin login for admin routes
     },
-  }
+  },
 );
 
 export const config = {
diff --git a/src/types/api.ts b/src/types/api.ts
index 61848c7..0b211b7 100644
--- a/src/types/api.ts
+++ b/src/types/api.ts
@@ -5,296 +5,296 @@
 // ---- Yalidine Types ----
 
 export interface YalidineWilaya {
-    id: number;
-    name: string;
-    name_ar?: string;
+  id: number;
+  name: string;
+  name_ar?: string;
 }
 
 export interface YalidineCommune {
-    id: number;
-    name: string;
-    name_ar?: string;
-    wilaya_id: number;
-    wilaya_name?: string;
+  id: number;
+  name: string;
+  name_ar?: string;
+  wilaya_id: number;
+  wilaya_name?: string;
 }
 
 export interface YalidineCentre {
-    centre_id: number;
-    name: string;
-    commune_id: number;
-    commune_name: string;
-    wilaya_id: number;
-    wilaya_name: string;
-    address?: string;
-    gps_longitude?: string;
-    gps_latitude?: string;
+  centre_id: number;
+  name: string;
+  commune_id: number;
+  commune_name: string;
+  wilaya_id: number;
+  wilaya_name: string;
+  address?: string;
+  gps_longitude?: string;
+  gps_latitude?: string;
 }
 
 export interface YalidineDeliveryFee {
-    wilaya_id: number;
-    wilaya_name: string;
-    home_fee: number;
-    desk_fee: number;
-    is_deliverable: boolean;
+  wilaya_id: number;
+  wilaya_name: string;
+  home_fee: number;
+  desk_fee: number;
+  is_deliverable: boolean;
 }
 
 export interface YalidineParcel {
-    tracking: string;
-    order_id?: string;
-    firstname: string;
-    familyname: string;
-    contact_phone: string;
-    address: string;
-    to_commune_name: string;
-    to_wilaya_name: string;
-    product_list: string;
-    price: number;
-    freeshipping: boolean;
-    is_stopdesk: boolean;
-    stopdesk_id?: number;
-    has_exchange: boolean;
-    product_to_collect?: string;
+  tracking: string;
+  order_id?: string;
+  firstname: string;
+  familyname: string;
+  contact_phone: string;
+  address: string;
+  to_commune_name: string;
+  to_wilaya_name: string;
+  product_list: string;
+  price: number;
+  freeshipping: boolean;
+  is_stopdesk: boolean;
+  stopdesk_id?: number;
+  has_exchange: boolean;
+  product_to_collect?: string;
 }
 
 export interface YalidineParcelResponse {
-    tracking: string;
-    label?: string;
-    order_id?: string;
-    status?: string;
+  tracking: string;
+  label?: string;
+  order_id?: string;
+  status?: string;
 }
 
 export interface YalidineTrackingEvent {
-    date: string;
-    status: string;
-    status_ar?: string;
-    center?: string;
-    note?: string;
+  date: string;
+  status: string;
+  status_ar?: string;
+  center?: string;
+  note?: string;
 }
 
 export interface YalidineTrackingResponse {
-    tracking: string;
-    status: string;
-    status_ar?: string;
-    history: YalidineTrackingEvent[];
+  tracking: string;
+  status: string;
+  status_ar?: string;
+  history: YalidineTrackingEvent[];
 }
 
 export interface YalidineApiResponse<T> {
-    success: boolean;
-    data?: T;
-    error?: string;
-    message?: string;
+  success: boolean;
+  data?: T;
+  error?: string;
+  message?: string;
 }
 
 // ---- ZR Express Types ----
 
 export interface ZRWilaya {
-    id: number;
-    name: string;
-    ar_name?: string;
-    code?: string;
+  id: number;
+  name: string;
+  ar_name?: string;
+  code?: string;
 }
 
 export interface ZRCommune {
-    id: number;
-    name: string;
-    ar_name?: string;
-    wilaya_id: number;
+  id: number;
+  name: string;
+  ar_name?: string;
+  wilaya_id: number;
 }
 
 export interface ZRStopDesk {
-    id: number;
-    name: string;
-    address: string;
-    wilaya_id: number;
-    commune_id: number;
-    phone?: string;
+  id: number;
+  name: string;
+  address: string;
+  wilaya_id: number;
+  commune_id: number;
+  phone?: string;
 }
 
 export interface ZRColis {
-    Ession: string;
-    Nom: string;
-    Telephone: string;
-    Telephone_2?: string;
-    Adresse: string;
-    Wilaya: string;
-    Commune: string;
-    Produit: string;
-    Prix: number;
-    Remarque?: string;
-    id_Externe?: string;
-    Source?: string;
-    Poids?: number;
-    Longueur?: number;
-    Largeur?: number;
-    Hauteur?: number;
-    Fragile?: number;
-    Ouverture?: number;
-    Echange?: number;
-    Recouvrement?: number;
-    StopDesk?: number;
+  Ession: string;
+  Nom: string;
+  Telephone: string;
+  Telephone_2?: string;
+  Adresse: string;
+  Wilaya: string;
+  Commune: string;
+  Produit: string;
+  Prix: number;
+  Remarque?: string;
+  id_Externe?: string;
+  Source?: string;
+  Poids?: number;
+  Longueur?: number;
+  Largeur?: number;
+  Hauteur?: number;
+  Fragile?: number;
+  Ouverture?: number;
+  Echange?: number;
+  Recouvrement?: number;
+  StopDesk?: number;
 }
 
 export interface ZRColisResponse {
-    success: boolean;
-    tracking?: string;
-    Tracking?: string;
-    message?: string;
-    error?: string;
+  success: boolean;
+  tracking?: string;
+  Tracking?: string;
+  message?: string;
+  error?: string;
 }
 
 export interface ZRTrackingEvent {
-    date: string;
-    status: string;
-    location?: string;
-    note?: string;
+  date: string;
+  status: string;
+  location?: string;
+  note?: string;
 }
 
 export interface ZRTrackingResponse {
-    tracking: string;
-    status: string;
-    statusCode?: number;
-    history?: ZRTrackingEvent[];
+  tracking: string;
+  status: string;
+  statusCode?: number;
+  history?: ZRTrackingEvent[];
 }
 
 export interface ZRApiResponse<T> {
-    success: boolean;
-    data?: T;
-    Colis?: T[];
-    error?: string;
-    message?: string;
+  success: boolean;
+  data?: T;
+  Colis?: T[];
+  error?: string;
+  message?: string;
 }
 
 // ---- Order Types ----
 
 export interface OrderItem {
-    id: string;
-    productId?: string;
-    productName: string;
-    size: string;
-    color: string;
-    quantity: number;
-    price: number;
+  id: string;
+  productId?: string;
+  productName: string;
+  size: string;
+  color: string;
+  quantity: number;
+  price: number;
 }
 
 export interface Order {
-    id: string;
-    customerName: string;
-    customerPhone: string;
-    customerAddress: string;
-    customerCity: string;
-    customerWilaya: string;
-    deliveryProvider?: string;
-    deliveryType?: string;
-    shippingPrice?: number;
-    stopDeskId?: number;
-    trackingNumber?: string;
-    trackingStatus?: string;
-    total: number;
-    status: string;
-    items: OrderItem[];
-    createdAt: string;
-    updatedAt?: string;
+  id: string;
+  customerName: string;
+  customerPhone: string;
+  customerAddress: string;
+  customerCity: string;
+  customerWilaya: string;
+  deliveryProvider?: string;
+  deliveryType?: string;
+  shippingPrice?: number;
+  stopDeskId?: number;
+  trackingNumber?: string;
+  trackingStatus?: string;
+  total: number;
+  status: string;
+  items: OrderItem[];
+  createdAt: string;
+  updatedAt?: string;
 }
 
 // ---- Product Types ----
 
 export interface Product {
-    id: string;
-    slug: string;
-    nameFr: string;
-    nameAr: string;
-    descriptionFr: string;
-    descriptionAr: string;
-    price: number;
-    images: string; // JSON string
-    sizes: string;  // JSON string
-    colors: string; // JSON string
-    stock: number;
-    isActive: boolean;
-    collectionId?: string;
-    collection?: Collection;
-    createdAt: string;
-    updatedAt: string;
+  id: string;
+  slug: string;
+  nameFr: string;
+  nameAr: string;
+  descriptionFr: string;
+  descriptionAr: string;
+  price: number;
+  images: string; // JSON string
+  sizes: string; // JSON string
+  colors: string; // JSON string
+  stock: number;
+  isActive: boolean;
+  collectionId?: string;
+  collection?: Collection;
+  createdAt: string;
+  updatedAt: string;
 }
 
 export interface Collection {
-    id: string;
-    slug: string;
-    nameFr: string;
-    nameAr: string;
-    description?: string;
-    image?: string;
-    products?: Product[];
-    createdAt: string;
-    updatedAt: string;
+  id: string;
+  slug: string;
+  nameFr: string;
+  nameAr: string;
+  description?: string;
+  image?: string;
+  products?: Product[];
+  createdAt: string;
+  updatedAt: string;
 }
 
 // ---- Loyalty Types ----
 
 export interface Customer {
-    id: string;
-    phone: string;
-    name?: string;
-    email?: string;
-    points: number;
-    totalSpent: number;
-    totalOrders: number;
-    birthday?: string;
-    birthdayBonusAt?: string;
-    redeemablePoints?: number;
-    redeemableValue?: number;
+  id: string;
+  phone: string;
+  name?: string;
+  email?: string;
+  points: number;
+  totalSpent: number;
+  totalOrders: number;
+  birthday?: string;
+  birthdayBonusAt?: string;
+  redeemablePoints?: number;
+  redeemableValue?: number;
 }
 
 export interface LoyaltyTransaction {
-    id: string;
-    customerId: string;
-    type: 'EARN' | 'REDEEM' | 'BONUS' | 'BIRTHDAY' | 'REVIEW';
-    points: number;
-    description?: string;
-    orderId?: string;
-    createdAt: string;
+  id: string;
+  customerId: string;
+  type: "EARN" | "REDEEM" | "BONUS" | "BIRTHDAY" | "REVIEW";
+  points: number;
+  description?: string;
+  orderId?: string;
+  createdAt: string;
 }
 
 export interface LoyaltyConfig {
-    pointsPerDinar: number;
-    redeemThreshold: number;
-    redeemValue: number;
-    birthdayBonus: number;
-    reviewBonus: number;
-    firstOrderBonus: number;
+  pointsPerDinar: number;
+  redeemThreshold: number;
+  redeemValue: number;
+  birthdayBonus: number;
+  reviewBonus: number;
+  firstOrderBonus: number;
 }
 
 // ---- Stock Alert Types ----
 
 export interface StockAlert {
-    id: string;
-    productId: string;
-    email?: string;
-    phone?: string;
-    size?: string;
-    color?: string;
-    notified: boolean;
-    createdAt: string;
+  id: string;
+  productId: string;
+  email?: string;
+  phone?: string;
+  size?: string;
+  color?: string;
+  notified: boolean;
+  createdAt: string;
 }
 
 // ---- Validation Types ----
 
 export interface ValidationResult {
-    valid: boolean;
-    errors: string[];
+  valid: boolean;
+  errors: string[];
 }
 
 // ---- API Response Types ----
 
 export interface ApiError {
-    error: string;
-    details?: string[];
-    status?: number;
+  error: string;
+  details?: string[];
+  status?: number;
 }
 
 export interface ApiSuccess<T> {
-    data: T;
-    message?: string;
+  data: T;
+  message?: string;
 }
 
 export type ApiResponse<T> = ApiSuccess<T> | ApiError;
diff --git a/src/types/index.ts b/src/types/index.ts
index 06c9530..635122e 100644
--- a/src/types/index.ts
+++ b/src/types/index.ts
@@ -1,158 +1,169 @@
 // Product Types
 export interface Product {
-    id: string;
-    nameFr: string;
-    nameAr: string;
-    descriptionFr: string;
-    descriptionAr: string;
-    price: number;
-    images: string; // JSON string - use parseImages() to get string[]
-    sizes: string;  // JSON string - use parseSizes() to get string[]
-    colors: string; // JSON string - use parseColors() to get string[]
-    stock: number;
-    isActive: boolean;
-    collectionId: string | null;
-    collection?: Collection | null;
-    createdAt: Date;
-    updatedAt: Date;
+  id: string;
+  nameFr: string;
+  nameAr: string;
+  descriptionFr: string;
+  descriptionAr: string;
+  price: number;
+  images: string; // JSON string - use parseImages() to get string[]
+  sizes: string; // JSON string - use parseSizes() to get string[]
+  colors: string; // JSON string - use parseColors() to get string[]
+  stock: number;
+  isActive: boolean;
+  collectionId: string | null;
+  collection?: Collection | null;
+  createdAt: Date;
+  updatedAt: Date;
 }
 
-export interface ProductWithParsedData extends Omit<Product, 'images' | 'sizes' | 'colors'> {
-    images: string[];
-    sizes: string[];
-    colors: string[];
+export interface ProductWithParsedData extends Omit<
+  Product,
+  "images" | "sizes" | "colors"
+> {
+  images: string[];
+  sizes: string[];
+  colors: string[];
 }
 
 // Collection Types
 export interface Collection {
-    id: string;
-    nameFr: string;
-    nameAr: string;
-    image: string | null;
-    products?: Product[];
-    createdAt: Date;
-    updatedAt: Date;
+  id: string;
+  nameFr: string;
+  nameAr: string;
+  image: string | null;
+  products?: Product[];
+  createdAt: Date;
+  updatedAt: Date;
 }
 
 // Order Types
-export type OrderStatus = 'PENDING' | 'CONFIRMED' | 'SHIPPED' | 'DELIVERED' | 'CANCELLED';
+export type OrderStatus =
+  | "PENDING"
+  | "CONFIRMED"
+  | "SHIPPED"
+  | "DELIVERED"
+  | "CANCELLED";
 
 export interface Order {
-    id: string;
-    customerName: string;
-    customerPhone: string;
-    customerAddress: string;
-    customerCity: string;
-    customerWilaya: string;
-    deliveryProvider: string | null;
-    deliveryType: string | null;
-    shippingPrice: number | null;
-    total: number;
-    status: OrderStatus;
-    items: OrderItem[];
-    createdAt: Date;
-    updatedAt: Date;
+  id: string;
+  customerName: string;
+  customerPhone: string;
+  customerAddress: string;
+  customerCity: string;
+  customerWilaya: string;
+  deliveryProvider: string | null;
+  deliveryType: string | null;
+  shippingPrice: number | null;
+  total: number;
+  status: OrderStatus;
+  items: OrderItem[];
+  createdAt: Date;
+  updatedAt: Date;
 }
 
 export interface OrderItem {
-    id: string;
-    orderId: string;
-    productId: string | null;
-    productName: string;
-    size: string;
-    color: string;
-    quantity: number;
-    price: number;
+  id: string;
+  orderId: string;
+  productId: string | null;
+  productName: string;
+  size: string;
+  color: string;
+  quantity: number;
+  price: number;
 }
 
 // Cart Types
 export interface CartItem {
-    id: string;
-    productId: string;
-    name: string;
-    price: number;
-    image: string;
-    size: string;
-    color: string;
-    quantity: number;
+  id: string;
+  productId: string;
+  name: string;
+  price: number;
+  image: string;
+  size: string;
+  color: string;
+  quantity: number;
 }
 
 // Delivery Types
-export type DeliveryProvider = 'ZR Express' | 'Yalidine';
-export type DeliveryType = 'HOME' | 'DESK';
+export type DeliveryProvider = "ZR Express" | "Yalidine";
+export type DeliveryType = "HOME" | "DESK";
 
 export interface DeliveryRate {
-    wilayaCode: number;
-    wilayaName: string;
-    zrExpressHome: number;
-    zrExpressDesk: number;
-    yalidineHome: number;
-    yalidineDesk: number;
+  wilayaCode: number;
+  wilayaName: string;
+  zrExpressHome: number;
+  zrExpressDesk: number;
+  yalidineHome: number;
+  yalidineDesk: number;
 }
 
 // API Response Types
 export interface ApiResponse<T> {
-    data?: T;
-    error?: string;
-    details?: string[];
+  data?: T;
+  error?: string;
+  details?: string[];
 }
 
 // Form Types
 export interface ProductFormData {
-    nameFr: string;
-    nameAr: string;
-    descriptionFr: string;
-    descriptionAr: string;
-    price: string;
-    sizes: string;
-    colors: string;
-    stock: string;
-    collectionId: string;
+  nameFr: string;
+  nameAr: string;
+  descriptionFr: string;
+  descriptionAr: string;
+  price: string;
+  sizes: string;
+  colors: string;
+  stock: string;
+  collectionId: string;
 }
 
 export interface CollectionFormData {
-    nameFr: string;
-    nameAr: string;
-    image: string;
+  nameFr: string;
+  nameAr: string;
+  image: string;
 }
 
 export interface CheckoutFormData {
-    firstName: string;
-    lastName: string;
-    phone: string;
-    address: string;
-    city: string;
-    wilaya: string;
+  firstName: string;
+  lastName: string;
+  phone: string;
+  address: string;
+  city: string;
+  wilaya: string;
 }
 
 // Helper Functions
 export function parseProductData(product: Product): ProductWithParsedData {
-    return {
-        ...product,
-        images: JSON.parse(product.images),
-        sizes: JSON.parse(product.sizes),
-        colors: JSON.parse(product.colors),
-    };
+  return {
+    ...product,
+    images: JSON.parse(product.images),
+    sizes: JSON.parse(product.sizes),
+    colors: JSON.parse(product.colors),
+  };
 }
 
 export function getStatusColor(status: OrderStatus): string {
-    const colors: Record<OrderStatus, string> = {
-        PENDING: 'bg-yellow-100 text-yellow-800',
-        CONFIRMED: 'bg-blue-100 text-blue-800',
-        SHIPPED: 'bg-purple-100 text-purple-800',
-        DELIVERED: 'bg-green-100 text-green-800',
-        CANCELLED: 'bg-red-100 text-red-800',
-    };
-    return colors[status] || 'bg-gray-100 text-gray-800';
+  const colors: Record<OrderStatus, string> = {
+    PENDING: "bg-yellow-100 text-yellow-800",
+    CONFIRMED: "bg-blue-100 text-blue-800",
+    SHIPPED: "bg-purple-100 text-purple-800",
+    DELIVERED: "bg-green-100 text-green-800",
+    CANCELLED: "bg-red-100 text-red-800",
+  };
+  return colors[status] || "bg-gray-100 text-gray-800";
 }
 
-export function getStatusLabel(status: OrderStatus, lang: 'fr' | 'ar' = 'fr'): string {
-    const labels: Record<OrderStatus, { fr: string; ar: string }> = {
-        PENDING: { fr: 'En attente', ar: 'في الانتظار' },
-        CONFIRMED: { fr: 'Confirmée', ar: 'مؤكدة' },
-        SHIPPED: { fr: 'Expédiée', ar: 'تم الشحن' },
-        DELIVERED: { fr: 'Livrée', ar: 'تم التوصيل' },
-        CANCELLED: { fr: 'Annulée', ar: 'ملغاة' },
-    };
-    return labels[status]?.[lang] || status;
+export function getStatusLabel(
+  status: OrderStatus,
+  lang: "fr" | "ar" = "fr",
+): string {
+  const labels: Record<OrderStatus, { fr: string; ar: string }> = {
+    PENDING: { fr: "En attente", ar: "في الانتظار" },
+    CONFIRMED: { fr: "Confirmée", ar: "مؤكدة" },
+    SHIPPED: { fr: "Expédiée", ar: "تم الشحن" },
+    DELIVERED: { fr: "Livrée", ar: "تم التوصيل" },
+    CANCELLED: { fr: "Annulée", ar: "ملغاة" },
+  };
+  return labels[status]?.[lang] || status;
 }
-- 
2.51.0

